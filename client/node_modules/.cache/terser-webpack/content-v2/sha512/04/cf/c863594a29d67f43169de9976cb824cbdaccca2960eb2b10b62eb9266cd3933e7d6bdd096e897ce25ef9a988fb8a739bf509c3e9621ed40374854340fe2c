{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{\"D5/R\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"CertifiedFormsModule\",(function(){return certified_forms_module_CertifiedFormsModule}));var common=__webpack_require__(\"ofXK\"),shared=__webpack_require__(\"M0ag\"),fesm2015_router=__webpack_require__(\"tyNb\"),core=__webpack_require__(\"ey9i\"),fesm2015_core=__webpack_require__(\"fXoL\"),browser=__webpack_require__(\"gusg\"),ngx_toastr=__webpack_require__(\"5eHb\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),show_authed_directive=__webpack_require__(\"TYhg\");const _c0=[\"emailInput\"],_c1=[\"conditions\"];function CheckoutComponent_div_8_Template(rf,ctx){if(1&rf&&(fesm2015_core.Qb(0,\"div\",15),fesm2015_core.Qb(1,\"div\",16),fesm2015_core.Qb(2,\"div\",17),fesm2015_core.Mb(3,\"img\",18),fesm2015_core.Pb(),fesm2015_core.Qb(4,\"div\",19),fesm2015_core.Qb(5,\"h2\",20),fesm2015_core.zc(6),fesm2015_core.Pb(),fesm2015_core.Qb(7,\"div\",21),fesm2015_core.Qb(8,\"ul\"),fesm2015_core.Qb(9,\"li\"),fesm2015_core.zc(10,\"Descarga inmediata en formatos Word y PDF\"),fesm2015_core.Pb(),fesm2015_core.Qb(11,\"li\"),fesm2015_core.zc(12,\"Una vez comprado podrás retroceder, modificar el formulario y descargar de nuevo\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(13,\"div\",22),fesm2015_core.Qb(14,\"span\",23),fesm2015_core.zc(15,\"Total:\"),fesm2015_core.Pb(),fesm2015_core.Qb(16,\"span\",24),fesm2015_core.zc(17),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(18,\"div\",25),fesm2015_core.Qb(19,\"span\"),fesm2015_core.Mb(20,\"img\",26),fesm2015_core.Pb(),fesm2015_core.Qb(21,\"span\"),fesm2015_core.Mb(22,\"img\",27),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf){const ctx_r462=fesm2015_core.dc();fesm2015_core.zb(3),fesm2015_core.jc(\"src\",ctx_r462.form.image,fesm2015_core.tc),fesm2015_core.zb(3),fesm2015_core.Ac(ctx_r462.form.title),fesm2015_core.zb(11),fesm2015_core.Bc(\"\",ctx_r462.form.amount,\" €\")}}function CheckoutComponent_div_9_label_7_Template(rf,ctx){if(1&rf){const _r476=fesm2015_core.Rb();fesm2015_core.Qb(0,\"label\",36),fesm2015_core.zc(1,\" ¿Tienes cuenta? \"),fesm2015_core.Qb(2,\"a\",41),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r476),fesm2015_core.dc(2).goToAuth()})),fesm2015_core.zc(3,\"Inicia sesión\"),fesm2015_core.Pb(),fesm2015_core.Pb()}}function CheckoutComponent_div_9_br_8_Template(rf,ctx){1&rf&&fesm2015_core.Mb(0,\"br\")}function CheckoutComponent_div_9_Template(rf,ctx){if(1&rf){const _r478=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",28),fesm2015_core.Qb(1,\"div\",29),fesm2015_core.Qb(2,\"h1\",30),fesm2015_core.zc(3,\"Dirección de correo para recibir el documento\"),fesm2015_core.Pb(),fesm2015_core.Mb(4,\"label\",31),fesm2015_core.Qb(5,\"input\",32,33),fesm2015_core.Zb(\"ngModelChange\",(function($event){return fesm2015_core.rc(_r478),fesm2015_core.dc().email=$event})),fesm2015_core.Pb(),fesm2015_core.yc(7,CheckoutComponent_div_9_label_7_Template,4,0,\"label\",34),fesm2015_core.yc(8,CheckoutComponent_div_9_br_8_Template,1,0,\"br\",35),fesm2015_core.Qb(9,\"div\",36),fesm2015_core.Qb(10,\"label\",37),fesm2015_core.Qb(11,\"input\",38,39),fesm2015_core.Zb(\"ngModelChange\",(function($event){return fesm2015_core.rc(_r478),fesm2015_core.dc().conditionsChecked=$event})),fesm2015_core.Pb(),fesm2015_core.Qb(13,\"span\"),fesm2015_core.zc(14,\"Acepto las condiciones generales de venta \"),fesm2015_core.Qb(15,\"a\",40),fesm2015_core.zc(16,\"(leer las CGV)\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const ctx_r463=fesm2015_core.dc();fesm2015_core.zb(5),fesm2015_core.ic(\"ngModel\",ctx_r463.email),fesm2015_core.zb(2),fesm2015_core.ic(\"appShowAuthed\",!1),fesm2015_core.zb(1),fesm2015_core.ic(\"appShowAuthed\",!0),fesm2015_core.zb(3),fesm2015_core.ic(\"ngModel\",ctx_r463.conditionsChecked)}}function CheckoutComponent_div_10_div_1_Template(rf,ctx){if(1&rf){const _r484=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",46),fesm2015_core.Qb(1,\"label\",47),fesm2015_core.Qb(2,\"div\",48),fesm2015_core.Mb(3,\"img\",49),fesm2015_core.Mb(4,\"img\",50),fesm2015_core.Pb(),fesm2015_core.Qb(5,\"div\",51),fesm2015_core.Qb(6,\"input\",52),fesm2015_core.Zb(\"change\",(function(){return fesm2015_core.rc(_r484),fesm2015_core.dc(2).onPaymentMethodSelected(\"card\")})),fesm2015_core.Pb(),fesm2015_core.zc(7,\" con tarjeta \"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(8,\"label\",53),fesm2015_core.Qb(9,\"div\",48),fesm2015_core.Mb(10,\"img\",54),fesm2015_core.Pb(),fesm2015_core.Qb(11,\"div\",51),fesm2015_core.Qb(12,\"input\",55),fesm2015_core.Zb(\"change\",(function(){return fesm2015_core.rc(_r484),fesm2015_core.dc(2).onPaymentMethodSelected(\"paypal\")})),fesm2015_core.Pb(),fesm2015_core.zc(13,\" con paypal \"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}}function CheckoutComponent_div_10_form_2_Template(rf,ctx){if(1&rf){const _r487=fesm2015_core.Rb();fesm2015_core.Qb(0,\"form\",56),fesm2015_core.Qb(1,\"div\",57),fesm2015_core.Qb(2,\"label\",58),fesm2015_core.zc(3,\"Nombre\"),fesm2015_core.Pb(),fesm2015_core.Qb(4,\"input\",59),fesm2015_core.Zb(\"ngModelChange\",(function($event){return fesm2015_core.rc(_r487),fesm2015_core.dc(2).cardholdersName=$event})),fesm2015_core.Pb(),fesm2015_core.Qb(5,\"div\",60),fesm2015_core.Qb(6,\"div\"),fesm2015_core.Qb(7,\"label\",61),fesm2015_core.zc(8,\"Fecha válida\"),fesm2015_core.Pb(),fesm2015_core.Mb(9,\"div\",62),fesm2015_core.Qb(10,\"small\",63),fesm2015_core.zc(11,\"Fecha de expiración inválida\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(12,\"div\"),fesm2015_core.Qb(13,\"label\",64),fesm2015_core.zc(14,\"CVV / CVC *\"),fesm2015_core.Pb(),fesm2015_core.Mb(15,\"div\",65),fesm2015_core.Qb(16,\"small\",63),fesm2015_core.zc(17,\"CVV Inválido\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(18,\"div\",66),fesm2015_core.Qb(19,\"label\",67),fesm2015_core.zc(20,\"Número de la tarjeta\"),fesm2015_core.Pb(),fesm2015_core.Mb(21,\"div\",68),fesm2015_core.Qb(22,\"small\",63),fesm2015_core.zc(23,\"Número inválido\"),fesm2015_core.Pb(),fesm2015_core.Qb(24,\"span\",69),fesm2015_core.zc(25,\"* El código CVV o CVC es un grupo de 3 o 4 números situado en el reverso de la tarjeta de crédito.\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const ctx_r481=fesm2015_core.dc(2);fesm2015_core.zb(4),fesm2015_core.ic(\"ngModel\",ctx_r481.cardholdersName)}}function CheckoutComponent_div_10_div_3_Template(rf,ctx){1&rf&&fesm2015_core.Mb(0,\"div\",70)}function CheckoutComponent_div_10_Template(rf,ctx){if(1&rf&&(fesm2015_core.Qb(0,\"div\",42),fesm2015_core.yc(1,CheckoutComponent_div_10_div_1_Template,14,0,\"div\",43),fesm2015_core.yc(2,CheckoutComponent_div_10_form_2_Template,26,1,\"form\",44),fesm2015_core.yc(3,CheckoutComponent_div_10_div_3_Template,1,0,\"div\",45),fesm2015_core.Pb()),2&rf){const ctx_r464=fesm2015_core.dc();fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",!1===ctx_r464.loadingPayment),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",!1===ctx_r464.loadingPayment&&\"card\"===ctx_r464.paymentMethod),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"paypal\"===ctx_r464.paymentMethod)}}function CheckoutComponent_div_11_Template(rf,ctx){if(1&rf){const _r489=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",71),fesm2015_core.Qb(1,\"h2\"),fesm2015_core.zc(2),fesm2015_core.Pb(),fesm2015_core.Qb(3,\"div\",22),fesm2015_core.Qb(4,\"span\",72),fesm2015_core.zc(5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"span\",73),fesm2015_core.zc(7),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(8,\"p\",74),fesm2015_core.zc(9,\"Recibirás un mensaje a \"),fesm2015_core.Qb(10,\"strong\"),fesm2015_core.zc(11),fesm2015_core.Pb(),fesm2015_core.zc(12,\" con tu factura así como los documentos. Durante los próximos 15 días podrás modificar el formulario de nuevo sin tener que pagar y volver a descargarlo, una vez terminado el plazo caducará.\"),fesm2015_core.Pb(),fesm2015_core.Qb(13,\"div\",75),fesm2015_core.Qb(14,\"h3\"),fesm2015_core.zc(15,\"Descarga ahora\"),fesm2015_core.Pb(),fesm2015_core.Qb(16,\"span\",76),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r489),fesm2015_core.dc().downloadWord()})),fesm2015_core.Pb(),fesm2015_core.Qb(17,\"span\",77),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r489),fesm2015_core.dc().downloadPdf()})),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const ctx_r465=fesm2015_core.dc();fesm2015_core.zb(2),fesm2015_core.Bc(\"Transacción: \",ctx_r465.transactionId,\"\"),fesm2015_core.zb(3),fesm2015_core.Ac(ctx_r465.form.title),fesm2015_core.zb(2),fesm2015_core.Bc(\"\",ctx_r465.form.amount,\" €\"),fesm2015_core.zb(4),fesm2015_core.Ac(ctx_r465.email)}}const _c2=function(a0){return{opacity:a0}};function CheckoutComponent_button_13_Template(rf,ctx){if(1&rf){const _r492=fesm2015_core.Rb();fesm2015_core.Qb(0,\"button\",78),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r492),fesm2015_core.dc().moveStep(\"previous\")})),fesm2015_core.zc(1,\"Anterior\"),fesm2015_core.Pb()}if(2&rf){const ctx_r466=fesm2015_core.dc();fesm2015_core.xc(\"display\",\"cart\"===ctx_r466.steps[ctx_r466.currentStep].type?\"none\":\"block\"),fesm2015_core.ic(\"ngStyle\",fesm2015_core.lc(4,_c2,\"cart\"===ctx_r466.steps[ctx_r466.currentStep].type?0:1))(\"disabled\",\"cart\"===ctx_r466.steps[ctx_r466.currentStep].type)}}function CheckoutComponent_button_14_Template(rf,ctx){if(1&rf){const _r494=fesm2015_core.Rb();fesm2015_core.Qb(0,\"button\",79),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r494),fesm2015_core.dc().exitModal.emit()})),fesm2015_core.zc(1,\"Anterior\"),fesm2015_core.Pb()}}function CheckoutComponent_button_15_Template(rf,ctx){if(1&rf){const _r496=fesm2015_core.Rb();fesm2015_core.Qb(0,\"button\",79),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r496),fesm2015_core.dc().exitModal.emit()})),fesm2015_core.zc(1,\"Anterior\"),fesm2015_core.Pb()}}function CheckoutComponent_button_16_Template(rf,ctx){if(1&rf){const _r498=fesm2015_core.Rb();fesm2015_core.Qb(0,\"button\",80),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r498),fesm2015_core.dc().moveStep(\"next\")})),fesm2015_core.zc(1,\"Siguiente\"),fesm2015_core.Pb()}if(2&rf){const ctx_r469=fesm2015_core.dc();fesm2015_core.ic(\"ngStyle\",fesm2015_core.lc(2,_c2,\"finish\"===ctx_r469.steps[ctx_r469.currentStep].type?0:1))(\"disabled\",\"finish\"===ctx_r469.steps[ctx_r469.currentStep].type)}}function CheckoutComponent_button_17_Template(rf,ctx){if(1&rf){const _r500=fesm2015_core.Rb();fesm2015_core.Qb(0,\"button\",81),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r500),fesm2015_core.dc().onSubmit()})),fesm2015_core.Qb(1,\"strong\"),fesm2015_core.zc(2,\"PAGAR\"),fesm2015_core.Pb(),fesm2015_core.Pb()}}const _c3=function(a0){return{\"checkout-panel__body__progress-bar__step__active\":a0}};let checkout_component_CheckoutComponent=(()=>{class CheckoutComponent{constructor(userService,checkoutService,formService,commonsService,convertService,router,toastr){this.userService=userService,this.checkoutService=checkoutService,this.formService=formService,this.commonsService=commonsService,this.convertService=convertService,this.router=router,this.toastr=toastr,this.formPaid=new fesm2015_core.n,this.exitModal=new fesm2015_core.n,this.downloadPdfOutput=new fesm2015_core.n,this.downloadWordOutput=new fesm2015_core.n,this.currentStep=0,this.loadingPayment=!0,this.idsOfFields=[\"number\",\"cvv\",\"expirationDate\"],this.paymentMethod=\"card\",this.steps=[{type:\"cart\",stepNum:0},{type:\"login\",stepNum:1},{type:\"payment\",stepNum:2},{type:\"finish\",stepNum:3}]}ngOnInit(){this.userService.isAuthenticated.subscribe(isAuthenticated=>{this.email=isAuthenticated?this.userService.getCurrentUser().email:\"\"}),this.form.fields[this.form.fields.length-1]&&(this.currentStep=this.form.fields[this.form.fields.length-1].checkoutProcess.phase,\"payment\"===this.steps[this.currentStep].type&&(this.currentStep=this.currentStep-1))}moveStep(type){\"next\"===type?this.validateBeforeNextStep()&&(this.currentStep+=1):\"previous\"===type&&(this.currentStep-=1),this.form.fields[this.form.fields.length-1].checkoutProcess.phase=this.currentStep,this.paymentProcess()}validateBeforeNextStep(){if(\"login\"===this.steps[this.currentStep].type){if(\"\"===this.email)return this.emailInput.nativeElement.style.borderBottom=\"3px solid red\",this.toastr.error(\"Email no puede estar vacío\",\"Email vacío\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"}),!1;if(!this.conditions.nativeElement.checked)return this.toastr.error(\"Debe aceptar las condiciones de venta\",\"Aceptar\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"}),!1}return!0}goToAuth(){window.sessionStorage&&(window.sessionStorage[this.form.title]=JSON.stringify(this.form),this.router.navigate([\"/auth/login\"],{queryParams:{formPath:this.router.url.substring(this.router.url.lastIndexOf(\"/\")+1)}}))}onSubmit(){this.tokenizeUserDetails()}onPaymentMethodSelected(method){this.paymentMethod=method,this.paymentProcess()}paymentProcess(){\"payment\"===this.steps[this.currentStep].type?(this.commonsService.toggleSpinner(),this.checkoutService.getToken(this.paymentMethod).subscribe(token=>{this.loadingPayment=!1,this.clientToken=token,this.createBraintreeUI(token)})):this.loadingPayment=!0}tokenizeUserDetails(){this.commonsService.toggleSpinner(),this.hostedFieldsInstance.tokenize({cardholderName:this.cardholdersName}).then(payload=>{this.checkoutService.pay(JSON.stringify(this.form.fields),this.email,payload.nonce,this.form.id,this.paymentMethod).subscribe(data=>{data.transaction?(this.commonsService.toggleSpinner(),this.moveStep(\"next\"),this.onPaymentCompleted(data.transaction.transactionId),this.toastr.success(\"Pago completado\",\"Finalizado\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"})):this.commonsService.toggleSpinner()})}).catch(error=>{this.commonsService.toggleSpinner(),this.toastr.error(\"Ha ocurrido un error, inténtelo de nuevo\",\"Error en el pago\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"}),console.log(error),\"HOSTED_FIELDS_FIELDS_INVALID\"===error.code?this.idsOfFields.forEach(id=>{if(error.details.invalidFieldKeys.includes(id)){const el=document.getElementById(id);el.classList.add(\"hosted-fields-invalid\"),el.nextElementSibling.hidden=!1}else{const el=document.getElementById(id);el.classList.remove(\"hosted-fields-invalid\"),el.nextElementSibling.hidden=!0}}):\"HOSTED_FIELDS_FIELDS_EMPTY\"===error.code&&this.idsOfFields.forEach(id=>{const el=document.getElementById(id);el.classList.add(\"hosted-fields-invalid\"),el.nextElementSibling.hidden=!1})})}createBraintreeUI(TOKEN){\"card\"===this.paymentMethod?browser.client.create({authorization:TOKEN}).then(clientInstance=>{browser.hostedFields.create({client:clientInstance,styles:{input:{\"font-size\":\"16px\",padding:\"0.5rem 0.25rem 0.5rem\",\"font-family\":\"Lato\",\"font-weight\":\"300\",color:\"rgba(46, 46, 46, 0.8)\"},\"::placeholder\":{transition:\"transition: 100ms linear\",\"font-weight\":\"300\",\"font-family\":\"Lato\",color:\"#4ECDC4\"},\":focus\":{\"border-color\":\"#77db77\",\"border-bottom\":\"3px solid #77db77\"},\"input:focus\":{\"border-color\":\"#77db77\",\"border-bottom\":\"3px solid #77db77\"}},fields:{number:{selector:\"#\"+this.idsOfFields[0],placeholder:\"1234 5678 9101 1213\"},cvv:{selector:\"#\"+this.idsOfFields[1],placeholder:\"111\"},expirationDate:{selector:\"#\"+this.idsOfFields[2],placeholder:\"02/20\"}}}).then(hostedFieldsInstance=>{this.hostedFieldsInstance=hostedFieldsInstance;const fields=hostedFieldsInstance.getState().fields;Object.keys(fields).every((function(field){return fields[field].isValid})),this.commonsService.toggleSpinner()})}):\"paypal\"===this.paymentMethod&&(this.commonsService.toggleSpinner(),paypal.Button.render({braintree:browser,env:\"sandbox\",client:{sandbox:TOKEN},style:{size:\"medium\"},payment:(data,actions)=>(this.commonsService.toggleSpinner(),actions.payment.create({payment:{transactions:[{amount:{total:this.form.amount,currency:\"EUR\"}}]}})),onAuthorize:(data,actions)=>(this.commonsService.toggleSpinner(),actions.payment.tokenize().then(payload=>{this.commonsService.toggleSpinner(),this.checkoutService.pay(JSON.stringify(this.form.fields),this.email,payload.nonce,this.form.id,this.paymentMethod).subscribe(result=>{this.commonsService.toggleSpinner(),this.moveStep(\"next\"),this.onPaymentCompleted(result.transaction.transactionId),this.toastr.success(\"Pago completado\",\"Finalizado\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"})})})),onCancel:function(data){console.log(\"checkout.js payment cancelled\",JSON.stringify(data))},onError:function(error){this.commonsService.toggleSpinner(),this.toastr.error(\"Paypal error\",error,{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"})}},\"#paypal-button\"))}onPaymentCompleted(transactionId){this.transactionId=transactionId,this.formService.getPaidCertifiedForm(transactionId).subscribe(data=>{data.certifiedForm.transactionId=transactionId,this.formPaid.emit(data.certifiedForm)})}downloadWord(){this.downloadWordOutput.emit()}downloadPdf(){this.downloadPdfOutput.emit()}}return CheckoutComponent.ɵfac=function(t){return new(t||CheckoutComponent)(fesm2015_core.Lb(core.s),fesm2015_core.Lb(core.c),fesm2015_core.Lb(core.k),fesm2015_core.Lb(core.e),fesm2015_core.Lb(core.g),fesm2015_core.Lb(fesm2015_router.d),fesm2015_core.Lb(ngx_toastr.b))},CheckoutComponent.ɵcmp=fesm2015_core.Fb({type:CheckoutComponent,selectors:[[\"app-checkout\"]],viewQuery:function(rf,ctx){var _t;1&rf&&(fesm2015_core.Dc(_c0,!0),fesm2015_core.Dc(_c1,!0)),2&rf&&(fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.emailInput=_t.first),fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.conditions=_t.first))},inputs:{form:\"form\"},outputs:{formPaid:\"formPaid\",exitModal:\"exitModal\",downloadPdfOutput:\"downloadPdfOutput\",downloadWordOutput:\"downloadWordOutput\"},decls:18,vars:18,consts:[[1,\"modal__content__top\",\"modal__content__top--privacy\"],[1,\"checkout-panel__body__progress-bar\"],[1,\"checkout-panel__body__progress-bar__step\",\"checkout-panel__body__progress-bar__step__active\"],[1,\"checkout-panel__body__progress-bar__step\",3,\"ngClass\"],[\"id\",\"modal-middle-privacy\",1,\"modal__content__modal-middle\",\"modal__content__modal-middle--privacy\",2,\"border-bottom\",\"none\"],[1,\"modal__content__modal-middle__container\"],[\"class\",\"checkout-panel__body__invoice\",4,\"ngIf\"],[\"class\",\"checkout-panel__body__email\",4,\"ngIf\"],[\"class\",\"payment-container\",4,\"ngIf\"],[\"class\",\"checkout-panel__body__success\",4,\"ngIf\"],[1,\"modal__content__modal-bottom\",\"modal__content__modal-bottom--privacy\",\"checkout-panel__footer\"],[\"class\",\"btn back-btn\",3,\"ngStyle\",\"display\",\"disabled\",\"click\",4,\"ngIf\"],[\"class\",\"btn back-btn\",3,\"click\",4,\"ngIf\"],[\"class\",\"btn next-btn\",3,\"ngStyle\",\"disabled\",\"click\",4,\"ngIf\"],[\"class\",\"btn next-btn secondaryC-background-color\",3,\"click\",4,\"ngIf\"],[1,\"checkout-panel__body__invoice\"],[1,\"checkout-panel__body__invoice__container\"],[1,\"checkout-panel__body__invoice__document\"],[\"alt\",\"checkout-image\",3,\"src\"],[1,\"checkout-panel__body__invoice__text\"],[1,\"checkout-panel__body__invoice__text__title\"],[1,\"checkout-panel__body__invoice__text__description\"],[1,\"checkout-panel__body__invoice__text__total\"],[1,\"checkout-panel__body__invoice__text__total__right\"],[1,\"checkout-panel__body__invoice__text__total__left\"],[1,\"checkout-panel__body__invoice__text__more-info\"],[\"src\",\"/assets/images/ssl-secure-en.png\",\"alt\",\"secure payment\"],[\"src\",\"https://s3.amazonaws.com/braintree-badges/braintree-badge-dark.png\"],[1,\"checkout-panel__body__email\"],[1,\"checkout-panel__body__email__container\"],[1,\"checkout-panel__body__email__container__title\"],[\"for\",\"email\"],[\"type\",\"email\",\"name\",\"email\",\"id\",\"name\",\"placeholder\",\"Email\",3,\"ngModel\",\"ngModelChange\"],[\"emailInput\",\"\"],[\"class\",\"checkout-panel__body__email__container__message\",4,\"appShowAuthed\"],[4,\"appShowAuthed\"],[1,\"checkout-panel__body__email__container__message\"],[\"for\",\"conditions\"],[\"type\",\"checkbox\",\"name\",\"conditions\",\"id\",\"conditions\",1,\"filled-in\",3,\"ngModel\",\"ngModelChange\"],[\"conditions\",\"\"],[\"routerLink\",\"/static-pages/cgv\",\"target\",\"_blank\",1,\"trigger\"],[\"href\",\"javascript:void(0)\",3,\"click\"],[1,\"payment-container\"],[\"class\",\"checkout-panel__body__payment-method\",4,\"ngIf\"],[\"class\",\"checkout-panel__body__input-fields\",4,\"ngIf\"],[\"id\",\"paypal-button\",\"style\",\"height: 200px; margin-left: auto;margin-right:auto; display: flex;align-items: center;\",4,\"ngIf\"],[1,\"checkout-panel__body__payment-method\"],[\"for\",\"card\",1,\"checkout-panel__body__payment-method__method\",\"card\"],[1,\"checkout-panel__body__payment-method__method__card-logos\"],[\"src\",\"https://designmodo.com/demo/checkout-panel/img/visa_logo.png\"],[\"src\",\"https://designmodo.com/demo/checkout-panel/img/mastercard_logo.png\"],[1,\"checkout-panel__body__payment-method__method__radio-input\"],[\"id\",\"card\",\"type\",\"radio\",\"name\",\"payment\",\"value\",\"card\",\"checked\",\"\",3,\"change\"],[\"for\",\"paypal\",1,\"checkout-panel__body__payment-method__method\",\"paypal\"],[\"src\",\"https://designmodo.com/demo/checkout-panel/img/paypal_logo.png\"],[\"id\",\"paypal\",\"type\",\"radio\",\"name\",\"payment\",\"value\",\"paypal\",3,\"change\"],[1,\"checkout-panel__body__input-fields\"],[1,\"checkout-panel__body__input-fields__column-1\"],[\"for\",\"cardholder-name\",\"name\",\"cardholderName\",1,\"hosted-field--label\"],[\"type\",\"text\",\"id\",\"cardholder\",\"placeholder\",\"P. ej: Juan Pérez Álvarez\",\"name\",\"cardholderName\",1,\"name-custom-input\",3,\"ngModel\",\"ngModelChange\"],[1,\"checkout-panel__body__input-fields__small-inputs\"],[\"for\",\"expirationDate\"],[\"id\",\"expirationDate\",1,\"hosted-fields\"],[\"hidden\",\"\",1,\"secondary-color\"],[\"for\",\"cvv\"],[\"id\",\"cvv\",\"name\",\"cvv\",1,\"hosted-fields\"],[1,\"checkout-panel__body__input-fields__column-2\"],[\"for\",\"number\"],[\"id\",\"number\",1,\"hosted-fields\"],[1,\"info\"],[\"id\",\"paypal-button\",2,\"height\",\"200px\",\"margin-left\",\"auto\",\"margin-right\",\"auto\",\"display\",\"flex\",\"align-items\",\"center\"],[1,\"checkout-panel__body__success\"],[1,\"checkout-panel__body__invoice__text__total__right\",\"total-success\"],[1,\"checkout-panel__body__invoice__text__total__left\",\"total-success\"],[1,\"checkout-panel__body__success__message\"],[1,\"checkout-panel__body__success__download\"],[1,\"icon\",\"icon-file-word-solid\",\"trigger\",3,\"click\"],[1,\"icon\",\"icon-file-pdf-solid\",3,\"click\"],[1,\"btn\",\"back-btn\",3,\"ngStyle\",\"disabled\",\"click\"],[1,\"btn\",\"back-btn\",3,\"click\"],[1,\"btn\",\"next-btn\",3,\"ngStyle\",\"disabled\",\"click\"],[1,\"btn\",\"next-btn\",\"secondaryC-background-color\",3,\"click\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Mb(2,\"div\",2),fesm2015_core.Mb(3,\"div\",3),fesm2015_core.Mb(4,\"div\",3),fesm2015_core.Mb(5,\"div\",3),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",4),fesm2015_core.Qb(7,\"div\",5),fesm2015_core.yc(8,CheckoutComponent_div_8_Template,23,3,\"div\",6),fesm2015_core.yc(9,CheckoutComponent_div_9_Template,17,4,\"div\",7),fesm2015_core.yc(10,CheckoutComponent_div_10_Template,4,3,\"div\",8),fesm2015_core.yc(11,CheckoutComponent_div_11_Template,18,4,\"div\",9),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(12,\"div\",10),fesm2015_core.yc(13,CheckoutComponent_button_13_Template,2,6,\"button\",11),fesm2015_core.yc(14,CheckoutComponent_button_14_Template,2,0,\"button\",12),fesm2015_core.yc(15,CheckoutComponent_button_15_Template,2,0,\"button\",12),fesm2015_core.yc(16,CheckoutComponent_button_16_Template,2,4,\"button\",13),fesm2015_core.yc(17,CheckoutComponent_button_17_Template,3,0,\"button\",14),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(3),fesm2015_core.ic(\"ngClass\",fesm2015_core.lc(12,_c3,ctx.steps[ctx.currentStep].stepNum>0)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngClass\",fesm2015_core.lc(14,_c3,ctx.steps[ctx.currentStep].stepNum>1)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngClass\",fesm2015_core.lc(16,_c3,ctx.steps[ctx.currentStep].stepNum>2)),fesm2015_core.zb(3),fesm2015_core.ic(\"ngIf\",\"cart\"===ctx.steps[ctx.currentStep].type),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"login\"===ctx.steps[ctx.currentStep].type),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"payment\"===ctx.steps[ctx.currentStep].type),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"finish\"===ctx.steps[ctx.currentStep].type),fesm2015_core.zb(2),fesm2015_core.ic(\"ngIf\",\"finish\"!==ctx.steps[ctx.currentStep].type),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"cart\"===ctx.steps[ctx.currentStep].type),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"finish\"===ctx.steps[ctx.currentStep].type),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"payment\"!==ctx.steps[ctx.currentStep].type),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"payment\"===ctx.steps[ctx.currentStep].type&&\"card\"===ctx.paymentMethod))},directives:[common.q,common.t,fesm2015_forms.c,fesm2015_forms.q,fesm2015_forms.t,show_authed_directive.a,fesm2015_forms.a,fesm2015_router.g,fesm2015_forms.G,fesm2015_forms.r,fesm2015_forms.s,common.w],encapsulation:2}),CheckoutComponent})();var BehaviorSubject=__webpack_require__(\"2Vo4\"),distinctUntilChanged=__webpack_require__(\"/uUt\");let shared_service_SharedService=(()=>{class SharedService{constructor(){this.currentFormSubject=new BehaviorSubject.a({}),this.currentForm=this.currentFormSubject.asObservable().pipe(Object(distinctUntilChanged.a)())}setForm(form){this.currentFormSubject.next(Object.assign({},form))}getCurrentForm(){return this.currentFormSubject.value}}return SharedService.ɵfac=function(t){return new(t||SharedService)},SharedService.ɵprov=fesm2015_core.Hb({token:SharedService,factory:SharedService.ɵfac}),SharedService})();var localfileeditor=__webpack_require__(\"KlD3\");let doc_creator_service_DocCreatorService=(()=>{class DocCreatorService{constructor(commonsService,convertService){this.commonsService=commonsService,this.convertService=convertService,this.scrollToelement=!1}init(uri){return this.createEditorFromURI(\"fillForm\",\"editorContainer\",uri),new Promise((resolve,reject)=>{const checkIfEditorCreated=setInterval(()=>{window.editor&&window.editor.getEditorSession()&&document.getElementsByTagName(\"office:text\").length&&(this.originalDocumentBodyClone=document.getElementsByTagName(\"office:text\")[0].cloneNode(!0),clearInterval(checkIfEditorCreated),resolve(\"Document ready\"))},300)})}destroy(){this.commonsService.isBrowser()&&(localfileeditor.closeAndDestroyEditor(),window.removeEventListener(\"resize\",this.resizeEvent))}createEditorFromURI(formType,idOfContainer=\"editorContainer\",dataURI){const byteString=atob(dataURI.split(\",\")[1]),mimeString=dataURI.split(\",\")[0].split(\":\")[1].split(\";\")[0],ab=new ArrayBuffer(byteString.length),ia=new Uint8Array(ab);for(let i=0;i<byteString.length;i++)ia[i]=byteString.charCodeAt(i);const blob=new Blob([ab],{type:mimeString}),url=URL.createObjectURL(blob);window.DOCUMENTOURL=url,localfileeditor.createEditor(formType,idOfContainer)}getEditorSession(){return localfileeditor.getEditorSession()}saveUri(){const reader=new FileReader;return new Promise((resolve,reject)=>{localfileeditor.getEditor().getDocumentAsByteArray((err,data)=>{if(err)return void alert(err);const blob=new Blob([data.buffer],{type:\"application/vnd.oasis.opendocument.text\"});reader.readAsDataURL(blob),reader.onloadend=()=>{resolve(reader.result)}})})}resizeDocumentContainer(){this.resizeEvent=()=>{setTimeout(()=>{document.getElementById(\"webodfeditor-editor1\").style.height=\"100%\",document.getElementById(\"webodfeditor-editor1\").style.width=\"100%\",localfileeditor.documentToFitScreen()},100)},window.addEventListener(\"resize\",this.resizeEvent),localfileeditor.documentToFitScreen()}buildDocument(steps,scrollToElement,buildJustReplacements=!1){this.currentDocumentBodyClone=this.originalDocumentBodyClone.cloneNode(!0),buildJustReplacements?(this.currentDocumentBodyClone=this.documentBodyCloneJustForReplacements.cloneNode(!0),this.currentDocumentBodyClone.querySelectorAll(\".highlight-disapear\").forEach(element=>{element.classList.remove(\"highlight-disapear\"),element.classList.remove(\"focused\")})):this.structuralChanges(steps),this.replacements(steps),document.getElementsByTagName(\"office:text\")[0].parentElement.replaceChild(this.currentDocumentBodyClone.cloneNode(!0),document.getElementsByTagName(\"office:text\")[0]),this.getEditorSession().getOdfCanvas().refreshSize(),scrollToElement&&this.scrollToElementWithClass(\"focused\")}scrollToElementWithClass(className,offset=0){const element=document.querySelector(\".\"+className);if(element){const cont=document.getElementById(\"webodfeditor-canvascontainer1\"),h=cont.clientHeight/2,elementTop=element.getBoundingClientRect().top;cont.scrollTo({top:cont.scrollTop+elementTop-h,behavior:\"smooth\"})}}dateToSpanishFormat(dateSelected){const dateSelectedObject=new Date(dateSelected);let dateToReturn=\"\";return dateSelected&&(dateToReturn=dateSelectedObject.toLocaleDateString(\"es-ES\",{year:\"numeric\",month:\"long\",day:\"numeric\"})),dateToReturn}showIndicationInsideText(wordToReplace,indications){const elementContainingWord=document.querySelector(`[data-identifier=${wordToReplace}]`),para=document.createElement(\"div\");para.innerHTML=`<div class=\"indicator-content not-selectable\">\\n                        <button id=\"close-indication\">&#10006;</button>\\n                        <span class=\"not-selectable\" style=\"margin:auto; width:100%\">${indications}\\n                        </span>\\n                    </div>`,para.style.top=elementContainingWord.getBoundingClientRect().top.toString(),para.style.left=elementContainingWord.getBoundingClientRect().left.toString(),para.classList.add(\"indicator\"),para.classList.add(\"smooth-intro\"),para.classList.add(\"not-selectable\"),elementContainingWord.appendChild(para);const removeIndication=e=>{window.innerWidth>885?e.target.classList.contains(\"icon-info-circle-solid\")||e.target.classList.contains(\"indication\")?document.querySelectorAll(\".indicator\").length>=2&&(para.parentNode.removeChild(para),window.removeEventListener(\"click\",removeIndication)):(para.parentNode.removeChild(para),window.removeEventListener(\"click\",removeIndication)):\"scrollToTop\"!==e.target.id&&\"close-indication\"!==e.target.id||(para.parentNode.removeChild(para),window.removeEventListener(\"click\",removeIndication))};window.addEventListener(\"click\",removeIndication),this.scrollToElementWithClass(\"indicator\",para.offsetHeight)}structuralChanges(steps){steps.forEach(step=>{\"iRadioC\"===step.type?this.buildForRadioC(step):\"iCheckbox\"===step.type?this.buildForCheckbox(step):\"iForEach\"===step.type&&this.buildForEach(step)}),this.documentBodyCloneJustForReplacements=this.currentDocumentBodyClone.cloneNode(!0)}buildForEach(step){step.content.forEach(content=>{const elementContainingWord=this.findword(content.wordToReplace);if(elementContainingWord.textContent===content.wordToReplace)content.modifiedReplacements.slice().reverse().forEach((modifiedReplacement,index)=>{let exactElementContainingWord;const regexp=new RegExp(step.wordToReplace,\"g\");if(index!==content.modifiedReplacements.length-1){const elementContainingWordClone=elementContainingWord.cloneNode(!0);if(elementContainingWord.parentNode.insertBefore(elementContainingWordClone,elementContainingWord.nextSibling),step.forEachFocused){const newSpan=document.createElement(\"span\");for(newSpan.classList.add(\"highlight-disapear\",\"focused\"),elementContainingWordClone.childNodes.forEach(child=>{newSpan.appendChild(child)});elementContainingWordClone.firstChild;)elementContainingWordClone.removeChild(elementContainingWordClone.firstChild);elementContainingWordClone.appendChild(newSpan)}exactElementContainingWord=elementContainingWordClone}else exactElementContainingWord=elementContainingWord;exactElementContainingWord=this.findExactContainingElement(step.wordToReplace,exactElementContainingWord),exactElementContainingWord.innerHTML=exactElementContainingWord.innerHTML.replace(regexp,modifiedReplacement)}),content.modifiedExtraReplacements.slice().reverse().forEach((modifiedExtraReplacement,index)=>{modifiedExtraReplacement.forEach(modifiedExtraReplacementArray=>{const elementContainingWord2=this.findword(modifiedExtraReplacementArray[0].identifier);modifiedExtraReplacementArray.slice().reverse().forEach((modifiedReplacement,indexNewArray3)=>{let exactElementContainingWord2;const regexp=new RegExp(modifiedReplacement.identifier,\"g\");if(indexNewArray3!==modifiedExtraReplacementArray.length-1){const elementContainingWordClone=elementContainingWord2.cloneNode(!0);elementContainingWord2.parentNode.insertBefore(elementContainingWordClone,elementContainingWord2.nextSibling),exactElementContainingWord2=this.findExactContainingElement(modifiedReplacement.identifier,elementContainingWordClone)}else exactElementContainingWord2=this.findExactContainingElement(modifiedReplacement.identifier,elementContainingWord2);exactElementContainingWord2.innerHTML=exactElementContainingWord2.innerHTML.replace(regexp,modifiedReplacement.replacement)})})});else if(elementContainingWord.textContent.includes(content.wordToReplace)&&elementContainingWord.childElementCount<=1){const newarray=content.modifiedReplacements.slice().reverse(),regexp=new RegExp(step.wordToReplace,\"g\"),textContent=elementContainingWord.textContent,firstHalfString=textContent.slice(0,textContent.indexOf(content.wordToReplace));let secondHalfStringWithoutWordtoReplace=textContent.slice(textContent.indexOf(content.wordToReplace),textContent.length).replace(regexp,\"\");newarray.forEach((modifiedReplacement,index)=>{secondHalfStringWithoutWordtoReplace=modifiedReplacement+secondHalfStringWithoutWordtoReplace}),elementContainingWord.innerHTML=`<span>${firstHalfString+secondHalfStringWithoutWordtoReplace}</span>`}}),step.forEachFocused=!1}buildForRadioC(step){let elementContainingWord=this.findword(step.wordToReplace);const regexp=new RegExp(step.wordToReplace,\"g\");let replacement;for(step.radios.forEach(radio=>{radio.checked&&(replacement=step.isFocused||step.radioCfocused?`<span class=\"highlight-disapear focused\">${radio.replacement}</span>`:radio.replacement,step.extraReplacements.forEach((extraReplacement,index)=>{const regexp2=new RegExp(extraReplacement.wordToReplace,\"g\"),elementContainingReplacementWord=this.findword(extraReplacement.wordToReplace),exactElementContainingReplacementWord=this.findExactContainingElement(extraReplacement.wordToReplace,elementContainingReplacementWord);let replacement2;radio.extraReplacements.forEach(radioExtraReplacement=>{radioExtraReplacement.insideId===extraReplacement.insideId&&(replacement2=radioExtraReplacement.replacement)}),exactElementContainingReplacementWord.innerHTML=exactElementContainingReplacementWord.innerHTML.replace(regexp2,replacement2)}))}),elementContainingWord=this.findExactContainingElement(step.wordToReplace,elementContainingWord);null!==elementContainingWord.firstElementChild&&!this.allElementsAreBr(elementContainingWord);)elementContainingWord=elementContainingWord.firstElementChild;elementContainingWord.innerHTML=elementContainingWord.innerHTML.replace(regexp,replacement),step.radioCfocused=!1}allElementsAreBr(elementContainingWord){let allElementsAreBr=!0;const children=elementContainingWord.children;for(let i;i<children.length;i++)\"BR\"!==children[i].tagName&&(allElementsAreBr=!1);return children.length||(allElementsAreBr=!1),allElementsAreBr}buildForCheckbox(step){const elementContainingWord=this.findword(step.wordToReplace);let replacement=step.replacement;step.checkboxes.forEach(checkbox=>{if(step.replacement.includes(checkbox.wordToReplace))if(checkbox.checked){const regexp=new RegExp(checkbox.wordToReplace,\"g\");replacement=replacement.replace(regexp,checkbox.replacement)}else{const regexp=new RegExp(checkbox.wordToReplace,\"g\");replacement=replacement.replace(regexp,\"\")}}),elementContainingWord.innerHTML===step.wordToReplace&&(elementContainingWord.innerHTML=replacement)}replacements(steps){steps.forEach(step=>{if(\"iText\"===step.type||\"iDate\"===step.type||\"iNumber\"===step.type){const elementsContainingWord=this.findAllwords(step.wordToReplace),regexp=new RegExp(step.wordToReplace,\"g\");elementsContainingWord.forEach(elementContainingWord=>{let element=elementContainingWord,replacement=step.replacement;element.innerHTML!==step.wordToReplace&&(element=this.findExactContainingElement(step.wordToReplace,element)),\"iDate\"===step.type&&(replacement=this.dateToSpanishFormat(step.replacement)),step.isEmpty&&(\"\"!==step.replacement?(step.isEmpty.prepend&&(replacement.slice(0,step.isEmpty.prepend.length)===step.isEmpty.prepend&&(replacement=replacement.slice(step.isEmpty.prepend.length,replacement.length)),replacement=step.isEmpty.prepend+replacement),step.isEmpty.append&&(replacement.slice(-step.isEmpty.append.length)===step.isEmpty.append&&(replacement=replacement.slice(0,-step.isEmpty.prepend.length)),replacement+=step.isEmpty.append)):step.isEmpty.defaultValue&&(replacement=step.isEmpty.defaultValue)),element&&(element.innerHTML=element.innerHTML.replace(regexp,`<span class=\"${step.isFocused?\"highlight focused\":\"\"}\" data-identifier=\"${step.wordToReplace}\">${replacement}</span>`))})}else if(\"iRadioB\"===step.type){const elementsContainingWord=this.findAllwords(step.wordToReplace);let replacement;const regexp=new RegExp(step.wordToReplace,\"g\");elementsContainingWord.forEach(elementContainingWord=>{step.radios.forEach(radio=>{if(radio.checked){replacement=radio.replacement;let element=elementContainingWord;element.innerHTML!==step.wordToReplace&&(element=this.findExactContainingElement(step.wordToReplace,element)),element&&(element.innerHTML=element.innerHTML.replace(regexp,`<span class=\" ${step.isFocused?\"highlight focused\":\"\"}\" data-identifier=\"${step.wordToReplace}\">${step.replacement}</span>`))}})})}step.extraReplacements&&step.extraReplacements.length&&step.extraReplacements.forEach(extraReplacement=>{const elementsContainingWord=this.findAllwords(extraReplacement.wordToReplace),regexp=new RegExp(extraReplacement.wordToReplace,\"g\");elementsContainingWord.forEach(elementContainingWord=>{let element=elementContainingWord,replacement=extraReplacement.replacement;element.innerHTML!==extraReplacement.wordToReplace&&(element=this.findExactContainingElement(extraReplacement.wordToReplace,element)),element&&(element.innerHTML=element.innerHTML.replace(regexp,`<span class=\"${extraReplacement.isFocused?\"highlight focused\":\"\"}\" data-identifier=\"${extraReplacement.wordToReplace}\">${replacement}</span>`))})})})}findword(wordToReplace,bodyClone=this.currentDocumentBodyClone){const children=bodyClone.childNodes;for(let i=0;i<children.length;i++)if(!this.elementIsExcluded(children[i])&&(children[i].innerHTML.includes(wordToReplace)||children[i].textContent.includes(wordToReplace)))return children[i]}findAllwords(wordToReplace,bodyClone=this.currentDocumentBodyClone){const allEelementsContainingWord=[],children=bodyClone.childNodes;for(let i=0;i<children.length;i++)this.elementIsExcluded(children[i])||children[i].innerHTML.includes(wordToReplace)&&allEelementsContainingWord.push(children[i]);return allEelementsContainingWord}findExactContainingElement(wordToReplace,bodyClone){let element=bodyClone;for(;element.childNodes&&element.childNodes.length>0&&element.innerHTML.includes(wordToReplace);)element.childNodes.forEach(el=>{\"#text\"!==el.nodeName?el.innerHTML.includes(wordToReplace)&&(element=el):el.textContent.includes(wordToReplace)&&(element=el)});return\"#text\"===element.nodeName&&(element=element.parentNode),element}elementIsExcluded(element){return[\"office:text\",\"text:sequence-decls\",\"text:sequence-decl\",\"draw:frame\",\"draw:image\",\"office:annotation\",\"office:annotation-end\",\"dc:creator\",\"dc:date\"].includes(element.nodeName)}downloadWord(formId,formURI){this.commonsService.toggleSpinner(),this.saveUri().then(uri=>{this.convertService.toWord(formId,uri).subscribe(data=>{const byteString=atob(data.word.split(\",\")[1]),mimeString=data.word.split(\",\")[0].split(\":\")[1].split(\";\")[0],ab=new ArrayBuffer(byteString.length),ia=new Uint8Array(ab);for(let i=0;i<byteString.length;i++)ia[i]=byteString.charCodeAt(i);const blob=new Blob([ab],{type:mimeString}),url=URL.createObjectURL(blob);console.log(url);const a=document.createElement(\"a\");a.href=url,a.download=\"word.doc\",a.click(),this.commonsService.toggleSpinner()})})}downloadPdf(formId,formURI){this.commonsService.toggleSpinner(),this.saveUri().then(uri=>{this.convertService.toPdf(formId,uri).subscribe(data=>{const byteString=atob(data.pdf.split(\",\")[1]),mimeString=data.pdf.split(\",\")[0].split(\":\")[1].split(\";\")[0],ab=new ArrayBuffer(byteString.length),ia=new Uint8Array(ab);for(let i=0;i<byteString.length;i++)ia[i]=byteString.charCodeAt(i);const blob=new Blob([ab],{type:mimeString}),url=URL.createObjectURL(blob);console.log(url);const a=document.createElement(\"a\");a.href=url,a.download=\"document.pdf\",a.click(),this.commonsService.toggleSpinner()})})}}return DocCreatorService.ɵfac=function(t){return new(t||DocCreatorService)(fesm2015_core.Vb(core.e),fesm2015_core.Vb(core.g))},DocCreatorService.ɵprov=fesm2015_core.Hb({token:DocCreatorService,factory:DocCreatorService.ɵfac}),DocCreatorService})(),step_service_StepsService=(()=>{class StepsService{constructor(documentCreatorService,commonsService){this.documentCreatorService=documentCreatorService,this.commonsService=commonsService}init(steps){this.steps=steps,this.cacheSteps=JSON.parse(JSON.stringify(this.steps))}refreshCache(){this.cacheSteps=JSON.parse(JSON.stringify(this.steps))}setInitialState(){if(!this.steps[0].inited){const buildSteps=()=>{this.steps.forEach(step=>{switch(step.type){case\"start\":step.inited=!0;break;case\"iText\":case\"iNumber\":case\"iDate\":this.input(step.replacement,step.wordToReplace,!1);break;case\"iForEach\":this.buildForEach(step.value,step.wordToReplace,!1);break;case\"iRadioB\":step.radios.forEach(radio=>{radio.checked&&this.onInputRadioBSelected(radio.radioId,step.wordToReplace,!1,!0)});break;case\"iRadioC\":let noneIsChecked=!0;step.radios.forEach(radio=>{radio.checked&&(noneIsChecked=!1,this.onInputRadioCSelected(radio.radioId,step.wordToReplace,!1))}),noneIsChecked&&this.onInputRadioCSelected(step.defaultRadioId,step.wordToReplace,!1)}})};for(let i=0;i<5;i++)buildSteps()}this.buildDocument(!1)}buildDocument(scrollToElement=!0,buildJustReplacements=!1,checkCache=!1){checkCache&&this.checkCache(),this.documentCreatorService.buildDocument(this.steps,scrollToElement,buildJustReplacements)}checkCache(){this.steps.forEach(step=>{this.checkIfIsOfType([\"iText\",\"iNumber\",\"iDate\",\"iRadioB\"],step)&&this.cacheSteps.forEach(cacheStep=>{step.wordToReplace===cacheStep.wordToReplace&&(\"iRadioB\"===step.type?cacheStep.radios.forEach(radio=>{radio.checked&&this.onInputRadioBSelected(radio.radioId,step.wordToReplace,!1,!0)}):step.replacement=cacheStep.replacement)})})}checkIfIsOfType(types,step){return types.forEach(type=>{if(step.type===type)return!0}),!1}input(replacement,wordToReplace,buildDocumentAfter=!0,buildJustReplacements=!1){const{step:step,index:index}=this.findStep(wordToReplace,!0,\"wordToReplace\");step.replacement=replacement,step.isFocused=!0,\"iNumber\"===step.type&&this.rulesForInumber(step,index),buildDocumentAfter&&this.buildDocument(!0,buildJustReplacements)}findStep(wordToReplace,setFocus,identifierToUse){let stepFound,indexFound;return this.steps.forEach((step,index)=>{step[identifierToUse]===wordToReplace?(stepFound=step,indexFound=index):setFocus&&(step.isFocused=!1)}),{step:stepFound,index:indexFound}}rulesForInumber(step,index){step.rules&&step.rules.length&&step.rules.forEach(rule=>{\"extraReplacementToCharacter\"===rule.rulename&&step.extraReplacements&&this.extraReplacementToCharacter(step,rule),\"extraReplacementAletras\"===rule.rulename&&step.extraReplacements&&this.extraReplacementAletras(step,rule)})}extraReplacementToCharacter(step,rule){step.extraReplacements.forEach((extraReplacement,i)=>{extraReplacement.wordToReplace===rule.wordToReplace&&step.extraReplacements.splice(i,1)}),step.extraReplacements.push({wordToReplace:rule.wordToReplace,replacement:this.commonsService.precioALetras(step.replacement,{plural:\"euros\",singular:\"euro\",centPlural:\"centavos\",centSingular:\"centavo\"})})}extraReplacementAletras(step,rule){step.extraReplacements.forEach((extraReplacement,i)=>{extraReplacement.wordToReplace===rule.wordToReplace&&step.extraReplacements.splice(i,1)}),step.extraReplacements.push({wordToReplace:rule.wordToReplace,replacement:this.commonsService.numeroALetras(step.replacement)})}buildForEach(value,wordToReplace,buildDocumentAfter=!0,forEachFocused=!1,checkCache=!1){const refreshRadioBSteps=[],refreshRadioCSteps=[],{step:step,index:index}=this.findStep(wordToReplace,!1,\"wordToReplace\");step.forEachFocused=forEachFocused,step.value=value,this.cleanPreviouslyAddedSteps(index,step.identifier),step.content.forEach((content,contentIndex)=>{content.modifiedReplacements=[],content.modifiedExtraReplacements=[];const modifiedExtraReplacements=[];content.extraReplacements.forEach(()=>{modifiedExtraReplacements.push([])});for(let i=0;i<parseInt(value);i++){let modifiedReplacement=content.replacementOriginal;content.extraReplacements.forEach((extraReplacement,indexOfExtraReplace)=>{modifiedExtraReplacements[indexOfExtraReplace].push({identifier:extraReplacement.identifier,replacement:extraReplacement.replacementOriginal})}),content.subSteps.forEach((subStep,subStepIndex)=>{const newIndentifier=step.identifier+subStep.identifier+i.toString()+subStepIndex.toString();modifiedReplacement=modifiedReplacement.replace(subStep.identifier,newIndentifier),content.extraReplacements.forEach((extraReplacement,indexOfExtraReplace)=>{const subStepExtraReplacement=subStep.extraReplacements[indexOfExtraReplace],modifiedExtraReplacement=modifiedExtraReplacements[indexOfExtraReplace][i];modifiedExtraReplacement.wordToReplace=extraReplacement.identifier+i.toString()+subStepIndex.toString();const newIndentifier2=step.identifier+subStepExtraReplacement.identifier+i.toString()+subStepIndex.toString();modifiedExtraReplacement.replacement=modifiedExtraReplacement.replacement.replace(subStepExtraReplacement.identifier,newIndentifier2),subStepExtraReplacement.wordToReplace=newIndentifier2,subStepExtraReplacement.identifier=newIndentifier2});let copySubStep=JSON.parse(JSON.stringify(subStep));this.cacheSteps.forEach(cachedStep=>{cachedStep.wordToReplace==newIndentifier&&(copySubStep=JSON.parse(JSON.stringify(cachedStep)),copySubStep.cached=!0)}),copySubStep.identifier=newIndentifier,copySubStep.wordToReplace=newIndentifier,copySubStep.hasIndex&&(copySubStep.question=1===parseInt(value)?copySubStep.questionOriginal.replace(\"->(index)\",\"\"):copySubStep.questionOriginal.replace(\"->(index)\",i+1)),this.steps.splice(index+1+subStepIndex+i*content.subSteps.length+parseInt(value)*contentIndex*content.subSteps.length,0,copySubStep),\"iRadioB\"===copySubStep.type&&refreshRadioBSteps.push(copySubStep),\"iRadioC\"===copySubStep.type&&(copySubStep.radios.forEach(radioC=>{radioC.subSteps.forEach(radioCsubstep=>{const newId=newIndentifier+radioCsubstep.identifier,regexp3=new RegExp(radioCsubstep.identifier,\"g\");radioC.replacementOriginal=radioC.replacementOriginal.replace(regexp3,newId),radioCsubstep.wordToReplace=newId,radioCsubstep.identifier=newId})}),refreshRadioCSteps.push(copySubStep))}),content.modifiedReplacements.push(modifiedReplacement)}content.modifiedExtraReplacements.push(modifiedExtraReplacements)}),refreshRadioBSteps.forEach(step=>{step.radios.forEach(radio=>{radio.checked&&this.onInputRadioBSelected(radio.radioId,step.wordToReplace,!1,!0)})}),buildDocumentAfter&&(refreshRadioCSteps.forEach(step=>{step.cached?step.radios.forEach(radio=>{radio.checked&&this.onInputRadioCSelected(radio.radioId,step.wordToReplace,!1)}):this.onInputRadioCSelected(step.defaultRadioId,step.wordToReplace,!1)}),this.buildDocument(!0,!1,checkCache))}cleanPreviouslyAddedSteps(index,identifierOrWordToReplace){for(;this.steps[index+1]&&this.steps[index+1].wordToReplace.includes(identifierOrWordToReplace);)this.steps.splice(index+1,1)}onInputRadioBSelected(radioSelectedId,wordToReplace,buildDocumentAfter=!0,avoidFocus=!1){const{step:step}=this.findStep(wordToReplace,!1,\"wordToReplace\");step.isFocused=!avoidFocus,step.radios.forEach(radio=>{radio.radioId===radioSelectedId?(step.replacement=radio.replacementOriginal,radio.checked=!0,step.extraReplacements&&step.extraReplacements.forEach((extraReplacement,i)=>{extraReplacement.replacement=radio.extraReplacements[i].replacement})):radio.checked=!1}),buildDocumentAfter&&this.buildDocument()}onInputRadioCSelected(radioSelectedId,wordToReplace,buildDocumentAfter=!0,radioCfocused=!1,checkCache=!1){const refreshForEachInputs=[],refreshNormalInputs=[],refreshRadioBInputs=[],refreshRadioCInputs=[],buildSelectedRadio=(step,index,radio)=>{this.cleanPreviouslyAddedSteps(index,step.wordToReplace);let replacement=radio.replacementOriginal;radio.extraReplacements.forEach(extraReplacement=>{extraReplacement.replacement=extraReplacement.replacementOriginal}),radio.subSteps.forEach((subStep,subStepIndex)=>{subStep.wordToReplace=step.identifier+subStep.identifier;const regexp=new RegExp(subStep.identifier,\"g\");replacement=replacement.replace(regexp,subStep.wordToReplace),radio.extraReplacements.forEach(extraReplacement=>{extraReplacement.replacement=extraReplacement.replacement.replace(subStep.identifier,subStep.wordToReplace)}),\"iCheckbox\"===subStep.type&&subStep.checkboxes.forEach(checkbox=>{checkbox.checked=!1}),\"iRadioC\"===subStep.type&&(subStep.inheritFromRadioC=subStep.wordToReplace,subStep.radios.forEach(radioC=>{radioC.subSteps.forEach(radioCsubstep=>{const newIndentifier=subStep.wordToReplace+radioCsubstep.identifier,regexp3=new RegExp(radioCsubstep.identifier,\"g\");radioC.replacementOriginal=radioC.replacementOriginal.replace(regexp3,newIndentifier),radioCsubstep.wordToReplace=newIndentifier,radioCsubstep.identifier=newIndentifier,radioCsubstep.inherited=!0})}),refreshRadioCInputs.push(subStep)),\"iForEach\"===subStep.type&&(subStep.content.forEach(content=>{const regexp2=new RegExp(content.wordToReplace,\"g\");content.replacementOriginal=content.replacementOriginal.replace(regexp2,subStep.wordToReplace),content.subSteps.forEach(contentSubstep=>{contentSubstep.wordToReplace=contentSubstep.wordToReplace.replace(regexp2,subStep.wordToReplace),contentSubstep.identifier=contentSubstep.identifier.replace(regexp2,subStep.wordToReplace)}),content.wordToReplace=subStep.wordToReplace,content.identifier=subStep.wordToReplace}),refreshForEachInputs.push(subStep)),\"iNumber\"===subStep.type&&(subStep.rules.forEach(rule=>{if(\"extraReplacementToCharacter\"===rule.rulename){const newRuleIdentifier=\"i\"+Math.random().toString(36).substring(7)+rule.identifier;rule.wordToReplace=newRuleIdentifier;const regexp4=new RegExp(rule.identifier,\"g\");replacement=replacement.replace(regexp4,newRuleIdentifier)}}),subStep.rules.length&&refreshNormalInputs.push(subStep)),\"iRadioB\"===subStep.type&&refreshRadioBInputs.push(subStep),this.steps.splice(index+1+subStepIndex,0,subStep)}),radio.replacement=replacement,radio.checked=!0};this.steps.forEach((step,index)=>{(step.identifier===wordToReplace||step.inheritFromRadioC&&step.inheritFromRadioC===wordToReplace)&&step.radios.forEach(radio=>{radio.radioId===radioSelectedId?buildSelectedRadio(step,index,radio):radio.checked=!1}),step.wordToReplace===wordToReplace?(step.isFocused=!0,step.radioCfocused=radioCfocused):step.isFocused=!1}),refreshForEachInputs.forEach(forEachInput=>{this.buildForEach(forEachInput.value,forEachInput.wordToReplace,!1,!0)}),refreshRadioCInputs.forEach(step=>{step.radios.forEach(radio=>{radio.checked&&this.onInputRadioCSelected(radio.radioId,step.wordToReplace,!1)})}),refreshNormalInputs.forEach(input=>{this.input(input.replacement,input.wordToReplace,!1)}),refreshRadioBInputs.forEach(step=>{step.radios.forEach(radio=>{radio.checked&&this.onInputRadioBSelected(radio.radioId,step.wordToReplace,!1,!0)})}),buildDocumentAfter&&this.buildDocument(!0,!1,checkCache)}onInputCheckboxSelected(checkboxIdentifier,wordToReplace,checked,buildDocumentAfter=!0){this.steps.forEach((step,index)=>{if(step.wordToReplace===wordToReplace){let replacement=step.replacementOriginal;step.checkboxes.forEach(checkbox=>{if(checkbox.wordToReplace=step.wordToReplace+checkbox.identifier,replacement=replacement.replace(checkbox.identifier,checkbox.wordToReplace),checkbox.identifier===checkboxIdentifier){const lengthOfRestOfArray=this.steps.length-index;for(let i=0;i<lengthOfRestOfArray;i++)this.steps[index+1+i]&&this.steps[index+1+i].wordToReplace.includes(checkbox.identifier)&&this.steps.splice(index+1+i,1);if(checked){let replacementSubstep=checkbox.replacementOriginal;checkbox.subSteps.forEach((subStep,subStepIndex)=>{subStep.wordToReplace=checkbox.wordToReplace+subStep.identifier,replacementSubstep=replacementSubstep.replace(subStep.identifier,subStep.wordToReplace),this.steps.splice(index+1+subStepIndex,0,subStep)}),checkbox.replacement=replacementSubstep}checkbox.checked=checked}}),step.replacement=replacement,step.rules&&step.rules.length&&step.rules.forEach(rule=>{if(\"noneIsChecked\"===rule.condition){let isAnyCheck=!1;step.checkboxes.forEach(checkbox=>{checkbox.checked&&(isAnyCheck=!0)}),isAnyCheck?rule.isFulfilled=!1:(step.replacement=rule.replacement,rule.isFulfilled=!0)}})}}),buildDocumentAfter&&this.buildDocument()}getStepsModel(){return this.steps}}return StepsService.ɵfac=function(t){return new(t||StepsService)(fesm2015_core.Vb(doc_creator_service_DocCreatorService),fesm2015_core.Vb(core.e))},StepsService.ɵprov=fesm2015_core.Hb({token:StepsService,factory:StepsService.ɵfac}),StepsService})();function ITextComponent_div_5_Template(rf,ctx){if(1&rf){const _r506=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",12),fesm2015_core.Qb(1,\"span\",13),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r506),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}const i_text_component_c0=function(a0){return{borderBottom:a0}};function ITextComponent_input_9_Template(rf,ctx){if(1&rf){const _r509=fesm2015_core.Rb();fesm2015_core.Qb(0,\"input\",14,15),fesm2015_core.Zb(\"keyup\",(function($event){return fesm2015_core.rc(_r509),fesm2015_core.dc().onInput($event)}))(\"click\",(function($event){return fesm2015_core.rc(_r509),fesm2015_core.dc().onInput($event)})),fesm2015_core.Pb()}if(2&rf){const ctx_r502=fesm2015_core.dc();fesm2015_core.ic(\"value\",ctx_r502.step.replacement)(\"placeholder\",ctx_r502.step.placeholder?ctx_r502.step.placeholder:\"\")(\"ngStyle\",fesm2015_core.lc(3,i_text_component_c0,ctx_r502.inputInvalid?\"3px solid red\":\"\"))}}function ITextComponent_textarea_10_Template(rf,ctx){if(1&rf){const _r513=fesm2015_core.Rb();fesm2015_core.Qb(0,\"textarea\",16,15),fesm2015_core.Zb(\"keyup\",(function($event){return fesm2015_core.rc(_r513),fesm2015_core.dc().onInput($event)}))(\"click\",(function($event){return fesm2015_core.rc(_r513),fesm2015_core.dc().onInput($event)})),fesm2015_core.Pb()}if(2&rf){const ctx_r503=fesm2015_core.dc();fesm2015_core.ic(\"value\",ctx_r503.step.replacement)(\"placeholder\",ctx_r503.step.placeholder?ctx_r503.step.placeholder:\"\")(\"ngStyle\",fesm2015_core.lc(3,i_text_component_c0,ctx_r503.inputInvalid?\"3px solid red\":\"\"))}}function ITextComponent_span_12_Template(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"span\",17),fesm2015_core.zc(1,\" Obligatorio * \"),fesm2015_core.Pb())}let i_text_component_ITextComponent=(()=>{class ITextComponent{constructor(stepModelService){this.stepModelService=stepModelService,this.emitIndication=new fesm2015_core.n}ngOnInit(){}showIndication(){this.emitIndication.emit()}onInput(e){this.stepModelService.input(e.srcElement.value,this.step.wordToReplace,!0,!0)}}return ITextComponent.ɵfac=function(t){return new(t||ITextComponent)(fesm2015_core.Lb(step_service_StepsService))},ITextComponent.ɵcmp=fesm2015_core.Fb({type:ITextComponent,selectors:[[\"app-i-text\"]],inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:13,vars:5,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__question\"],[\"type\",\"text\",3,\"value\",\"placeholder\",\"ngStyle\",\"keyup\",\"click\",4,\"ngIf\"],[\"cols\",\"30\",\"rows\",\"6\",3,\"value\",\"placeholder\",\"ngStyle\",\"keyup\",\"click\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__bottom\"],[\"class\",\"form-creator__fields-area__field__bottom__mandatory-label\",4,\"ngIf\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"],[\"type\",\"text\",3,\"value\",\"placeholder\",\"ngStyle\",\"keyup\",\"click\"],[\"input\",\"\"],[\"cols\",\"30\",\"rows\",\"6\",3,\"value\",\"placeholder\",\"ngStyle\",\"keyup\",\"click\"],[1,\"form-creator__fields-area__field__bottom__mandatory-label\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,ITextComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"span\",7),fesm2015_core.zc(8),fesm2015_core.Pb(),fesm2015_core.yc(9,ITextComponent_input_9_Template,2,5,\"input\",8),fesm2015_core.yc(10,ITextComponent_textarea_10_Template,2,5,\"textarea\",9),fesm2015_core.Pb(),fesm2015_core.Qb(11,\"div\",10),fesm2015_core.yc(12,ITextComponent_span_12_Template,2,0,\"span\",11),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(3),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"textarea\"!==ctx.step.subType),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"textarea\"===ctx.step.subType),fesm2015_core.zb(2),fesm2015_core.ic(\"ngIf\",ctx.step.mandatory))},directives:[common.t,common.w],encapsulation:2}),ITextComponent})();function IDateComponent_div_5_Template(rf,ctx){if(1&rf){const _r519=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",13),fesm2015_core.Qb(1,\"span\",14),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r519),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}function IDateComponent_span_13_Template(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"span\",15),fesm2015_core.zc(1,\" Obligatorio * \"),fesm2015_core.Pb())}const i_date_component_c0=function(a0){return{borderBottom:a0}};let i_date_component_IDateComponent=(()=>{class IDateComponent{constructor(stepModelService){this.stepModelService=stepModelService,this.emitIndication=new fesm2015_core.n}ngOnInit(){}showIndication(){this.emitIndication.emit()}onInput(value,wordToReplace){this.stepModelService.input(value,wordToReplace,!0,!0)}}return IDateComponent.ɵfac=function(t){return new(t||IDateComponent)(fesm2015_core.Lb(step_service_StepsService))},IDateComponent.ɵcmp=fesm2015_core.Fb({type:IDateComponent,selectors:[[\"app-i-date\"]],inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:14,vars:7,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__date-container\"],[1,\"form-creator__fields-area__field__middle__question\"],[\"type\",\"date\",3,\"value\",\"ngStyle\",\"change\"],[\"input\",\"\"],[1,\"form-creator__fields-area__field__bottom\"],[\"class\",\"form-creator__fields-area__field__bottom__mandatory-label\",4,\"ngIf\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"],[1,\"form-creator__fields-area__field__bottom__mandatory-label\"]],template:function(rf,ctx){if(1&rf){const _r520=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,IDateComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"div\",7),fesm2015_core.Qb(8,\"span\",8),fesm2015_core.zc(9),fesm2015_core.Pb(),fesm2015_core.Qb(10,\"input\",9,10),fesm2015_core.Zb(\"change\",(function(){fesm2015_core.rc(_r520);const _r516=fesm2015_core.pc(11);return ctx.onInput(_r516.value,ctx.step.wordToReplace)})),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(12,\"div\",11),fesm2015_core.yc(13,IDateComponent_span_13_Template,2,0,\"span\",12),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}2&rf&&(fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(4),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(1),fesm2015_core.ic(\"value\",ctx.step.replacement)(\"ngStyle\",fesm2015_core.lc(5,i_date_component_c0,ctx.inputInvalid?\"3px solid red\":\"\")),fesm2015_core.zb(3),fesm2015_core.ic(\"ngIf\",ctx.step.mandatory))},directives:[common.t,common.w],encapsulation:2}),IDateComponent})();const i_number_component_c0=[\"input\"];function INumberComponent_div_5_Template(rf,ctx){if(1&rf){const _r525=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",12),fesm2015_core.Qb(1,\"span\",13),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r525),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}function INumberComponent_span_12_Template(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"span\",14),fesm2015_core.zc(1,\" Obligatorio * \"),fesm2015_core.Pb())}const i_number_component_c1=function(a0){return{borderBottom:a0}};let i_number_component_INumberComponent=(()=>{class INumberComponent{constructor(stepModelService,toastr){this.stepModelService=stepModelService,this.toastr=toastr,this.emitIndication=new fesm2015_core.n}ngOnInit(){}onInputNumberChanged(e){let newValue=e.srcElement.value;isNaN(newValue)?(this.toastr.error(\"Número no válido\",\"Debe ser un número\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"}),this.input.nativeElement.style.borderBottom=\"3px solid red\"):(this.input.nativeElement.style.borderBottom=\"\",newValue.includes(\",\")&&(newValue=newValue.replace(\",\",\"\")),newValue.includes(\".\")&&(newValue=newValue.replace(\".\",\"\")),this.stepModelService.input(newValue,this.step.wordToReplace,!0,!0))}showIndication(){this.emitIndication.emit()}}return INumberComponent.ɵfac=function(t){return new(t||INumberComponent)(fesm2015_core.Lb(step_service_StepsService),fesm2015_core.Lb(ngx_toastr.b))},INumberComponent.ɵcmp=fesm2015_core.Fb({type:INumberComponent,selectors:[[\"app-i-number\"]],viewQuery:function(rf,ctx){var _t;1&rf&&fesm2015_core.Dc(i_number_component_c0,!0),2&rf&&fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.input=_t.first)},inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:13,vars:8,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__question\"],[\"type\",\"text\",3,\"value\",\"placeholder\",\"ngStyle\",\"keyup\",\"click\"],[\"input\",\"\"],[1,\"form-creator__fields-area__field__bottom\"],[\"class\",\"form-creator__fields-area__field__bottom__mandatory-label\",4,\"ngIf\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"],[1,\"form-creator__fields-area__field__bottom__mandatory-label\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,INumberComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"span\",7),fesm2015_core.zc(8),fesm2015_core.Pb(),fesm2015_core.Qb(9,\"input\",8,9),fesm2015_core.Zb(\"keyup\",(function($event){return ctx.onInputNumberChanged($event)}))(\"click\",(function($event){return ctx.onInputNumberChanged($event)})),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(11,\"div\",10),fesm2015_core.yc(12,INumberComponent_span_12_Template,2,0,\"span\",11),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(3),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(1),fesm2015_core.ic(\"value\",ctx.step.replacement)(\"placeholder\",ctx.step.placeholder?ctx.step.placeholder:\"\")(\"ngStyle\",fesm2015_core.lc(6,i_number_component_c1,ctx.inputInvalid?\"3px solid red\":\"\")),fesm2015_core.zb(3),fesm2015_core.ic(\"ngIf\",ctx.step.mandatory))},directives:[common.t,common.w],encapsulation:2}),INumberComponent})();function IRadioBComponent_div_5_Template(rf,ctx){if(1&rf){const _r529=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",11),fesm2015_core.Qb(1,\"span\",12),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r529),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}function IRadioBComponent_p_10_Template(rf,ctx){if(1&rf){const _r532=fesm2015_core.Rb();fesm2015_core.Qb(0,\"p\"),fesm2015_core.Qb(1,\"label\"),fesm2015_core.Qb(2,\"input\",13),fesm2015_core.Zb(\"change\",(function(){fesm2015_core.rc(_r532);const radio_r530=ctx.$implicit,ctx_r531=fesm2015_core.dc();return ctx_r531.onInputSelected(radio_r530.radioId,ctx_r531.step.wordToReplace)})),fesm2015_core.Pb(),fesm2015_core.Qb(3,\"span\"),fesm2015_core.zc(4),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const radio_r530=ctx.$implicit;fesm2015_core.zb(2),fesm2015_core.ic(\"checked\",radio_r530.checked),fesm2015_core.zb(2),fesm2015_core.Ac(radio_r530.label)}}let i_radio_b_component_IRadioBComponent=(()=>{class IRadioBComponent{constructor(stepModelService,documentCreatorService){this.stepModelService=stepModelService,this.documentCreatorService=documentCreatorService,this.emitIndication=new fesm2015_core.n}ngOnInit(){}showIndication(){this.emitIndication.emit()}onInputSelected(radioId,wordToReplace){this.stepModelService.onInputRadioBSelected(radioId,wordToReplace)}}return IRadioBComponent.ɵfac=function(t){return new(t||IRadioBComponent)(fesm2015_core.Lb(step_service_StepsService),fesm2015_core.Lb(doc_creator_service_DocCreatorService))},IRadioBComponent.ɵcmp=fesm2015_core.Fb({type:IRadioBComponent,selectors:[[\"app-i-radio-b\"]],inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:12,vars:3,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__question\"],[1,\"form-creator__fields-area__field__middle__radio-input--fill-form\",\"radio\"],[4,\"ngFor\",\"ngForOf\"],[1,\"form-creator__fields-area__field__bottom\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"],[\"name\",\"group1\",\"type\",\"radio\",\"value\",\"Valor de la pregunta numero 1\",1,\"with-gap\",3,\"checked\",\"change\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,IRadioBComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"span\",7),fesm2015_core.zc(8),fesm2015_core.Pb(),fesm2015_core.Qb(9,\"div\",8),fesm2015_core.yc(10,IRadioBComponent_p_10_Template,5,2,\"p\",9),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Mb(11,\"div\",10),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(3),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(2),fesm2015_core.ic(\"ngForOf\",ctx.step.radios))},directives:[common.t,common.s],encapsulation:2}),IRadioBComponent})();function IRadioCComponent_div_5_Template(rf,ctx){if(1&rf){const _r536=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",11),fesm2015_core.Qb(1,\"span\",12),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r536),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}function IRadioCComponent_p_10_Template(rf,ctx){if(1&rf){const _r539=fesm2015_core.Rb();fesm2015_core.Qb(0,\"p\"),fesm2015_core.Qb(1,\"label\"),fesm2015_core.Qb(2,\"input\",13),fesm2015_core.Zb(\"change\",(function(){fesm2015_core.rc(_r539);const radio_r537=ctx.$implicit,ctx_r538=fesm2015_core.dc();return ctx_r538.onRadioCchanged(radio_r537.radioId,ctx_r538.step.wordToReplace)})),fesm2015_core.Pb(),fesm2015_core.Qb(3,\"span\"),fesm2015_core.zc(4),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const radio_r537=ctx.$implicit;fesm2015_core.zb(2),fesm2015_core.ic(\"checked\",radio_r537.checked),fesm2015_core.zb(2),fesm2015_core.Ac(radio_r537.label)}}let i_radio_c_component_IRadioCComponent=(()=>{class IRadioCComponent{constructor(stepModelService,documentCreatorService){this.stepModelService=stepModelService,this.documentCreatorService=documentCreatorService,this.emitIndication=new fesm2015_core.n}ngOnInit(){}showIndication(){this.emitIndication.emit()}onRadioCchanged(radioId,wordToReplace){this.stepModelService.refreshCache(),this.stepModelService.onInputRadioCSelected(radioId,wordToReplace,!0,!0,!0)}}return IRadioCComponent.ɵfac=function(t){return new(t||IRadioCComponent)(fesm2015_core.Lb(step_service_StepsService),fesm2015_core.Lb(doc_creator_service_DocCreatorService))},IRadioCComponent.ɵcmp=fesm2015_core.Fb({type:IRadioCComponent,selectors:[[\"app-i-radio-c\"]],inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:12,vars:3,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__question\"],[1,\"form-creator__fields-area__field__middle__radio-input--fill-form\",\"radio\"],[4,\"ngFor\",\"ngForOf\"],[1,\"form-creator__fields-area__field__bottom\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"],[\"name\",\"group1\",\"type\",\"radio\",\"value\",\"Valor de la pregunta numero 1\",1,\"with-gap\",3,\"checked\",\"change\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,IRadioCComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"span\",7),fesm2015_core.zc(8),fesm2015_core.Pb(),fesm2015_core.Qb(9,\"div\",8),fesm2015_core.yc(10,IRadioCComponent_p_10_Template,5,2,\"p\",9),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Mb(11,\"div\",10),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(3),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(2),fesm2015_core.ic(\"ngForOf\",ctx.step.radios))},directives:[common.t,common.s],encapsulation:2}),IRadioCComponent})();function IForEachComponent_div_5_Template(rf,ctx){if(1&rf){const _r543=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",12),fesm2015_core.Qb(1,\"span\",13),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r543),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}let i_for_each_component_IForEachComponent=(()=>{class IForEachComponent{constructor(stepModelService,documentCreatorService){this.stepModelService=stepModelService,this.documentCreatorService=documentCreatorService,this.emitIndication=new fesm2015_core.n}ngOnInit(){}showIndication(){this.emitIndication.emit()}onInput(value,wordToReplace){this.stepModelService.refreshCache(),this.stepModelService.buildForEach(value,wordToReplace,!0,!0,!0)}}return IForEachComponent.ɵfac=function(t){return new(t||IForEachComponent)(fesm2015_core.Lb(step_service_StepsService),fesm2015_core.Lb(doc_creator_service_DocCreatorService))},IForEachComponent.ɵcmp=fesm2015_core.Fb({type:IForEachComponent,selectors:[[\"app-i-for-each\"]],inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:16,vars:6,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__question\"],[1,\"slider-range-container\"],[\"type\",\"range\",1,\"range-slider\",3,\"min\",\"max\",\"value\",\"change\"],[\"input\",\"\"],[1,\"form-creator__fields-area__field__bottom\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"]],template:function(rf,ctx){if(1&rf){const _r544=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,IForEachComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"span\",7),fesm2015_core.zc(8),fesm2015_core.Pb(),fesm2015_core.Qb(9,\"div\",8),fesm2015_core.Qb(10,\"input\",9,10),fesm2015_core.Zb(\"change\",(function(){fesm2015_core.rc(_r544);const _r541=fesm2015_core.pc(11);return ctx.onInput(_r541.value,ctx.step.wordToReplace)})),fesm2015_core.Pb(),fesm2015_core.Qb(12,\"p\"),fesm2015_core.Qb(13,\"span\"),fesm2015_core.zc(14),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Mb(15,\"div\",11),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const _r541=fesm2015_core.pc(11);fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(3),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(2),fesm2015_core.jc(\"min\",ctx.step.min),fesm2015_core.jc(\"max\",ctx.step.max),fesm2015_core.ic(\"value\",ctx.step.value),fesm2015_core.zb(4),fesm2015_core.Ac(_r541.value)}},directives:[common.t],encapsulation:2}),IForEachComponent})();function ISelectComponent_div_5_Template(rf,ctx){if(1&rf){const _r548=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",12),fesm2015_core.Qb(1,\"span\",13),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r548),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}function ISelectComponent_option_11_Template(rf,ctx){if(1&rf&&(fesm2015_core.Qb(0,\"option\",14),fesm2015_core.zc(1),fesm2015_core.Pb()),2&rf){const radio_r549=ctx.$implicit;fesm2015_core.jc(\"value\",radio_r549.radioId),fesm2015_core.ic(\"selected\",radio_r549.checked),fesm2015_core.zb(1),fesm2015_core.Bc(\" \",radio_r549.label,\" \")}}let i_select_component_ISelectComponent=(()=>{class ISelectComponent{constructor(stepModelService,documentCreatorService){this.stepModelService=stepModelService,this.documentCreatorService=documentCreatorService,this.emitIndication=new fesm2015_core.n}ngOnInit(){}onInputSelectChanged(e){\"iRadioC\"===this.step.type?this.stepModelService.onInputRadioCSelected(e.target.value,this.step.wordToReplace):\"iRadioB\"===this.step.type&&this.stepModelService.onInputRadioBSelected(e.target.value,this.step.wordToReplace)}showIndication(){this.emitIndication.emit()}}return ISelectComponent.ɵfac=function(t){return new(t||ISelectComponent)(fesm2015_core.Lb(step_service_StepsService),fesm2015_core.Lb(doc_creator_service_DocCreatorService))},ISelectComponent.ɵcmp=fesm2015_core.Fb({type:ISelectComponent,selectors:[[\"app-i-select\"]],inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:13,vars:3,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__question\"],[1,\"input-select\"],[1,\"browser-default\",3,\"change\"],[3,\"value\",\"selected\",4,\"ngFor\",\"ngForOf\"],[1,\"form-creator__fields-area__field__bottom\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"],[3,\"value\",\"selected\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,ISelectComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"span\",7),fesm2015_core.zc(8),fesm2015_core.Pb(),fesm2015_core.Qb(9,\"div\",8),fesm2015_core.Qb(10,\"select\",9),fesm2015_core.Zb(\"change\",(function($event){return ctx.onInputSelectChanged($event)})),fesm2015_core.yc(11,ISelectComponent_option_11_Template,2,3,\"option\",10),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Mb(12,\"div\",11),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(3),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(3),fesm2015_core.ic(\"ngForOf\",ctx.step.radios))},directives:[common.t,common.s,fesm2015_forms.v,fesm2015_forms.F],encapsulation:2}),ISelectComponent})();function ICheckboxComponent_div_5_Template(rf,ctx){if(1&rf){const _r553=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",12),fesm2015_core.Qb(1,\"span\",13),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r553),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb(),fesm2015_core.Pb()}}function ICheckboxComponent_label_10_Template(rf,ctx){if(1&rf){const _r557=fesm2015_core.Rb();fesm2015_core.Qb(0,\"label\"),fesm2015_core.Qb(1,\"input\",14,15),fesm2015_core.Zb(\"change\",(function(){fesm2015_core.rc(_r557);const checkbox_r554=ctx.$implicit,_r555=fesm2015_core.pc(2),ctx_r556=fesm2015_core.dc();return ctx_r556.onInputCheckboxSelected(checkbox_r554.identifier,ctx_r556.step.wordToReplace,_r555.checked)})),fesm2015_core.Pb(),fesm2015_core.Qb(3,\"span\"),fesm2015_core.zc(4),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const checkbox_r554=ctx.$implicit;fesm2015_core.zb(1),fesm2015_core.ic(\"checked\",checkbox_r554.checked),fesm2015_core.zb(3),fesm2015_core.Bc(\"\",checkbox_r554.label,\".\")}}let i_checkbox_component_ICheckboxComponent=(()=>{class ICheckboxComponent{constructor(stepModelService,documentCreatorService){this.stepModelService=stepModelService,this.documentCreatorService=documentCreatorService,this.emitIndication=new fesm2015_core.n}ngOnInit(){}showIndication(){this.emitIndication.emit()}onInputCheckboxSelected(identifier,wordToReplace,checked){this.stepModelService.onInputCheckboxSelected(identifier,wordToReplace,checked)}}return ICheckboxComponent.ɵfac=function(t){return new(t||ICheckboxComponent)(fesm2015_core.Lb(step_service_StepsService),fesm2015_core.Lb(doc_creator_service_DocCreatorService))},ICheckboxComponent.ɵcmp=fesm2015_core.Fb({type:ICheckboxComponent,selectors:[[\"app-i-checkbox\"]],inputs:{step:\"step\",inputInvalid:\"inputInvalid\"},outputs:{emitIndication:\"emitIndication\"},decls:14,vars:3,consts:[[1,\"form-creator__fields-area__middle__container\",\"fade-in\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__field__field-area\",\"form-creator__fields-area__field__field-area--input-text\"],[1,\"form-creator__fields-area__field__top\",\"form-creator__fields-area__field__top--fill-form\"],[\"class\",\"indication\",4,\"ngIf\"],[1,\"form-creator__fields-area__field__middle\"],[1,\"form-creator__fields-area__field__middle__question\"],[1,\"form-creator__fields-area__field__middle__checkbox-input\"],[4,\"ngFor\",\"ngForOf\"],[1,\"form-creator__fields-area__field__bottom\"],[1,\"form-creator__fields-area__field__bottom__mandatory-label\"],[1,\"indication\"],[1,\"icon\",\"icon-info-circle-solid\",\"trigger\",3,\"click\"],[\"type\",\"checkbox\",1,\"filled-in\",3,\"checked\",\"change\"],[\"input\",\"\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"div\",4),fesm2015_core.yc(5,ICheckboxComponent_div_5_Template,2,0,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.Qb(7,\"span\",7),fesm2015_core.zc(8),fesm2015_core.Pb(),fesm2015_core.Qb(9,\"div\",8),fesm2015_core.yc(10,ICheckboxComponent_label_10_Template,5,2,\"label\",9),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(11,\"div\",10),fesm2015_core.Qb(12,\"span\",11),fesm2015_core.zc(13,\" Obligatorio * \"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(5),fesm2015_core.ic(\"ngIf\",ctx.step.indications&&ctx.step.indications.areIndications),fesm2015_core.zb(3),fesm2015_core.Ac(ctx.step.question),fesm2015_core.zb(2),fesm2015_core.ic(\"ngForOf\",ctx.step.checkboxes))},directives:[common.t,common.s],encapsulation:2}),ICheckboxComponent})();const form_component_c0=[\"modal\"],form_component_c1=[\"modalEnd\"],form_component_c2=[\"modalDownload\"],form_component_c3=[\"modalIndication\"],_c4=[\"input\"],_c5=[\"progressBar\"];function FormComponent_div_4_Template(rf,ctx){if(1&rf){const _r579=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",43),fesm2015_core.Qb(1,\"div\",44),fesm2015_core.Qb(2,\"span\",45),fesm2015_core.Qb(3,\"div\",46),fesm2015_core.Mb(4,\"img\",47),fesm2015_core.Pb(),fesm2015_core.Qb(5,\"span\",48),fesm2015_core.zc(6,\"Silvia Camejo Alarcón\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(7,\"span\",49),fesm2015_core.Qb(8,\"span\"),fesm2015_core.zc(9,\"Actualizado:\"),fesm2015_core.Pb(),fesm2015_core.zc(10),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(11,\"div\",50),fesm2015_core.Qb(12,\"div\",51),fesm2015_core.Qb(13,\"span\",52),fesm2015_core.Zb(\"click\",(function(){fesm2015_core.rc(_r579);const ctx_r578=fesm2015_core.dc(),_r574=fesm2015_core.pc(27);return ctx_r578.toogleModal(_r574)})),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const ctx_r560=fesm2015_core.dc();fesm2015_core.zb(10),fesm2015_core.Bc(\" \",ctx_r560.form.updated,\" \")}}function FormComponent_div_5_Template(rf,ctx){if(1&rf&&(fesm2015_core.Qb(0,\"div\",53),fesm2015_core.Qb(1,\"div\",54),fesm2015_core.Qb(2,\"span\",null,55),fesm2015_core.zc(4),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()),2&rf){const ctx_r561=fesm2015_core.dc();fesm2015_core.zb(2),fesm2015_core.xc(\"width\",ctx_r561.progresBarPercentage),fesm2015_core.zb(2),fesm2015_core.Ac(ctx_r561.progresBarPercentage)}}function FormComponent_div_7_Template(rf,ctx){if(1&rf){const _r582=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",56),fesm2015_core.Qb(1,\"div\",57),fesm2015_core.Qb(2,\"h3\",58),fesm2015_core.zc(3),fesm2015_core.Pb(),fesm2015_core.Qb(4,\"span\",59),fesm2015_core.zc(5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"button\",60),fesm2015_core.Zb(\"click\",(function(){fesm2015_core.rc(_r582);const ctx_r581=fesm2015_core.dc(),_r574=fesm2015_core.pc(27);return ctx_r581.toogleModal(_r574)})),fesm2015_core.zc(7,\" Rellenar formulario \"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const ctx_r562=fesm2015_core.dc();fesm2015_core.zb(3),fesm2015_core.Bc(\" \",ctx_r562.steps[ctx_r562.currentStep].title,\" \"),fesm2015_core.zb(2),fesm2015_core.Bc(\" \",ctx_r562.steps[ctx_r562.currentStep].description,\" \")}}function FormComponent_app_i_text_8_Template(rf,ctx){if(1&rf){const _r584=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-text\",61),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r584),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r563=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r563.steps[ctx_r563.currentStep])(\"inputInvalid\",ctx_r563.inputInvalid)}}function FormComponent_app_i_date_9_Template(rf,ctx){if(1&rf){const _r586=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-date\",61),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r586),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r564=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r564.steps[ctx_r564.currentStep])(\"inputInvalid\",ctx_r564.inputInvalid)}}function FormComponent_app_i_number_10_Template(rf,ctx){if(1&rf){const _r588=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-number\",61),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r588),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r565=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r565.steps[ctx_r565.currentStep])(\"inputInvalid\",ctx_r565.inputInvalid)}}function FormComponent_app_i_for_each_11_Template(rf,ctx){if(1&rf){const _r590=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-for-each\",62),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r590),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r566=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r566.steps[ctx_r566.currentStep])}}function FormComponent_app_i_radio_b_12_Template(rf,ctx){if(1&rf){const _r592=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-radio-b\",62),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r592),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r567=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r567.steps[ctx_r567.currentStep])}}function FormComponent_app_i_radio_c_13_Template(rf,ctx){if(1&rf){const _r594=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-radio-c\",62),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r594),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r568=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r568.steps[ctx_r568.currentStep])}}function FormComponent_app_i_select_14_Template(rf,ctx){if(1&rf){const _r596=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-select\",62),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r596),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r569=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r569.steps[ctx_r569.currentStep])}}function FormComponent_app_i_checkbox_15_Template(rf,ctx){if(1&rf){const _r598=fesm2015_core.Rb();fesm2015_core.Qb(0,\"app-i-checkbox\",62),fesm2015_core.Zb(\"emitIndication\",(function(){return fesm2015_core.rc(_r598),fesm2015_core.dc().showIndication()})),fesm2015_core.Pb()}if(2&rf){const ctx_r570=fesm2015_core.dc();fesm2015_core.ic(\"step\",ctx_r570.steps[ctx_r570.currentStep])}}function FormComponent_div_16_Template(rf,ctx){if(1&rf){const _r600=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",56),fesm2015_core.Qb(1,\"div\",63),fesm2015_core.Qb(2,\"div\",64),fesm2015_core.Qb(3,\"div\",65),fesm2015_core.Qb(4,\"div\",66),fesm2015_core.Mb(5,\"span\",67),fesm2015_core.Qb(6,\"h1\"),fesm2015_core.zc(7,\"Finalizado\"),fesm2015_core.Pb(),fesm2015_core.Qb(8,\"button\",68),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r600),fesm2015_core.dc().toogleCheckout()})),fesm2015_core.zc(9,\"Descargar\"),fesm2015_core.Pb(),fesm2015_core.Qb(10,\"div\",69),fesm2015_core.Mb(11,\"span\",70),fesm2015_core.Mb(12,\"span\",71),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}}function FormComponent_div_17_Template(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",72),fesm2015_core.Qb(1,\"div\",73),fesm2015_core.Mb(2,\"span\",74),fesm2015_core.Qb(3,\"span\",75),fesm2015_core.zc(4,\"1.\"),fesm2015_core.Pb(),fesm2015_core.Qb(5,\"span\",76),fesm2015_core.zc(6,\"Elige un documento\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(7,\"div\",73),fesm2015_core.Mb(8,\"span\",77),fesm2015_core.Qb(9,\"span\",75),fesm2015_core.zc(10,\"2.\"),fesm2015_core.Pb(),fesm2015_core.Qb(11,\"span\",76),fesm2015_core.zc(12,\"Rellena el formulario\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(13,\"div\",73),fesm2015_core.Mb(14,\"span\",78),fesm2015_core.Qb(15,\"span\",75),fesm2015_core.zc(16,\"3.\"),fesm2015_core.Pb(),fesm2015_core.Qb(17,\"span\",76),fesm2015_core.zc(18,\"Guárdalo e imprímelo\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb())}function FormComponent_div_18_div_10_Template(rf,ctx){if(1&rf){const _r603=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",81),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r603),fesm2015_core.dc(2).moveStep(\"next\")})),fesm2015_core.Qb(1,\"span\",83),fesm2015_core.zc(2,\"Siguiente\"),fesm2015_core.Pb(),fesm2015_core.Mb(3,\"span\",86),fesm2015_core.Pb()}}function FormComponent_div_18_Template(rf,ctx){if(1&rf){const _r605=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",79),fesm2015_core.Qb(1,\"div\",80),fesm2015_core.Qb(2,\"div\",81),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r605),fesm2015_core.dc().moveStep(\"previous\")})),fesm2015_core.Mb(3,\"span\",82),fesm2015_core.Qb(4,\"span\",83),fesm2015_core.zc(5,\"Anterior\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",84),fesm2015_core.Zb(\"click\",(function(){return fesm2015_core.rc(_r605),fesm2015_core.dc().previewDocumentButton(!0)})),fesm2015_core.zc(7,\" Preview \"),fesm2015_core.Qb(8,\"span\"),fesm2015_core.zc(9,\"⬇\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.yc(10,FormComponent_div_18_div_10_Template,4,0,\"div\",85),fesm2015_core.Pb(),fesm2015_core.Pb()}if(2&rf){const ctx_r573=fesm2015_core.dc();fesm2015_core.zb(10),fesm2015_core.ic(\"ngIf\",\"end\"!==(null==ctx_r573.steps[ctx_r573.currentStep]?null:ctx_r573.steps[ctx_r573.currentStep].type))}}let form_component_FormComponent=(()=>{class FormComponent{constructor(stepModelService,commonsService,sharedService,documentCreatorService,formsService,toastr,checkoutService,route){this.stepModelService=stepModelService,this.commonsService=commonsService,this.sharedService=sharedService,this.documentCreatorService=documentCreatorService,this.formsService=formsService,this.toastr=toastr,this.checkoutService=checkoutService,this.route=route,this.form=new core.i,this.currentStep=0,this.progresBarPercentage=\"0%\",this.steps=[],this.formAlreadyPaid=!1,this.indications={areIndications:!0,indicationsType:\"outsideText\",value:\"\"},this.inputInvalid=!1}ngOnInit(){this.commonsService.isBrowser()&&(this.commonsService.toggleSpinner(),this.route.params.subscribe(routeParams=>{this.route.queryParams.subscribe(params=>{params.transactionId?(this.formAlreadyPaid=!0,this.formsService.getPaidCertifiedForm(params.transactionId).subscribe(data=>{if(data.certifiedForm){const certifiedForm=data.certifiedForm;this.form.fields=JSON.parse(certifiedForm.fields),this.steps=this.form.fields,this.form.title=certifiedForm.title,this.form.uri=certifiedForm.uri,this.form.id=routeParams.id,this.form.amount=certifiedForm.amount,this.form.topLabelTitle=certifiedForm.topLabelTitle,this.form.information=certifiedForm.information,this.form.updated=certifiedForm.updated,this.setInitiaState()}else data.transactionNotFound?this.commonsService.toastMessage(\"error\",\"Transaction Id does not exist\",\"Transaction id not found\"):data.formExpired&&this.commonsService.toastMessage(\"error\",\"The period of 30 days to change the document has expired\",\"Transaction expired\")})):window.sessionStorage&&window.sessionStorage[routeParams.id]?(this.form=JSON.parse(window.sessionStorage[routeParams.id]),this.steps=this.form.fields,this.formAlreadyPaid=this.form.alreadyPaid,this.setInitiaState()):this.formsService.getCertifiedForm(routeParams.id).subscribe(certifiedForm=>{this.steps=certifiedForm.steps,this.form.fields=this.steps,this.form.title=certifiedForm.title,this.form.uri=certifiedForm.uri,this.form.id=routeParams.id,this.form.amount=certifiedForm.amount,this.form.image=certifiedForm.image,this.form.topLabelTitle=certifiedForm.topLabelTitle,this.form.information=certifiedForm.information,this.form.updated=certifiedForm.updated,this.setInitiaState()})})}))}ngAfterViewInit(){this.commonsService.resizeEditor(!1)}ngOnDestroy(){this.documentCreatorService.destroy(),window.removeEventListener(\"resize\",this.commonsService.resizeEditor.bind(this)),this.commonsService.setFormCreatorPlayground(!0)}setInitiaState(){this.stepModelService.init(this.form.fields),this.sharedService.setForm(this.form),this.form.fields.forEach((step,index)=>{step.isCurrentStep&&(this.currentStep=index,this.updateProgressBarPercentage(),\"end\"===this.steps[this.currentStep].type&&this.steps[this.currentStep].checkoutProcess.isInited&&!this.formAlreadyPaid&&this.toogleModal(this.modalEnd.nativeElement))}),this.documentCreatorService.init(this.form.uri).then(data=>{this.commonsService.setFormCreatorPlayground(!1),this.commonsService.resizeEditor(!0),window.addEventListener(\"resize\",this.commonsService.resizeEditor.bind(this)),this.documentCreatorService.resizeDocumentContainer(),this.stepModelService.buildDocument(!1),this.stepModelService.setInitialState(),this.documentCreatorService.resizeEvent(),this.commonsService.toggleSpinner()})}toogleModal(modal){this.commonsService.toggleModal(modal,!0)}moveStep(type){\"next\"===type?this.validateBeforeNextStep(this.steps[this.currentStep])&&(this.steps[this.currentStep].isCurrentStep=!1,this.steps[this.currentStep+1].isCurrentStep=!0,this.currentStep+=1):\"previous\"===type&&(this.steps[this.currentStep].isCurrentStep=!1,this.steps[this.currentStep-1].isCurrentStep=!0,this.currentStep-=1),this.updateProgressBarPercentage(),\"end\"===this.steps[this.currentStep].type&&this.prepareForCheckout()}validateBeforeNextStep(step){if(step.mandatory){if(\"\"===step.replacement)return this.toastr.error(\"Form cannot be empty\",\"Empty field\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"}),this.inputInvalid=!0,!1;this.inputInvalid=!1}return!0}updateProgressBarPercentage(){if(this.progressBar&&this.currentStep){const oldPercentage=Math.round(this.currentStep/(this.steps.length-1)*100),currentPercentage=parseInt(this.progresBarPercentage,10),difference=oldPercentage>currentPercentage?oldPercentage-currentPercentage:currentPercentage-oldPercentage;for(let i=0;i<difference+1;i++)setTimeout(()=>{const newPercentage=oldPercentage>currentPercentage?currentPercentage+i:currentPercentage-i;this.progressBar.nativeElement.style.width=newPercentage+\"%\",this.progresBarPercentage=newPercentage+\"%\"},10*i)}else this.progresBarPercentage=Math.round(this.currentStep/(this.steps.length-1)*100)+\"%\"}showIndication(){const step=this.steps[this.currentStep];step.indications.areIndications&&(\"outsideText\"===step.indications.indicationsType||window.innerWidth<885?(this.indications=step.indications,this.toogleModal(this.modalIndication.nativeElement)):this.documentCreatorService.showIndicationInsideText(step.wordToReplace,step.indications.value))}prepareForCheckout(){this.form.fields=this.steps,this.sharedService.setForm(this.form)}startCheckout(){this.steps[this.currentStep].checkoutProcess.isInited=!0}onFormPaid(certifiedForm){this.documentCreatorService.destroy(),window.removeEventListener(\"resize\",this.commonsService.resizeEditor.bind(this)),this.formAlreadyPaid=!0,this.form.alreadyPaid=!0,this.form.uri=certifiedForm.uri,this.form.fields=JSON.parse(certifiedForm.fields),this.setInitiaState(),this.commonsService.toggleSpinner(),this.sendEmail(certifiedForm.transactionId)}previewDocumentButton(setDocumentVisible){this.commonsService.previewDocumentButton(setDocumentVisible),this.documentCreatorService.resizeEvent()}onExitPayment(){this.toogleModal(this.modalEnd.nativeElement)}toogleCheckout(){this.formAlreadyPaid?this.toogleModal(this.modalDownload.nativeElement):(this.toogleModal(this.modalEnd.nativeElement),this.startCheckout())}downloadWord(){this.documentCreatorService.downloadWord(this.form.id,this.form.uri)}downloadPdf(){this.documentCreatorService.downloadPdf(this.form.id,this.form.uri)}sendEmail(transactionId){setTimeout(()=>{this.documentCreatorService.saveUri().then(uri=>{this.checkoutService.sendMail(transactionId,uri).subscribe(data=>{console.log(data)})})},1e3)}}return FormComponent.ɵfac=function(t){return new(t||FormComponent)(fesm2015_core.Lb(step_service_StepsService),fesm2015_core.Lb(core.e),fesm2015_core.Lb(shared_service_SharedService),fesm2015_core.Lb(doc_creator_service_DocCreatorService),fesm2015_core.Lb(core.k),fesm2015_core.Lb(ngx_toastr.b),fesm2015_core.Lb(core.c),fesm2015_core.Lb(fesm2015_router.a))},FormComponent.ɵcmp=fesm2015_core.Fb({type:FormComponent,selectors:[[\"app-form\"]],viewQuery:function(rf,ctx){var _t;1&rf&&(fesm2015_core.Dc(form_component_c0,!0),fesm2015_core.Dc(form_component_c1,!0),fesm2015_core.Dc(form_component_c2,!0),fesm2015_core.Dc(form_component_c3,!0),fesm2015_core.Dc(_c4,!0),fesm2015_core.Dc(_c5,!0)),2&rf&&(fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.modal=_t.first),fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.modalEnd=_t.first),fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.modalDownload=_t.first),fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.modalIndication=_t.first),fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.input=_t.first),fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.progressBar=_t.first))},decls:63,vars:17,consts:[[1,\"form-creator__container\"],[\"id\",\"fields-area\",1,\"form-creator__fields-area\"],[1,\"form-creator__fields-area__container\"],[1,\"form-creator__fields-area__top\"],[\"class\",\"form-creator__fields-area__top__container\",4,\"ngIf\"],[\"class\",\"progress-container\",4,\"ngIf\"],[1,\"form-creator__fields-area__middle\"],[\"class\",\"form-creator__fields-area__middle__container\",4,\"ngIf\"],[3,\"step\",\"inputInvalid\",\"emitIndication\",4,\"ngIf\"],[3,\"step\",\"emitIndication\",4,\"ngIf\"],[\"class\",\"form-creator__fields-area__bottom form-creator__fields-area__bottom--initial-screen\",4,\"ngIf\"],[\"class\",\"form-creator__fields-area__bottom\",4,\"ngIf\"],[\"id\",\"text-area\",1,\"form-creator__text-area\"],[\"id\",\"wodoautomatikdocs\",2,\"width\",\"100%\",\"height\",\"100%\",\"margin\",\"0px\",\"padding\",\"0px\"],[\"id\",\"editorContainer\",2,\"width\",\"100%\",\"height\",\"100%\",\"margin\",\"0px\",\"padding\",\"0px\"],[\"id\",\"scrollToTop\",1,\"button-filled\",\"button-filled--preview-document\",2,\"display\",\"none\",3,\"click\"],[2,\"font-size\",\"20px\"],[1,\"modal\"],[\"modal\",\"\"],[1,\"modal__content\",\"modal__content--privacy\"],[1,\"modal__content__top\",\"modal__content__top--privacy\"],[1,\"text-center\"],[\"id\",\"modal-middle-privacy\",1,\"modal__content__modal-middle\",\"modal__content__modal-middle--privacy\"],[1,\"modal__content__modal-middle__container\"],[3,\"innerHTML\"],[1,\"modal__content__modal-bottom\",\"modal__content__modal-bottom--privacy\"],[\"id\",\"modal-button\",1,\"button-filled\",3,\"click\"],[\"modalEnd\",\"\"],[1,\"modal__content\",\"modal__content--privacy\",3,\"form\",\"formPaid\",\"exitModal\",\"downloadWordOutput\",\"downloadPdfOutput\"],[\"modalDownload\",\"\"],[1,\"modal__content\",2,\"padding\",\"2rem\"],[1,\"modal__content__modal-middle\",\"modal__content__modal-middle--change-password\"],[1,\"download-documents-modal\"],[1,\"icon\",\"icon-file-word-solid\",\"trigger\",3,\"click\"],[1,\"icon\",\"icon-file-pdf-solid\",3,\"click\"],[1,\"modal__content__modal-bottom\"],[\"modalIndication\",\"\"],[1,\"modal__content\",\"modal__content--question-indication\"],[1,\"modal__content__top\",\"modal__content__top--indication\"],[1,\"modal__content__modal-middle\",\"modal__content__modal-middle--question-indication\"],[1,\"modal__content__modal-middle__container\",3,\"innerHTML\"],[1,\"new-modal-content__footer\",\"new-modal-content__footer--indicactions\"],[1,\"btn\",\"next-btn\",3,\"click\"],[1,\"form-creator__fields-area__top__container\"],[1,\"form-creator__fields-area__top__author-date\"],[1,\"form-creator__fields-area__top__author-date__author\"],[1,\"form-creator__fields-area__top__author-date__author__image-container\"],[\"src\",\"/assets/images/silvia-avatar.jpeg\",\"alt\",\"avatar\"],[\"routerLink\",\"/static-pages/silvia-profile\"],[1,\"form-creator__fields-area__top__author-date__date\"],[1,\"form-creator__fields-area__top__before-start-button\"],[1,\"form-creator__fields-area__top__before-start-button__information-modal-icon\",\"trigger\"],[1,\"icon\",\"icon-info-solid\",3,\"click\"],[1,\"progress-container\"],[1,\"progress\",\"progress-large\"],[\"progressBar\",\"\"],[1,\"form-creator__fields-area__middle__container\"],[1,\"form-creator__fields-area__middle__initial-screen\"],[1,\"form-creator__fields-area__middle__initial-screen__form-title\"],[1,\"form-creator__fields-area__middle__initial-screen__description\"],[1,\"button-filled\",\"button-filled--start-form\",3,\"click\"],[3,\"step\",\"inputInvalid\",\"emitIndication\"],[3,\"step\",\"emitIndication\"],[1,\"form-creator__fields-area__field\"],[1,\"form-creator__fields-area__field__container\"],[1,\"form-creator__fields-area__end-step\"],[1,\"form-creator__fields-area__end-step__container\"],[1,\"form-creator__fields-area__end-step__check\",\"icon\",\"icon-check-circle-solid\"],[1,\"button-filled\",\"button-filled--start-form\",\"trigger\",3,\"click\"],[1,\"form-creator__fields-area__end-step__icons\"],[1,\"icon\",\"icon-file-word-solid\",\"trigger\"],[1,\"icon\",\"icon-file-pdf-solid\"],[1,\"form-creator__fields-area__bottom\",\"form-creator__fields-area__bottom--initial-screen\"],[1,\"form-creator__fields-area__bottom__step\"],[1,\"icon\",\"icon-file-regular\"],[1,\"form-creator__fields-area__bottom__step__number\"],[1,\"form-creator__fields-area__bottom__step__description\"],[1,\"icon\",\"icon-list-alt-regular\"],[1,\"icon\",\"icon-print-solid\"],[1,\"form-creator__fields-area__bottom\"],[1,\"form-creator__fields-area__bottom__container\"],[1,\"form-creator__fields-area__bottom__arrow-button\",3,\"click\"],[1,\"icon\",\"icon-chevron-left-solid\"],[1,\"form-creator__fields-area__bottom__arrow-button__label\"],[1,\"form-creator__fields-area__bottom__preview-button\",3,\"click\"],[\"class\",\"form-creator__fields-area__bottom__arrow-button\",3,\"click\",4,\"ngIf\"],[1,\"icon\",\"icon-chevron-right-solid\"]],template:function(rf,ctx){if(1&rf){const _r607=fesm2015_core.Rb();fesm2015_core.Qb(0,\"div\",0),fesm2015_core.Qb(1,\"div\",1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.yc(4,FormComponent_div_4_Template,14,1,\"div\",4),fesm2015_core.yc(5,FormComponent_div_5_Template,5,3,\"div\",5),fesm2015_core.Pb(),fesm2015_core.Qb(6,\"div\",6),fesm2015_core.yc(7,FormComponent_div_7_Template,8,2,\"div\",7),fesm2015_core.yc(8,FormComponent_app_i_text_8_Template,1,2,\"app-i-text\",8),fesm2015_core.yc(9,FormComponent_app_i_date_9_Template,1,2,\"app-i-date\",8),fesm2015_core.yc(10,FormComponent_app_i_number_10_Template,1,2,\"app-i-number\",8),fesm2015_core.yc(11,FormComponent_app_i_for_each_11_Template,1,1,\"app-i-for-each\",9),fesm2015_core.yc(12,FormComponent_app_i_radio_b_12_Template,1,1,\"app-i-radio-b\",9),fesm2015_core.yc(13,FormComponent_app_i_radio_c_13_Template,1,1,\"app-i-radio-c\",9),fesm2015_core.yc(14,FormComponent_app_i_select_14_Template,1,1,\"app-i-select\",9),fesm2015_core.yc(15,FormComponent_app_i_checkbox_15_Template,1,1,\"app-i-checkbox\",9),fesm2015_core.yc(16,FormComponent_div_16_Template,13,0,\"div\",7),fesm2015_core.Pb(),fesm2015_core.yc(17,FormComponent_div_17_Template,19,0,\"div\",10),fesm2015_core.yc(18,FormComponent_div_18_Template,11,1,\"div\",11),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(19,\"div\",12),fesm2015_core.Qb(20,\"div\",13),fesm2015_core.Mb(21,\"div\",14),fesm2015_core.Pb(),fesm2015_core.Qb(22,\"button\",15),fesm2015_core.Zb(\"click\",(function(){return ctx.previewDocumentButton(!1)})),fesm2015_core.zc(23,\"Form \"),fesm2015_core.Qb(24,\"span\",16),fesm2015_core.zc(25,\"↑\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(26,\"div\",17,18),fesm2015_core.Qb(28,\"div\",19),fesm2015_core.Qb(29,\"div\",20),fesm2015_core.Qb(30,\"h2\",21),fesm2015_core.zc(31,\"Indicaciones antes de comenzar el formulario\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(32,\"div\",22),fesm2015_core.Qb(33,\"div\",23),fesm2015_core.Mb(34,\"div\",24),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(35,\"div\",25),fesm2015_core.Qb(36,\"button\",26),fesm2015_core.Zb(\"click\",(function(){fesm2015_core.rc(_r607);const _r574=fesm2015_core.pc(27);return ctx.toogleModal(_r574),ctx.moveStep(\"next\")})),fesm2015_core.zc(37,\"Rellenar\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(38,\"div\",17,27),fesm2015_core.Qb(40,\"app-checkout\",28),fesm2015_core.Zb(\"formPaid\",(function($event){return ctx.onFormPaid($event)}))(\"exitModal\",(function(){return ctx.onExitPayment()}))(\"downloadWordOutput\",(function(){return ctx.downloadWord()}))(\"downloadPdfOutput\",(function(){return ctx.downloadPdf()})),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(41,\"div\",17,29),fesm2015_core.Qb(43,\"div\",30),fesm2015_core.Qb(44,\"div\",31),fesm2015_core.Qb(45,\"div\",23),fesm2015_core.Qb(46,\"div\",32),fesm2015_core.Qb(47,\"span\",33),fesm2015_core.Zb(\"click\",(function(){return ctx.downloadWord()})),fesm2015_core.Pb(),fesm2015_core.Qb(48,\"span\",34),fesm2015_core.Zb(\"click\",(function(){return ctx.downloadPdf()})),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(49,\"div\",35),fesm2015_core.Qb(50,\"button\",26),fesm2015_core.Zb(\"click\",(function(){fesm2015_core.rc(_r607);const _r576=fesm2015_core.pc(42);return ctx.toogleModal(_r576)})),fesm2015_core.zc(51,\"Cancelar\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(52,\"div\",17,36),fesm2015_core.Qb(54,\"div\",37),fesm2015_core.Qb(55,\"div\",38),fesm2015_core.Qb(56,\"h2\"),fesm2015_core.zc(57,\"Indicaciones\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(58,\"div\",39),fesm2015_core.Mb(59,\"div\",40),fesm2015_core.Pb(),fesm2015_core.Qb(60,\"div\",41),fesm2015_core.Qb(61,\"button\",42),fesm2015_core.Zb(\"click\",(function(){fesm2015_core.rc(_r607);const _r577=fesm2015_core.pc(53);return ctx.toogleModal(_r577)})),fesm2015_core.zc(62,\"Entendido\"),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb()}2&rf&&(fesm2015_core.zb(4),fesm2015_core.ic(\"ngIf\",\"start\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"start\"!==(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(2),fesm2015_core.ic(\"ngIf\",\"start\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iText\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iDate\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iNumber\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iForEach\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iRadioB\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)&&\"select\"!==(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].subType)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iRadioC\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)&&\"select\"!==(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].subType)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iRadioC\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)&&\"select\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].subType)||\"iRadioB\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)&&\"select\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].subType)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"iCheckbox\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"end\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"start\"===(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(1),fesm2015_core.ic(\"ngIf\",\"start\"!==(null==ctx.steps[ctx.currentStep]?null:ctx.steps[ctx.currentStep].type)),fesm2015_core.zb(16),fesm2015_core.ic(\"innerHTML\",ctx.form.information,fesm2015_core.sc),fesm2015_core.zb(6),fesm2015_core.ic(\"form\",ctx.form),fesm2015_core.zb(19),fesm2015_core.ic(\"innerHTML\",ctx.indications.value,fesm2015_core.sc))},directives:[common.t,checkout_component_CheckoutComponent,fesm2015_router.e,i_text_component_ITextComponent,i_date_component_IDateComponent,i_number_component_INumberComponent,i_for_each_component_IForEachComponent,i_radio_b_component_IRadioBComponent,i_radio_c_component_IRadioCComponent,i_select_component_ISelectComponent,i_checkbox_component_ICheckboxComponent],encapsulation:2}),FormComponent})();const certified_forms_component_c0=[\"subMenu\"],certified_forms_component_c1=[\"loginModal\"];function CertifiedFormsComponent_li_6_Template(rf,ctx){if(1&rf&&(fesm2015_core.Qb(0,\"li\",8),fesm2015_core.zc(1),fesm2015_core.Pb()),2&rf){const ctx_r559=fesm2015_core.dc();fesm2015_core.zb(1),fesm2015_core.Bc(\" \",ctx_r559.form.topLabelTitle,\" \")}}const routes=[{path:\":id\",component:(()=>{class CertifiedFormsComponent{constructor(commonsService,formsService,userService,sharedService,router,route,toastr){this.commonsService=commonsService,this.formsService=formsService,this.userService=userService,this.sharedService=sharedService,this.router=router,this.route=route,this.toastr=toastr,this.form=new core.i,this.originalForm=new core.i,this.currentStep=0,this.updatingForm=!1}ngOnInit(){this.commonsService.addTags(\"certifiedForms\"),this.sharedService.currentForm.subscribe(form=>{this.commonsService.isObjectEmpty(form)||(this.form=form,this.currentStep=form.currentStep)}),this.userService.isAuthenticated.subscribe(isAuthenticated=>{this.isAuth=!!isAuthenticated}),this.commonsService.isBrowser()&&window.addEventListener(\"unload\",this.saveInSessionStorage.bind(this))}ngOnDestroy(){this.saveInSessionStorage(),window.removeEventListener(\"unload\",this.saveInSessionStorage)}topMenuNav(e){this.commonsService.subMenuNav(e,this.subMenu.nativeElement)}saveForm(){this.isAuth?(this.form.type=\"Certified\",this.validateForm(),this.formsService.save(this.form).subscribe(form=>{this.toastr.success(\"Has been saved\",form.title,{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"})},err=>{console.log(err),this.toastr.error(\"Un error ha ocurrido. Inténtalo de nuevo\",\"Error\",{positionClass:\"toast-bottom-right\",progressBar:!0,progressAnimation:\"decreasing\"})})):(window.sessionStorage&&(window.sessionStorage[this.form.id]=JSON.stringify(this.form)),this.router.navigate([\"/auth/login\"],{queryParams:{formPath:this.router.url.substring(this.router.url.lastIndexOf(\"/\")+1)}}))}saveInSessionStorage(){window.sessionStorage&&(window.sessionStorage[this.form.id]=JSON.stringify(this.form))}toogleModal(modal){this.commonsService.toggleModal(modal,!0)}validateForm(){this.form.description=\"blabla\",this.form.text=\"blaw\"}}return CertifiedFormsComponent.ɵfac=function(t){return new(t||CertifiedFormsComponent)(fesm2015_core.Lb(core.e),fesm2015_core.Lb(core.k),fesm2015_core.Lb(core.s),fesm2015_core.Lb(shared_service_SharedService),fesm2015_core.Lb(fesm2015_router.d),fesm2015_core.Lb(fesm2015_router.a),fesm2015_core.Lb(ngx_toastr.b))},CertifiedFormsComponent.ɵcmp=fesm2015_core.Fb({type:CertifiedFormsComponent,selectors:[[\"app-certified-forms\"]],viewQuery:function(rf,ctx){var _t;1&rf&&(fesm2015_core.Dc(certified_forms_component_c0,!0),fesm2015_core.Dc(certified_forms_component_c1,!0)),2&rf&&(fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.subMenu=_t.first),fesm2015_core.oc(_t=fesm2015_core.ac())&&(ctx.loginModal=_t.first))},decls:9,vars:2,consts:[[1,\"sub-menu\"],[\"subMenu\",\"\"],[1,\"sub-menu__container\",\"sub-menu__container--fill-form\"],[1,\"sub-menu__left-button\",\"sub-menu__left-button--fill-form\"],[1,\"button-filled\",\"button-filled--sub-menu-fill-form\",\"icon\",\"icon-save-solid\",3,\"hidden\",\"click\"],[1,\"sub-menu__nav\",\"sub-menu__nav--fill-form\",2,\"justify-content\",\"center\"],[\"class\",\"sub-menu__nav__button sub-menu__nav__button--without-hover\",4,\"ngIf\"],[\"id\",\"form-creator\",1,\"form-creator\"],[1,\"sub-menu__nav__button\",\"sub-menu__nav__button--without-hover\"]],template:function(rf,ctx){1&rf&&(fesm2015_core.Qb(0,\"div\",0,1),fesm2015_core.Qb(2,\"div\",2),fesm2015_core.Qb(3,\"div\",3),fesm2015_core.Qb(4,\"button\",4),fesm2015_core.Zb(\"click\",(function(){return ctx.saveForm()})),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(5,\"ul\",5),fesm2015_core.yc(6,CertifiedFormsComponent_li_6_Template,2,1,\"li\",6),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Pb(),fesm2015_core.Qb(7,\"div\",7),fesm2015_core.Mb(8,\"app-form\"),fesm2015_core.Pb()),2&rf&&(fesm2015_core.zb(4),fesm2015_core.ic(\"hidden\",!ctx.currentStep),fesm2015_core.zb(2),fesm2015_core.ic(\"ngIf\",ctx.form))},directives:[common.t,form_component_FormComponent],encapsulation:2}),CertifiedFormsComponent})(),children:[]}];let certified_forms_routing_module_CertifiedFormsRoutingModule=(()=>{class CertifiedFormsRoutingModule{}return CertifiedFormsRoutingModule.ɵmod=fesm2015_core.Jb({type:CertifiedFormsRoutingModule}),CertifiedFormsRoutingModule.ɵinj=fesm2015_core.Ib({factory:function(t){return new(t||CertifiedFormsRoutingModule)},imports:[[fesm2015_router.h.forChild(routes)],fesm2015_router.h]}),CertifiedFormsRoutingModule})(),certified_forms_module_CertifiedFormsModule=(()=>{class CertifiedFormsModule{}return CertifiedFormsModule.ɵmod=fesm2015_core.Jb({type:CertifiedFormsModule}),CertifiedFormsModule.ɵinj=fesm2015_core.Ib({factory:function(t){return new(t||CertifiedFormsModule)},providers:[shared_service_SharedService,doc_creator_service_DocCreatorService,step_service_StepsService],imports:[[common.c,shared.a,certified_forms_routing_module_CertifiedFormsRoutingModule]]}),CertifiedFormsModule})()},gusg:function(module,exports,__webpack_require__){module.exports=function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,(function(r){return o(e[i][1][r]||r)}),p,p.exports,r,e,n,t)}return n[i].exports}for(var u=!1,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(_dereq_,module,exports){(function(global){\"use strict\";var PromisePolyfill=_dereq_(\"promise-polyfill\");module.exports=global.Promise||PromisePolyfill}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"promise-polyfill\":39}],2:[function(_dereq_,module,exports){\"use strict\";var Promise=_dereq_(\"./lib/promise\"),scriptPromiseCache={};function loadScript(options){var attrs,container,script,scriptLoadPromise,stringifiedOptions=JSON.stringify(options);return!options.forceScriptReload&&(scriptLoadPromise=scriptPromiseCache[stringifiedOptions])||(script=document.createElement(\"script\"),attrs=options.dataAttributes||{},container=options.container||document.head,script.src=options.src,script.id=options.id,script.async=!0,options.crossorigin&&script.setAttribute(\"crossorigin\",options.crossorigin),Object.keys(attrs).forEach((function(key){script.setAttribute(\"data-\"+key,attrs[key])})),scriptLoadPromise=new Promise((function(resolve,reject){script.addEventListener(\"load\",(function(){resolve(script)})),script.addEventListener(\"error\",(function(){reject(new Error(options.src+\" failed to load.\"))})),script.addEventListener(\"abort\",(function(){reject(new Error(options.src+\" has aborted.\"))})),container.appendChild(script)})),scriptPromiseCache[stringifiedOptions]=scriptLoadPromise),scriptLoadPromise}loadScript.clearCache=function(){scriptPromiseCache={}},module.exports=loadScript},{\"./lib/promise\":1}],3:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(ua){return/Android/.test(ua=ua||global.navigator.userAgent)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],4:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(ua){return/CrOS/i.test(ua=ua||global.navigator.userAgent)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],5:[function(_dereq_,module,exports){\"use strict\";var isEdge=_dereq_(\"./is-edge\"),isSamsung=_dereq_(\"./is-samsung\");module.exports=function(ua){return!(-1===(ua=ua||navigator.userAgent).indexOf(\"Chrome\")&&-1===ua.indexOf(\"CriOS\")||isEdge(ua)||isSamsung(ua))}},{\"./is-edge\":6,\"./is-samsung\":18}],6:[function(_dereq_,module,exports){\"use strict\";module.exports=function(ua){return-1!==(ua=ua||navigator.userAgent).indexOf(\"Edge/\")}},{}],7:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(ua){return/Firefox/i.test(ua=ua||global.navigator.userAgent)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],8:[function(_dereq_,module,exports){(function(global){\"use strict\";var isIE11=_dereq_(\"./is-ie11\");module.exports=function(ua){return-1!==(ua=ua||global.navigator.userAgent).indexOf(\"MSIE\")||isIE11(ua)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./is-ie11\":10}],9:[function(_dereq_,module,exports){\"use strict\";module.exports=function(ua){return-1!==(ua=ua||navigator.userAgent).indexOf(\"MSIE 10\")}},{}],10:[function(_dereq_,module,exports){\"use strict\";module.exports=function(ua){return-1!==(ua=ua||navigator.userAgent).indexOf(\"Trident/7\")}},{}],11:[function(_dereq_,module,exports){\"use strict\";module.exports=function(ua){return-1!==(ua=ua||navigator.userAgent).indexOf(\"MSIE 9\")}},{}],12:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(ua){return/FxiOS/i.test(ua=ua||global.navigator.userAgent)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],13:[function(_dereq_,module,exports){\"use strict\";var isIos=_dereq_(\"./is-ios\"),webkitRegexp=/webkit/i;module.exports=function(ua){return ua=ua||navigator.userAgent,isIos(ua)&&function(ua){return ua.match(webkitRegexp)}(ua)&&-1===ua.indexOf(\"CriOS\")}},{\"./is-ios\":16}],14:[function(_dereq_,module,exports){(function(global){\"use strict\";var isIos=_dereq_(\"./is-ios\");module.exports=function(ua){return!!isIos(ua=ua||global.navigator.userAgent)&&(!!function(ua){return/\\bGSA\\b/.test(ua)}(ua)||/.+AppleWebKit(?!.*Safari)/.test(ua))}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./is-ios\":16}],15:[function(_dereq_,module,exports){(function(global){\"use strict\";var isIosWebview=_dereq_(\"./is-ios-webview\");module.exports=function(ua,statusBarVisible){return statusBarVisible=void 0!==statusBarVisible?statusBarVisible:global.statusbar.visible,isIosWebview(ua)&&statusBarVisible}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./is-ios-webview\":14}],16:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(ua){return/iPhone|iPod|iPad/i.test(ua=ua||global.navigator.userAgent)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],17:[function(_dereq_,module,exports){(function(global){\"use strict\";var isIosFirefox=_dereq_(\"./is-ios-firefox\"),isFirefox=_dereq_(\"./is-firefox\");module.exports=function(ua){return isIosFirefox(ua=ua||global.navigator.userAgent)||/iPhone|iPod|iPad|Mobile|Tablet/i.test(ua)&&isFirefox(ua)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./is-firefox\":7,\"./is-ios-firefox\":12}],18:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(ua){return/SamsungBrowser/i.test(ua=ua||global.navigator.userAgent)}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],19:[function(_dereq_,module,exports){(function(global){\"use strict\";var isAndroid=_dereq_(\"./is-android\"),isIosFirefox=_dereq_(\"./is-ios-firefox\"),isIosWebview=_dereq_(\"./is-ios-webview\"),isChrome=_dereq_(\"./is-chrome\"),isSamsungBrowser=_dereq_(\"./is-samsung\");function isOperaMini(ua){return(ua=ua||global.navigator.userAgent).indexOf(\"Opera Mini\")>-1}module.exports=function(ua){return!(isIosWebview(ua=ua||global.navigator.userAgent)||isIosFirefox(ua)||function(ua){return!!isAndroid(ua=ua||global.navigator.userAgent)&&/Version\\/[\\d\\.]+/.test(ua)&&!isOperaMini(ua)}(ua)||isOperaMini(ua)||function(ua){var match;return!!(match=(ua=ua||global.navigator.userAgent).match(/CriOS\\/(\\d+)\\./))&&parseInt(match[1],10)<48}(ua)||function(ua){return!isChrome(ua)&&!isSamsungBrowser(ua)&&/samsung/i.test(ua)}(ua))}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./is-android\":3,\"./is-chrome\":5,\"./is-ios-firefox\":12,\"./is-ios-webview\":14,\"./is-samsung\":18}],20:[function(_dereq_,module,exports){\"use strict\";function _classesOf(element){return element.className.trim().split(/\\s+/)}function add(element){var toAdd=Array.prototype.slice.call(arguments,1),className=_classesOf(element).filter((function(classname){return-1===toAdd.indexOf(classname)})).concat(toAdd).join(\" \");element.className=className}function remove(element){var toRemove=Array.prototype.slice.call(arguments,1),className=_classesOf(element).filter((function(classname){return-1===toRemove.indexOf(classname)})).join(\" \");element.className=className}module.exports={add:add,remove:remove,toggle:function(element,classname,adding){adding?add(element,classname):remove(element,classname)}}},{}],21:[function(_dereq_,module,exports){\"use strict\";function EventEmitter(){this._events={}}EventEmitter.prototype.on=function(event,callback){this._events[event]?this._events[event].push(callback):this._events[event]=[callback]},EventEmitter.prototype.off=function(event,callback){var indexOfCallback,eventCallbacks=this._events[event];eventCallbacks&&(indexOfCallback=eventCallbacks.indexOf(callback),eventCallbacks.splice(indexOfCallback,1))},EventEmitter.prototype._emit=function(event){var args,eventCallbacks=this._events[event];eventCallbacks&&(args=Array.prototype.slice.call(arguments,1),eventCallbacks.forEach((function(callback){callback.apply(null,args)})))},EventEmitter.prototype.hasListener=function(event){var eventCallbacks=this._events[event];return!!eventCallbacks&&eventCallbacks.length>0},EventEmitter.createChild=function(ChildObject){ChildObject.prototype=Object.create(EventEmitter.prototype,{constructor:ChildObject})},module.exports=EventEmitter},{}],22:[function(_dereq_,module,exports){(function(global){\"use strict\";function ExtendedPromise(options){var self=this;return\"function\"==typeof options?new ExtendedPromise.Promise(options):(this._promise=new ExtendedPromise.Promise((function(resolve,reject){self._resolveFunction=resolve,self._rejectFunction=reject})),this._onResolve=(options=options||{}).onResolve||ExtendedPromise.defaultOnResolve,this._onReject=options.onReject||ExtendedPromise.defaultOnReject,function(options){return options.hasOwnProperty(\"suppressUnhandledPromiseMessage\")?Boolean(options.suppressUnhandledPromiseMessage):Boolean(ExtendedPromise.suppressUnhandledPromiseMessage)}(options)&&this._promise.catch((function(){})),this._resetState(),this._promise.resolve=this.resolve.bind(this),this._promise.reject=this.reject.bind(this),this._promise)}[\"all\",\"allSettled\",\"race\",\"reject\",\"resolve\"].forEach((function(method){ExtendedPromise[method]=function(){var args=Array.prototype.slice.call(arguments);return ExtendedPromise.Promise[method].apply(ExtendedPromise.Promise,args)}})),ExtendedPromise.setPromise=function(PromiseClass){ExtendedPromise.Promise=PromiseClass},ExtendedPromise.setPromise(global.Promise),ExtendedPromise.defaultOnResolve=function(result){return ExtendedPromise.Promise.resolve(result)},ExtendedPromise.defaultOnReject=function(err){return ExtendedPromise.Promise.reject(err)},ExtendedPromise.prototype.resolve=function(arg){var self=this;return this._promise.isFulfilled||(this._setResolved(),ExtendedPromise.Promise.resolve().then((function(){return self._onResolve(arg)})).then(this._resolveFunction).catch((function(err){self._resetState(),self._promise.reject(err)}))),this._promise},ExtendedPromise.prototype.reject=function(arg){var self=this;return this._promise.isFulfilled||(this._setRejected(),ExtendedPromise.Promise.resolve().then((function(){return self._onReject(arg)})).then((function(result){self._setResolved(),self._resolveFunction(result)})).catch(this._rejectFunction)),this._promise},ExtendedPromise.prototype._resetState=function(){this._promise.isFulfilled=!1,this._promise.isResolved=!1,this._promise.isRejected=!1},ExtendedPromise.prototype._setResolved=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!0,this._promise.isRejected=!1},ExtendedPromise.prototype._setRejected=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!1,this._promise.isRejected=!0},module.exports=ExtendedPromise}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],23:[function(_dereq_,module,exports){\"use strict\";var setAttributes=_dereq_(\"./lib/set-attributes\"),defaultAttributes=_dereq_(\"./lib/default-attributes\"),assign=_dereq_(\"./lib/assign\");module.exports=function(options){var iframe=document.createElement(\"iframe\"),config=assign({},defaultAttributes,options);return config.style&&\"string\"!=typeof config.style&&(assign(iframe.style,config.style),delete config.style),setAttributes(iframe,config),iframe.getAttribute(\"id\")||(iframe.id=iframe.name),iframe}},{\"./lib/assign\":24,\"./lib/default-attributes\":25,\"./lib/set-attributes\":26}],24:[function(_dereq_,module,exports){\"use strict\";module.exports=function(target){var objs=Array.prototype.slice.call(arguments,1);return objs.forEach((function(obj){\"object\"==typeof obj&&Object.keys(obj).forEach((function(key){target[key]=obj[key]}))})),target}},{}],25:[function(_dereq_,module,exports){\"use strict\";module.exports={src:\"about:blank\",frameBorder:0,allowtransparency:!0,scrolling:\"no\"}},{}],26:[function(_dereq_,module,exports){\"use strict\";module.exports=function(element,attributes){var value;for(var key in attributes)attributes.hasOwnProperty(key)&&(null==(value=attributes[key])?element.removeAttribute(key):element.setAttribute(key,value))}},{}],27:[function(_dereq_,module,exports){\"use strict\";module.exports=function(fn){return function(){var args=arguments;setTimeout((function(){try{fn.apply(null,args)}catch(err){console.log(\"Error in callback function\"),console.log(err)}}),1)}}},{}],28:[function(_dereq_,module,exports){\"use strict\";module.exports=function(fn){var called=!1;return function(){called||(called=!0,fn.apply(null,arguments))}}},{}],29:[function(_dereq_,module,exports){\"use strict\";module.exports=function(promise,callback){if(!callback)return promise;promise.then((function(data){callback(null,data)})).catch((function(err){callback(err)}))}},{}],30:[function(_dereq_,module,exports){\"use strict\";var deferred=_dereq_(\"./lib/deferred\"),once=_dereq_(\"./lib/once\"),promiseOrCallback=_dereq_(\"./lib/promise-or-callback\");function wrapPromise(fn){return function(){var callback,args=Array.prototype.slice.call(arguments),lastArg=args[args.length-1];return\"function\"==typeof lastArg&&(callback=args.pop(),callback=once(deferred(callback))),promiseOrCallback(fn.apply(this,args),callback)}}wrapPromise.wrapPrototype=function(target,options){var ignoreMethods,includePrivateMethods;return ignoreMethods=(options=options||{}).ignoreMethods||[],includePrivateMethods=!0===options.transformPrivateMethods,Object.getOwnPropertyNames(target.prototype).filter((function(method){var isNotPrivateMethod,isNonConstructorFunction=\"constructor\"!==method&&\"function\"==typeof target.prototype[method],isNotAnIgnoredMethod=-1===ignoreMethods.indexOf(method);return isNotPrivateMethod=!!includePrivateMethods||\"_\"!==method.charAt(0),isNonConstructorFunction&&isNotPrivateMethod&&isNotAnIgnoredMethod})).forEach((function(method){target.prototype[method]=wrapPromise(target.prototype[method])})),target},module.exports=wrapPromise},{\"./lib/deferred\":27,\"./lib/once\":28,\"./lib/promise-or-callback\":29}],31:[function(_dereq_,module,exports){\"use strict\";var testOrder,types=_dereq_(\"./lib/card-types\"),clone=_dereq_(\"./lib/clone\"),findBestMatch=_dereq_(\"./lib/find-best-match\"),isValidInputType=_dereq_(\"./lib/is-valid-input-type\"),addMatchingCardsToResults=_dereq_(\"./lib/add-matching-cards-to-results\"),customCards={},cardNames={VISA:\"visa\",MASTERCARD:\"mastercard\",AMERICAN_EXPRESS:\"american-express\",DINERS_CLUB:\"diners-club\",DISCOVER:\"discover\",JCB:\"jcb\",UNIONPAY:\"unionpay\",MAESTRO:\"maestro\",ELO:\"elo\",MIR:\"mir\",HIPER:\"hiper\",HIPERCARD:\"hipercard\"},ORIGINAL_TEST_ORDER=[cardNames.VISA,cardNames.MASTERCARD,cardNames.AMERICAN_EXPRESS,cardNames.DINERS_CLUB,cardNames.DISCOVER,cardNames.JCB,cardNames.UNIONPAY,cardNames.MAESTRO,cardNames.ELO,cardNames.MIR,cardNames.HIPER,cardNames.HIPERCARD];function findType(type){return customCards[type]||types[type]}function getCardPosition(name,ignoreErrorForNotExisting){var position=testOrder.indexOf(name);if(!ignoreErrorForNotExisting&&-1===position)throw new Error('\"'+name+'\" is not a supported card type.');return position}function creditCardType(cardNumber){var bestMatch,results=[];return isValidInputType(cardNumber)?0===cardNumber.length?testOrder.map((function(type){return clone(findType(type))})):(testOrder.forEach((function(type){var cardConfiguration=findType(type);addMatchingCardsToResults(cardNumber,cardConfiguration,results)})),(bestMatch=findBestMatch(results))?[bestMatch]:results):[]}testOrder=clone(ORIGINAL_TEST_ORDER),creditCardType.getTypeInfo=function(type){return clone(findType(type))},creditCardType.removeCard=function(name){var position=getCardPosition(name);testOrder.splice(position,1)},creditCardType.addCard=function(config){var existingCardPosition=getCardPosition(config.type,!0);customCards[config.type]=config,-1===existingCardPosition&&testOrder.push(config.type)},creditCardType.updateCard=function(cardType,updates){var clonedCard,originalObject=customCards[cardType]||types[cardType];if(!originalObject)throw new Error('\"'+cardType+'\" is not a recognized type. Use `addCard` instead.');if(updates.type&&originalObject.type!==updates.type)throw new Error(\"Cannot overwrite type parameter.\");clonedCard=clone(originalObject,!0),Object.keys(clonedCard).forEach((function(key){updates[key]&&(clonedCard[key]=updates[key])})),customCards[clonedCard.type]=clonedCard},creditCardType.changeOrder=function(name,position){var currentPosition=getCardPosition(name);testOrder.splice(currentPosition,1),testOrder.splice(position,0,name)},creditCardType.resetModifications=function(){testOrder=clone(ORIGINAL_TEST_ORDER),customCards={}},creditCardType.types=cardNames,module.exports=creditCardType},{\"./lib/add-matching-cards-to-results\":32,\"./lib/card-types\":33,\"./lib/clone\":34,\"./lib/find-best-match\":35,\"./lib/is-valid-input-type\":36}],32:[function(_dereq_,module,exports){\"use strict\";var clone=_dereq_(\"./clone\"),matches=_dereq_(\"./matches\");module.exports=function(cardNumber,cardConfiguration,results){var i,pattern,patternLength,clonedCardConfiguration;for(i=0;i<cardConfiguration.patterns.length;i++)if(matches(cardNumber,pattern=cardConfiguration.patterns[i])){clonedCardConfiguration=clone(cardConfiguration),patternLength=Array.isArray(pattern)?String(pattern[0]).length:String(pattern).length,cardNumber.length>=patternLength&&(clonedCardConfiguration.matchStrength=patternLength),results.push(clonedCardConfiguration);break}}},{\"./clone\":34,\"./matches\":37}],33:[function(_dereq_,module,exports){\"use strict\";module.exports={visa:{niceType:\"Visa\",type:\"visa\",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:\"CVV\",size:3}},mastercard:{niceType:\"Mastercard\",type:\"mastercard\",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:\"CVC\",size:3}},\"american-express\":{niceType:\"American Express\",type:\"american-express\",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:\"CID\",size:4}},\"diners-club\":{niceType:\"Diners Club\",type:\"diners-club\",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:\"CVV\",size:3}},discover:{niceType:\"Discover\",type:\"discover\",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:\"CID\",size:3}},jcb:{niceType:\"JCB\",type:\"jcb\",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:\"CVV\",size:3}},unionpay:{niceType:\"UnionPay\",type:\"unionpay\",patterns:[620,[624,626],[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[622019,622999],[62207,62209],[622126,622925],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:\"CVN\",size:3}},maestro:{niceType:\"Maestro\",type:\"maestro\",patterns:[493698,[5e5,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:\"CVC\",size:3}},elo:{niceType:\"Elo\",type:\"elo\",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:\"CVE\",size:3}},mir:{niceType:\"Mir\",type:\"mir\",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:\"CVP2\",size:3}},hiper:{niceType:\"Hiper\",type:\"hiper\",patterns:[637095,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:\"CVC\",size:3}},hipercard:{niceType:\"Hipercard\",type:\"hipercard\",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:\"CVC\",size:3}}}},{}],34:[function(_dereq_,module,exports){\"use strict\";module.exports=function(originalObject){return originalObject?JSON.parse(JSON.stringify(originalObject)):null}},{}],35:[function(_dereq_,module,exports){\"use strict\";module.exports=function(results){if(function(results){var numberOfResultsWithMaxStrengthProperty=results.filter((function(result){return result.matchStrength})).length;return numberOfResultsWithMaxStrengthProperty>0&&numberOfResultsWithMaxStrengthProperty===results.length}(results))return results.reduce((function(bestMatch,result){return bestMatch?bestMatch.matchStrength<result.matchStrength?result:bestMatch:result}))}},{}],36:[function(_dereq_,module,exports){\"use strict\";module.exports=function(cardNumber){return\"string\"==typeof cardNumber||cardNumber instanceof String}},{}],37:[function(_dereq_,module,exports){\"use strict\";module.exports=function(cardNumber,pattern){return Array.isArray(pattern)?function(cardNumber,min,max){var maxLengthToCheck=String(min).length,substr=cardNumber.substr(0,maxLengthToCheck),integerRepresentationOfCardNumber=parseInt(substr,10);return min=parseInt(String(min).substr(0,substr.length),10),max=parseInt(String(max).substr(0,substr.length),10),integerRepresentationOfCardNumber>=min&&integerRepresentationOfCardNumber<=max}(cardNumber,pattern[0],pattern[1]):function(cardNumber,pattern){return(pattern=String(pattern)).substring(0,cardNumber.length)===cardNumber.substring(0,pattern.length)}(cardNumber,pattern)}},{}],38:[function(_dereq_,module,exports){(function(global){\"use strict\";var win,framebus,popups=[],subscribers={},prefix=\"/*framebus*/\";function publish(event){var payload,origin=_getOrigin(this);return!_isntString(event)&&!_isntString(origin)&&!1!==(payload=_packagePayload(event,Array.prototype.slice.call(arguments,1),origin))&&(_broadcast(win.top||win.self,payload,origin),!0)}function subscribe(event,fn){var origin=_getOrigin(this);return!_subscriptionArgsInvalid(event,fn,origin)&&(subscribers[origin]=subscribers[origin]||{},subscribers[origin][event]=subscribers[origin][event]||[],subscribers[origin][event].push(fn),!0)}function unsubscribe(event,fn){var i,subscriberList,origin=_getOrigin(this);if(_subscriptionArgsInvalid(event,fn,origin))return!1;if(!(subscriberList=subscribers[origin]&&subscribers[origin][event]))return!1;for(i=0;i<subscriberList.length;i++)if(subscriberList[i]===fn)return subscriberList.splice(i,1),!0;return!1}function _getOrigin(scope){return scope&&scope._origin||\"*\"}function _isntString(string){return\"string\"!=typeof string}function _packagePayload(event,args,origin){var packaged=!1,payload={event:event,origin:origin},reply=args[args.length-1];\"function\"==typeof reply&&(payload.reply=_subscribeReplier(reply,origin),args=args.slice(0,-1)),payload.args=args;try{packaged=prefix+JSON.stringify(payload)}catch(e){throw new Error(\"Could not stringify event: \"+e.message)}return packaged}function _unpackPayload(e){var payload,replyOrigin,replySource,replyEvent;if(e.data.slice(0,prefix.length)!==prefix)return!1;try{payload=JSON.parse(e.data.slice(prefix.length))}catch(err){return!1}return null!=payload.reply&&(replyOrigin=e.origin,replySource=e.source,replyEvent=payload.reply,payload.reply=function(data){var replyPayload;return!!replySource&&!1!==(replyPayload=_packagePayload(replyEvent,[data],replyOrigin))&&void replySource.postMessage(replyPayload,replyOrigin)},payload.args.push(payload.reply)),payload}function _attach(w){win||((win=w||global).addEventListener?win.addEventListener(\"message\",_onmessage,!1):win.attachEvent?win.attachEvent(\"onmessage\",_onmessage):null===win.onmessage?win.onmessage=_onmessage:win=null)}function _uuid(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,(function(c){var r=16*Math.random()|0;return(\"x\"===c?r:3&r|8).toString(16)}))}function _onmessage(e){var payload;_isntString(e.data)||(payload=_unpackPayload(e))&&(_dispatch(\"*\",payload.event,payload.args,e),_dispatch(e.origin,payload.event,payload.args,e),function(payload,origin,source){var i,popup;for(i=popups.length-1;i>=0;i--)!0===(popup=popups[i]).closed?popups=popups.slice(i,1):source!==popup&&_broadcast(popup.top,payload,origin)}(e.data,payload.origin,e.source))}function _dispatch(origin,event,args,e){var i;if(subscribers[origin]&&subscribers[origin][event])for(i=0;i<subscribers[origin][event].length;i++)subscribers[origin][event][i].apply(e,args)}function _broadcast(frame,payload,origin){var frameToBroadcastTo,i=0;try{for(frame.postMessage(payload,origin),function(frame){return frame.top===frame&&null!=frame.opener&&frame.opener!==frame&&!0!==frame.opener.closed}(frame)&&_broadcast(frame.opener.top,payload,origin);frameToBroadcastTo=frame.frames[i];)_broadcast(frameToBroadcastTo,payload,origin),i++}catch(_){}}function _subscribeReplier(fn,origin){var uuid=_uuid();return framebus.target(origin).subscribe(uuid,(function replier(d,o){fn(d,o),framebus.target(origin).unsubscribe(uuid,replier)})),uuid}function _subscriptionArgsInvalid(event,fn,origin){return!!_isntString(event)||\"function\"!=typeof fn||!!_isntString(origin)}_attach(),module.exports=framebus={target:function(origin){var key,targetedFramebus={};for(key in framebus)framebus.hasOwnProperty(key)&&(targetedFramebus[key]=framebus[key]);return targetedFramebus._origin=origin||\"*\",targetedFramebus},_packagePayload:_packagePayload,_unpackPayload:_unpackPayload,_attach:_attach,_detach:function(){null!=win&&(win.removeEventListener?win.removeEventListener(\"message\",_onmessage,!1):win.detachEvent?win.detachEvent(\"onmessage\",_onmessage):win.onmessage===_onmessage&&(win.onmessage=null),win=null,popups=[],subscribers={})},_dispatch:_dispatch,_broadcast:_broadcast,_subscribeReplier:_subscribeReplier,_subscriptionArgsInvalid:_subscriptionArgsInvalid,_onmessage:_onmessage,_uuid:_uuid,_getSubscribers:function(){return subscribers},_win:function(){return win},include:function(popup){return null!=popup&&null!=popup.Window&&popup.constructor===popup.Window&&(popups.push(popup),!0)},publish:publish,pub:publish,trigger:publish,emit:publish,subscribe:subscribe,sub:subscribe,on:subscribe,unsubscribe:unsubscribe,unsub:unsubscribe,off:unsubscribe}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],39:[function(_dereq_,module,exports){\"use strict\";var setTimeoutFunc=setTimeout;function isArray(x){return Boolean(x&&void 0!==x.length)}function noop(){}function Promise(fn){if(!(this instanceof Promise))throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!=typeof fn)throw new TypeError(\"not a function\");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn((function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)}))):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError(\"A promise cannot be resolved with itself.\");if(newValue&&(\"object\"==typeof newValue||\"function\"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if(\"function\"==typeof then)return void doResolve((fn=then,thisArg=newValue,function(){fn.apply(thisArg,arguments)}),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}var fn,thisArg}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn((function(){self._handled||Promise._unhandledRejectionFn(self._value)}));for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=\"function\"==typeof onFulfilled?onFulfilled:null,this.onRejected=\"function\"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn((function(value){done||(done=!0,resolve(self,value))}),(function(reason){done||(done=!0,reject(self,reason))}))}catch(ex){if(done)return;done=!0,reject(self,ex)}}Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.prototype.finally=function(callback){var constructor=this.constructor;return this.then((function(value){return constructor.resolve(callback()).then((function(){return value}))}),(function(reason){return constructor.resolve(callback()).then((function(){return constructor.reject(reason)}))}))},Promise.all=function(arr){return new Promise((function(resolve,reject){if(!isArray(arr))return reject(new TypeError(\"Promise.all accepts an array\"));var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(\"object\"==typeof val||\"function\"==typeof val)){var then=val.then;if(\"function\"==typeof then)return void then.call(val,(function(val){res(i,val)}),reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])}))},Promise.resolve=function(value){return value&&\"object\"==typeof value&&value.constructor===Promise?value:new Promise((function(resolve){resolve(value)}))},Promise.reject=function(value){return new Promise((function(resolve,reject){reject(value)}))},Promise.race=function(arr){return new Promise((function(resolve,reject){if(!isArray(arr))return reject(new TypeError(\"Promise.race accepts an array\"));for(var i=0,len=arr.length;i<len;i++)Promise.resolve(arr[i]).then(resolve,reject)}))},Promise._immediateFn=\"function\"==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){\"undefined\"!=typeof console&&console&&console.warn(\"Possible Unhandled Promise Rejection:\",err)},module.exports=Promise},{}],40:[function(_dereq_,module,exports){(function(global){\"use strict\";var UA=global.navigator&&global.navigator.userAgent,isAndroid=_dereq_(\"@braintree/browser-detection/is-android\"),isChromeOs=_dereq_(\"@braintree/browser-detection/is-chrome-os\"),isChrome=_dereq_(\"@braintree/browser-detection/is-chrome\"),isIos=_dereq_(\"@braintree/browser-detection/is-ios\"),isIE9=_dereq_(\"@braintree/browser-detection/is-ie9\"),KITKAT_WEBVIEW_REGEX=/Version\\/\\d\\.\\d* Chrome\\/\\d*\\.0\\.0\\.0/;module.exports={isIE9:isIE9,isAndroidChrome:function(uaArg){var ua=uaArg||UA;return(isAndroid(ua)||isChromeOs(ua))&&isChrome(ua)},isIos:isIos,isKitKatWebview:function(uaArg){var ua=uaArg||UA;return isAndroid(ua)&&KITKAT_WEBVIEW_REGEX.test(ua)},isSamsungBrowser:function(ua){return/SamsungBrowser/.test(ua=ua||UA)||function(ua){return!isChrome(ua)&&ua.indexOf(\"Samsung\")>-1}(ua)}}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"@braintree/browser-detection/is-android\":3,\"@braintree/browser-detection/is-chrome\":5,\"@braintree/browser-detection/is-chrome-os\":4,\"@braintree/browser-detection/is-ie9\":11,\"@braintree/browser-detection/is-ios\":16}],41:[function(_dereq_,module,exports){\"use strict\";var device=_dereq_(\"./lib/device\");module.exports=function(){return!device.isSamsungBrowser()}},{\"./lib/device\":40}],42:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\"),errors=_dereq_(\"./errors\"),assign=_dereq_(\"../lib/assign\").assign,Promise=_dereq_(\"../lib/promise\"),methods=_dereq_(\"../lib/methods\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");function AmericanExpress(options){this._client=options.client}AmericanExpress.prototype.getRewardsBalance=function(options){var data,nonce=options.nonce;return nonce?(delete(data=assign({_meta:{source:\"american-express\"},paymentMethodNonce:nonce},options)).nonce,this._client.request({method:\"get\",endpoint:\"payment_methods/amex_rewards_balance\",data:data}).catch((function(err){return Promise.reject(new BraintreeError({type:errors.AMEX_NETWORK_ERROR.type,code:errors.AMEX_NETWORK_ERROR.code,message:\"A network error occurred when getting the American Express rewards balance.\",details:{originalError:err}}))}))):Promise.reject(new BraintreeError({type:errors.AMEX_NONCE_REQUIRED.type,code:errors.AMEX_NONCE_REQUIRED.code,message:\"getRewardsBalance must be called with a nonce.\"}))},AmericanExpress.prototype.getExpressCheckoutProfile=function(options){return options.nonce?this._client.request({method:\"get\",endpoint:\"payment_methods/amex_express_checkout_cards/\"+options.nonce,data:{_meta:{source:\"american-express\"},paymentMethodNonce:options.nonce}}).catch((function(err){return Promise.reject(new BraintreeError({type:errors.AMEX_NETWORK_ERROR.type,code:errors.AMEX_NETWORK_ERROR.code,message:\"A network error occurred when getting the American Express Checkout nonce profile.\",details:{originalError:err}}))})):Promise.reject(new BraintreeError({type:errors.AMEX_NONCE_REQUIRED.type,code:errors.AMEX_NONCE_REQUIRED.code,message:\"getExpressCheckoutProfile must be called with a nonce.\"}))},AmericanExpress.prototype.teardown=function(){return convertMethodsToError(this,methods(AmericanExpress.prototype)),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(AmericanExpress)},{\"../lib/assign\":95,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/methods\":130,\"../lib/promise\":132,\"./errors\":43,\"@braintree/wrap-promise\":30}],43:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={AMEX_NONCE_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"AMEX_NONCE_REQUIRED\"},AMEX_NETWORK_ERROR:{type:BraintreeError.types.NETWORK,code:\"AMEX_NETWORK_ERROR\"}}},{\"../lib/braintree-error\":98}],44:[function(_dereq_,module,exports){\"use strict\";var AmericanExpress=_dereq_(\"./american-express\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){var name=\"American Express\";return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name})})).then((function(client){return options.client=client,new AmericanExpress(options)}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"./american-express\":42,\"@braintree/wrap-promise\":30}],45:[function(_dereq_,module,exports){(function(global){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\"),analytics=_dereq_(\"../lib/analytics\"),errors=_dereq_(\"./errors\"),Promise=_dereq_(\"../lib/promise\"),methods=_dereq_(\"../lib/methods\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");function ApplePay(options){this._instantiatedWithClient=Boolean(!options.useDeferredClient),this._client=options.client,this._createPromise=options.createPromise,this._client&&this._setMerchantIdentifier()}ApplePay.prototype._waitForClient=function(){return this._client?Promise.resolve():this._createPromise.then((function(client){this._client=client,this._setMerchantIdentifier()}).bind(this))},ApplePay.prototype._setMerchantIdentifier=function(){var applePayConfig=this._client.getConfiguration().gatewayConfiguration.applePayWeb;applePayConfig&&Object.defineProperty(this,\"merchantIdentifier\",{value:applePayConfig.merchantIdentifier,configurable:!1,writable:!1})},ApplePay.prototype.createPaymentRequest=function(paymentRequest){return this._instantiatedWithClient?this._createPaymentRequestSynchronously(paymentRequest):this._waitForClient().then((function(){return this._createPaymentRequestSynchronously(paymentRequest)}).bind(this))},ApplePay.prototype._createPaymentRequestSynchronously=function(paymentRequest){var applePay=this._client.getConfiguration().gatewayConfiguration.applePayWeb,defaults={countryCode:applePay.countryCode,currencyCode:applePay.currencyCode,merchantCapabilities:applePay.merchantCapabilities||[\"supports3DS\"],supportedNetworks:applePay.supportedNetworks.map((function(network){return\"mastercard\"===network?\"masterCard\":network}))};return Object.assign({},defaults,paymentRequest)},ApplePay.prototype.performValidation=function(options){var self=this;return options&&options.validationURL?this._waitForClient().then((function(){var applePayWebSession={validationUrl:options.validationURL,domainName:options.domainName||global.location.hostname,merchantIdentifier:options.merchantIdentifier||self.merchantIdentifier};return null!=options.displayName&&(applePayWebSession.displayName=options.displayName),self._client.request({method:\"post\",endpoint:\"apple_pay_web/sessions\",data:{_meta:{source:\"apple-pay\"},applePayWebSession:applePayWebSession}})})).then((function(response){return analytics.sendEvent(self._client,\"applepay.performValidation.succeeded\"),Promise.resolve(response)})).catch((function(err){return analytics.sendEvent(self._client,\"applepay.performValidation.failed\"),Promise.reject(new BraintreeError(\"CLIENT_REQUEST_ERROR\"===err.code?{type:errors.APPLE_PAY_MERCHANT_VALIDATION_FAILED.type,code:errors.APPLE_PAY_MERCHANT_VALIDATION_FAILED.code,message:errors.APPLE_PAY_MERCHANT_VALIDATION_FAILED.message,details:{originalError:err.details.originalError}}:{type:errors.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.type,code:errors.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.code,message:errors.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.message,details:{originalError:err}}))})):Promise.reject(new BraintreeError(errors.APPLE_PAY_VALIDATION_URL_REQUIRED))},ApplePay.prototype.tokenize=function(options){var self=this;return options.token?this._waitForClient().then((function(){return self._client.request({method:\"post\",endpoint:\"payment_methods/apple_payment_tokens\",data:{_meta:{source:\"apple-pay\"},applePaymentToken:Object.assign({},options.token,{paymentData:btoa(JSON.stringify(options.token.paymentData))})}})})).then((function(response){return analytics.sendEvent(self._client,\"applepay.tokenize.succeeded\"),Promise.resolve(response.applePayCards[0])})).catch((function(err){return analytics.sendEvent(self._client,\"applepay.tokenize.failed\"),Promise.reject(new BraintreeError({type:errors.APPLE_PAY_TOKENIZATION.type,code:errors.APPLE_PAY_TOKENIZATION.code,message:errors.APPLE_PAY_TOKENIZATION.message,details:{originalError:err}}))})):Promise.reject(new BraintreeError(errors.APPLE_PAY_PAYMENT_TOKEN_REQUIRED))},ApplePay.prototype.teardown=function(){return convertMethodsToError(this,methods(ApplePay.prototype)),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(ApplePay)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../lib/analytics\":93,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/methods\":130,\"../lib/promise\":132,\"./errors\":46,\"@braintree/wrap-promise\":30}],46:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={APPLE_PAY_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"APPLE_PAY_NOT_ENABLED\",message:\"Apple Pay is not enabled for this merchant.\"},APPLE_PAY_VALIDATION_URL_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"APPLE_PAY_VALIDATION_URL_REQUIRED\",message:\"performValidation must be called with a validationURL.\"},APPLE_PAY_MERCHANT_VALIDATION_NETWORK:{type:BraintreeError.types.NETWORK,code:\"APPLE_PAY_MERCHANT_VALIDATION_NETWORK\",message:\"A network error occurred when validating the Apple Pay merchant.\"},APPLE_PAY_MERCHANT_VALIDATION_FAILED:{type:BraintreeError.types.MERCHANT,code:\"APPLE_PAY_MERCHANT_VALIDATION_FAILED\",message:\"Make sure you have registered your domain name in the Braintree Control Panel.\"},APPLE_PAY_PAYMENT_TOKEN_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"APPLE_PAY_PAYMENT_TOKEN_REQUIRED\",message:\"tokenize must be called with a payment token.\"},APPLE_PAY_TOKENIZATION:{type:BraintreeError.types.NETWORK,code:\"APPLE_PAY_TOKENIZATION\",message:\"A network error occurred when processing the Apple Pay payment.\"}}},{\"../lib/braintree-error\":98}],47:[function(_dereq_,module,exports){\"use strict\";var ApplePay=_dereq_(\"./apple-pay\"),analytics=_dereq_(\"../lib/analytics\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),Promise=_dereq_(\"../lib/promise\"),errors=_dereq_(\"./errors\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"Apple Pay\",client:options.client,authorization:options.authorization}).then((function(){var applePayInstance,createPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"Apple Pay\"}).then((function(client){return client.getConfiguration().gatewayConfiguration.applePayWeb?(analytics.sendEvent(client,\"applepay.initialized\"),client):Promise.reject(new BraintreeError(errors.APPLE_PAY_NOT_ENABLED))}));return options.createPromise=createPromise,applePayInstance=new ApplePay(options),options.useDeferredClient?applePayInstance:createPromise.then((function(client){return applePayInstance._client=client,applePayInstance}))}))})),VERSION:\"3.60.0\"}},{\"../lib/analytics\":93,\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./apple-pay\":45,\"./errors\":46,\"@braintree/wrap-promise\":30}],48:[function(_dereq_,module,exports){\"use strict\";var isIe=_dereq_(\"@braintree/browser-detection/is-ie\"),isIe9=_dereq_(\"@braintree/browser-detection/is-ie9\");module.exports={isIe:isIe,isIe9:isIe9}},{\"@braintree/browser-detection/is-ie\":8,\"@braintree/browser-detection/is-ie9\":11}],49:[function(_dereq_,module,exports){\"use strict\";var BRAINTREE_VERSION=_dereq_(\"./constants\").BRAINTREE_VERSION,GraphQL=_dereq_(\"./request/graphql\"),request=_dereq_(\"./request\"),isVerifiedDomain=_dereq_(\"../lib/is-verified-domain\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),convertToBraintreeError=_dereq_(\"../lib/convert-to-braintree-error\"),getGatewayConfiguration=_dereq_(\"./get-configuration\").getConfiguration,createAuthorizationData=_dereq_(\"../lib/create-authorization-data\"),addMetadata=_dereq_(\"../lib/add-metadata\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),once=_dereq_(\"../lib/once\"),deferred=_dereq_(\"../lib/deferred\"),assign=_dereq_(\"../lib/assign\").assign,analytics=_dereq_(\"../lib/analytics\"),errors=_dereq_(\"./errors\"),VERSION=_dereq_(\"../lib/constants\").VERSION,GRAPHQL_URLS=_dereq_(\"../lib/constants\").GRAPHQL_URLS,methods=_dereq_(\"../lib/methods\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),assets=_dereq_(\"../lib/assets\"),FRAUDNET_FNCLS=_dereq_(\"../lib/constants\").FRAUDNET_FNCLS,FRAUDNET_SOURCE=_dereq_(\"../lib/constants\").FRAUDNET_SOURCE,FRAUDNET_URL=_dereq_(\"../lib/constants\").FRAUDNET_URL,cachedClients={};function Client(configuration){var configurationJSON,gatewayConfiguration;if(configuration=configuration||{},configurationJSON=JSON.stringify(configuration),!(gatewayConfiguration=configuration.gatewayConfiguration))throw new BraintreeError(errors.CLIENT_MISSING_GATEWAY_CONFIGURATION);[\"assetsUrl\",\"clientApiUrl\",\"configUrl\"].forEach((function(property){if(property in gatewayConfiguration&&!isVerifiedDomain(gatewayConfiguration[property]))throw new BraintreeError({type:errors.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:errors.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:property+\" property is on an invalid domain.\"})})),this.getConfiguration=function(){return JSON.parse(configurationJSON)},this._request=request,this._configuration=this.getConfiguration(),this._clientApiBaseUrl=gatewayConfiguration.clientApiUrl+\"/v1/\",gatewayConfiguration.graphQL&&(this._graphQL=new GraphQL({graphQL:gatewayConfiguration.graphQL}))}Client.initialize=function(options){var clientInstance,authData,promise=cachedClients[options.authorization];if(promise)return analytics.sendEvent(promise,\"custom.client.load.cached\"),promise;try{authData=createAuthorizationData(options.authorization)}catch(err){return Promise.reject(new BraintreeError(errors.CLIENT_INVALID_AUTHORIZATION))}return promise=getGatewayConfiguration(authData).then((function(configuration){return options.debug&&(configuration.isDebug=!0),configuration.authorization=options.authorization,clientInstance=new Client(configuration)})),cachedClients[options.authorization]=promise,analytics.sendEvent(promise,\"custom.client.load.initialized\"),promise.then((function(client){return analytics.sendEvent(clientInstance,\"custom.client.load.succeeded\"),client})).catch((function(err){return delete cachedClients[options.authorization],Promise.reject(err)}))},Client.clearCache=function(){cachedClients={}},Client.prototype._findOrCreateFraudnetJSON=function(clientMetadataId){var config,additionalData,authorizationFingerprint,parameters,el=document.querySelector('script[fncls=\"'+FRAUDNET_FNCLS+'\"]');el||((el=document.body.appendChild(document.createElement(\"script\"))).type=\"application/json\",el.setAttribute(\"fncls\",FRAUDNET_FNCLS)),config=this.getConfiguration(),additionalData={rda_tenant:\"bt_card\",mid:config.gatewayConfiguration.merchantId},(authorizationFingerprint=config.authorizationFingerprint)&&authorizationFingerprint.split(\"&\").forEach((function(pieces){var component=pieces.split(\"=\");\"customer_id\"===component[0]&&component.length>1&&(additionalData.cid=component[1])})),parameters={f:clientMetadataId.substr(0,32),fp:additionalData,bu:!1,s:FRAUDNET_SOURCE},el.text=JSON.stringify(parameters)},Client.prototype.request=function(options,callback){var self=this,requestPromise=new Promise((function(resolve,reject){var optionName,api,baseUrl,requestOptions,configuration,shouldCollectData=Boolean(\"payment_methods/credit_cards\"===options.endpoint&&self.getConfiguration().gatewayConfiguration.creditCards.collectDeviceData);if(\"graphQLApi\"!==options.api&&(options.method?options.endpoint||(optionName=\"options.endpoint\"):optionName=\"options.method\"),optionName)throw new BraintreeError({type:errors.CLIENT_OPTION_REQUIRED.type,code:errors.CLIENT_OPTION_REQUIRED.code,message:optionName+\" is required when making a request.\"});if(requestOptions={method:options.method,graphQL:self._graphQL,timeout:options.timeout,metadata:self._configuration.analyticsMetadata},\"clientApi\"===(api=\"api\"in options?options.api:\"clientApi\"))baseUrl=self._clientApiBaseUrl,requestOptions.data=addMetadata(self._configuration,options.data);else{if(\"graphQLApi\"!==api)throw new BraintreeError({type:errors.CLIENT_OPTION_INVALID.type,code:errors.CLIENT_OPTION_INVALID.code,message:\"options.api is invalid.\"});baseUrl=GRAPHQL_URLS[self._configuration.gatewayConfiguration.environment],options.endpoint=\"\",requestOptions.method=\"post\",requestOptions.data=assign({clientSdkMetadata:{source:self._configuration.analyticsMetadata.source,integration:self._configuration.analyticsMetadata.integration,sessionId:self._configuration.analyticsMetadata.sessionId}},options.data),requestOptions.headers={Authorization:\"Bearer \"+((configuration=self._configuration).authorizationFingerprint||configuration.authorization),\"Braintree-Version\":BRAINTREE_VERSION}}requestOptions.url=baseUrl+options.endpoint,requestOptions.sendAnalyticsEvent=function(kind){analytics.sendEvent(self,kind)},self._request(requestOptions,(function(err,data,status){var resolvedData,requestError;(requestError=function(status,err){var requestError;if(-1===status?requestError=new BraintreeError(errors.CLIENT_REQUEST_TIMEOUT):403===status?requestError=new BraintreeError(errors.CLIENT_AUTHORIZATION_INSUFFICIENT):429===status?requestError=new BraintreeError(errors.CLIENT_RATE_LIMITED):status>=500?requestError=new BraintreeError(errors.CLIENT_GATEWAY_NETWORK):(status<200||status>=400)&&(requestError=convertToBraintreeError(err,{type:errors.CLIENT_REQUEST_ERROR.type,code:errors.CLIENT_REQUEST_ERROR.code,message:errors.CLIENT_REQUEST_ERROR.message})),requestError)return requestError.details=requestError.details||{},requestError.details.httpStatus=status,requestError}(status,err))?reject(requestError):\"graphQLApi\"===api&&data.errors?reject(convertToBraintreeError(data.errors,{type:errors.CLIENT_GRAPHQL_REQUEST_ERROR.type,code:errors.CLIENT_GRAPHQL_REQUEST_ERROR.code,message:errors.CLIENT_GRAPHQL_REQUEST_ERROR.message})):(resolvedData=assign({_httpStatus:status},data),shouldCollectData&&resolvedData.creditCards&&resolvedData.creditCards.length>0&&(self._findOrCreateFraudnetJSON(resolvedData.creditCards[0].nonce),assets.loadScript({src:FRAUDNET_URL,forceScriptReload:!0})),resolve(resolvedData))}))}));return\"function\"==typeof callback?(callback=once(deferred(callback)),void requestPromise.then((function(response){callback(null,response,response._httpStatus)})).catch((function(err){callback(err,null,err&&err.details&&err.details.httpStatus)}))):requestPromise},Client.prototype.toJSON=function(){return this.getConfiguration()},Client.prototype.getVersion=function(){return VERSION},Client.prototype.teardown=wrapPromise((function(){return delete cachedClients[this.getConfiguration().authorization],convertMethodsToError(this,methods(Client.prototype)),Promise.resolve()})),module.exports=Client},{\"../lib/add-metadata\":92,\"../lib/analytics\":93,\"../lib/assets\":94,\"../lib/assign\":95,\"../lib/braintree-error\":98,\"../lib/constants\":103,\"../lib/convert-methods-to-error\":104,\"../lib/convert-to-braintree-error\":105,\"../lib/create-authorization-data\":107,\"../lib/deferred\":109,\"../lib/is-verified-domain\":128,\"../lib/methods\":130,\"../lib/once\":131,\"../lib/promise\":132,\"./constants\":50,\"./errors\":51,\"./get-configuration\":52,\"./request\":64,\"./request/graphql\":62,\"@braintree/wrap-promise\":30}],50:[function(_dereq_,module,exports){\"use strict\";module.exports={BRAINTREE_VERSION:\"2018-05-10\"}},{}],51:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN:{type:BraintreeError.types.MERCHANT,code:\"CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN\"},CLIENT_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"CLIENT_OPTION_REQUIRED\"},CLIENT_OPTION_INVALID:{type:BraintreeError.types.MERCHANT,code:\"CLIENT_OPTION_INVALID\"},CLIENT_MISSING_GATEWAY_CONFIGURATION:{type:BraintreeError.types.INTERNAL,code:\"CLIENT_MISSING_GATEWAY_CONFIGURATION\",message:\"Missing gatewayConfiguration.\"},CLIENT_INVALID_AUTHORIZATION:{type:BraintreeError.types.MERCHANT,code:\"CLIENT_INVALID_AUTHORIZATION\",message:\"Authorization is invalid. Make sure your client token or tokenization key is valid.\"},CLIENT_GATEWAY_NETWORK:{type:BraintreeError.types.NETWORK,code:\"CLIENT_GATEWAY_NETWORK\",message:\"Cannot contact the gateway at this time.\"},CLIENT_REQUEST_TIMEOUT:{type:BraintreeError.types.NETWORK,code:\"CLIENT_REQUEST_TIMEOUT\",message:\"Request timed out waiting for a reply.\"},CLIENT_REQUEST_ERROR:{type:BraintreeError.types.NETWORK,code:\"CLIENT_REQUEST_ERROR\",message:\"There was a problem with your request.\"},CLIENT_GRAPHQL_REQUEST_ERROR:{type:BraintreeError.types.NETWORK,code:\"CLIENT_GRAPHQL_REQUEST_ERROR\",message:\"There was a problem with your request.\"},CLIENT_RATE_LIMITED:{type:BraintreeError.types.MERCHANT,code:\"CLIENT_RATE_LIMITED\",message:\"You are being rate-limited; please try again in a few minutes.\"},CLIENT_AUTHORIZATION_INSUFFICIENT:{type:BraintreeError.types.MERCHANT,code:\"CLIENT_AUTHORIZATION_INSUFFICIENT\",message:\"The authorization used has insufficient privileges.\"}}},{\"../lib/braintree-error\":98}],52:[function(_dereq_,module,exports){(function(global){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),request=_dereq_(\"./request\"),uuid=_dereq_(\"../lib/vendor/uuid\"),constants=_dereq_(\"../lib/constants\"),errors=_dereq_(\"./errors\"),GraphQL=_dereq_(\"./request/graphql\"),GRAPHQL_URLS=_dereq_(\"../lib/constants\").GRAPHQL_URLS,isDateStringBeforeOrOn=_dereq_(\"../lib/is-date-string-before-or-on\"),BRAINTREE_VERSION=_dereq_(\"./constants\").BRAINTREE_VERSION;module.exports={getConfiguration:wrapPromise((function(authData){return new Promise((function(resolve,reject){var attrs,configUrl,reqOptions,sessionId=uuid(),analyticsMetadata={merchantAppId:global.location.host,platform:constants.PLATFORM,sdkVersion:constants.VERSION,source:constants.SOURCE,integration:constants.INTEGRATION,integrationType:constants.INTEGRATION,sessionId:sessionId};configUrl=authData.configUrl,(attrs=authData.attrs)._meta=analyticsMetadata,attrs.braintreeLibraryVersion=constants.BRAINTREE_LIBRARY_VERSION,attrs.configVersion=\"3\",reqOptions={url:configUrl,method:\"GET\",data:attrs},attrs.authorizationFingerprint&&authData.graphQL?(isDateStringBeforeOrOn(authData.graphQL.date,BRAINTREE_VERSION)&&(reqOptions.graphQL=new GraphQL({graphQL:{url:authData.graphQL.url,features:[\"configuration\"]}})),reqOptions.metadata=analyticsMetadata):attrs.tokenizationKey&&(reqOptions.graphQL=new GraphQL({graphQL:{url:GRAPHQL_URLS[authData.environment],features:[\"configuration\"]}}),reqOptions.metadata=analyticsMetadata),request(reqOptions,(function(err,response,status){var errorTemplate;err?reject(new BraintreeError({type:(errorTemplate=403===status?errors.CLIENT_AUTHORIZATION_INSUFFICIENT:errors.CLIENT_GATEWAY_NETWORK).type,code:errorTemplate.code,message:errorTemplate.message,details:{originalError:err}})):resolve({authorizationType:attrs.tokenizationKey?\"TOKENIZATION_KEY\":\"CLIENT_TOKEN\",authorizationFingerprint:attrs.authorizationFingerprint,analyticsMetadata:analyticsMetadata,gatewayConfiguration:response})}))}))}))}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../lib/braintree-error\":98,\"../lib/constants\":103,\"../lib/is-date-string-before-or-on\":126,\"../lib/promise\":132,\"../lib/vendor/uuid\":136,\"./constants\":50,\"./errors\":51,\"./request\":64,\"./request/graphql\":62,\"@braintree/wrap-promise\":30}],53:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\"),Client=_dereq_(\"./client\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),sharedErrors=_dereq_(\"../lib/errors\");module.exports={create:wrapPromise((function(options){return options.authorization?Client.initialize(options):Promise.reject(new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:\"options.authorization is required when instantiating a client.\"}))})),VERSION:\"3.60.0\"}},{\"../lib/braintree-error\":98,\"../lib/errors\":112,\"../lib/promise\":132,\"./client\":49,\"@braintree/wrap-promise\":30}],54:[function(_dereq_,module,exports){\"use strict\";var querystring=_dereq_(\"../../lib/querystring\"),assign=_dereq_(\"../../lib/assign\").assign,prepBody=_dereq_(\"./prep-body\"),parseBody=_dereq_(\"./parse-body\"),xhr=_dereq_(\"./xhr\"),isXHRAvailable=xhr.isAvailable,GraphQLRequest=_dereq_(\"./graphql/request\"),DefaultRequest=_dereq_(\"./default-request\");module.exports={request:function(options,cb){!function _requestWithRetry(options,tcpRetryCount,cb){var status,resBody,ajaxRequest,body,method,headers,parsedBody,url=options.url,graphQL=options.graphQL,timeout=options.timeout,req=xhr.getRequestObject(),callback=cb,isGraphQLRequest=Boolean(graphQL&&graphQL.isGraphQLRequest(url,options.data));options.headers=assign({\"Content-Type\":\"application/json\"},options.headers),url=(ajaxRequest=isGraphQLRequest?new GraphQLRequest(options):new DefaultRequest(options)).getUrl(),body=ajaxRequest.getBody(),method=ajaxRequest.getMethod(),headers=ajaxRequest.getHeaders(),\"GET\"===method&&(url=querystring.queryify(url,body),body=null),isXHRAvailable?req.onreadystatechange=function(){if(4===req.readyState){if(0===req.status&&isGraphQLRequest)return delete options.graphQL,void _requestWithRetry(options,tcpRetryCount,cb);if(parsedBody=parseBody(req.responseText),resBody=ajaxRequest.adaptResponseBody(parsedBody),(status=ajaxRequest.determineStatus(req.status,parsedBody))>=400||status<200){if(isGraphQLRequest&&function(body){var errorClass=!body.data&&body.errors&&body.errors[0]&&body.errors[0].extensions&&body.errors[0].extensions.errorClass;return\"UNKNOWN\"===errorClass||\"INTERNAL\"===errorClass}(parsedBody))return delete options.graphQL,void _requestWithRetry(options,tcpRetryCount,cb);if(tcpRetryCount<1&&function(status){return!status||408===status}(status))return tcpRetryCount++,void _requestWithRetry(options,tcpRetryCount,cb);callback(resBody||\"error\",null,status||500)}else callback(null,resBody,status)}}:(options.headers&&(url=querystring.queryify(url,headers)),req.onload=function(){callback(null,parseBody(req.responseText),req.status)},req.onerror=function(){callback(\"error\",null,500)},req.onprogress=function(){},req.ontimeout=function(){callback(\"timeout\",null,-1)});try{req.open(method,url,!0)}catch(requestOpenError){if(!isGraphQLRequest)throw requestOpenError;return delete options.graphQL,void _requestWithRetry(options,tcpRetryCount,cb)}req.timeout=timeout,isXHRAvailable&&Object.keys(headers).forEach((function(headerKey){req.setRequestHeader(headerKey,headers[headerKey])}));try{req.send(prepBody(method,body))}catch(e){}}(options,0,cb)}}},{\"../../lib/assign\":95,\"../../lib/querystring\":133,\"./default-request\":55,\"./graphql/request\":63,\"./parse-body\":67,\"./prep-body\":68,\"./xhr\":69}],55:[function(_dereq_,module,exports){\"use strict\";function DefaultRequest(options){this._url=options.url,this._data=options.data,this._method=options.method,this._headers=options.headers}DefaultRequest.prototype.getUrl=function(){return this._url},DefaultRequest.prototype.getBody=function(){return this._data},DefaultRequest.prototype.getMethod=function(){return this._method},DefaultRequest.prototype.getHeaders=function(){return this._headers},DefaultRequest.prototype.adaptResponseBody=function(parsedBody){return parsedBody},DefaultRequest.prototype.determineStatus=function(status){return status},module.exports=DefaultRequest},{}],56:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(){return global.navigator.userAgent}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],57:[function(_dereq_,module,exports){\"use strict\";var errorResponseAdapter=_dereq_(\"./error\"),assign=_dereq_(\"../../../../lib/assign\").assign,cardTypeTransforms_creditCard={AMERICAN_EXPRESS:\"American Express\",DISCOVER:\"Discover\",INTERNATIONAL_MAESTRO:\"Maestro\",JCB:\"JCB\",MASTERCARD:\"MasterCard\",SOLO:\"Solo\",UK_MAESTRO:\"UK Maestro\",UNION_PAY:\"UnionPay\",VISA:\"Visa\"},cardTypeTransforms_applePayWeb={VISA:\"visa\",MASTERCARD:\"mastercard\",DISCOVER:\"discover\",AMERICAN_EXPRESS:\"amex\"},cardTypeTransforms_visaCheckout={VISA:\"Visa\",MASTERCARD:\"MasterCard\",DISCOVER:\"Discover\",AMERICAN_EXPRESS:\"American Express\"},cardTypeTransforms_googlePay={VISA:\"visa\",MASTERCARD:\"mastercard\",DISCOVER:\"discover\",AMERICAN_EXPRESS:\"amex\"},cardTypeTransforms_masterpass={VISA:\"visa\",MASTERCARD:\"master\",DISCOVER:\"discover\",AMERICAN_EXPRESS:\"amex\",DINERS:\"diners\",INTERNATIONAL_MAESTRO:\"maestro\",JCB:\"jcb\"};function mapCardTypes(cardTypes,cardTypeTransformMap){return cardTypes.reduce((function(acc,type){return cardTypeTransformMap.hasOwnProperty(type)?acc.concat(cardTypeTransformMap[type]):acc}),[])}module.exports=function(responseBody,ctx){return responseBody.data&&!responseBody.errors?function(body,ctx){var response,configuration=body.data.clientConfiguration;return response={environment:configuration.environment.toLowerCase(),clientApiUrl:configuration.clientApiUrl,assetsUrl:configuration.assetsUrl,analytics:{url:configuration.analyticsUrl},merchantId:configuration.merchantId,venmo:\"off\"},configuration.supportedFeatures&&(response.graphQL={url:ctx._graphQL._config.url,features:configuration.supportedFeatures.map((function(feature){return feature.toLowerCase()}))}),configuration.braintreeApi&&(response.braintreeApi=configuration.braintreeApi),configuration.applePayWeb&&(response.applePayWeb=configuration.applePayWeb,response.applePayWeb.supportedNetworks=mapCardTypes(configuration.applePayWeb.supportedCardBrands,cardTypeTransforms_applePayWeb),delete response.applePayWeb.supportedCardBrands),configuration.ideal&&(response.ideal=configuration.ideal),configuration.kount&&(response.kount={kountMerchantId:configuration.kount.merchantId}),configuration.creditCard?(response.challenges=configuration.creditCard.challenges.map((function(challenge){return challenge.toLowerCase()})),response.creditCards={supportedCardTypes:mapCardTypes(configuration.creditCard.supportedCardBrands,cardTypeTransforms_creditCard)},response.threeDSecureEnabled=configuration.creditCard.threeDSecureEnabled,response.threeDSecure=configuration.creditCard.threeDSecure):(response.challenges=[],response.creditCards={supportedCardTypes:[]},response.threeDSecureEnabled=!1),configuration.googlePay&&(response.androidPay={displayName:configuration.googlePay.displayName,enabled:!0,environment:configuration.googlePay.environment.toLowerCase(),googleAuthorizationFingerprint:configuration.googlePay.googleAuthorization,supportedNetworks:mapCardTypes(configuration.googlePay.supportedCardBrands,cardTypeTransforms_googlePay)}),configuration.venmo&&(response.payWithVenmo={merchantId:configuration.venmo.merchantId,accessToken:configuration.venmo.accessToken,environment:configuration.venmo.environment.toLowerCase()}),configuration.paypal?(response.paypalEnabled=!0,response.paypal=assign({},configuration.paypal),response.paypal.currencyIsoCode=response.paypal.currencyCode,response.paypal.environment=response.paypal.environment.toLowerCase(),delete response.paypal.currencyCode):response.paypalEnabled=!1,configuration.unionPay&&(response.unionPay={enabled:!0,merchantAccountId:configuration.unionPay.merchantAccountId}),configuration.visaCheckout&&(response.visaCheckout={apikey:configuration.visaCheckout.apiKey,externalClientId:configuration.visaCheckout.externalClientId,supportedCardTypes:mapCardTypes(configuration.visaCheckout.supportedCardBrands,cardTypeTransforms_visaCheckout)}),configuration.masterpass&&(response.masterpass={merchantCheckoutId:configuration.masterpass.merchantCheckoutId,supportedNetworks:mapCardTypes(configuration.masterpass.supportedCardBrands,cardTypeTransforms_masterpass)}),configuration.usBankAccount&&(response.usBankAccount={routeId:configuration.usBankAccount.routeId,plaid:{publicKey:configuration.usBankAccount.plaidPublicKey}}),response}(responseBody,ctx):errorResponseAdapter(responseBody)}},{\"../../../../lib/assign\":95,\"./error\":59}],58:[function(_dereq_,module,exports){\"use strict\";var errorResponseAdapter=_dereq_(\"./error\"),CARD_BRAND_MAP={AMERICAN_EXPRESS:\"American Express\",DINERS:\"Discover\",DISCOVER:\"Discover\",INTERNATIONAL_MAESTRO:\"Maestro\",JCB:\"JCB\",MASTERCARD:\"MasterCard\",UK_MAESTRO:\"Maestro\",UNION_PAY:\"Union Pay\",VISA:\"Visa\"},BIN_DATA_MAP={YES:\"Yes\",NO:\"No\",UNKNOWN:\"Unknown\"},AUTHENTICATION_INSIGHT_MAP={PSDTWO:\"psd2\"};module.exports=function(responseBody){return responseBody.data&&!responseBody.errors?(lastTwo=(creditCard=(data=responseBody.data.tokenizeCreditCard).creditCard).last4?creditCard.last4.substr(2,4):\"\",(binData=creditCard.binData)&&([\"commercial\",\"debit\",\"durbinRegulated\",\"healthcare\",\"payroll\",\"prepaid\"].forEach((function(key){binData[key]=binData[key]?BIN_DATA_MAP[binData[key]]:\"Unknown\"})),[\"issuingBank\",\"countryOfIssuance\",\"productId\"].forEach((function(key){binData[key]||(binData[key]=\"Unknown\")}))),response={creditCards:[{binData:binData,consumed:!1,description:lastTwo?\"ending in \"+lastTwo:\"\",nonce:data.token,details:{expirationMonth:creditCard.expirationMonth,expirationYear:creditCard.expirationYear,bin:creditCard.bin||\"\",cardType:CARD_BRAND_MAP[creditCard.brandCode]||\"Unknown\",lastFour:creditCard.last4||\"\",lastTwo:lastTwo},type:\"CreditCard\",threeDSecureInfo:null}]},data.authenticationInsight&&(response.creditCards[0].authenticationInsight={regulationEnvironment:AUTHENTICATION_INSIGHT_MAP[regulationEnvironment=data.authenticationInsight.customerAuthenticationRegulationEnvironment]||regulationEnvironment.toLowerCase()}),response):errorResponseAdapter(responseBody);var response,regulationEnvironment,data,creditCard,lastTwo,binData}},{\"./error\":59}],59:[function(_dereq_,module,exports){\"use strict\";module.exports=function(responseBody){var errorClass=responseBody.errors&&responseBody.errors[0]&&responseBody.errors[0].extensions&&responseBody.errors[0].extensions.errorClass;return\"VALIDATION\"===errorClass?function(responseBody){var errors,field,fieldErrors=function(errors){var fieldErrors=[];return errors.forEach((function(error){error.extensions&&error.extensions.inputPath&&function addFieldError(inputPath,errorDetail,fieldErrors){var fieldError,legacyCode=errorDetail.extensions.legacyCode,inputField=inputPath[0];1!==inputPath.length?(fieldErrors.forEach((function(candidate){candidate.field===inputField&&(fieldError=candidate)})),fieldError||fieldErrors.push(fieldError={field:inputField,fieldErrors:[]}),addFieldError(inputPath.slice(1),errorDetail,fieldError.fieldErrors)):fieldErrors.push({code:legacyCode,field:inputField,message:errorDetail.message})}(error.extensions.inputPath.slice(1),error,fieldErrors)})),fieldErrors}(responseBody.errors);return 0===fieldErrors.length?{error:{message:responseBody.errors[0].message}}:{error:{message:(errors=fieldErrors,field=errors[0].field,{creditCard:\"Credit card is invalid\"}[field])},fieldErrors:fieldErrors}}(responseBody):errorClass?function(responseBody){return{error:{message:responseBody.errors[0].message},fieldErrors:[]}}(responseBody):{error:{message:\"There was a problem serving your request\"},fieldErrors:[]}}},{}],60:[function(_dereq_,module,exports){\"use strict\";module.exports=function(){return{query:\"query ClientConfiguration {   clientConfiguration {     analyticsUrl     environment     merchantId     assetsUrl     clientApiUrl     creditCard {       supportedCardBrands       challenges       threeDSecureEnabled       threeDSecure {         cardinalAuthenticationJWT       }     }     applePayWeb {       countryCode       currencyCode       merchantIdentifier       supportedCardBrands     }     googlePay {       displayName       supportedCardBrands       environment       googleAuthorization     }     ideal {       routeId       assetsUrl     }     kount {       merchantId     }     masterpass {       merchantCheckoutId       supportedCardBrands     }     paypal {       displayName       clientId       privacyUrl       userAgreementUrl       assetsUrl       environment       environmentNoNetwork       unvettedMerchant       braintreeClientId       billingAgreementsEnabled       merchantAccountId       currencyCode       payeeEmail     }     unionPay {       merchantAccountId     }     usBankAccount {       routeId       plaidPublicKey     }     venmo {       merchantId       accessToken       environment     }     visaCheckout {       apiKey       externalClientId       supportedCardBrands     }     braintreeApi {       accessToken       url     }     supportedFeatures   } }\",operationName:\"ClientConfiguration\"}}},{}],61:[function(_dereq_,module,exports){\"use strict\";var assign=_dereq_(\"../../../../lib/assign\").assign;function createCreditCardTokenizationBody(body,options){var cc=body.creditCard,billingAddress=cc&&cc.billingAddress,expDate=cc&&cc.expirationDate,expirationMonth=cc&&(cc.expirationMonth||expDate&&expDate.split(\"/\")[0].trim()),expirationYear=cc&&(cc.expirationYear||expDate&&expDate.split(\"/\")[1].trim()),variables={input:{creditCard:{number:cc&&cc.number,expirationMonth:expirationMonth,expirationYear:expirationYear,cvv:cc&&cc.cvv,cardholderName:cc&&cc.cardholderName},options:{}}};return options.hasAuthenticationInsight&&(variables.authenticationInsightInput={merchantAccountId:body.merchantAccountId}),billingAddress&&(variables.input.creditCard.billingAddress=billingAddress),variables.input=function(body,input){var validate;return body.creditCard&&body.creditCard.options&&\"boolean\"==typeof body.creditCard.options.validate?validate=body.creditCard.options.validate:body.authorizationFingerprint&&body.tokenizationKey||body.authorizationFingerprint?validate=!0:body.tokenizationKey&&(validate=!1),\"boolean\"==typeof validate&&(input.options=assign({validate:validate},input.options)),input}(body,variables.input),variables}module.exports=function(body){var config,hasAuthenticationInsight,mutation,options={hasAuthenticationInsight:Boolean(body.authenticationInsight&&body.merchantAccountId)};return{query:(config=options,hasAuthenticationInsight=config.hasAuthenticationInsight,mutation=\"mutation TokenizeCreditCard($input: TokenizeCreditCardInput!\",hasAuthenticationInsight&&(mutation+=\", $authenticationInsightInput: AuthenticationInsightInput!\"),mutation+=\") {   tokenizeCreditCard(input: $input) {     token     creditCard {       bin       brandCode       last4       expirationMonth      expirationYear      binData {         prepaid         healthcare         debit         durbinRegulated         commercial         payroll         issuingBank         countryOfIssuance         productId       }     } \",hasAuthenticationInsight&&(mutation+=\"    authenticationInsight(input: $authenticationInsightInput) {      customerAuthenticationRegulationEnvironment    }\"),mutation+=\"  } }\"),variables:createCreditCardTokenizationBody(body,options),operationName:\"TokenizeCreditCard\"}}},{\"../../../../lib/assign\":95}],62:[function(_dereq_,module,exports){\"use strict\";var browserDetection=_dereq_(\"../../browser-detection\"),features={tokenize_credit_cards:\"payment_methods/credit_cards\",configuration:\"configuration\"},disallowedInputPaths=[\"creditCard.options.unionPayEnrollment\"];function GraphQL(config){this._config=config.graphQL}GraphQL.prototype.getGraphQLEndpoint=function(){return this._config.url},GraphQL.prototype.isGraphQLRequest=function(url,body){var featureEnabled,path=this.getClientApiPath(url);return!(!this._isGraphQLEnabled()||!path||browserDetection.isIe9())&&(featureEnabled=this._config.features.some((function(feature){return features[feature]===path})),!function(body){return disallowedInputPaths.some((function(keys){return void 0!==keys.split(\".\").reduce((function(accumulator,key){return accumulator&&accumulator[key]}),body)}))}(body)&&featureEnabled)},GraphQL.prototype.getClientApiPath=function(url){var path,pathParts=url.split(\"/client_api/v1/\");return pathParts.length>1&&(path=pathParts[1].split(\"?\")[0]),path},GraphQL.prototype._isGraphQLEnabled=function(){return Boolean(this._config)},module.exports=GraphQL},{\"../../browser-detection\":48}],63:[function(_dereq_,module,exports){\"use strict\";var BRAINTREE_VERSION=_dereq_(\"../../constants\").BRAINTREE_VERSION,assign=_dereq_(\"../../../lib/assign\").assign,creditCardTokenizationBodyGenerator=_dereq_(\"./generators/credit-card-tokenization\"),creditCardTokenizationResponseAdapter=_dereq_(\"./adapters/credit-card-tokenization\"),configurationBodyGenerator=_dereq_(\"./generators/configuration\"),configurationResponseAdapter=_dereq_(\"./adapters/configuration\"),generators={\"payment_methods/credit_cards\":creditCardTokenizationBodyGenerator,configuration:configurationBodyGenerator},adapters={\"payment_methods/credit_cards\":creditCardTokenizationResponseAdapter,configuration:configurationResponseAdapter};function GraphQLRequest(options){var clientApiPath=options.graphQL.getClientApiPath(options.url);this._graphQL=options.graphQL,this._data=options.data,this._method=options.method,this._headers=options.headers,this._clientSdkMetadata={source:options.metadata.source,integration:options.metadata.integration,sessionId:options.metadata.sessionId},this._sendAnalyticsEvent=options.sendAnalyticsEvent||Function.prototype,this._generator=generators[clientApiPath],this._adapter=adapters[clientApiPath],this._sendAnalyticsEvent(\"graphql.init\")}GraphQLRequest.prototype.getUrl=function(){return this._graphQL.getGraphQLEndpoint()},GraphQLRequest.prototype.getBody=function(){var formattedBody=function formatBodyKeys(originalBody){var body={};return Object.keys(originalBody).forEach((function(key){var snakeString,camelCaseKey=-1===(snakeString=key).indexOf(\"_\")?snakeString:snakeString.toLowerCase().replace(/(\\_\\w)/g,(function(match){return match[1].toUpperCase()}));body[camelCaseKey]=\"object\"==typeof originalBody[key]?formatBodyKeys(originalBody[key]):\"number\"==typeof originalBody[key]?String(originalBody[key]):originalBody[key]})),body}(this._data),generatedBody=this._generator(formattedBody),body=assign({clientSdkMetadata:this._clientSdkMetadata},generatedBody);return JSON.stringify(body)},GraphQLRequest.prototype.getMethod=function(){return\"POST\"},GraphQLRequest.prototype.getHeaders=function(){var authorization;return this._data.authorizationFingerprint?(this._sendAnalyticsEvent(\"graphql.authorization-fingerprint\"),authorization=this._data.authorizationFingerprint):(this._sendAnalyticsEvent(\"graphql.tokenization-key\"),authorization=this._data.tokenizationKey),assign({},this._headers,{Authorization:\"Bearer \"+authorization,\"Braintree-Version\":BRAINTREE_VERSION})},GraphQLRequest.prototype.adaptResponseBody=function(parsedBody){return this._adapter(parsedBody,this)},GraphQLRequest.prototype.determineStatus=function(httpStatus,parsedResponse){var status,errorClass;return 200===httpStatus?(errorClass=parsedResponse.errors&&parsedResponse.errors[0]&&parsedResponse.errors[0].extensions&&parsedResponse.errors[0].extensions.errorClass,status=parsedResponse.data&&!parsedResponse.errors?200:\"VALIDATION\"===errorClass?422:\"AUTHORIZATION\"===errorClass?403:\"AUTHENTICATION\"===errorClass?401:function(errorClass,parsedResponse){return!errorClass&&parsedResponse.errors[0].message}(errorClass,parsedResponse)?403:500):status=httpStatus||500,this._sendAnalyticsEvent(\"graphql.status.\"+httpStatus),this._sendAnalyticsEvent(\"graphql.determinedStatus.\"+status),status},module.exports=GraphQLRequest},{\"../../../lib/assign\":95,\"../../constants\":50,\"./adapters/configuration\":57,\"./adapters/credit-card-tokenization\":58,\"./generators/configuration\":60,\"./generators/credit-card-tokenization\":61}],64:[function(_dereq_,module,exports){\"use strict\";var ajaxIsAvaliable,once=_dereq_(\"../../lib/once\"),JSONPDriver=_dereq_(\"./jsonp-driver\"),AJAXDriver=_dereq_(\"./ajax-driver\"),getUserAgent=_dereq_(\"./get-user-agent\"),isHTTP=_dereq_(\"./is-http\");module.exports=function(options,cb){cb=once(cb||Function.prototype),options.method=(options.method||\"GET\").toUpperCase(),options.timeout=null==options.timeout?6e4:options.timeout,options.data=options.data||{},null==ajaxIsAvaliable&&(ajaxIsAvaliable=!(isHTTP()&&/MSIE\\s(8|9)/.test(getUserAgent()))),ajaxIsAvaliable?AJAXDriver.request(options,cb):JSONPDriver.request(options,cb)}},{\"../../lib/once\":131,\"./ajax-driver\":54,\"./get-user-agent\":56,\"./is-http\":65,\"./jsonp-driver\":66}],65:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports=function(){return\"http:\"===global.location.protocol}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],66:[function(_dereq_,module,exports){(function(global){\"use strict\";var head,uuid=_dereq_(\"../../lib/vendor/uuid\"),querystring=_dereq_(\"../../lib/querystring\"),timeouts={};function _cleanupGlobal(callbackName){try{delete global[callbackName]}catch(_){global[callbackName]=null}}module.exports={request:function(options,callback){var script,callbackName=\"callback_json_\"+uuid().replace(/-/g,\"\"),url=options.url,method=options.method,timeout=options.timeout;url=querystring.queryify(url,options.data),function(script,callback,callbackName){global[callbackName]=function(response){var status=response.status||500,err=null,data=null;delete response.status,status>=400||status<200?err=response:data=response,_cleanupGlobal(callbackName),function(script){script&&script.parentNode&&script.parentNode.removeChild(script)}(script),clearTimeout(timeouts[callbackName]),callback(err,data,status)}}(script=function(url,callbackName){var script=document.createElement(\"script\"),done=!1;return script.src=url,script.async=!0,script.onerror=function(){global[callbackName]({message:\"error\",status:500})},script.onload=script.onreadystatechange=function(){done||this.readyState&&\"loaded\"!==this.readyState&&\"complete\"!==this.readyState||(done=!0,script.onload=script.onreadystatechange=null)},script}(url=querystring.queryify(url,{_method:method,callback:callbackName}),callbackName),callback,callbackName),function(timeout,callbackName){timeouts[callbackName]=setTimeout((function(){timeouts[callbackName]=null,global[callbackName]({error:\"timeout\",status:-1}),global[callbackName]=function(){_cleanupGlobal(callbackName)}}),timeout)}(timeout,callbackName),head||(head=document.getElementsByTagName(\"head\")[0]),head.appendChild(script)}}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../lib/querystring\":133,\"../../lib/vendor/uuid\":136}],67:[function(_dereq_,module,exports){\"use strict\";module.exports=function(body){try{body=JSON.parse(body)}catch(e){}return body}},{}],68:[function(_dereq_,module,exports){\"use strict\";module.exports=function(method,body){if(\"string\"!=typeof method)throw new Error(\"Method must be a string\");return\"get\"!==method.toLowerCase()&&null!=body&&(body=\"string\"==typeof body?body:JSON.stringify(body)),body}},{}],69:[function(_dereq_,module,exports){(function(global){\"use strict\";var isXHRAvailable=global.XMLHttpRequest&&\"withCredentials\"in new global.XMLHttpRequest;module.exports={isAvailable:isXHRAvailable,getRequestObject:function(){return isXHRAvailable?new global.XMLHttpRequest:new global.XDomainRequest}}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],70:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={DATA_COLLECTOR_KOUNT_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\",message:\"Kount is not enabled for this merchant.\"},DATA_COLLECTOR_KOUNT_ERROR:{type:BraintreeError.types.MERCHANT,code:\"DATA_COLLECTOR_KOUNT_ERROR\"},DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS:{type:BraintreeError.types.MERCHANT,code:\"DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS\",message:\"Data Collector must be created with Kount and/or PayPal.\"}}},{\"../lib/braintree-error\":98}],71:[function(_dereq_,module,exports){\"use strict\";var cachedSessionId,FRAUDNET_FNCLS=_dereq_(\"../lib/constants\").FRAUDNET_FNCLS,FRAUDNET_SOURCE=_dereq_(\"../lib/constants\").FRAUDNET_SOURCE,FRAUDNET_URL=_dereq_(\"../lib/constants\").FRAUDNET_URL,loadScript=_dereq_(\"../lib/assets\").loadScript,Promise=_dereq_(\"../lib/promise\");function Fraudnet(){}function removeElementIfOnPage(element){element&&element.parentNode&&element.parentNode.removeChild(element)}Fraudnet.prototype.initialize=function(){var sessionId,beaconId,el,self=this;return this.sessionId=cachedSessionId=function(){var i,id=\"\";for(i=0;i<32;i++)id+=Math.floor(16*Math.random()).toString(16);return id}(),this._beaconId=\"https://b.stats.paypal.com/counter.cgi?i=127.0.0.1&p=\"+this.sessionId+\"&t=\"+(new Date).getTime()/1e3+\"&a=14\",this._parameterBlock=(sessionId=this.sessionId,beaconId=this._beaconId,(el=document.body.appendChild(document.createElement(\"script\"))).type=\"application/json\",el.setAttribute(\"fncls\",FRAUDNET_FNCLS),el.text=JSON.stringify({f:sessionId,s:FRAUDNET_SOURCE,b:beaconId}),el),loadScript({src:FRAUDNET_URL}).then((function(block){return self._thirdPartyBlock=block,self})).catch((function(){return null}))},Fraudnet.prototype.teardown=function(){removeElementIfOnPage(document.querySelector('iframe[title=\"ppfniframe\"]')),removeElementIfOnPage(document.querySelector('iframe[title=\"pbf\"]')),removeElementIfOnPage(this._parameterBlock),removeElementIfOnPage(this._thirdPartyBlock)},module.exports={setup:function(){var fraudNet=new Fraudnet;return cachedSessionId?(fraudNet.sessionId=cachedSessionId,Promise.resolve(fraudNet)):fraudNet.initialize()},clearSessionIdCache:function(){cachedSessionId=null}}},{\"../lib/assets\":94,\"../lib/constants\":103,\"../lib/promise\":132}],72:[function(_dereq_,module,exports){\"use strict\";var kount=_dereq_(\"./kount\"),fraudnet=_dereq_(\"./fraudnet\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),methods=_dereq_(\"../lib/methods\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),errors=_dereq_(\"./errors\");module.exports={create:wrapPromise((function(options){var data,name=\"Data Collector\",result={_instances:[]};return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then((function(){return result._instantiatedWithAClient=!options.useDeferredClient,result._createPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name}).then((function(client){var kountInstance,config=client.getConfiguration();if(!0===options.kount&&config.gatewayConfiguration.kount){try{kountInstance=kount.setup({environment:config.gatewayConfiguration.environment,merchantId:config.gatewayConfiguration.kount.kountMerchantId})}catch(err){return Promise.reject(new BraintreeError({type:errors.DATA_COLLECTOR_KOUNT_ERROR.type,code:errors.DATA_COLLECTOR_KOUNT_ERROR.code,message:err.message}))}data=kountInstance.deviceData,result._instances.push(kountInstance)}else data={};return Promise.resolve()})).then((function(){return fraudnet.setup().then((function(fraudnetInstance){fraudnetInstance&&(data.correlation_id=fraudnetInstance.sessionId,result._instances.push(fraudnetInstance))}))})).then((function(){return 0===result._instances.length?Promise.reject(new BraintreeError(errors.DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS)):(result.deviceData=JSON.stringify(data),result.rawDeviceData=data,result)})),result.teardown=function(result){return wrapPromise((function(){return result._createPromise.then((function(){result._instances.forEach((function(instance){instance&&instance.teardown()})),convertMethodsToError(result,methods(result))}))}))}(result),result.getDeviceData=function(result){return wrapPromise((function(options){return options=options||{},result._createPromise.then((function(){return Promise.resolve(options.raw?result.rawDeviceData:result.deviceData)}))}))}(result),result._instantiatedWithAClient?result._createPromise:result}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/methods\":130,\"../lib/promise\":132,\"./errors\":70,\"./fraudnet\":71,\"./kount\":73,\"@braintree/wrap-promise\":30}],73:[function(_dereq_,module,exports){\"use strict\";var sjcl=_dereq_(\"./vendor/sjcl\"),camelCaseToSnakeCase=_dereq_(\"../lib/camel-case-to-snake-case\"),QA_URL=\"https://assets.qa.braintreepayments.com/data\",environmentUrls={development:QA_URL,qa:QA_URL,sandbox:\"https://assets.braintreegateway.com/sandbox/data\",production:\"https://assets.braintreegateway.com/data\"},cachedDeviceData={};function Kount(options){var previouslyInitializedDeviceData=Kount.getCachedDeviceData(options.merchantId);if(previouslyInitializedDeviceData)return this.deviceData=previouslyInitializedDeviceData,void(this._isCached=!0);this._currentEnvironment=this._initializeEnvironment(options),sjcl.random.startCollectors(),this._deviceSessionId=this._generateDeviceSessionId(),this.deviceData=this._getDeviceData(),Kount.setCachedDeviceData(options.merchantId,this.deviceData),this._iframe=this._setupIFrame()}Kount.getCachedDeviceData=function(merchantId){return cachedDeviceData[merchantId]},Kount.setCachedDeviceData=function(merchantId,data){cachedDeviceData[merchantId]=data},Kount.prototype.teardown=function(){this._isCached||(sjcl.random.stopCollectors(),this._removeIframe())},Kount.prototype._removeIframe=function(){this._iframe.parentNode.removeChild(this._iframe)},Kount.prototype._getDeviceData=function(){return camelCaseToSnakeCase({deviceSessionId:this._deviceSessionId,fraudMerchantId:this._currentEnvironment.id})},Kount.prototype._generateDeviceSessionId=function(){var bits;return bits=sjcl.random.randomWords(4,0),sjcl.codec.hex.fromBits(bits)},Kount.prototype._setupIFrame=function(){var params,iframe,self=this;return params=\"?m=\"+this._currentEnvironment.id+\"&s=\"+this._deviceSessionId,(iframe=document.createElement(\"iframe\")).width=1,iframe.id=\"braintreeDataFrame-\"+this._deviceSessionId,iframe.height=1,iframe.frameBorder=0,iframe.scrolling=\"no\",iframe.style.position=\"fixed\",iframe.style.left=\"-999999px\",iframe.style.top=\"-999999px\",iframe.title=\"Braintree-Kount-iframe\",iframe.setAttribute(\"aria-hidden\",\"true\"),document.body.appendChild(iframe),setTimeout((function(){iframe.src=self._currentEnvironment.url+\"/logo.htm\"+params,iframe.innerHTML='<img src=\"'+self._currentEnvironment.url+\"/logo.gif\"+params+'\" alt=\"\" />'}),10),iframe},Kount.prototype._initializeEnvironment=function(options){var url=environmentUrls[options.environment];if(null==url)throw new Error(options.environment+\" is not a valid environment for kount.environment\");return{url:url,name:options.environment,id:options.merchantId}},module.exports={setup:function(o){return new Kount(null!=o?o:{})},Kount:Kount,environmentUrls:environmentUrls}},{\"../lib/camel-case-to-snake-case\":102,\"./vendor/sjcl\":74}],74:[function(_dereq_,module,exports){\"use strict\";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return\"CORRUPT: \"+this.message},this.message=a},invalid:function(a){this.toString=function(){return\"INVALID: \"+this.message},this.message=a},bug:function(a){this.toString=function(){return\"BUG: \"+this.message},this.message=a},notReady:function(a){this.toString=function(){return\"NOT READY: \"+this.message},this.message=a}}};function t(a,b,c){if(4!==b.length)throw new sjcl.exception.invalid(\"invalid aes block size\");var d=a.b[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var k,l,p,h,n=d.length/4-2,m=4,q=[0,0,0,0];a=(k=a.l[c])[0];var r=k[1],v=k[2],w=k[3],x=k[4];for(h=0;h<n;h++)k=a[e>>>24]^r[f>>16&255]^v[g>>8&255]^w[255&b]^d[m],l=a[f>>>24]^r[g>>16&255]^v[b>>8&255]^w[255&e]^d[m+1],p=a[g>>>24]^r[b>>16&255]^v[e>>8&255]^w[255&f]^d[m+2],b=a[b>>>24]^r[e>>16&255]^v[f>>8&255]^w[255&g]^d[m+3],m+=4,e=k,f=l,g=p;for(h=0;4>h;h++)q[c?3&-h:h]=x[e>>>24]<<24^x[f>>16&255]<<16^x[g>>8&255]<<8^x[255&b]^d[m++],k=e,e=f,f=g,g=b,b=k;return q}function u(a,b){var c,d,e,f=a.u,g=a.b,k=f[0],l=f[1],p=f[2],n=f[3],h=f[4],m=f[5],q=f[6],r=f[7];for(c=0;64>c;c++)d=(d=16>c?b[c]:b[15&c]=((d=b[c+1&15])>>>7^d>>>18^d>>>3^d<<25^d<<14)+((e=b[c+14&15])>>>17^e>>>19^e>>>10^e<<15^e<<13)+b[15&c]+b[c+9&15]|0)+r+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(q^h&(m^q))+g[c],r=q,q=m,m=h,h=n+d|0,n=p,p=l,k=d+((l=k)&p^n&(l^p))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;f[0]=f[0]+k|0,f[1]=f[1]+l|0,f[2]=f[2]+p|0,f[3]=f[3]+n|0,f[4]=f[4]+h|0,f[5]=f[5]+m|0,f[6]=f[6]+q|0,f[7]=f[7]+r|0}function A(a,b){var c,d=sjcl.random.B[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}function C(a,b){\"undefined\"!=typeof window&&window.performance&&\"function\"==typeof window.performance.now?a.addEntropy(window.performance.now(),b,\"loadtime\"):a.addEntropy((new Date).valueOf(),b,\"loadtime\")}function y(a){a.b=z(a).concat(z(a)),a.C=new sjcl.cipher.aes(a.b)}function z(a){for(var b=0;4>b&&(a.g[b]=a.g[b]+1|0,!a.g[b]);b++);return a.C.encrypt(a.g)}function B(a,b){return function(){b.apply(a,arguments)}}sjcl.cipher.aes=function(a){this.l[0][0][0]||this.G();var b,c,d,e,f=this.l[0][4],g=this.l[1],k=1;if(4!==(b=a.length)&&6!==b&&8!==b)throw new sjcl.exception.invalid(\"invalid aes key size\");for(this.b=[d=a.slice(0),e=[]],a=b;a<4*b+28;a++)c=d[a-1],(0==a%b||8===b&&4==a%b)&&(c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[255&c],0==a%b&&(c=c<<8^c>>>24^k<<24,k=k<<1^283*(k>>7))),d[a]=d[a-b]^c;for(b=0;a;b++,a--)c=d[3&b?a:a-4],e[b]=4>=a||4>b?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^g[3][f[255&c]]},sjcl.cipher.aes.prototype={encrypt:function(a){return t(this,a,0)},decrypt:function(a){return t(this,a,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){var e,f,g,p,n,h,m,a=this.l[0],b=this.l[1],c=a[4],d=b[4],k=[],l=[];for(e=0;256>e;e++)l[(k[e]=e<<1^283*(e>>7))^e]=e;for(f=g=0;!c[f];f^=p||1,g=l[g]||1)for(c[f]=h=(h=g^g<<1^g<<2^g<<3^g<<4)>>8^255&h^99,d[h]=f,m=16843009*(n=k[e=k[p=k[f]]])^65537*e^257*p^16843008*f,n=257*k[h]^16843008*h,e=0;4>e;e++)a[e][f]=n=n<<24^n>>>8,b[e][h]=m=m<<24^m>>>8;for(e=0;5>e;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)}},sjcl.bitArray={bitSlice:function(a,b,c){return a=sjcl.bitArray.M(a.slice(b/32),32-(31&b)).slice(1),void 0===c?a:sjcl.bitArray.clamp(a,c-b)},extract:function(a,b,c){var d=Math.floor(-b-c&31);return(-32&(b+c-1^b)?a[b/32|0]<<32-d^a[b/32+1|0]>>>d:a[b/32|0]>>>d)&(1<<c)-1},concat:function(a,b){if(0===a.length||0===b.length)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return 32===d?a.concat(b):sjcl.bitArray.M(b,d,0|c,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;return 0===b?0:32*(b-1)+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(32*a.length<b)return a;var c=(a=a.slice(0,Math.ceil(b/32))).length;return b&=31,0<c&&b&&(a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1)),a},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return!1;var d,c=0;for(d=0;d<a.length;d++)c|=a[d]^b[d];return 0===c},M:function(a,b,c,d){var e;for(e=0,void 0===d&&(d=[]);32<=b;b-=32)d.push(c),c=0;if(0===b)return d.concat(a);for(e=0;e<a.length;e++)d.push(c|a[e]>>>b),c=a[e]<<32-b;return a=sjcl.bitArray.getPartial(e=a.length?a[a.length-1]:0),d.push(sjcl.bitArray.partial(b+a&31,32<b+a?c:d.pop(),1)),d},Y:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(a){var b,c;for(b=0;b<a.length;++b)a[b]=(c=a[b])>>>24|c>>>8&65280|(65280&c)<<8|c<<24;return a}},sjcl.codec.utf8String={fromBits:function(a){var d,e,b=\"\",c=sjcl.bitArray.bitLength(a);for(d=0;d<c/8;d++)0==(3&d)&&(e=a[d/4]),b+=String.fromCharCode(e>>>8>>>8>>>8),e<<=8;return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var c,b=[],d=0;for(c=0;c<a.length;c++)d=d<<8|a.charCodeAt(c),3==(3&c)&&(b.push(d),d=0);return 3&c&&b.push(sjcl.bitArray.partial(8*(3&c),d)),b}},sjcl.codec.hex={fromBits:function(a){var c,b=\"\";for(c=0;c<a.length;c++)b+=(0xf00000000000+(0|a[c])).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,d,c=[];for(d=(a=a.replace(/\\s|0x/g,\"\")).length,a+=\"00000000\",b=0;b<a.length;b+=8)c.push(0^parseInt(a.substr(b,8),16));return sjcl.bitArray.clamp(c,4*d)}},sjcl.hash.sha256=function(a){this.b[0]||this.G(),a?(this.u=a.u.slice(0),this.o=a.o.slice(0),this.h=a.h):this.reset()},sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.u=this.K.slice(0),this.o=[],this.h=0,this},update:function(a){\"string\"==typeof a&&(a=sjcl.codec.utf8String.toBits(a));var b,c=this.o=sjcl.bitArray.concat(this.o,a);if(9007199254740991<(a=this.h=(b=this.h)+sjcl.bitArray.bitLength(a)))throw new sjcl.exception.invalid(\"Cannot hash more than 2^53 - 1 bits\");if(\"undefined\"!=typeof Uint32Array){var d=new Uint32Array(c),e=0;for(b=512+b-(512+b&511);b<=a;b+=512)u(this,d.subarray(16*e,16*(e+1))),e+=1;c.splice(0,16*e)}else for(b=512+b-(512+b&511);b<=a;b+=512)u(this,c.splice(0,16));return this},finalize:function(){var a,b,c=this.u;for(a=(b=sjcl.bitArray.concat(b=this.o,[sjcl.bitArray.partial(1,1)])).length+2;15&a;a++)b.push(0);for(b.push(Math.floor(this.h/4294967296)),b.push(0|this.h);b.length;)u(this,b.splice(0,16));return this.reset(),c},K:[],b:[],G:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}for(var d,e,b=0,c=2;64>b;c++){for(e=!0,d=2;d*d<=c;d++)if(0==c%d){e=!1;break}e&&(8>b&&(this.K[b]=a(Math.pow(c,.5))),this.b[b]=a(Math.pow(c,1/3)),b++)}}},sjcl.prng=function(a){this.c=[new sjcl.hash.sha256],this.i=[0],this.H=0,this.v={},this.F=0,this.J={},this.L=this.f=this.j=this.T=0,this.b=[0,0,0,0,0,0,0,0],this.g=[0,0,0,0],this.C=void 0,this.D=a,this.s=!1,this.B={progress:{},seeded:{}},this.m=this.S=0,this.w=1,this.A=2,this.O=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.P=3e4,this.N=80},sjcl.prng.prototype={randomWords:function(a,b){var d,e,c=[];if((d=this.isReady(b))===this.m)throw new sjcl.exception.notReady(\"generator isn't seeded\");if(d&this.A){d=!(d&this.w);var g,f=0;for(this.L=(e=[])[0]=(new Date).valueOf()+this.P,g=0;16>g;g++)e.push(4294967296*Math.random()|0);for(g=0;g<this.c.length&&(e=e.concat(this.c[g].finalize()),f+=this.i[g],this.i[g]=0,d||!(this.H&1<<g));g++);for(this.H>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.i.push(0)),this.f-=f,f>this.j&&(this.j=f),this.H++,this.b=sjcl.hash.sha256.hash(this.b.concat(e)),this.C=new sjcl.cipher.aes(this.b),d=0;4>d&&(this.g[d]=this.g[d]+1|0,!this.g[d]);d++);}for(d=0;d<a;d+=4)0==(d+1)%this.O&&y(this),e=z(this),c.push(e[0],e[1],e[2],e[3]);return y(this),c.slice(0,a)},setDefaultParanoia:function(a,b){if(0===a&&\"Setting paranoia=0 will ruin your security; use it only for testing\"!==b)throw new sjcl.exception.invalid(\"Setting paranoia=0 will ruin your security; use it only for testing\");this.D=a},addEntropy:function(a,b,c){c=c||\"user\";var d,e,f=(new Date).valueOf(),g=this.v[c],k=this.isReady(),l=0;switch(void 0===(d=this.J[c])&&(d=this.J[c]=this.T++),void 0===g&&(g=this.v[c]=0),this.v[c]=(this.v[c]+1)%this.c.length,typeof a){case\"number\":void 0===b&&(b=1),this.c[g].update([d,this.F++,1,b,f,1,0|a]);break;case\"object\":if(\"[object Uint32Array]\"===(c=Object.prototype.toString.call(a))){for(e=[],c=0;c<a.length;c++)e.push(a[c]);a=e}else for(\"[object Array]\"!==c&&(l=1),c=0;c<a.length&&!l;c++)\"number\"!=typeof a[c]&&(l=1);if(!l){if(void 0===b)for(c=b=0;c<a.length;c++)for(e=a[c];0<e;)b++,e>>>=1;this.c[g].update([d,this.F++,2,b,f,a.length].concat(a))}break;case\"string\":void 0===b&&(b=a.length),this.c[g].update([d,this.F++,3,b,f,a.length]),this.c[g].update(a);break;default:l=1}if(l)throw new sjcl.exception.bug(\"random: addEntropy only supports number, array of numbers or string\");this.i[g]+=b,this.f+=b,k===this.m&&(this.isReady()!==this.m&&A(\"seeded\",Math.max(this.j,this.f)),A(\"progress\",this.getProgress()))},isReady:function(a){return a=this.I[void 0!==a?a:this.D],this.j&&this.j>=a?this.i[0]>this.N&&(new Date).valueOf()>this.L?this.A|this.w:this.w:this.f>=a?this.A|this.m:this.m},getProgress:function(a){return this.j>=(a=this.I[a||this.D])||this.f>a?1:this.f/a},startCollectors:function(){if(!this.s){if(this.a={loadTimeCollector:B(this,this.V),mouseCollector:B(this,this.W),keyboardCollector:B(this,this.U),accelerometerCollector:B(this,this.R),touchCollector:B(this,this.X)},window.addEventListener)window.addEventListener(\"load\",this.a.loadTimeCollector,!1),window.addEventListener(\"mousemove\",this.a.mouseCollector,!1),window.addEventListener(\"keypress\",this.a.keyboardCollector,!1),window.addEventListener(\"devicemotion\",this.a.accelerometerCollector,!1),window.addEventListener(\"touchmove\",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new sjcl.exception.bug(\"can't attach event\");document.attachEvent(\"onload\",this.a.loadTimeCollector),document.attachEvent(\"onmousemove\",this.a.mouseCollector),document.attachEvent(\"keypress\",this.a.keyboardCollector)}this.s=!0}},stopCollectors:function(){this.s&&(window.removeEventListener?(window.removeEventListener(\"load\",this.a.loadTimeCollector,!1),window.removeEventListener(\"mousemove\",this.a.mouseCollector,!1),window.removeEventListener(\"keypress\",this.a.keyboardCollector,!1),window.removeEventListener(\"devicemotion\",this.a.accelerometerCollector,!1),window.removeEventListener(\"touchmove\",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent(\"onload\",this.a.loadTimeCollector),document.detachEvent(\"onmousemove\",this.a.mouseCollector),document.detachEvent(\"keypress\",this.a.keyboardCollector)),this.s=!1)},addEventListener:function(a,b){this.B[a][this.S++]=b},removeEventListener:function(a,b){var c,d,e=this.B[a],f=[];for(d in e)e.hasOwnProperty(d)&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)delete e[d=f[c]]},U:function(){C(this,1)},W:function(a){var b,c;try{b=a.x||a.clientX||a.offsetX||0,c=a.y||a.clientY||a.offsetY||0}catch(d){c=b=0}0!=b&&0!=c&&this.addEntropy([b,c],2,\"mouse\"),C(this,0)},X:function(a){this.addEntropy([(a=a.touches[0]||a.changedTouches[0]).pageX||a.clientX,a.pageY||a.clientY],1,\"touch\"),C(this,0)},V:function(){C(this,2)},R:function(a){if(a=a.accelerationIncludingGravity.x||a.accelerationIncludingGravity.y||a.accelerationIncludingGravity.z,window.orientation){var b=window.orientation;\"number\"==typeof b&&this.addEntropy(b,1,\"accelerometer\")}a&&this.addEntropy(a,2,\"accelerometer\"),C(this,0)}},sjcl.random=new sjcl.prng(6);a:try{var D,E,F,G;if(G=void 0!==module&&module.exports){var H;try{H=_dereq_(\"crypto\")}catch(a){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,\"crypto['randomBytes']\");else if(\"undefined\"!=typeof window&&\"undefined\"!=typeof Uint32Array){if(F=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break a;window.msCrypto.getRandomValues(F)}sjcl.random.addEntropy(F,1024,\"crypto['getRandomValues']\")}}catch(a){\"undefined\"!=typeof window&&window.console&&(console.log(\"There was an error collecting entropy from the browser:\"),console.log(a))}void 0!==module&&module.exports&&(module.exports=sjcl)},{crypto:void 0}],75:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={GOOGLE_PAYMENT_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"GOOGLE_PAYMENT_NOT_ENABLED\",message:\"Google Pay is not enabled for this merchant.\"},GOOGLE_PAYMENT_GATEWAY_ERROR:{code:\"GOOGLE_PAYMENT_GATEWAY_ERROR\",message:\"There was an error when tokenizing the Google Pay payment method.\",type:BraintreeError.types.UNKNOWN},GOOGLE_PAYMENT_UNSUPPORTED_VERSION:{code:\"GOOGLE_PAYMENT_UNSUPPORTED_VERSION\",type:BraintreeError.types.MERCHANT}}},{\"../lib/braintree-error\":98}],76:[function(_dereq_,module,exports){\"use strict\";var analytics=_dereq_(\"../lib/analytics\"),assign=_dereq_(\"../lib/assign\").assign,convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),find=_dereq_(\"../lib/find\"),generateGooglePayConfiguration=_dereq_(\"../lib/generate-google-pay-configuration\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),errors=_dereq_(\"./errors\"),methods=_dereq_(\"../lib/methods\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),CREATE_PAYMENT_DATA_REQUEST_METHODS={1:\"_createV1PaymentDataRequest\",2:\"_createV2PaymentDataRequest\"};function GooglePayment(options){if(this._createPromise=options.createPromise,this._client=options.client,this._useDeferredClient=options.useDeferredClient,this._googlePayVersion=options.googlePayVersion||1,this._googleMerchantId=options.googleMerchantId,this._isUnsupportedGooglePayAPIVersion())throw new BraintreeError({code:errors.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.code,message:\"The Braintree SDK does not support Google Pay version \"+this._googlePayVersion+\". Please upgrade the version of your Braintree SDK and contact support if this error persists.\",type:errors.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.type})}GooglePayment.prototype._waitForClient=function(){return this._client?Promise.resolve():this._createPromise.then((function(client){this._client=client}).bind(this))},GooglePayment.prototype._isUnsupportedGooglePayAPIVersion=function(){return!(this._googlePayVersion in CREATE_PAYMENT_DATA_REQUEST_METHODS)},GooglePayment.prototype._getDefaultConfig=function(){return this._defaultConfig||(this._defaultConfig=generateGooglePayConfiguration(this._client.getConfiguration(),this._googlePayVersion,this._googleMerchantId)),this._defaultConfig},GooglePayment.prototype._createV1PaymentDataRequest=function(paymentDataRequest){var defaultConfig=this._getDefaultConfig(),allowedCardNetworks=paymentDataRequest.cardRequirements&&paymentDataRequest.cardRequirements.allowedCardNetworks||defaultConfig.cardRequirements.allowedCardNetworks;return(paymentDataRequest=assign({},defaultConfig,paymentDataRequest)).cardRequirements.allowedCardNetworks=allowedCardNetworks,paymentDataRequest},GooglePayment.prototype._createV2PaymentDataRequest=function(paymentDataRequest){var defaultConfig=this._getDefaultConfig();return paymentDataRequest.allowedPaymentMethods&&paymentDataRequest.allowedPaymentMethods.forEach((function(paymentMethod){var defaultPaymentMethod=find(defaultConfig.allowedPaymentMethods,\"type\",paymentMethod.type);defaultPaymentMethod&&function(merchantSubmittedPaymentMethod,defaultPaymentMethod){Object.keys(defaultPaymentMethod).forEach((function(parameter){merchantSubmittedPaymentMethod[parameter]=\"object\"==typeof defaultPaymentMethod[parameter]?assign({},defaultPaymentMethod[parameter],merchantSubmittedPaymentMethod[parameter]):merchantSubmittedPaymentMethod[parameter]||defaultPaymentMethod[parameter]}))}(paymentMethod,defaultPaymentMethod)})),assign({},defaultConfig,paymentDataRequest)},GooglePayment.prototype.createPaymentDataRequest=function(overrides){return this._useDeferredClient?this._waitForClient().then((function(){return this._createPaymentDataRequestSyncronously(overrides)}).bind(this)):this._createPaymentDataRequestSyncronously(overrides)},GooglePayment.prototype._createPaymentDataRequestSyncronously=function(overrides){var paymentDataRequest=assign({},overrides),version=this._googlePayVersion,createPaymentDataRequestMethod=CREATE_PAYMENT_DATA_REQUEST_METHODS[version];return analytics.sendEvent(this._createPromise,\"google-payment.v\"+version+\".createPaymentDataRequest\"),this[createPaymentDataRequestMethod](paymentDataRequest)},GooglePayment.prototype.parseResponse=function(response){var self=this;return Promise.resolve().then((function(){var payload,parsedResponse=JSON.parse(2===response.apiVersion?response.paymentMethodData.tokenizationData.token:response.paymentMethodToken.token),error=parsedResponse.error;return error?Promise.reject(error):(analytics.sendEvent(self._createPromise,\"google-payment.parseResponse.succeeded\"),parsedResponse.paypalAccounts?(payload=parsedResponse.paypalAccounts[0],analytics.sendEvent(self._createPromise,\"google-payment.parseResponse.succeeded.paypal\"),Promise.resolve({nonce:payload.nonce,type:payload.type,description:payload.description})):(payload=parsedResponse.androidPayCards[0],analytics.sendEvent(self._createPromise,\"google-payment.parseResponse.succeeded.google-payment\"),Promise.resolve({nonce:payload.nonce,type:payload.type,description:payload.description,details:{cardType:payload.details.cardType,lastFour:payload.details.lastFour,lastTwo:payload.details.lastTwo,isNetworkTokenized:payload.details.isNetworkTokenized},binData:payload.binData})))})).catch((function(error){return analytics.sendEvent(self._createPromise,\"google-payment.parseResponse.failed\"),Promise.reject(new BraintreeError({code:errors.GOOGLE_PAYMENT_GATEWAY_ERROR.code,message:errors.GOOGLE_PAYMENT_GATEWAY_ERROR.message,type:errors.GOOGLE_PAYMENT_GATEWAY_ERROR.type,details:{originalError:error}}))}))},GooglePayment.prototype.teardown=function(){return convertMethodsToError(this,methods(GooglePayment.prototype)),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(GooglePayment)},{\"../lib/analytics\":93,\"../lib/assign\":95,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/find\":113,\"../lib/generate-google-pay-configuration\":125,\"../lib/methods\":130,\"../lib/promise\":132,\"./errors\":75,\"@braintree/wrap-promise\":30}],77:[function(_dereq_,module,exports){\"use strict\";var GooglePayment=_dereq_(\"./google-payment\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),Promise=_dereq_(\"../lib/promise\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),errors=_dereq_(\"./errors\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"Google Pay\",client:options.client,authorization:options.authorization}).then((function(){var createPromise,instance;return createPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"Google Pay\"}).then((function(client){var configuration=client.getConfiguration();return options.client=client,configuration.gatewayConfiguration.androidPay?client:Promise.reject(new BraintreeError(errors.GOOGLE_PAYMENT_NOT_ENABLED))})),options.createPromise=createPromise,instance=new GooglePayment(options),options.useDeferredClient?instance:createPromise.then((function(client){return instance._client=client,instance}))}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./errors\":75,\"./google-payment\":76,\"@braintree/wrap-promise\":30}],78:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\"),errors=_dereq_(\"../shared/errors\"),allowedAttributes=_dereq_(\"../shared/constants\").allowedAttributes;module.exports=function(attribute,value){var err;return allowedAttributes.hasOwnProperty(attribute)?null==value||function(attribute,value){return\"string\"===allowedAttributes[attribute]?\"string\"==typeof value||\"number\"==typeof value:\"boolean\"===allowedAttributes[attribute]&&(\"true\"===String(value)||\"false\"===String(value))}(attribute,value)||(err=new BraintreeError({type:errors.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.type,code:errors.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.code,message:'Value \"'+value+'\" is not allowed for \"'+attribute+'\" attribute.'})):err=new BraintreeError({type:errors.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.type,code:errors.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.code,message:'The \"'+attribute+'\" attribute is not supported in Hosted Fields.'}),err}},{\"../../lib/braintree-error\":98,\"../shared/constants\":86,\"../shared/errors\":87}],79:[function(_dereq_,module,exports){\"use strict\";var constants=_dereq_(\"../shared/constants\"),useMin=_dereq_(\"../../lib/use-min\");module.exports=function(assetsUrl,componentId,isDebug){return assetsUrl+\"/web/\"+constants.VERSION+\"/html/hosted-fields-frame\"+useMin(isDebug)+\".html#\"+componentId}},{\"../../lib/use-min\":134,\"../shared/constants\":86}],80:[function(_dereq_,module,exports){\"use strict\";var directions=_dereq_(\"../shared/constants\").navigationDirections,browserDetection=_dereq_(\"../shared/browser-detection\"),focusIntercept=_dereq_(\"../shared/focus-intercept\"),findParentTags=_dereq_(\"../shared/find-parent-tags\"),userFocusableTagNames=[\"INPUT\",\"SELECT\",\"TEXTAREA\"],unfocusedInputTypes=[\"hidden\",\"button\",\"reset\",\"submit\",\"checkbox\",\"radio\",\"file\"];function _isUserFocusableElement(element){return browserDetection.hasSoftwareKeyboard()?userFocusableTagNames.indexOf(element.tagName)>-1&&unfocusedInputTypes.indexOf(element.type)<0:\"hidden\"!==element.type}function _findFirstFocusableElement(elementsInForm){var elementsIndex,element;for(elementsIndex=0;elementsIndex<elementsInForm.length;elementsIndex++)if(_isUserFocusableElement(element=elementsInForm[elementsIndex]))return element;return null}module.exports={removeExtraFocusElements:function(checkoutForm,onRemoveFocusIntercepts){var elements=Array.prototype.slice.call(checkoutForm.elements);[_findFirstFocusableElement(elements),_findFirstFocusableElement(elements.reverse())].forEach((function(input){input&&focusIntercept.matchFocusElement(input.getAttribute(\"id\"))&&onRemoveFocusIntercepts(input.getAttribute(\"id\"))}))},createFocusChangeHandler:function(callbacks){return function(type,direction){var currentIndex,targetElement,checkoutForm,navHelper,sourceElement=document.getElementById(\"bt-\"+type+\"-\"+direction);if(sourceElement)if(checkoutForm=findParentTags(sourceElement,\"form\")[0],document.forms.length<1||!checkoutForm)callbacks.onRemoveFocusIntercepts();else{currentIndex=(checkoutForm=[].slice.call(checkoutForm.elements)).indexOf(sourceElement),navHelper=function(direction,numberOfElementsInForm){switch(direction){case directions.BACK:return{checkIndexBounds:function(index){return index<0},indexChange:-1};case directions.FORWARD:return{checkIndexBounds:function(index){return index>numberOfElementsInForm-1},indexChange:1}}return{}}(direction,checkoutForm.length);do{if(navHelper.checkIndexBounds(currentIndex+=navHelper.indexChange))return;targetElement=checkoutForm[currentIndex]}while(!_isUserFocusableElement(targetElement));focusIntercept.matchFocusElement(targetElement.getAttribute(\"id\"))?callbacks.onTriggerInputFocus(targetElement.getAttribute(\"data-braintree-type\")):targetElement.focus()}}}}},{\"../shared/browser-detection\":85,\"../shared/constants\":86,\"../shared/find-parent-tags\":88,\"../shared/focus-intercept\":89}],81:[function(_dereq_,module,exports){\"use strict\";var allowedStyles=_dereq_(\"../shared/constants\").allowedStyles;module.exports=function(cssClass){var computedStyles,element=document.createElement(\"input\"),styles={};return\".\"===cssClass[0]&&(cssClass=cssClass.substring(1)),element.className=cssClass,element.style.display=\"none !important\",element.style.position=\"fixed !important\",element.style.left=\"-99999px !important\",element.style.top=\"-99999px !important\",document.body.appendChild(element),computedStyles=window.getComputedStyle(element),allowedStyles.forEach((function(style){var value=computedStyles[style];value&&(styles[style]=value)})),document.body.removeChild(element),styles}},{\"../shared/constants\":86}],82:[function(_dereq_,module,exports){(function(global){\"use strict\";var assign=_dereq_(\"../../lib/assign\").assign,createAssetsUrl=_dereq_(\"../../lib/create-assets-url\"),Destructor=_dereq_(\"../../lib/destructor\"),classList=_dereq_(\"@braintree/class-list\"),iFramer=_dereq_(\"@braintree/iframer\"),Bus=_dereq_(\"../../lib/bus\"),createDeferredClient=_dereq_(\"../../lib/create-deferred-client\"),BraintreeError=_dereq_(\"../../lib/braintree-error\"),composeUrl=_dereq_(\"./compose-url\"),getStylesFromClass=_dereq_(\"./get-styles-from-class\"),constants=_dereq_(\"../shared/constants\"),errors=_dereq_(\"../shared/errors\"),INTEGRATION_TIMEOUT_MS=_dereq_(\"../../lib/constants\").INTEGRATION_TIMEOUT_MS,uuid=_dereq_(\"../../lib/vendor/uuid\"),findParentTags=_dereq_(\"../shared/find-parent-tags\"),browserDetection=_dereq_(\"../shared/browser-detection\"),events=constants.events,EventEmitter=_dereq_(\"@braintree/event-emitter\"),injectFrame=_dereq_(\"./inject-frame\"),analytics=_dereq_(\"../../lib/analytics\"),allowedFields=constants.allowedFields,methods=_dereq_(\"../../lib/methods\"),convertMethodsToError=_dereq_(\"../../lib/convert-methods-to-error\"),sharedErrors=_dereq_(\"../../lib/errors\"),getCardTypes=_dereq_(\"../shared/get-card-types\"),attributeValidationError=_dereq_(\"./attribute-validation-error\"),Promise=_dereq_(\"../../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),focusChange=_dereq_(\"./focus-change\"),destroyFocusIntercept=_dereq_(\"../shared/focus-intercept\").destroy;function HostedFields(options){var failureTimeout,clientConfig,assetsUrl,isDebug,hostedFieldsUrl,self=this,fields={},frameReadyPromiseResolveFunctions={},frameReadyPromises=[],componentId=uuid();if(this._merchantConfigurationOptions=assign({},options),options.client?(assetsUrl=(clientConfig=options.client.getConfiguration()).gatewayConfiguration.assetsUrl,isDebug=clientConfig.isDebug):(assetsUrl=createAssetsUrl.create(options.authorization),isDebug=Boolean(options.isDebug)),this._clientPromise=createDeferredClient.create({client:options.client,authorization:options.authorization,debug:isDebug,assetsUrl:assetsUrl,name:\"Hosted Fields\"}),hostedFieldsUrl=composeUrl(assetsUrl,componentId,isDebug),!options.fields||0===Object.keys(options.fields).length)throw new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:\"options.fields is required when instantiating Hosted Fields.\"});EventEmitter.call(this),this._injectedNodes=[],this._destructor=new Destructor,this._fields=fields,this._state={fields:{},cards:getCardTypes(\"\")},this._bus=new Bus({channel:componentId,merchantUrl:location.href}),this._destructor.registerFunctionForTeardown((function(){self._bus.teardown()})),analytics.sendEvent(this._clientPromise,options.client?\"custom.hosted-fields.initialized\":\"custom.hosted-fields.initialized.deferred-client\"),Object.keys(options.fields).forEach((function(key){var field,container,frame,frameReadyPromise;if(!constants.allowedFields.hasOwnProperty(key))throw new BraintreeError({type:errors.HOSTED_FIELDS_INVALID_FIELD_KEY.type,code:errors.HOSTED_FIELDS_INVALID_FIELD_KEY.code,message:'\"'+key+'\" is not a valid field.'});if(\"string\"==typeof(container=(field=options.fields[key]).container||field.selector)&&(container=document.querySelector(container)),!container||1!==container.nodeType)throw new BraintreeError({type:errors.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.type,code:errors.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.code,message:errors.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.message,details:{fieldSelector:field.selector,fieldContainer:field.container,fieldKey:key}});if(container.querySelector('iframe[name^=\"braintree-\"]'))throw new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.type,code:errors.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.code,message:errors.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.message,details:{fieldSelector:field.selector,fieldContainer:field.container,fieldKey:key}});if(field.maxlength&&\"number\"!=typeof field.maxlength)throw new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:\"The value for maxlength must be a number.\",details:{fieldKey:key}});if(field.minlength&&\"number\"!=typeof field.minlength)throw new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:\"The value for minlength must be a number.\",details:{fieldKey:key}});frame=iFramer({type:key,name:\"braintree-hosted-field-\"+key,style:constants.defaultIFrameStyle,title:\"Secure Credit Card Frame - \"+constants.allowedFields[key].label}),this._injectedNodes.push.apply(this._injectedNodes,injectFrame(frame,container,(function(){self._bus.emit(events.TRIGGER_INPUT_FOCUS,key)}))),this._setupLabelFocus(key,container),fields[key]={frameElement:frame,containerElement:container},frameReadyPromise=new Promise((function(resolve){frameReadyPromiseResolveFunctions[key]=resolve})),frameReadyPromises.push(frameReadyPromise),this._state.fields[key]={isEmpty:!0,isValid:!1,isPotentiallyValid:!0,isFocused:!1,container:container},setTimeout((function(){browserDetection.isIE()||browserDetection.isEdge()?(frame.src=\"about:blank\",setTimeout((function(){frame.src=hostedFieldsUrl}),0)):frame.src=hostedFieldsUrl}),0)}).bind(this)),this._merchantConfigurationOptions.styles&&Object.keys(this._merchantConfigurationOptions.styles).forEach((function(selector){var className=self._merchantConfigurationOptions.styles[selector];\"string\"==typeof className&&(self._merchantConfigurationOptions.styles[selector]=getStylesFromClass(className))})),this._bus.on(events.REMOVE_FOCUS_INTERCEPTS,destroyFocusIntercept),this._bus.on(events.TRIGGER_FOCUS_CHANGE,focusChange.createFocusChangeHandler({onRemoveFocusIntercepts:function(element){self._bus.emit(events.REMOVE_FOCUS_INTERCEPTS,element)},onTriggerInputFocus:function(targetType){self._bus.emit(events.TRIGGER_INPUT_FOCUS,targetType)}})),this._bus.on(events.READY_FOR_CLIENT,(function(reply){self._clientPromise.then((function(client){reply(client)}))})),this._bus.on(events.CARD_FORM_ENTRY_HAS_BEGUN,(function(){analytics.sendEvent(self._clientPromise,\"hosted-fields.input.started\")})),this._bus.on(events.BIN_AVAILABLE,(function(bin){self._emit(\"binAvailable\",{bin:bin})})),failureTimeout=setTimeout((function(){analytics.sendEvent(self._clientPromise,\"custom.hosted-fields.load.timed-out\"),self._emit(\"timeout\")}),INTEGRATION_TIMEOUT_MS),Promise.all(frameReadyPromises).then((function(results){var formattedConfig,reply=results[0];clearTimeout(failureTimeout),reply(((formattedConfig=assign({},self._merchantConfigurationOptions)).fields=assign({},formattedConfig.fields),Object.keys(formattedConfig.fields).forEach((function(field){formattedConfig.fields[field]=assign({},formattedConfig.fields[field]),delete formattedConfig.fields[field].container})),formattedConfig)),self._cleanUpFocusIntercepts(),self._emit(\"ready\")})),this._bus.on(events.FRAME_READY,(function(data,reply){frameReadyPromiseResolveFunctions[data.field](reply)})),this._bus.on(events.INPUT_EVENT,function(fields){return function(eventData){var field,merchantPayload=eventData.merchantPayload,emittedBy=merchantPayload.emittedBy,container=fields[emittedBy].containerElement;Object.keys(merchantPayload.fields).forEach((function(key){merchantPayload.fields[key].container=fields[key].containerElement})),field=merchantPayload.fields[emittedBy],\"blur\"===eventData.type&&function(container){var hiddenInput;browserDetection.isIos()&&document.activeElement===document.body&&((hiddenInput=container.querySelector(\"input\"))||((hiddenInput=document.createElement(\"input\")).type=\"button\",hiddenInput.style.height=\"0px\",hiddenInput.style.width=\"0px\",hiddenInput.style.opacity=\"0\",hiddenInput.style.padding=\"0\",hiddenInput.style.position=\"absolute\",hiddenInput.style.left=\"-200%\",hiddenInput.style.top=\"0px\",container.insertBefore(hiddenInput,container.firstChild)),hiddenInput.focus(),hiddenInput.blur())}(container),classList.toggle(container,constants.externalClasses.FOCUSED,field.isFocused),classList.toggle(container,constants.externalClasses.VALID,field.isValid),classList.toggle(container,constants.externalClasses.INVALID,!field.isPotentiallyValid),this._state={cards:merchantPayload.cards,fields:merchantPayload.fields},this._emit(eventData.type,merchantPayload)}}(fields).bind(this)),browserDetection.isIos()&&this._bus.on(events.TRIGGER_INPUT_FOCUS,(function(fieldName){var container=fields[fieldName].containerElement;setTimeout((function(){var boundingBox,verticalMidpoint,horizontalMidpoint;boundingBox=container.getBoundingClientRect(),verticalMidpoint=Math.floor(boundingBox.height/2),horizontalMidpoint=Math.floor(boundingBox.width/2),boundingBox.top<(global.innerHeight-verticalMidpoint||document.documentElement.clientHeight-verticalMidpoint)&&boundingBox.right>horizontalMidpoint&&boundingBox.bottom>verticalMidpoint&&boundingBox.left<(global.innerWidth-horizontalMidpoint||document.documentElement.clientWidth-horizontalMidpoint)||container.scrollIntoView()}),5)})),this._destructor.registerFunctionForTeardown((function(){var j,node,parent;for(j=0;j<self._injectedNodes.length;j++)(parent=(node=self._injectedNodes[j]).parentNode).removeChild(node),classList.remove(parent,constants.externalClasses.FOCUSED,constants.externalClasses.INVALID,constants.externalClasses.VALID)})),this._destructor.registerFunctionForTeardown((function(){destroyFocusIntercept()})),this._destructor.registerFunctionForTeardown((function(){var methodNames=methods(HostedFields.prototype).concat(methods(EventEmitter.prototype));convertMethodsToError(self,methodNames)}))}EventEmitter.createChild(HostedFields),HostedFields.prototype._setupLabelFocus=function(type,container){var labels,i,shouldSkipLabelFocus=browserDetection.isIos(),bus=this._bus;if(!shouldSkipLabelFocus&&null!=container.id){for(labels=(labels=Array.prototype.slice.call(document.querySelectorAll('label[for=\"'+container.id+'\"]'))).concat(findParentTags(container,\"label\")),i=0;i<labels.length;i++)labels[i].addEventListener(\"click\",triggerFocus,!1);this._destructor.registerFunctionForTeardown((function(){for(i=0;i<labels.length;i++)labels[i].removeEventListener(\"click\",triggerFocus,!1)}))}function triggerFocus(){bus.emit(events.TRIGGER_INPUT_FOCUS,type)}},HostedFields.prototype._getAnyFieldContainer=function(){var self=this;return Object.keys(this._fields).reduce((function(found,field){return found||self._fields[field].containerElement}),null)},HostedFields.prototype._cleanUpFocusIntercepts=function(){var iframeContainer,checkoutForm;document.forms.length<1?this._bus.emit(events.REMOVE_FOCUS_INTERCEPTS):(iframeContainer=this._getAnyFieldContainer(),(checkoutForm=findParentTags(iframeContainer,\"form\")[0])?focusChange.removeExtraFocusElements(checkoutForm,(function(id){this._bus.emit(events.REMOVE_FOCUS_INTERCEPTS,id)}).bind(this)):this._bus.emit(events.REMOVE_FOCUS_INTERCEPTS))},HostedFields.prototype._attachInvalidFieldContainersToError=function(err){err.details&&err.details.invalidFieldKeys&&err.details.invalidFieldKeys.length>0&&(err.details.invalidFields={},err.details.invalidFieldKeys.forEach((function(field){err.details.invalidFields[field]=this._fields[field].containerElement}).bind(this)))},HostedFields.prototype.getChallenges=function(){return this._clientPromise.then((function(client){return client.getConfiguration().gatewayConfiguration.challenges}))},HostedFields.prototype.getSupportedCardTypes=function(){return this._clientPromise.then((function(client){return client.getConfiguration().gatewayConfiguration.creditCards.supportedCardTypes.map((function(cardType){return\"MasterCard\"===cardType?\"Mastercard\":cardType}))}))},HostedFields.prototype.teardown=function(){var self=this;return new Promise((function(resolve,reject){self._destructor.teardown((function(err){analytics.sendEvent(self._clientPromise,\"custom.hosted-fields.teardown-completed\"),err?reject(err):resolve()}))}))},HostedFields.prototype.tokenize=function(options){var self=this;return options||(options={}),new Promise((function(resolve,reject){self._bus.emit(events.TOKENIZATION_REQUEST,options,(function(response){var err=response[0],payload=response[1];err?(self._attachInvalidFieldContainersToError(err),reject(new BraintreeError(err))):resolve(payload)}))}))},HostedFields.prototype.addClass=function(field,classname){var err;return allowedFields.hasOwnProperty(field)?this._fields.hasOwnProperty(field)?this._bus.emit(events.ADD_CLASS,field,classname):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot add class to \"'+field+'\" field because it is not part of the current Hosted Fields options.'}):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'\"'+field+'\" is not a valid field. You must use a valid field option when adding a class.'}),err?Promise.reject(err):Promise.resolve()},HostedFields.prototype.removeClass=function(field,classname){var err;return allowedFields.hasOwnProperty(field)?this._fields.hasOwnProperty(field)?this._bus.emit(events.REMOVE_CLASS,field,classname):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove class from \"'+field+'\" field because it is not part of the current Hosted Fields options.'}):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'\"'+field+'\" is not a valid field. You must use a valid field option when removing a class.'}),err?Promise.reject(err):Promise.resolve()},HostedFields.prototype.setAttribute=function(options){var attributeErr,err;return allowedFields.hasOwnProperty(options.field)?this._fields.hasOwnProperty(options.field)?(attributeErr=attributeValidationError(options.attribute,options.value))?err=attributeErr:this._bus.emit(events.SET_ATTRIBUTE,options.field,options.attribute,options.value):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot set attribute for \"'+options.field+'\" field because it is not part of the current Hosted Fields options.'}):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'\"'+options.field+'\" is not a valid field. You must use a valid field option when setting an attribute.'}),err?Promise.reject(err):Promise.resolve()},HostedFields.prototype.setMonthOptions=function(options){var errorMessage,self=this,merchantOptions=this._merchantConfigurationOptions.fields;return merchantOptions.expirationMonth?merchantOptions.expirationMonth.select||(errorMessage=\"Expiration month field must be a select element.\"):errorMessage=\"Expiration month field must exist to use setMonthOptions.\",errorMessage?Promise.reject(new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:errorMessage})):new Promise((function(resolve){self._bus.emit(events.SET_MONTH_OPTIONS,options,resolve)}))},HostedFields.prototype.setMessage=function(options){this._bus.emit(events.SET_MESSAGE,options.field,options.message)},HostedFields.prototype.removeAttribute=function(options){var attributeErr,err;return allowedFields.hasOwnProperty(options.field)?this._fields.hasOwnProperty(options.field)?(attributeErr=attributeValidationError(options.attribute))?err=attributeErr:this._bus.emit(events.REMOVE_ATTRIBUTE,options.field,options.attribute):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove attribute for \"'+options.field+'\" field because it is not part of the current Hosted Fields options.'}):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'\"'+options.field+'\" is not a valid field. You must use a valid field option when removing an attribute.'}),err?Promise.reject(err):Promise.resolve()},HostedFields.prototype.setPlaceholder=function(field,placeholder){return this.setAttribute({field:field,attribute:\"placeholder\",value:placeholder})},HostedFields.prototype.clear=function(field){var err;return allowedFields.hasOwnProperty(field)?this._fields.hasOwnProperty(field)?this._bus.emit(events.CLEAR_FIELD,field):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot clear \"'+field+'\" field because it is not part of the current Hosted Fields options.'}):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'\"'+field+'\" is not a valid field. You must use a valid field option when clearing a field.'}),err?Promise.reject(err):Promise.resolve()},HostedFields.prototype.focus=function(field){var err;return allowedFields.hasOwnProperty(field)?this._fields.hasOwnProperty(field)?this._bus.emit(events.TRIGGER_INPUT_FOCUS,field):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:errors.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot focus \"'+field+'\" field because it is not part of the current Hosted Fields options.'}):err=new BraintreeError({type:errors.HOSTED_FIELDS_FIELD_INVALID.type,code:errors.HOSTED_FIELDS_FIELD_INVALID.code,message:'\"'+field+'\" is not a valid field. You must use a valid field option when focusing a field.'}),err?Promise.reject(err):Promise.resolve()},HostedFields.prototype.getState=function(){return this._state},module.exports=wrapPromise.wrapPrototype(HostedFields)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../lib/analytics\":93,\"../../lib/assign\":95,\"../../lib/braintree-error\":98,\"../../lib/bus\":101,\"../../lib/constants\":103,\"../../lib/convert-methods-to-error\":104,\"../../lib/create-assets-url\":106,\"../../lib/create-deferred-client\":108,\"../../lib/destructor\":110,\"../../lib/errors\":112,\"../../lib/methods\":130,\"../../lib/promise\":132,\"../../lib/vendor/uuid\":136,\"../shared/browser-detection\":85,\"../shared/constants\":86,\"../shared/errors\":87,\"../shared/find-parent-tags\":88,\"../shared/focus-intercept\":89,\"../shared/get-card-types\":90,\"./attribute-validation-error\":78,\"./compose-url\":79,\"./focus-change\":80,\"./get-styles-from-class\":81,\"./inject-frame\":83,\"@braintree/class-list\":20,\"@braintree/event-emitter\":21,\"@braintree/iframer\":23,\"@braintree/wrap-promise\":30}],83:[function(_dereq_,module,exports){\"use strict\";var focusIntercept=_dereq_(\"../shared/focus-intercept\"),directions=_dereq_(\"../shared/constants\").navigationDirections;module.exports=function(frame,container,focusHandler){var frameType=frame.getAttribute(\"type\"),clearboth=document.createElement(\"div\"),fragment=document.createDocumentFragment(),focusInterceptBefore=focusIntercept.generate(frameType,directions.BACK,focusHandler),focusInterceptAfter=focusIntercept.generate(frameType,directions.FORWARD,focusHandler);return clearboth.style.clear=\"both\",fragment.appendChild(focusInterceptBefore),fragment.appendChild(frame),fragment.appendChild(focusInterceptAfter),fragment.appendChild(clearboth),container.appendChild(fragment),[frame,clearboth]}},{\"../shared/constants\":86,\"../shared/focus-intercept\":89}],84:[function(_dereq_,module,exports){\"use strict\";var HostedFields=_dereq_(\"./external/hosted-fields\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),errors=_dereq_(\"./shared/errors\"),supportsInputFormatting=_dereq_(\"restricted-input/supports-input-formatting\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),Promise=_dereq_(\"../lib/promise\");module.exports={supportsInputFormatting:supportsInputFormatting,create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"Hosted Fields\",authorization:options.authorization,client:options.client}).then((function(){var integration=new HostedFields(options);return new Promise((function(resolve,reject){integration.on(\"ready\",(function(){resolve(integration)})),integration.on(\"timeout\",(function(){reject(new BraintreeError(errors.HOSTED_FIELDS_TIMEOUT))}))}))}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/promise\":132,\"./external/hosted-fields\":82,\"./shared/errors\":87,\"@braintree/wrap-promise\":30,\"restricted-input/supports-input-formatting\":41}],85:[function(_dereq_,module,exports){\"use strict\";var isAndroid=_dereq_(\"@braintree/browser-detection/is-android\"),isChromeOS=_dereq_(\"@braintree/browser-detection/is-chrome-os\"),isIos=_dereq_(\"@braintree/browser-detection/is-ios\");module.exports={isIE:_dereq_(\"@braintree/browser-detection/is-ie\"),isEdge:_dereq_(\"@braintree/browser-detection/is-edge\"),isIe9:_dereq_(\"@braintree/browser-detection/is-ie9\"),isIe10:_dereq_(\"@braintree/browser-detection/is-ie10\"),isAndroid:isAndroid,isChromeOS:isChromeOS,isFirefox:_dereq_(\"@braintree/browser-detection/is-firefox\"),isIos:isIos,isIosWebview:_dereq_(\"@braintree/browser-detection/is-ios-webview\"),hasSoftwareKeyboard:function(){return isAndroid()||isChromeOS()||isIos()}}},{\"@braintree/browser-detection/is-android\":3,\"@braintree/browser-detection/is-chrome-os\":4,\"@braintree/browser-detection/is-edge\":6,\"@braintree/browser-detection/is-firefox\":7,\"@braintree/browser-detection/is-ie\":8,\"@braintree/browser-detection/is-ie10\":9,\"@braintree/browser-detection/is-ie9\":11,\"@braintree/browser-detection/is-ios\":16,\"@braintree/browser-detection/is-ios-webview\":14}],86:[function(_dereq_,module,exports){\"use strict\";var enumerate=_dereq_(\"../../lib/enumerate\"),errors=_dereq_(\"./errors\"),constants={VERSION:\"3.60.0\",maxExpirationYearAge:19,externalEvents:{FOCUS:\"focus\",BLUR:\"blur\",EMPTY:\"empty\",NOT_EMPTY:\"notEmpty\",VALIDITY_CHANGE:\"validityChange\",CARD_TYPE_CHANGE:\"cardTypeChange\"},defaultMaxLengths:{number:19,postalCode:8,expirationDate:7,expirationMonth:2,expirationYear:4,cvv:3},externalClasses:{FOCUSED:\"braintree-hosted-fields-focused\",INVALID:\"braintree-hosted-fields-invalid\",VALID:\"braintree-hosted-fields-valid\"},navigationDirections:{BACK:\"before\",FORWARD:\"after\"},defaultIFrameStyle:{border:\"none\",width:\"100%\",height:\"100%\",float:\"left\"},tokenizationErrorCodes:{81724:errors.HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE,81736:errors.HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED},allowedStyles:[\"-moz-appearance\",\"-moz-osx-font-smoothing\",\"-moz-tap-highlight-color\",\"-moz-transition\",\"-webkit-appearance\",\"-webkit-font-smoothing\",\"-webkit-tap-highlight-color\",\"-webkit-transition\",\"appearance\",\"color\",\"direction\",\"font\",\"font-family\",\"font-size\",\"font-size-adjust\",\"font-stretch\",\"font-style\",\"font-variant\",\"font-variant-alternates\",\"font-variant-caps\",\"font-variant-east-asian\",\"font-variant-ligatures\",\"font-variant-numeric\",\"font-weight\",\"letter-spacing\",\"line-height\",\"margin\",\"opacity\",\"outline\",\"padding\",\"text-shadow\",\"transition\"],allowedFields:{number:{name:\"credit-card-number\",label:\"Credit Card Number\"},cvv:{name:\"cvv\",label:\"CVV\"},expirationDate:{name:\"expiration\",label:\"Expiration Date\"},expirationMonth:{name:\"expiration-month\",label:\"Expiration Month\"},expirationYear:{name:\"expiration-year\",label:\"Expiration Year\"},postalCode:{name:\"postal-code\",label:\"Postal Code\"}},allowedAttributes:{\"aria-invalid\":\"boolean\",\"aria-required\":\"boolean\",disabled:\"boolean\",placeholder:\"string\"},autocompleteMappings:{\"credit-card-number\":\"cc-number\",expiration:\"cc-exp\",\"expiration-month\":\"cc-exp-month\",\"expiration-year\":\"cc-exp-year\",cvv:\"cc-csc\",\"postal-code\":\"billing postal-code\"}};constants.events=enumerate([\"ADD_CLASS\",\"AUTOFILL_EXPIRATION_DATE\",\"BIN_AVAILABLE\",\"CARD_FORM_ENTRY_HAS_BEGUN\",\"CLEAR_FIELD\",\"CONFIGURATION\",\"FRAME_READY\",\"INPUT_EVENT\",\"READY_FOR_CLIENT\",\"REMOVE_ATTRIBUTE\",\"REMOVE_CLASS\",\"REMOVE_FOCUS_INTERCEPTS\",\"SET_ATTRIBUTE\",\"SET_MESSAGE\",\"SET_MONTH_OPTIONS\",\"TOKENIZATION_REQUEST\",\"TRIGGER_FOCUS_CHANGE\",\"TRIGGER_INPUT_FOCUS\",\"VALIDATE_STRICT\"],\"hosted-fields:\"),module.exports=constants},{\"../../lib/enumerate\":111,\"./errors\":87}],87:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={HOSTED_FIELDS_TIMEOUT:{type:BraintreeError.types.UNKNOWN,code:\"HOSTED_FIELDS_TIMEOUT\",message:\"Hosted Fields timed out when attempting to set up.\"},HOSTED_FIELDS_INVALID_FIELD_KEY:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_INVALID_FIELD_KEY\"},HOSTED_FIELDS_INVALID_FIELD_SELECTOR:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_INVALID_FIELD_SELECTOR\",message:\"Selector does not reference a valid DOM node.\"},HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME\",message:\"Element already contains a Braintree iframe.\"},HOSTED_FIELDS_FIELD_INVALID:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_FIELD_INVALID\"},HOSTED_FIELDS_FIELD_NOT_PRESENT:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_FIELD_NOT_PRESENT\"},HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR:{type:BraintreeError.types.NETWORK,code:\"HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR\",message:\"A tokenization network error occurred.\"},HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE:{type:BraintreeError.types.CUSTOMER,code:\"HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE\",message:\"This credit card already exists in the merchant's vault.\"},HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED:{type:BraintreeError.types.CUSTOMER,code:\"HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED\",message:\"CVV verification failed during tokenization.\"},HOSTED_FIELDS_FAILED_TOKENIZATION:{type:BraintreeError.types.CUSTOMER,code:\"HOSTED_FIELDS_FAILED_TOKENIZATION\",message:\"The supplied card data failed tokenization.\"},HOSTED_FIELDS_FIELDS_EMPTY:{type:BraintreeError.types.CUSTOMER,code:\"HOSTED_FIELDS_FIELDS_EMPTY\",message:\"All fields are empty. Cannot tokenize empty card fields.\"},HOSTED_FIELDS_FIELDS_INVALID:{type:BraintreeError.types.CUSTOMER,code:\"HOSTED_FIELDS_FIELDS_INVALID\",message:\"Some payment input fields are invalid. Cannot tokenize invalid card fields.\"},HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED\"},HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED\"},HOSTED_FIELDS_FIELD_PROPERTY_INVALID:{type:BraintreeError.types.MERCHANT,code:\"HOSTED_FIELDS_FIELD_PROPERTY_INVALID\"}}},{\"../../lib/braintree-error\":98}],88:[function(_dereq_,module,exports){\"use strict\";module.exports=function(element,tag){for(var parent=element.parentNode,parents=[];null!=parent;)null!=parent.tagName&&parent.tagName.toLowerCase()===tag&&parents.push(parent),parent=parent.parentNode;return parents}},{}],89:[function(_dereq_,module,exports){\"use strict\";var browserDetection=_dereq_(\"./browser-detection\"),classList=_dereq_(\"@braintree/class-list\"),constants=_dereq_(\"./constants\"),allowedFields=Object.keys(constants.allowedFields),directions=constants.navigationDirections,focusIntercept={generate:function(type,direction,handler){var input=document.createElement(\"input\");return browserDetection.hasSoftwareKeyboard()||browserDetection.isFirefox()||browserDetection.isIE()?(input.setAttribute(\"aria-hidden\",\"true\"),input.setAttribute(\"autocomplete\",\"off\"),input.setAttribute(\"data-braintree-direction\",direction),input.setAttribute(\"data-braintree-type\",type),input.setAttribute(\"id\",\"bt-\"+type+\"-\"+direction),input.setAttribute(\"style\",JSON.stringify({border:\"none !important\",display:\"block !important\",height:\"1px !important\",left:\"-1px !important\",opacity:\"0 !important\",position:\"absolute !important\",top:\"-1px !important\",width:\"1px !important\"}).replace(/[{}\"]/g,\"\").replace(/,/g,\";\")),classList.add(input,\"focus-intercept\"),input.addEventListener(\"focus\",(function(event){handler(event),browserDetection.hasSoftwareKeyboard()||input.blur()})),input):document.createDocumentFragment()},destroy:function(idString){var focusInputs;idString?focusInputs=[document.getElementById(idString)]:(focusInputs=document.querySelectorAll(\"[data-braintree-direction]\"),focusInputs=[].slice.call(focusInputs)),focusInputs.forEach((function(node){node&&1===node.nodeType&&focusIntercept.matchFocusElement(node.getAttribute(\"id\"))&&node.parentNode.removeChild(node)}))},matchFocusElement:function(idString){var idComponents,hasBTPrefix,isAllowedType;return!!idString&&3===(idComponents=idString.split(\"-\")).length&&(hasBTPrefix=\"bt\"===idComponents[0],isAllowedType=allowedFields.indexOf(idComponents[1])>-1,Boolean(hasBTPrefix&&isAllowedType&&(idComponents[2]===directions.BACK||idComponents[2]===directions.FORWARD)))}};module.exports=focusIntercept},{\"./browser-detection\":85,\"./constants\":86,\"@braintree/class-list\":20}],90:[function(_dereq_,module,exports){\"use strict\";var creditCardType=_dereq_(\"credit-card-type\");module.exports=function(number){var results=creditCardType(number);return results.forEach((function(card){\"mastercard\"===card.type&&(card.type=\"master-card\")})),results}},{\"credit-card-type\":31}],91:[function(_dereq_,module,exports){\"use strict\";var americanExpress=_dereq_(\"./american-express\"),applePay=_dereq_(\"./apple-pay\"),client=_dereq_(\"./client\"),dataCollector=_dereq_(\"./data-collector\"),hostedFields=_dereq_(\"./hosted-fields\"),localPayment=_dereq_(\"./local-payment\"),masterpass=_dereq_(\"./masterpass\"),paymentRequest=_dereq_(\"./payment-request\"),paypal=_dereq_(\"./paypal\"),paypalCheckout=_dereq_(\"./paypal-checkout\"),googlePayment=_dereq_(\"./google-payment\"),threeDSecure=_dereq_(\"./three-d-secure\"),unionpay=_dereq_(\"./unionpay\"),usBankAccount=_dereq_(\"./us-bank-account\"),vaultManager=_dereq_(\"./vault-manager\"),venmo=_dereq_(\"./venmo\"),visaCheckout=_dereq_(\"./visa-checkout\"),preferredPaymentMethods=_dereq_(\"./preferred-payment-methods\");module.exports={americanExpress:americanExpress,applePay:applePay,client:client,dataCollector:dataCollector,hostedFields:hostedFields,localPayment:localPayment,masterpass:masterpass,googlePayment:googlePayment,paymentRequest:paymentRequest,paypal:paypal,paypalCheckout:paypalCheckout,threeDSecure:threeDSecure,unionpay:unionpay,usBankAccount:usBankAccount,vaultManager:vaultManager,venmo:venmo,visaCheckout:visaCheckout,preferredPaymentMethods:preferredPaymentMethods,VERSION:\"3.60.0\"}},{\"./american-express\":44,\"./apple-pay\":47,\"./client\":53,\"./data-collector\":72,\"./google-payment\":77,\"./hosted-fields\":84,\"./local-payment\":139,\"./masterpass\":142,\"./payment-request\":147,\"./paypal\":154,\"./paypal-checkout\":151,\"./preferred-payment-methods\":157,\"./three-d-secure\":167,\"./unionpay\":171,\"./us-bank-account\":177,\"./vault-manager\":180,\"./venmo\":182,\"./visa-checkout\":189}],92:[function(_dereq_,module,exports){\"use strict\";var createAuthorizationData=_dereq_(\"./create-authorization-data\"),jsonClone=_dereq_(\"./json-clone\"),constants=_dereq_(\"./constants\");module.exports=function(configuration,data){var key,attrs=data?jsonClone(data):{},authAttrs=createAuthorizationData(configuration.authorization).attrs,_meta=jsonClone(configuration.analyticsMetadata);for(key in attrs.braintreeLibraryVersion=constants.BRAINTREE_LIBRARY_VERSION,attrs._meta)attrs._meta.hasOwnProperty(key)&&(_meta[key]=attrs._meta[key]);return attrs._meta=_meta,authAttrs.tokenizationKey?attrs.tokenizationKey=authAttrs.tokenizationKey:attrs.authorizationFingerprint=authAttrs.authorizationFingerprint,attrs}},{\"./constants\":103,\"./create-authorization-data\":107,\"./json-clone\":129}],93:[function(_dereq_,module,exports){\"use strict\";var Promise=_dereq_(\"./promise\"),constants=_dereq_(\"./constants\"),addMetadata=_dereq_(\"./add-metadata\");module.exports={sendEvent:function(clientInstanceOrPromise,kind,callback){var timestamp=Date.now();return Promise.resolve(clientInstanceOrPromise).then((function(client){var timestampInPromise=Date.now(),configuration=client.getConfiguration(),request=client._request,url=configuration.gatewayConfiguration.analytics.url,data={analytics:[{kind:constants.ANALYTICS_PREFIX+kind,isAsync:Math.floor(timestampInPromise/1e3)!==Math.floor(timestamp/1e3),timestamp:timestamp}]};request({url:url,method:\"post\",data:addMetadata(configuration,data),timeout:constants.ANALYTICS_REQUEST_TIMEOUT_MS},callback)}))}}},{\"./add-metadata\":92,\"./constants\":103,\"./promise\":132}],94:[function(_dereq_,module,exports){\"use strict\";var loadScript=_dereq_(\"@braintree/asset-loader/load-script\");module.exports={loadScript:loadScript}},{\"@braintree/asset-loader/load-script\":2}],95:[function(_dereq_,module,exports){\"use strict\";function assignPolyfill(destination){var i,source,key;for(i=1;i<arguments.length;i++)for(key in source=arguments[i])source.hasOwnProperty(key)&&(destination[key]=source[key]);return destination}module.exports={assign:\"function\"==typeof Object.assign?Object.assign:assignPolyfill,_assign:assignPolyfill}},{}],96:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"./braintree-error\"),Promise=_dereq_(\"./promise\"),sharedErrors=_dereq_(\"./errors\");module.exports={verify:function(options){var client,authorization,name;return options?(name=options.name,authorization=options.authorization,(client=options.client)||authorization?authorization||\"3.60.0\"===client.getVersion()?Promise.resolve():Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:\"Client (version \"+client.getVersion()+\") and \"+name+\" (version 3.60.0) components must be from the same SDK version.\"})):Promise.reject(new BraintreeError({type:sharedErrors.INSTANTIATION_OPTION_REQUIRED.type,code:sharedErrors.INSTANTIATION_OPTION_REQUIRED.code,message:\"options.client is required when instantiating \"+name+\".\"}))):Promise.reject(new BraintreeError({type:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:sharedErrors.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:\"Options must be passed to basicComponentVerification function.\"}))}}},{\"./braintree-error\":98,\"./errors\":112,\"./promise\":132}],97:[function(_dereq_,module,exports){\"use strict\";var once=_dereq_(\"./once\");function call(fn,callback){0===fn.length?(fn(),callback(null)):fn(callback)}module.exports=function(functions,cb){var i,length=functions.length,remaining=length,callback=once(cb);if(0!==length)for(i=0;i<length;i++)call(functions[i],finish);else callback(null);function finish(err){err?callback(err):0==(remaining-=1)&&callback(null)}}},{\"./once\":131}],98:[function(_dereq_,module,exports){\"use strict\";var enumerate=_dereq_(\"./enumerate\");function BraintreeError(options){if(!BraintreeError.types.hasOwnProperty(options.type))throw new Error(options.type+\" is not a valid type.\");if(!options.code)throw new Error(\"Error code required.\");if(!options.message)throw new Error(\"Error message required.\");this.name=\"BraintreeError\",this.code=options.code,this.message=options.message,this.type=options.type,this.details=options.details}(BraintreeError.prototype=Object.create(Error.prototype)).constructor=BraintreeError,BraintreeError.types=enumerate([\"CUSTOMER\",\"MERCHANT\",\"NETWORK\",\"INTERNAL\",\"UNKNOWN\"]),BraintreeError.findRootError=function(err){return err instanceof BraintreeError&&err.details&&err.details.originalError?BraintreeError.findRootError(err.details.originalError):err},module.exports=BraintreeError},{\"./enumerate\":111}],99:[function(_dereq_,module,exports){\"use strict\";var isVerifiedDomain=_dereq_(\"../is-verified-domain\");module.exports={checkOrigin:function(postMessageOrigin,merchantUrl){var merchantHost,a=document.createElement(\"a\");return a.href=merchantUrl,merchantHost=\"https:\"===a.protocol?a.host.replace(/:443$/,\"\"):\"http:\"===a.protocol?a.host.replace(/:80$/,\"\"):a.host,a.protocol+\"//\"+merchantHost===postMessageOrigin||(a.href=postMessageOrigin,isVerifiedDomain(postMessageOrigin))}}},{\"../is-verified-domain\":128}],100:[function(_dereq_,module,exports){\"use strict\";var enumerate=_dereq_(\"../enumerate\");module.exports=enumerate([\"CONFIGURATION_REQUEST\"],\"bus:\")},{\"../enumerate\":111}],101:[function(_dereq_,module,exports){\"use strict\";var bus=_dereq_(\"framebus\"),events=_dereq_(\"./events\"),checkOrigin=_dereq_(\"./check-origin\").checkOrigin,BraintreeError=_dereq_(\"../braintree-error\");function BraintreeBus(options){if(this.channel=(options=options||{}).channel,!this.channel)throw new BraintreeError({type:BraintreeError.types.INTERNAL,code:\"MISSING_CHANNEL_ID\",message:\"Channel ID must be specified.\"});this.merchantUrl=options.merchantUrl,this._isDestroyed=!1,this._isVerbose=!1,this._listeners=[],this._log(\"new bus on channel \"+this.channel,[location.href])}BraintreeBus.prototype.on=function(eventName,originalHandler){var namespacedEvent,args,handler=originalHandler,self=this;this._isDestroyed||(this.merchantUrl&&(handler=function(){checkOrigin(this.origin,self.merchantUrl)&&originalHandler.apply(this,arguments)}),namespacedEvent=this._namespaceEvent(eventName),(args=Array.prototype.slice.call(arguments))[0]=namespacedEvent,args[1]=handler,this._log(\"on\",args),bus.on.apply(bus,args),this._listeners.push({eventName:eventName,handler:handler,originalHandler:originalHandler}))},BraintreeBus.prototype.emit=function(eventName){var args;this._isDestroyed||((args=Array.prototype.slice.call(arguments))[0]=this._namespaceEvent(eventName),this._log(\"emit\",args),bus.emit.apply(bus,args))},BraintreeBus.prototype._offDirect=function(eventName){var args=Array.prototype.slice.call(arguments);this._isDestroyed||(args[0]=this._namespaceEvent(eventName),this._log(\"off\",args),bus.off.apply(bus,args))},BraintreeBus.prototype.off=function(eventName,originalHandler){var i,listener,handler=originalHandler;if(!this._isDestroyed){if(this.merchantUrl)for(i=0;i<this._listeners.length;i++)(listener=this._listeners[i]).originalHandler===originalHandler&&(handler=listener.handler);this._offDirect(eventName,handler)}},BraintreeBus.prototype._namespaceEvent=function(eventName){return[\"braintree\",this.channel,eventName].join(\":\")},BraintreeBus.prototype.teardown=function(){var listener,i;for(i=0;i<this._listeners.length;i++)this._offDirect((listener=this._listeners[i]).eventName,listener.handler);this._listeners.length=0,this._isDestroyed=!0},BraintreeBus.prototype._log=function(functionName,args){this._isVerbose&&console.log(functionName,args)},BraintreeBus.events=events,module.exports=BraintreeBus},{\"../braintree-error\":98,\"./check-origin\":99,\"./events\":100,framebus:38}],102:[function(_dereq_,module,exports){\"use strict\";module.exports=function(obj){return Object.keys(obj).reduce((function(newObj,key){return newObj[function(key){return key.replace(/([a-z\\d])([A-Z])/g,\"$1_$2\").replace(/([A-Z]+)([A-Z][a-z\\d]+)/g,\"$1_$2\").toLowerCase()}(key)]=obj[key],newObj}),{})}},{}],103:[function(_dereq_,module,exports){\"use strict\";module.exports={ANALYTICS_PREFIX:\"web.\",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:\"https://assets.braintreegateway.com\",sandbox:\"https://assets.braintreegateway.com\"},CLIENT_API_URLS:{production:\"https://api.braintreegateway.com:443\",sandbox:\"https://api.sandbox.braintreegateway.com:443\"},FRAUDNET_SOURCE:\"BRAINTREE_SIGNIN\",FRAUDNET_FNCLS:\"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99\",FRAUDNET_URL:\"https://c.paypal.com/da/r/fb.js\",GRAPHQL_URLS:{production:\"https://payments.braintree-api.com/graphql\",sandbox:\"https://payments.sandbox.braintree-api.com/graphql\"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:\"3.60.0\",INTEGRATION:\"custom\",SOURCE:\"client\",PLATFORM:\"web\",BRAINTREE_LIBRARY_VERSION:\"braintree/web/3.60.0\"}},{}],104:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"./braintree-error\"),sharedErrors=_dereq_(\"./errors\");module.exports=function(instance,methodNames){methodNames.forEach((function(methodName){instance[methodName]=function(){throw new BraintreeError({type:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.type,code:sharedErrors.METHOD_CALLED_AFTER_TEARDOWN.code,message:methodName+\" cannot be called after teardown.\"})}}))}},{\"./braintree-error\":98,\"./errors\":112}],105:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"./braintree-error\");module.exports=function(originalErr,btErrorObject){return originalErr instanceof BraintreeError?originalErr:new BraintreeError({type:btErrorObject.type,code:btErrorObject.code,message:btErrorObject.message,details:{originalError:originalErr}})}},{\"./braintree-error\":98}],106:[function(_dereq_,module,exports){\"use strict\";var ASSETS_URLS=_dereq_(\"./constants\").ASSETS_URLS;module.exports={create:function(authorization){return ASSETS_URLS.production}}},{\"./constants\":103}],107:[function(_dereq_,module,exports){\"use strict\";var atob=_dereq_(\"../lib/vendor/polyfill\").atob,CLIENT_API_URLS=_dereq_(\"../lib/constants\").CLIENT_API_URLS;module.exports=function(authorization){var parsedClientToken,parsedTokenizationKey,tokens,environment,data={attrs:{},configUrl:\"\"};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(authorization)?(environment=(tokens=authorization.split(\"_\"))[0],parsedTokenizationKey={merchantId:tokens.slice(2).join(\"_\"),environment:environment},data.environment=parsedTokenizationKey.environment,data.attrs.tokenizationKey=authorization,data.configUrl=CLIENT_API_URLS[parsedTokenizationKey.environment]+\"/merchants/\"+parsedTokenizationKey.merchantId+\"/client_api/v1/configuration\"):(parsedClientToken=JSON.parse(atob(authorization)),data.environment=parsedClientToken.environment,data.attrs.authorizationFingerprint=parsedClientToken.authorizationFingerprint,data.configUrl=parsedClientToken.configUrl,data.graphQL=parsedClientToken.graphQL),data}},{\"../lib/constants\":103,\"../lib/vendor/polyfill\":135}],108:[function(_dereq_,module,exports){(function(global){\"use strict\";var BraintreeError=_dereq_(\"./braintree-error\"),Promise=_dereq_(\"./promise\"),assets=_dereq_(\"./assets\"),sharedErrors=_dereq_(\"./errors\");module.exports={create:function(options){var promise=Promise.resolve();return options.client?Promise.resolve(options.client):(global.braintree&&global.braintree.client||(promise=assets.loadScript({src:options.assetsUrl+\"/web/3.60.0/js/client.min.js\"}).catch((function(err){return Promise.reject(new BraintreeError({type:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:sharedErrors.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:err}}))}))),promise.then((function(){return\"3.60.0\"!==global.braintree.client.VERSION?Promise.reject(new BraintreeError({type:sharedErrors.INCOMPATIBLE_VERSIONS.type,code:sharedErrors.INCOMPATIBLE_VERSIONS.code,message:\"Client (version \"+global.braintree.client.VERSION+\") and \"+options.name+\" (version 3.60.0) components must be from the same SDK version.\"})):global.braintree.client.create({authorization:options.authorization,debug:options.debug})})))}}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./assets\":94,\"./braintree-error\":98,\"./errors\":112,\"./promise\":132}],109:[function(_dereq_,module,exports){\"use strict\";module.exports=function(fn){return function(){var args=arguments;setTimeout((function(){fn.apply(null,args)}),1)}}},{}],110:[function(_dereq_,module,exports){\"use strict\";var batchExecuteFunctions=_dereq_(\"./batch-execute-functions\");function Destructor(){this._teardownRegistry=[],this._isTearingDown=!1}Destructor.prototype.registerFunctionForTeardown=function(fn){\"function\"==typeof fn&&this._teardownRegistry.push(fn)},Destructor.prototype.teardown=function(callback){this._isTearingDown?callback(new Error(\"Destructor is already tearing down\")):(this._isTearingDown=!0,batchExecuteFunctions(this._teardownRegistry,(function(err){this._teardownRegistry=[],this._isTearingDown=!1,\"function\"==typeof callback&&callback(err)}).bind(this)))},module.exports=Destructor},{\"./batch-execute-functions\":97}],111:[function(_dereq_,module,exports){\"use strict\";module.exports=function(values,prefix){return prefix=null==prefix?\"\":prefix,values.reduce((function(enumeration,value){return enumeration[value]=prefix+value,enumeration}),{})}},{}],112:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"./braintree-error\");module.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:BraintreeError.types.INTERNAL,code:\"INVALID_USE_OF_INTERNAL_FUNCTION\"},INSTANTIATION_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"INSTANTIATION_OPTION_REQUIRED\"},INCOMPATIBLE_VERSIONS:{type:BraintreeError.types.MERCHANT,code:\"INCOMPATIBLE_VERSIONS\"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:BraintreeError.types.NETWORK,code:\"CLIENT_SCRIPT_FAILED_TO_LOAD\",message:\"Braintree client script could not be loaded.\"},METHOD_CALLED_AFTER_TEARDOWN:{type:BraintreeError.types.MERCHANT,code:\"METHOD_CALLED_AFTER_TEARDOWN\"}}},{\"./braintree-error\":98}],113:[function(_dereq_,module,exports){\"use strict\";module.exports=function(array,key,value){var i;for(i=0;i<array.length;i++)if(array[i].hasOwnProperty(key)&&array[i][key]===value)return array[i];return null}},{}],114:[function(_dereq_,module,exports){(function(global){\"use strict\";var Popup=_dereq_(\"./strategies/popup\"),PopupBridge=_dereq_(\"./strategies/popup-bridge\"),Modal=_dereq_(\"./strategies/modal\"),Bus=_dereq_(\"../../bus\"),events=_dereq_(\"../shared/events\"),errors=_dereq_(\"../shared/errors\"),constants=_dereq_(\"../shared/constants\"),uuid=_dereq_(\"../../vendor/uuid\"),iFramer=_dereq_(\"@braintree/iframer\"),BraintreeError=_dereq_(\"../../braintree-error\"),browserDetection=_dereq_(\"../shared/browser-detection\"),isHTTPS=_dereq_(\"../../is-https\"),assign=_dereq_(\"./../../assign\").assign,REQUIRED_CONFIG_KEYS=[\"name\",\"dispatchFrameUrl\",\"openFrameUrl\"];function noop(){}function FrameService(options){!function(options){if(!options)throw new Error(\"Valid configuration is required\");if(REQUIRED_CONFIG_KEYS.forEach((function(key){if(!options.hasOwnProperty(key))throw new Error(\"A valid frame \"+key+\" must be provided\")})),!/^[\\w_]+$/.test(options.name))throw new Error(\"A valid frame name must be provided\")}(options),this._serviceId=uuid().replace(/-/g,\"\"),this._options={name:options.name+\"_\"+this._serviceId,dispatchFrameUrl:options.dispatchFrameUrl,openFrameUrl:options.openFrameUrl,height:options.height,width:options.width,top:options.top,left:options.left},this.state=options.state||{},this._bus=new Bus({channel:this._serviceId}),this._setBusEvents()}FrameService.prototype.initialize=function(callback){var dispatchFrameReadyHandler=(function(){callback(),this._bus.off(events.DISPATCH_FRAME_READY,dispatchFrameReadyHandler)}).bind(this);this._bus.on(events.DISPATCH_FRAME_READY,dispatchFrameReadyHandler),this._writeDispatchFrame()},FrameService.prototype._writeDispatchFrame=function(){var frameName=constants.DISPATCH_FRAME_NAME+\"_\"+this._serviceId;this._dispatchFrame=iFramer({\"aria-hidden\":!0,name:frameName,title:frameName,src:this._options.dispatchFrameUrl,class:constants.DISPATCH_FRAME_CLASS,height:0,width:0,style:{position:\"absolute\",left:\"-9999px\"}}),document.body.appendChild(this._dispatchFrame)},FrameService.prototype._setBusEvents=function(){this._bus.on(events.DISPATCH_FRAME_REPORT,(function(res,reply){this._onCompleteCallback&&this._onCompleteCallback.call(null,res.err,res.payload),this._frame.close(),this._onCompleteCallback=null,reply&&reply()}).bind(this)),this._bus.on(Bus.events.CONFIGURATION_REQUEST,(function(reply){reply(this.state)}).bind(this))},FrameService.prototype.open=function(options,callback){if(this._frame=this._getFrameForEnvironment(options=options||{}),this._frame.initialize(callback),!(this._frame instanceof PopupBridge)){if(assign(this.state,options.state),this._onCompleteCallback=callback,this._frame.open(),this.isFrameClosed())return this._cleanupFrame(),void(callback&&callback(browserDetection.isIE()&&!isHTTPS.isHTTPS()?new BraintreeError(errors.FRAME_SERVICE_FRAME_OPEN_FAILED_IE_BUG):new BraintreeError(errors.FRAME_SERVICE_FRAME_OPEN_FAILED)));this._pollForPopupClose()}},FrameService.prototype.redirect=function(url){this._frame&&!this.isFrameClosed()&&this._frame.redirect(url)},FrameService.prototype.close=function(){this.isFrameClosed()||this._frame.close()},FrameService.prototype.focus=function(){this.isFrameClosed()||this._frame.focus()},FrameService.prototype.createHandler=function(options){return options=options||{},{close:(function(){options.beforeClose&&options.beforeClose(),this.close()}).bind(this),focus:(function(){options.beforeFocus&&options.beforeFocus(),this.focus()}).bind(this)}},FrameService.prototype.createNoopHandler=function(){return{close:noop,focus:noop}},FrameService.prototype.teardown=function(){this.close(),this._dispatchFrame.parentNode.removeChild(this._dispatchFrame),this._dispatchFrame=null,this._cleanupFrame()},FrameService.prototype.isFrameClosed=function(){return null==this._frame||this._frame.isClosed()},FrameService.prototype._cleanupFrame=function(){this._frame=null,clearInterval(this._popupInterval),this._popupInterval=null},FrameService.prototype._pollForPopupClose=function(){return this._popupInterval=setInterval((function(){this.isFrameClosed()&&(this._cleanupFrame(),this._onCompleteCallback&&this._onCompleteCallback(new BraintreeError(errors.FRAME_SERVICE_FRAME_CLOSED)))}).bind(this),constants.POPUP_POLL_INTERVAL),this._popupInterval},FrameService.prototype._getFrameForEnvironment=function(options){var usePopup=browserDetection.supportsPopups(),popupBridgeExists=Boolean(global.popupBridge),initOptions=assign({},this._options,options);return popupBridgeExists?new PopupBridge(initOptions):usePopup?new Popup(initOptions):new Modal(initOptions)},module.exports=FrameService}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../braintree-error\":98,\"../../bus\":101,\"../../is-https\":127,\"../../vendor/uuid\":136,\"../shared/browser-detection\":121,\"../shared/constants\":122,\"../shared/errors\":123,\"../shared/events\":124,\"./../../assign\":95,\"./strategies/modal\":116,\"./strategies/popup\":119,\"./strategies/popup-bridge\":117,\"@braintree/iframer\":23}],115:[function(_dereq_,module,exports){\"use strict\";var FrameService=_dereq_(\"./frame-service\");module.exports={create:function(options,callback){var frameService=new FrameService(options);frameService.initialize((function(){callback(frameService)}))}}},{\"./frame-service\":114}],116:[function(_dereq_,module,exports){(function(global){\"use strict\";var iFramer=_dereq_(\"@braintree/iframer\"),assign=_dereq_(\"../../../assign\").assign,browserDetection=_dereq_(\"../../shared/browser-detection\"),ELEMENT_STYLES={position:\"fixed\",top:0,left:0,bottom:0,padding:0,margin:0,border:0,outline:\"none\",zIndex:20001,background:\"#FFFFFF\"};function noop(){}function Modal(options){this._closed=null,this._frame=null,this._options=options||{},this._container=this._options.container||document.body}Modal.prototype.initialize=noop,Modal.prototype.open=function(){var iframerConfig={src:this._options.openFrameUrl,name:this._options.name,scrolling:\"yes\",height:\"100%\",width:\"100%\",style:assign({},ELEMENT_STYLES),title:\"Lightbox Frame\"};browserDetection.isIos()?(browserDetection.isIosWKWebview()&&(this._lockScrolling(),iframerConfig.style={}),this._el=document.createElement(\"div\"),assign(this._el.style,ELEMENT_STYLES,{height:\"100%\",width:\"100%\",overflow:\"auto\",\"-webkit-overflow-scrolling\":\"touch\"}),this._frame=iFramer(iframerConfig),this._el.appendChild(this._frame)):this._el=this._frame=iFramer(iframerConfig),this._closed=!1,this._container.appendChild(this._el)},Modal.prototype.focus=noop,Modal.prototype.close=function(){this._container.removeChild(this._el),this._frame=null,this._closed=!0,browserDetection.isIosWKWebview()&&this._unlockScrolling()},Modal.prototype.isClosed=function(){return Boolean(this._closed)},Modal.prototype.redirect=function(redirectUrl){this._frame.src=redirectUrl},Modal.prototype._unlockScrolling=function(){document.body.style.overflow=this._savedBodyProperties.overflowStyle,document.body.style.position=this._savedBodyProperties.positionStyle,global.scrollTo(this._savedBodyProperties.left,this._savedBodyProperties.top),delete this._savedBodyProperties},Modal.prototype._lockScrolling=function(){var doc=document.documentElement;this._savedBodyProperties={left:(global.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0),top:(global.pageYOffset||doc.scrollTop)-(doc.clientTop||0),overflowStyle:document.body.style.overflow,positionStyle:document.body.style.position},document.body.style.overflow=\"hidden\",document.body.style.position=\"fixed\",global.scrollTo(0,0)},module.exports=Modal}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../../assign\":95,\"../../shared/browser-detection\":121,\"@braintree/iframer\":23}],117:[function(_dereq_,module,exports){(function(global){\"use strict\";var BraintreeError=_dereq_(\"../../../braintree-error\"),errors=_dereq_(\"../../shared/errors\");function noop(){}function PopupBridge(options){this._closed=null,this._options=options}PopupBridge.prototype.initialize=function(callback){var self=this;global.popupBridge.onComplete=function(err,payload){var popupDismissed=!payload&&!err;self._closed=!0,err||popupDismissed?callback(new BraintreeError(errors.FRAME_SERVICE_FRAME_CLOSED)):callback(null,payload)}},PopupBridge.prototype.open=function(options){var url;url=(options=options||{}).openFrameUrl||this._options.openFrameUrl,this._closed=!1,global.popupBridge.open(url)},PopupBridge.prototype.focus=noop,PopupBridge.prototype.close=noop,PopupBridge.prototype.isClosed=function(){return Boolean(this._closed)},PopupBridge.prototype.redirect=function(redirectUrl){this.open({openFrameUrl:redirectUrl})},module.exports=PopupBridge}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../../braintree-error\":98,\"../../shared/errors\":123}],118:[function(_dereq_,module,exports){\"use strict\";var constants=_dereq_(\"../../../shared/constants\"),position=_dereq_(\"./position\");function calculatePosition(type,userDefinedPosition,size){return void 0!==userDefinedPosition?userDefinedPosition:position[type](size)}module.exports=function(options){var height=options.height||constants.DEFAULT_POPUP_HEIGHT,width=options.width||constants.DEFAULT_POPUP_WIDTH,top=calculatePosition(\"top\",options.top,height),left=calculatePosition(\"left\",options.left,width);return[constants.POPUP_BASE_OPTIONS,\"height=\"+height,\"width=\"+width,\"top=\"+top,\"left=\"+left].join(\",\")}},{\"../../../shared/constants\":122,\"./position\":120}],119:[function(_dereq_,module,exports){(function(global){\"use strict\";var composeOptions=_dereq_(\"./compose-options\");function Popup(options){this._frame=null,this._options=options||{},this.open()}Popup.prototype.initialize=function(){},Popup.prototype.open=function(){this._frame=global.open(this._options.openFrameUrl,this._options.name,composeOptions(this._options))},Popup.prototype.focus=function(){this._frame.focus()},Popup.prototype.close=function(){this._frame.closed||this._frame.close()},Popup.prototype.isClosed=function(){return!this._frame||Boolean(this._frame.closed)},Popup.prototype.redirect=function(redirectUrl){this._frame.location.href=redirectUrl},module.exports=Popup}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"./compose-options\":118}],120:[function(_dereq_,module,exports){(function(global){\"use strict\";function center(windowMetric,popupMetric,offset){return(windowMetric-popupMetric)/2+offset}module.exports={top:function(height){return center(global.outerHeight||document.documentElement.clientHeight,height,null==global.screenY?global.screenTop:global.screenY)},left:function(width){return center(global.outerWidth||document.documentElement.clientWidth,width,null==global.screenX?global.screenLeft:global.screenX)},center:center}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],121:[function(_dereq_,module,exports){\"use strict\";module.exports={isIos:_dereq_(\"@braintree/browser-detection/is-ios\"),isIosWKWebview:_dereq_(\"@braintree/browser-detection/is-ios-wkwebview\"),isIE:_dereq_(\"@braintree/browser-detection/is-ie\"),supportsPopups:_dereq_(\"@braintree/browser-detection/supports-popups\")}},{\"@braintree/browser-detection/is-ie\":8,\"@braintree/browser-detection/is-ios\":16,\"@braintree/browser-detection/is-ios-wkwebview\":15,\"@braintree/browser-detection/supports-popups\":19}],122:[function(_dereq_,module,exports){\"use strict\";module.exports={DISPATCH_FRAME_NAME:\"dispatch\",DISPATCH_FRAME_CLASS:\"braintree-dispatch-frame\",POPUP_BASE_OPTIONS:\"resizable,scrollbars\",DEFAULT_POPUP_WIDTH:450,DEFAULT_POPUP_HEIGHT:535,POPUP_POLL_INTERVAL:100,POPUP_CLOSE_TIMEOUT:100}},{}],123:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../braintree-error\");module.exports={FRAME_SERVICE_FRAME_CLOSED:{type:BraintreeError.types.INTERNAL,code:\"FRAME_SERVICE_FRAME_CLOSED\",message:\"Frame closed before tokenization could occur.\"},FRAME_SERVICE_FRAME_OPEN_FAILED:{type:BraintreeError.types.INTERNAL,code:\"FRAME_SERVICE_FRAME_OPEN_FAILED\",message:\"Frame failed to open.\"},FRAME_SERVICE_FRAME_OPEN_FAILED_IE_BUG:{type:BraintreeError.types.INTERNAL,code:\"FRAME_SERVICE_FRAME_OPEN_FAILED_IE_BUG\",message:\"Could not open frame. This may be due to a bug in IE browsers when attempting to open an HTTPS page from a HTTP page. https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11324352/\"}}},{\"../../braintree-error\":98}],124:[function(_dereq_,module,exports){\"use strict\";var enumerate=_dereq_(\"../../enumerate\");module.exports=enumerate([\"DISPATCH_FRAME_READY\",\"DISPATCH_FRAME_REPORT\"],\"frameService:\")},{\"../../enumerate\":111}],125:[function(_dereq_,module,exports){\"use strict\";var assign=_dereq_(\"./assign\").assign;function generateTokenizationParameters(configuration,overrides){var metadata=configuration.analyticsMetadata,basicTokenizationParameters={gateway:\"braintree\",\"braintree:merchantId\":configuration.gatewayConfiguration.merchantId,\"braintree:apiVersion\":\"v1\",\"braintree:sdkVersion\":\"3.60.0\",\"braintree:metadata\":JSON.stringify({source:metadata.source,integration:metadata.integration,sessionId:metadata.sessionId,version:\"3.60.0\",platform:metadata.platform})};return assign({},basicTokenizationParameters,overrides)}module.exports=function(configuration,googlePayVersion,googleMerchantId){var data,paypalPaymentMethod,androidPayConfiguration=configuration.gatewayConfiguration.androidPay,environment=\"production\"===configuration.gatewayConfiguration.environment?\"PRODUCTION\":\"TEST\";return 2===googlePayVersion?(data={apiVersion:2,apiVersionMinor:0,environment:environment,allowedPaymentMethods:[{type:\"CARD\",parameters:{allowedAuthMethods:[\"PAN_ONLY\",\"CRYPTOGRAM_3DS\"],allowedCardNetworks:androidPayConfiguration.supportedNetworks.map((function(card){return card.toUpperCase()}))},tokenizationSpecification:{type:\"PAYMENT_GATEWAY\",parameters:generateTokenizationParameters(configuration,{\"braintree:authorizationFingerprint\":androidPayConfiguration.googleAuthorizationFingerprint})}}]},googleMerchantId&&(data.merchantInfo={merchantId:googleMerchantId}),androidPayConfiguration.paypalClientId&&(paypalPaymentMethod={type:\"PAYPAL\",parameters:{purchase_context:{purchase_units:[{payee:{client_id:androidPayConfiguration.paypalClientId},recurring_payment:!0}]}},tokenizationSpecification:{type:\"PAYMENT_GATEWAY\",parameters:generateTokenizationParameters(configuration,{\"braintree:paypalClientId\":androidPayConfiguration.paypalClientId})}},data.allowedPaymentMethods.push(paypalPaymentMethod))):(data={environment:environment,allowedPaymentMethods:[\"CARD\",\"TOKENIZED_CARD\"],paymentMethodTokenizationParameters:{tokenizationType:\"PAYMENT_GATEWAY\",parameters:generateTokenizationParameters(configuration,{\"braintree:authorizationFingerprint\":androidPayConfiguration.googleAuthorizationFingerprint})},cardRequirements:{allowedCardNetworks:androidPayConfiguration.supportedNetworks.map((function(card){return card.toUpperCase()}))}},\"TOKENIZATION_KEY\"===configuration.authorizationType&&(data.paymentMethodTokenizationParameters.parameters[\"braintree:clientKey\"]=configuration.authorization),googleMerchantId&&(data.merchantId=googleMerchantId),googlePayVersion&&(data.apiVersion=googlePayVersion)),data}},{\"./assign\":95}],126:[function(_dereq_,module,exports){\"use strict\";function convertDateStringToDate(dateString){var splitDate=dateString.split(\"-\");return new Date(splitDate[0],splitDate[1],splitDate[2])}module.exports=function(firstDate,secondDate){return convertDateStringToDate(firstDate)<=convertDateStringToDate(secondDate)}},{}],127:[function(_dereq_,module,exports){(function(global){\"use strict\";module.exports={isHTTPS:function(protocol){return\"https:\"===(protocol||global.location.protocol)}}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],128:[function(_dereq_,module,exports){\"use strict\";var parser,legalHosts={\"paypal.com\":1,\"braintreepayments.com\":1,\"braintreegateway.com\":1,\"braintree-api.com\":1};module.exports=function(url){var mainDomain;return url=url.toLowerCase(),!!/^https:/.test(url)&&((parser=parser||document.createElement(\"a\")).href=url,mainDomain=parser.hostname.split(\".\").slice(-2).join(\".\"),legalHosts.hasOwnProperty(mainDomain))}},{}],129:[function(_dereq_,module,exports){\"use strict\";module.exports=function(value){return JSON.parse(JSON.stringify(value))}},{}],130:[function(_dereq_,module,exports){\"use strict\";module.exports=function(obj){return Object.keys(obj).filter((function(key){return\"function\"==typeof obj[key]}))}},{}],131:[function(_dereq_,module,exports){arguments[4][28][0].apply(exports,arguments)},{dup:28}],132:[function(_dereq_,module,exports){(function(global){\"use strict\";var Promise=global.Promise||_dereq_(\"promise-polyfill\"),ExtendedPromise=_dereq_(\"@braintree/extended-promise\");ExtendedPromise.suppressUnhandledPromiseMessage=!0,ExtendedPromise.setPromise(Promise),module.exports=Promise}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"@braintree/extended-promise\":22,\"promise-polyfill\":39}],133:[function(_dereq_,module,exports){(function(global){\"use strict\";function stringify(params,namespace){var k,v,p,value,query=[];for(p in params)params.hasOwnProperty(p)&&(v=params[p],k=namespace?(value=params)&&\"object\"==typeof value&&\"number\"==typeof value.length&&\"[object Array]\"===Object.prototype.toString.call(value)?namespace+\"[]\":namespace+\"[\"+p+\"]\":p,query.push(\"object\"==typeof v?stringify(v,k):encodeURIComponent(k)+\"=\"+encodeURIComponent(v)));return query.join(\"&\")}module.exports={parse:function(url){return/\\?/.test(url=url||global.location.href)?url.replace(/#.*$/,\"\").replace(/^.*\\?/,\"\").split(\"&\").reduce((function(toReturn,keyValue){var parts=keyValue.split(\"=\"),key=decodeURIComponent(parts[0]),value=decodeURIComponent(parts[1]);return toReturn[key]=value,toReturn}),{}):{}},stringify:stringify,queryify:function(url,params){return url=url||\"\",null!=params&&\"object\"==typeof params&&function(obj){var key;for(key in obj)if(obj.hasOwnProperty(key))return!0;return!1}(params)&&(url+=-1===url.indexOf(\"?\")?\"?\":\"\",url+=-1!==url.indexOf(\"=\")?\"&\":\"\",url+=stringify(params)),url}}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],134:[function(_dereq_,module,exports){\"use strict\";module.exports=function(isDebug){return isDebug?\"\":\".min\"}},{}],135:[function(_dereq_,module,exports){(function(global){\"use strict\";var atobNormalized=\"function\"==typeof global.atob?global.atob:atob;function atob(base64String){var b,c,b1,b2,b3,i,characters=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",result=\"\";if(!new RegExp(\"^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$\").test(base64String))throw new Error(\"Non base64 encoded input passed to window.atob polyfill\");i=0;do{b1=characters.indexOf(base64String.charAt(i++)),b=(15&(b2=characters.indexOf(base64String.charAt(i++))))<<4|(b3=characters.indexOf(base64String.charAt(i++)))>>2&15,c=(3&b3)<<6|63&characters.indexOf(base64String.charAt(i++)),result+=String.fromCharCode((63&b1)<<2|b2>>4&3)+(b?String.fromCharCode(b):\"\")+(c?String.fromCharCode(c):\"\")}while(i<base64String.length);return result}module.exports={atob:function(base64String){return atobNormalized.call(global,base64String)},_atob:atob}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{}],136:[function(_dereq_,module,exports){\"use strict\";module.exports=function(){return\"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g,(function(c){var r=16*Math.random()|0;return(\"x\"===c?r:3&r|8).toString(16)}))}},{}],137:[function(_dereq_,module,exports){\"use strict\";module.exports={REQUIRED_OPTIONS_FOR_START_PAYMENT:[\"onPaymentStart\",\"paymentType\",\"amount\",\"fallback\"]}},{}],138:[function(_dereq_,module,exports){(function(global){\"use strict\";var frameService=_dereq_(\"../../lib/frame-service/external\"),BraintreeError=_dereq_(\"../../lib/braintree-error\"),useMin=_dereq_(\"../../lib/use-min\"),INTEGRATION_TIMEOUT_MS=_dereq_(\"../../lib/constants\").INTEGRATION_TIMEOUT_MS,analytics=_dereq_(\"../../lib/analytics\"),methods=_dereq_(\"../../lib/methods\"),convertMethodsToError=_dereq_(\"../../lib/convert-methods-to-error\"),convertToBraintreeError=_dereq_(\"../../lib/convert-to-braintree-error\"),Promise=_dereq_(\"../../lib/promise\"),querystring=_dereq_(\"../../lib/querystring\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),constants=_dereq_(\"./constants\"),errors=_dereq_(\"../shared/errors\");function LocalPayment(options){this._client=options.client,this._assetsUrl=options.client.getConfiguration().gatewayConfiguration.assetsUrl+\"/web/3.60.0\",this._isDebug=options.client.getConfiguration().isDebug,this._loadingFrameUrl=this._assetsUrl+\"/html/local-payment-landing-frame\"+useMin(this._isDebug)+\".html\",this._authorizationInProgress=!1,this._paymentType=\"unknown\",this._merchantAccountId=options.merchantAccountId}LocalPayment.prototype._initialize=function(){var self=this,client=this._client,failureTimeout=setTimeout((function(){analytics.sendEvent(client,\"local-payment.load.timed-out\")}),INTEGRATION_TIMEOUT_MS);return new Promise((function(resolve){frameService.create({name:\"localpaymentlandingpage\",dispatchFrameUrl:self._assetsUrl+\"/html/dispatch-frame\"+useMin(self._isDebug)+\".html\",openFrameUrl:self._loadingFrameUrl},(function(service){self._frameService=service,clearTimeout(failureTimeout),analytics.sendEvent(client,\"local-payment.load.succeeded\"),resolve(self)}))}))},LocalPayment.prototype.startPayment=function(options){var address,params,self=this,serviceId=this._frameService._serviceId;return function(options){var i;if(!options)return!0;for(i=0;i<constants.REQUIRED_OPTIONS_FOR_START_PAYMENT.length;i++)if(!options.hasOwnProperty(constants.REQUIRED_OPTIONS_FOR_START_PAYMENT[i]))return!0;return!options.fallback.url||!options.fallback.buttonText}(options)?Promise.reject(new BraintreeError(errors.LOCAL_PAYMENT_START_PAYMENT_MISSING_REQUIRED_OPTION)):(address=options.address||{},params={intent:\"sale\",returnUrl:querystring.queryify(self._assetsUrl+\"/html/local-payment-redirect-frame\"+useMin(self._isDebug)+\".html\",{channel:serviceId,r:options.fallback.url,t:options.fallback.buttonText}),cancelUrl:querystring.queryify(self._assetsUrl+\"/html/cancel-frame\"+useMin(self._isDebug)+\".html\",{channel:serviceId}),experienceProfile:{noShipping:!options.shippingAddressRequired},fundingSource:options.paymentType,amount:options.amount,currencyIsoCode:options.currencyCode,firstName:options.givenName,lastName:options.surname,payerEmail:options.email,phone:options.phone,line1:address.streetAddress,line2:address.extendedAddress,city:address.locality,state:address.region,postalCode:address.postalCode,countryCode:address.countryCode,merchantAccountId:self._merchantAccountId},self._paymentType=options.paymentType.toLowerCase(),self._authorizationInProgress?(analytics.sendEvent(self._client,self._paymentType+\".local-payment.start-payment.error.already-opened\"),Promise.reject(new BraintreeError(errors.LOCAL_PAYMENT_ALREADY_IN_PROGRESS))):(self._authorizationInProgress=!0,new Promise((function(resolve,reject){self._startPaymentCallback=self._createStartPaymentCallback(resolve,reject),self._frameService.open({},self._startPaymentCallback),self._client.request({method:\"post\",endpoint:\"local_payments/create\",data:params}).then((function(response){analytics.sendEvent(self._client,self._paymentType+\".local-payment.start-payment.opened\"),self._startPaymentOptions=options,options.onPaymentStart({paymentId:response.paymentResource.paymentToken},(function(){self._frameService.redirect(response.paymentResource.redirectUrl)}))})).catch((function(err){var status=err.details&&err.details.httpStatus;self._frameService.close(),self._authorizationInProgress=!1,reject(422!==status?convertToBraintreeError(err,{type:errors.LOCAL_PAYMENT_START_PAYMENT_FAILED.type,code:errors.LOCAL_PAYMENT_START_PAYMENT_FAILED.code,message:errors.LOCAL_PAYMENT_START_PAYMENT_FAILED.message}):new BraintreeError({type:errors.LOCAL_PAYMENT_INVALID_PAYMENT_OPTION.type,code:errors.LOCAL_PAYMENT_INVALID_PAYMENT_OPTION.code,message:errors.LOCAL_PAYMENT_INVALID_PAYMENT_OPTION.message,details:{originalError:err}}))}))}))))},LocalPayment.prototype.tokenize=function(params){var self=this,client=this._client;return params=params||querystring.parse(),client.request({endpoint:\"payment_methods/paypal_accounts\",method:\"post\",data:this._formatTokenizeData(params)}).then((function(response){var payload=self._formatTokenizePayload(response);return analytics.sendEvent(client,global.popupBridge?self._paymentType+\".local-payment.tokenization.success-popupbridge\":self._paymentType+\".local-payment.tokenization.success\"),payload})).catch((function(err){return analytics.sendEvent(client,self._paymentType+\".local-payment.tokenization.failed\"),Promise.reject(convertToBraintreeError(err,{type:errors.LOCAL_PAYMENT_TOKENIZATION_FAILED.type,code:errors.LOCAL_PAYMENT_TOKENIZATION_FAILED.code,message:errors.LOCAL_PAYMENT_TOKENIZATION_FAILED.message}))}))},LocalPayment.prototype.closeWindow=function(){this._authoriztionInProgress&&analytics.sendEvent(this._client,this._paymentType+\".local-payment.start-payment.closed.by-merchant\"),this._frameService.close()},LocalPayment.prototype.focusWindow=function(){this._frameService.focus()},LocalPayment.prototype._createStartPaymentCallback=function(resolve,reject){var self=this,client=this._client;return function(err,params){self._authorizationInProgress=!1,err?\"FRAME_SERVICE_FRAME_CLOSED\"===err.code?(analytics.sendEvent(client,self._paymentType+\".local-payment.tokenization.closed.by-user\"),reject(new BraintreeError(errors.LOCAL_PAYMENT_WINDOW_CLOSED))):err.code&&err.code.indexOf(\"FRAME_SERVICE_FRAME_OPEN_FAILED\")>-1&&reject(new BraintreeError({code:errors.LOCAL_PAYMENT_WINDOW_OPEN_FAILED.code,type:errors.LOCAL_PAYMENT_WINDOW_OPEN_FAILED.type,message:errors.LOCAL_PAYMENT_WINDOW_OPEN_FAILED.message,details:{originalError:err}})):params&&(global.popupBridge||self._frameService.redirect(self._loadingFrameUrl),self.tokenize(params).then(resolve).catch(reject).then((function(){self._frameService.close()})))}},LocalPayment.prototype._formatTokenizePayload=function(response){var payload,account={};return response.paypalAccounts&&(account=response.paypalAccounts[0]),payload={nonce:account.nonce,details:{},type:account.type},account.details&&(account.details.payerInfo&&(payload.details=account.details.payerInfo),account.details.correlationId&&(payload.correlationId=account.details.correlationId)),payload},LocalPayment.prototype.hasTokenizationParams=function(){var params=querystring.parse();return Boolean(params.btLpToken&&params.btLpPaymentId&&params.btLpPayerId)},LocalPayment.prototype._formatTokenizeData=function(params){var clientConfiguration=this._client.getConfiguration();return{merchantAccountId:this._merchantAccountId,paypalAccount:{correlationId:params.btLpToken||params.token,paymentToken:params.btLpPaymentId||params.paymentId,payerId:params.btLpPayerId||params.PayerID,unilateral:clientConfiguration.gatewayConfiguration.paypal.unvettedMerchant,intent:\"sale\"}}},LocalPayment.prototype.teardown=function(){return this._frameService.teardown(),convertMethodsToError(this,methods(LocalPayment.prototype)),analytics.sendEvent(this._client,\"local-payment.teardown-completed\"),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(LocalPayment)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../lib/analytics\":93,\"../../lib/braintree-error\":98,\"../../lib/constants\":103,\"../../lib/convert-methods-to-error\":104,\"../../lib/convert-to-braintree-error\":105,\"../../lib/frame-service/external\":115,\"../../lib/methods\":130,\"../../lib/promise\":132,\"../../lib/querystring\":133,\"../../lib/use-min\":134,\"../shared/errors\":140,\"./constants\":137,\"@braintree/wrap-promise\":30}],139:[function(_dereq_,module,exports){\"use strict\";var analytics=_dereq_(\"../lib/analytics\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),LocalPayment=_dereq_(\"./external/local-payment\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),errors=_dereq_(\"./shared/errors\");module.exports={create:wrapPromise((function(options){var name=\"Local Payment\";return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name})})).then((function(client){var config=client.getConfiguration();return options.client=client,!0!==config.gatewayConfiguration.paypalEnabled?Promise.reject(new BraintreeError(errors.LOCAL_PAYMENT_NOT_ENABLED)):(analytics.sendEvent(client,\"local-payment.initialized\"),new LocalPayment(options)._initialize())}))})),VERSION:\"3.60.0\"}},{\"../lib/analytics\":93,\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./external/local-payment\":138,\"./shared/errors\":140,\"@braintree/wrap-promise\":30}],140:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={LOCAL_PAYMENT_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"LOCAL_PAYMENT_NOT_ENABLED\",message:\"LocalPayment is not enabled for this merchant.\"},LOCAL_PAYMENT_ALREADY_IN_PROGRESS:{type:BraintreeError.types.MERCHANT,code:\"LOCAL_PAYMENT_ALREADY_IN_PROGRESS\",message:\"LocalPayment payment is already in progress.\"},LOCAL_PAYMENT_WINDOW_CLOSED:{type:BraintreeError.types.CUSTOMER,code:\"LOCAL_PAYMENT_WINDOW_CLOSED\",message:\"Customer closed LocalPayment window before authorizing.\"},LOCAL_PAYMENT_WINDOW_OPEN_FAILED:{type:BraintreeError.types.MERCHANT,code:\"LOCAL_PAYMENT_WINDOW_OPEN_FAILED\",message:\"LocalPayment window failed to open; make sure startPayment was called in response to a user action.\"},LOCAL_PAYMENT_START_PAYMENT_FAILED:{type:BraintreeError.types.NETWORK,code:\"LOCAL_PAYMENT_START_PAYMENT_FAILED\",message:\"LocalPayment startPayment failed.\"},LOCAL_PAYMENT_START_PAYMENT_MISSING_REQUIRED_OPTION:{type:BraintreeError.types.MERCHANT,code:\"LOCAL_PAYMENT_START_PAYMENT_MISSING_REQUIRED_OPTION\",message:\"Missing required option for startPayment.\"},LOCAL_PAYMENT_TOKENIZATION_FAILED:{type:BraintreeError.types.NETWORK,code:\"LOCAL_PAYMENT_TOKENIZATION_FAILED\",message:\"Could not tokenize user's local payment method.\"},LOCAL_PAYMENT_INVALID_PAYMENT_OPTION:{type:BraintreeError.types.MERCHANT,code:\"LOCAL_PAYMENT_INVALID_PAYMENT_OPTION\",message:\"Local payment options are invalid.\"}}},{\"../../lib/braintree-error\":98}],141:[function(_dereq_,module,exports){(function(global){\"use strict\";var Promise=_dereq_(\"../../lib/promise\"),frameService=_dereq_(\"../../lib/frame-service/external\"),BraintreeError=_dereq_(\"../../lib/braintree-error\"),errors=_dereq_(\"../shared/errors\"),methods=_dereq_(\"../../lib/methods\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),analytics=_dereq_(\"../../lib/analytics\"),convertMethodsToError=_dereq_(\"../../lib/convert-methods-to-error\"),convertToBraintreeError=_dereq_(\"../../lib/convert-to-braintree-error\"),constants=_dereq_(\"../shared/constants\"),INTEGRATION_TIMEOUT_MS=_dereq_(\"../../lib/constants\").INTEGRATION_TIMEOUT_MS;function Masterpass(options){var configuration=options.client.getConfiguration();this._client=options.client,this._assetsUrl=configuration.gatewayConfiguration.assetsUrl+\"/web/3.60.0\",this._isDebug=configuration.isDebug,this._authInProgress=!1,this._callbackUrl=global.popupBridge&&\"function\"==typeof global.popupBridge.getReturnUrlPrefix?global.popupBridge.getReturnUrlPrefix()+\"return\":this._assetsUrl+\"/html/redirect-frame\"+(this._isDebug?\"\":\".min\")+\".html\"}Masterpass.prototype._initialize=function(){var self=this;return new Promise((function(resolve){var failureTimeout=setTimeout((function(){analytics.sendEvent(self._client,\"masterpass.load.timed-out\")}),INTEGRATION_TIMEOUT_MS);frameService.create({name:constants.LANDING_FRAME_NAME,height:constants.POPUP_HEIGHT,width:constants.POPUP_WIDTH,dispatchFrameUrl:self._assetsUrl+\"/html/dispatch-frame\"+(self._isDebug?\"\":\".min\")+\".html\",openFrameUrl:self._assetsUrl+\"/html/masterpass-landing-frame\"+(self._isDebug?\"\":\".min\")+\".html\"},(function(service){self._frameService=service,clearTimeout(failureTimeout),analytics.sendEvent(self._client,\"masterpass.load.succeeded\"),resolve(self)}))}))},Masterpass.prototype.tokenize=function(options){var self=this;return!options||function(options){var i;for(i=0;i<constants.REQUIRED_OPTIONS_FOR_TOKENIZE.length;i++)if(!options.hasOwnProperty(constants.REQUIRED_OPTIONS_FOR_TOKENIZE[i]))return!0;return!1}(options)?Promise.reject(new BraintreeError(errors.MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION)):self._authInProgress?Promise.reject(new BraintreeError(errors.MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS)):new Promise((function(resolve,reject){self._navigateFrameToLoadingPage(options).catch(reject),self._frameService.open(options.frameOptions,self._createFrameOpenHandler(resolve,reject))}))},Masterpass.prototype._navigateFrameToLoadingPage=function(options){var self=this;return this._authInProgress=!0,this._client.request({method:\"post\",endpoint:\"masterpass/request_token\",data:{requestToken:{originUrl:global.location.protocol+\"//\"+global.location.hostname,subtotal:options.subtotal,currencyCode:options.currencyCode,callbackUrl:this._callbackUrl}}}).then((function(response){var queryParams,redirectUrl=self._assetsUrl+\"/html/masterpass-loading-frame\"+(self._isDebug?\"\":\".min\")+\".html?\",gatewayConfiguration=self._client.getConfiguration().gatewayConfiguration,config=options.config||{};queryParams={environment:gatewayConfiguration.environment,requestToken:response.requestToken,callbackUrl:self._callbackUrl,merchantCheckoutId:gatewayConfiguration.masterpass.merchantCheckoutId,allowedCardTypes:gatewayConfiguration.masterpass.supportedNetworks,version:constants.MASTERPASS_VERSION},Object.keys(config).forEach((function(key){\"function\"!=typeof config[key]&&(queryParams[key]=config[key])})),redirectUrl+=Object.keys(queryParams).map((function(key){return key+\"=\"+queryParams[key]})).join(\"&\"),self._frameService.redirect(redirectUrl)})).catch((function(err){var status=err.details&&err.details.httpStatus;return self._closeWindow(),Promise.reject(convertToBraintreeError(err,422===status?errors.MASTERPASS_INVALID_PAYMENT_OPTION:errors.MASTERPASS_FLOW_FAILED))}))},Masterpass.prototype._createFrameOpenHandler=function(resolve,reject){var self=this;return global.popupBridge?function(popupBridgeErr,payload){return self._authInProgress=!1,popupBridgeErr?(analytics.sendEvent(self._client,\"masterpass.tokenization.closed-popupbridge.by-user\"),void reject(convertToBraintreeError(popupBridgeErr,errors.MASTERPASS_POPUP_CLOSED))):payload.queryItems?void self._tokenizeMasterpass(payload.queryItems).then(resolve).catch(reject):(analytics.sendEvent(self._client,\"masterpass.tokenization.failed-popupbridge\"),void reject(new BraintreeError(errors.MASTERPASS_FLOW_FAILED)))}:function(frameServiceErr,payload){if(frameServiceErr)return self._authInProgress=!1,\"FRAME_SERVICE_FRAME_CLOSED\"===frameServiceErr.code?(analytics.sendEvent(self._client,\"masterpass.tokenization.closed.by-user\"),void reject(new BraintreeError(errors.MASTERPASS_POPUP_CLOSED))):frameServiceErr.code&&frameServiceErr.code.indexOf(\"FRAME_SERVICE_FRAME_OPEN_FAILED\")>-1?(analytics.sendEvent(self._client,\"masterpass.tokenization.failed.to-open\"),void reject(new BraintreeError({code:errors.MASTERPASS_POPUP_OPEN_FAILED.code,type:errors.MASTERPASS_POPUP_OPEN_FAILED.type,message:errors.MASTERPASS_POPUP_OPEN_FAILED.message,details:{originalError:frameServiceErr}}))):(analytics.sendEvent(self._client,\"masterpass.tokenization.failed\"),self._closeWindow(),void reject(convertToBraintreeError(frameServiceErr,errors.MASTERPASS_FLOW_FAILED)));self._tokenizeMasterpass(payload).then(resolve).catch(reject)}},Masterpass.prototype._tokenizeMasterpass=function(payload){var self=this;return\"success\"!==payload.mpstatus?(analytics.sendEvent(self._client,\"masterpass.tokenization.closed.by-user\"),self._closeWindow(),Promise.reject(new BraintreeError(errors.MASTERPASS_POPUP_CLOSED))):function(payload){return[payload.oauth_verifier,payload.oauth_token,payload.checkout_resource_url].some((function(element){return null==element||\"null\"===element}))}(payload)?(analytics.sendEvent(self._client,\"masterpass.tokenization.closed.missing-payload\"),self._closeWindow(),Promise.reject(new BraintreeError(errors.MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS))):self._client.request({endpoint:\"payment_methods/masterpass_cards\",method:\"post\",data:{masterpassCard:{checkoutResourceUrl:payload.checkout_resource_url,requestToken:payload.oauth_token,verifierToken:payload.oauth_verifier}}}).then((function(response){return self._closeWindow(),analytics.sendEvent(self._client,global.popupBridge?\"masterpass.tokenization.success-popupbridge\":\"masterpass.tokenization.success\"),response.masterpassCards[0]})).catch((function(tokenizeErr){return self._closeWindow(),analytics.sendEvent(self._client,global.popupBridge?\"masterpass.tokenization.failed-popupbridge\":\"masterpass.tokenization.failed\"),Promise.reject(convertToBraintreeError(tokenizeErr,errors.MASTERPASS_ACCOUNT_TOKENIZATION_FAILED))}))},Masterpass.prototype._closeWindow=function(){this._authInProgress=!1,this._frameService.close()},Masterpass.prototype.teardown=function(){var self=this;return new Promise((function(resolve){self._frameService.teardown(),convertMethodsToError(self,methods(Masterpass.prototype)),analytics.sendEvent(self._client,\"masterpass.teardown-completed\"),resolve()}))},module.exports=wrapPromise.wrapPrototype(Masterpass)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../lib/analytics\":93,\"../../lib/braintree-error\":98,\"../../lib/constants\":103,\"../../lib/convert-methods-to-error\":104,\"../../lib/convert-to-braintree-error\":105,\"../../lib/frame-service/external\":115,\"../../lib/methods\":130,\"../../lib/promise\":132,\"../shared/constants\":144,\"../shared/errors\":145,\"@braintree/wrap-promise\":30}],142:[function(_dereq_,module,exports){(function(global){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),browserDetection=_dereq_(\"./shared/browser-detection\"),Masterpass=_dereq_(\"./external/masterpass\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),errors=_dereq_(\"./shared/errors\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");function isSupported(){return Boolean(global.popupBridge||browserDetection.supportsPopups())}module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"Masterpass\",client:options.client,authorization:options.authorization}).then((function(){return isSupported()?Promise.resolve():Promise.reject(new BraintreeError(errors.MASTERPASS_BROWSER_NOT_SUPPORTED))})).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"Masterpass\"})})).then((function(client){return options.client=client,options.client.getConfiguration().gatewayConfiguration.masterpass?new Masterpass(options)._initialize():Promise.reject(new BraintreeError(errors.MASTERPASS_NOT_ENABLED))}))})),isSupported:isSupported,VERSION:\"3.60.0\"}}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./external/masterpass\":141,\"./shared/browser-detection\":143,\"./shared/errors\":145,\"@braintree/wrap-promise\":30}],143:[function(_dereq_,module,exports){\"use strict\";module.exports={supportsPopups:_dereq_(\"@braintree/browser-detection/supports-popups\")}},{\"@braintree/browser-detection/supports-popups\":19}],144:[function(_dereq_,module,exports){\"use strict\";module.exports={LANDING_FRAME_NAME:\"braintreemasterpasslanding\",POPUP_WIDTH:450,POPUP_HEIGHT:660,MASTERPASS_VERSION:\"v6\",REQUIRED_OPTIONS_FOR_TOKENIZE:[\"subtotal\",\"currencyCode\"]}},{}],145:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={MASTERPASS_BROWSER_NOT_SUPPORTED:{type:BraintreeError.types.CUSTOMER,code:\"MASTERPASS_BROWSER_NOT_SUPPORTED\",message:\"Browser is not supported.\"},MASTERPASS_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"MASTERPASS_NOT_ENABLED\",message:\"Masterpass is not enabled for this merchant.\"},MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION:{type:BraintreeError.types.MERCHANT,code:\"MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION\",message:\"Missing required option for tokenize.\"},MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS:{type:BraintreeError.types.MERCHANT,code:\"MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS\",message:\"Masterpass tokenization is already in progress.\"},MASTERPASS_ACCOUNT_TOKENIZATION_FAILED:{type:BraintreeError.types.NETWORK,code:\"MASTERPASS_ACCOUNT_TOKENIZATION_FAILED\",message:\"Could not tokenize user's Masterpass account.\"},MASTERPASS_POPUP_OPEN_FAILED:{type:BraintreeError.types.MERCHANT,code:\"MASTERPASS_POPUP_OPEN_FAILED\",message:\"Masterpass popup failed to open. Make sure to tokenize in response to a user action, such as a click.\"},MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS:{type:BraintreeError.types.MERCHANT,code:\"MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS\",message:\"Masterpass popup failed to return all required parameters needed to continue tokenization.\"},MASTERPASS_POPUP_CLOSED:{type:BraintreeError.types.CUSTOMER,code:\"MASTERPASS_POPUP_CLOSED\",message:\"Customer closed Masterpass popup before authorizing.\"},MASTERPASS_INVALID_PAYMENT_OPTION:{type:BraintreeError.types.MERCHANT,code:\"MASTERPASS_INVALID_PAYMENT_OPTION\",message:\"Masterpass payment options are invalid.\"},MASTERPASS_FLOW_FAILED:{type:BraintreeError.types.NETWORK,code:\"MASTERPASS_FLOW_FAILED\",message:\"Could not initialize Masterpass flow.\"}}},{\"../../lib/braintree-error\":98}],146:[function(_dereq_,module,exports){(function(global){\"use strict\";var analytics=_dereq_(\"../../lib/analytics\"),assign=_dereq_(\"../../lib/assign\").assign,Bus=_dereq_(\"../../lib/bus\"),convertMethodsToError=_dereq_(\"../../lib/convert-methods-to-error\"),generateGooglePayConfiguration=_dereq_(\"../../lib/generate-google-pay-configuration\"),iFramer=_dereq_(\"@braintree/iframer\"),uuid=_dereq_(\"../../lib/vendor/uuid\"),useMin=_dereq_(\"../../lib/use-min\"),methods=_dereq_(\"../../lib/methods\"),Promise=_dereq_(\"../../lib/promise\"),EventEmitter=_dereq_(\"@braintree/event-emitter\"),BraintreeError=_dereq_(\"../../lib/braintree-error\"),constants=_dereq_(\"../shared/constants\"),events=constants.events,errors=constants.errors,wrapPromise=_dereq_(\"@braintree/wrap-promise\"),CARD_TYPE_MAPPINGS={Visa:\"visa\",MasterCard:\"mastercard\",\"American Express\":\"amex\",\"Diners Club\":\"diners\",Discover:\"discover\",JCB:\"jcb\",UnionPay:\"unionpay\",Maestro:\"maestro\"};function PaymentRequestComponent(options){var enabledPaymentMethods=options.enabledPaymentMethods||{};EventEmitter.call(this),this._componentId=uuid(),this._client=options.client,this._enabledPaymentMethods={basicCard:!1!==enabledPaymentMethods.basicCard,googlePay:!1!==enabledPaymentMethods.googlePay},this._googlePayVersion=2===options.googlePayVersion?2:1,this._googleMerchantId=\"18278000977346790994\",this._supportedPaymentMethods=this._constructDefaultSupportedPaymentMethods(),this._defaultSupportedPaymentMethods=Object.keys(this._supportedPaymentMethods).map((function(key){return this._supportedPaymentMethods[key]}).bind(this)),this._bus=new Bus({channel:this._componentId})}EventEmitter.createChild(PaymentRequestComponent),PaymentRequestComponent.prototype._constructDefaultSupportedPaymentMethods=function(){var configuration=this._client.getConfiguration(),androidPayConfiguration=configuration.gatewayConfiguration.androidPay,cardConfiguration=configuration.gatewayConfiguration.creditCards,supportedPaymentMethods={};return this._enabledPaymentMethods.basicCard&&cardConfiguration&&cardConfiguration.supportedCardTypes.length>0&&(supportedPaymentMethods.basicCard={supportedMethods:\"basic-card\",data:{supportedNetworks:cardConfiguration.supportedCardTypes.reduce((function(types,cardType){return cardType in CARD_TYPE_MAPPINGS&&types.push(CARD_TYPE_MAPPINGS[cardType]),types}),[])}}),this._enabledPaymentMethods.googlePay&&androidPayConfiguration&&androidPayConfiguration.enabled&&(supportedPaymentMethods.googlePay={supportedMethods:\"https://google.com/pay\",data:generateGooglePayConfiguration(configuration,this._googlePayVersion,this._googleMerchantId)}),supportedPaymentMethods},PaymentRequestComponent.prototype.initialize=function(){var clientConfiguration=this._client.getConfiguration(),self=this;return this._frame=iFramer({allowPaymentRequest:!0,name:\"braintree-payment-request-frame\",class:\"braintree-payment-request-frame\",height:0,width:0,style:{position:\"absolute\",left:\"-9999px\"},title:\"Secure Payment Frame\"}),0===this._defaultSupportedPaymentMethods.length?Promise.reject(new BraintreeError(errors.PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS)):new Promise((function(resolve){var componentId;self._bus.on(events.FRAME_READY,(function(reply){reply(self._client)})),self._bus.on(events.FRAME_CAN_MAKE_REQUESTS,(function(){analytics.sendEvent(self._client,\"payment-request.initialized\"),self._bus.on(events.SHIPPING_ADDRESS_CHANGE,(function(shippingAddress){var shippingAddressChangeEvent={target:{shippingAddress:shippingAddress},updateWith:function(paymentDetails){self._bus.emit(events.UPDATE_SHIPPING_ADDRESS,paymentDetails)}};self._emit(\"shippingAddressChange\",shippingAddressChangeEvent),self._emit(\"shippingaddresschange\",shippingAddressChangeEvent)})),self._bus.on(events.SHIPPING_OPTION_CHANGE,(function(shippingOption){var shippingOptionChangeEvent={target:{shippingOption:shippingOption},updateWith:function(paymentDetails){self._bus.emit(events.UPDATE_SHIPPING_OPTION,paymentDetails)}};self._emit(\"shippingOptionChange\",shippingOptionChangeEvent),self._emit(\"shippingoptionchange\",shippingOptionChangeEvent)})),resolve(self)})),self._frame.src=(componentId=self._componentId,clientConfiguration.gatewayConfiguration.assetsUrl+\"/web/3.60.0/html/payment-request-frame\"+useMin(clientConfiguration.isDebug)+\".html#\"+componentId),document.body.appendChild(self._frame)}))},PaymentRequestComponent.prototype.createSupportedPaymentMethodsConfiguration=function(type,overrides){var configuration;if(!type)throw new BraintreeError(errors.PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE);if(!this._enabledPaymentMethods[type])throw new BraintreeError(errors.PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED);return(configuration=assign({},this._supportedPaymentMethods[type])).data=assign({},configuration.data,overrides),configuration},PaymentRequestComponent.prototype.tokenize=function(configuration){var self=this;return new Promise((function(resolve,reject){self._bus.emit(events.PAYMENT_REQUEST_INITIALIZED,{supportedPaymentMethods:configuration.supportedPaymentMethods||self._defaultSupportedPaymentMethods,details:configuration.details,options:configuration.options},(function(response){var rawError=response[0],payload=response[1];rawError?reject(self._formatTokenizationError(rawError)):(analytics.sendEvent(self._client,\"payment-request.tokenize.succeeded\"),resolve({nonce:payload.nonce,type:payload.type,description:payload.description,details:{rawPaymentResponse:payload.details.rawPaymentResponse,cardType:payload.details.cardType,lastFour:payload.details.lastFour,lastTwo:payload.details.lastTwo},binData:payload.binData}))}))}))},PaymentRequestComponent.prototype.canMakePayment=function(configuration){var unsupportedPaymentMethod,self=this;return global.PaymentRequest?configuration.supportedPaymentMethods&&(configuration.supportedPaymentMethods.forEach((function(config){var supportedMethods=config.supportedMethods;supportedMethods in constants.SUPPORTED_METHODS||(unsupportedPaymentMethod=supportedMethods)})),unsupportedPaymentMethod)?Promise.reject(new BraintreeError({type:errors.PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD.type,code:errors.PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD.code,message:unsupportedPaymentMethod+\" is not a supported payment method.\"})):new Promise((function(resolve,reject){self._bus.emit(events.CAN_MAKE_PAYMENT,{supportedPaymentMethods:configuration.supportedPaymentMethods||self._defaultSupportedPaymentMethods,details:configuration.details,options:configuration.options},(function(response){var error=response[0],payload=response[1];error?reject(self._formatCanMakePaymentError(error)):(analytics.sendEvent(self._client,\"payment-request.can-make-payment.\"+payload),resolve(payload))}))})):(analytics.sendEvent(self._client,\"payment-request.can-make-payment.not-available\"),Promise.resolve(!1))},PaymentRequestComponent.prototype.teardown=function(){return this._bus.teardown(),this._frame.parentNode.removeChild(this._frame),convertMethodsToError(this,methods(PaymentRequestComponent.prototype)),analytics.sendEvent(this._client,\"payment-request.teardown-completed\"),Promise.resolve()},PaymentRequestComponent.prototype._formatTokenizationError=function(error){var formattedError;switch(error.name){case\"AbortError\":return formattedError=new BraintreeError({type:errors.PAYMENT_REQUEST_CANCELED.type,code:errors.PAYMENT_REQUEST_CANCELED.code,message:errors.PAYMENT_REQUEST_CANCELED.message,details:{originalError:error}}),analytics.sendEvent(this._client,\"payment-request.tokenize.canceled\"),formattedError;case\"PAYMENT_REQUEST_INITIALIZATION_FAILED\":formattedError=new BraintreeError({type:errors.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.type,code:errors.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.code,message:errors.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.message,details:{originalError:error}});break;case\"BRAINTREE_GATEWAY_GOOGLE_PAYMENT_TOKENIZATION_ERROR\":formattedError=new BraintreeError({type:errors.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.type,code:errors.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.code,message:errors.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.message,details:{originalError:error}});break;case\"BRAINTREE_GATEWAY_GOOGLE_PAYMENT_PARSING_ERROR\":formattedError=new BraintreeError({type:errors.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.type,code:errors.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.code,message:errors.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.message,details:{originalError:error}});break;default:formattedError=new BraintreeError({code:errors.PAYMENT_REQUEST_NOT_COMPLETED.code,type:error.type||BraintreeError.types.CUSTOMER,message:errors.PAYMENT_REQUEST_NOT_COMPLETED.message,details:{originalError:error}})}return analytics.sendEvent(this._client,\"payment-request.tokenize.failed\"),formattedError},PaymentRequestComponent.prototype._formatCanMakePaymentError=function(error){var formattedError;switch(error.name){case\"PAYMENT_REQUEST_INITIALIZATION_FAILED\":formattedError=new BraintreeError({type:errors.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.type,code:errors.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.code,message:errors.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.message,details:{originalError:error}});break;case\"NotAllowedError\":formattedError=new BraintreeError({type:errors.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED.type,code:errors.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED.code,message:errors.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED.message,details:{originalError:error}});break;default:formattedError=new BraintreeError({code:errors.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED.code,type:errors.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED.type,message:errors.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED.message,details:{originalError:error}})}return analytics.sendEvent(this._client,\"payment-request.can-make-payment.failed\"),formattedError},module.exports=wrapPromise.wrapPrototype(PaymentRequestComponent)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../lib/analytics\":93,\"../../lib/assign\":95,\"../../lib/braintree-error\":98,\"../../lib/bus\":101,\"../../lib/convert-methods-to-error\":104,\"../../lib/generate-google-pay-configuration\":125,\"../../lib/methods\":130,\"../../lib/promise\":132,\"../../lib/use-min\":134,\"../../lib/vendor/uuid\":136,\"../shared/constants\":148,\"@braintree/event-emitter\":21,\"@braintree/iframer\":23,\"@braintree/wrap-promise\":30}],147:[function(_dereq_,module,exports){\"use strict\";var PaymentRequestComponent=_dereq_(\"./external/payment-request\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){var name=\"Payment Request\";return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name})})).then((function(client){return options.client=client,new PaymentRequestComponent(options).initialize()}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"./external/payment-request\":146,\"@braintree/wrap-promise\":30}],148:[function(_dereq_,module,exports){\"use strict\";var enumerate=_dereq_(\"../../lib/enumerate\"),errors=_dereq_(\"./errors\"),constants={};constants.events=enumerate([\"CAN_MAKE_PAYMENT\",\"FRAME_READY\",\"FRAME_CAN_MAKE_REQUESTS\",\"PAYMENT_REQUEST_INITIALIZED\",\"SHIPPING_ADDRESS_CHANGE\",\"UPDATE_SHIPPING_ADDRESS\",\"SHIPPING_OPTION_CHANGE\",\"UPDATE_SHIPPING_OPTION\"],\"payment-request:\"),constants.errors=errors,constants.SUPPORTED_METHODS={\"basic-card\":!0,\"https://google.com/pay\":!0},module.exports=constants},{\"../../lib/enumerate\":111,\"./errors\":149}],149:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS:{type:BraintreeError.types.MERCHANT,code:\"PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS\",message:\"There are no supported payment methods associated with this account.\"},PAYMENT_REQUEST_CANCELED:{type:BraintreeError.types.CUSTOMER,code:\"PAYMENT_REQUEST_CANCELED\",message:\"Payment request was canceled.\"},PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED:{type:BraintreeError.types.MERCHANT,code:\"PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED\",message:\"Something went wrong when configuring the payment request.\"},PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED:{type:BraintreeError.types.UNKNOWN,code:\"PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED\",message:\"Something went wrong when calling `canMakePayment`\"},PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED:{type:BraintreeError.types.MERCHANT,code:\"PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED\",message:\"Something went wrong when calling `canMakePayment`. Most likely, `canMakePayment` was called multiple times with different supportedMethods configurations.\"},PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD:{type:BraintreeError.types.MERCHANT,code:\"PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD\"},PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE:{type:BraintreeError.types.MERCHANT,code:\"PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE\",message:\"Something went wrong when tokenizing the Google Pay card.\"},PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR:{type:BraintreeError.types.UNKNOWN,code:\"PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR\",message:\"Something went wrong when tokenizing the Google Pay card.\"},PAYMENT_REQUEST_NOT_COMPLETED:{code:\"PAYMENT_REQUEST_NOT_COMPLETED\",message:\"Payment request could not be completed.\"},PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE:{type:BraintreeError.types.MERCHANT,code:\"PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE\",message:\"createSupportedPaymentMethodsConfiguration must include a type parameter.\"},PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED\",message:\"createSupportedPaymentMethodsConfiguration type parameter must be valid or enabled.\"}}},{\"../../lib/braintree-error\":98}],150:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={PAYPAL_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_NOT_ENABLED\",message:\"PayPal is not enabled for this merchant.\"},PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED\",message:\"A linked PayPal Sandbox account is required to use PayPal Checkout in Sandbox. See https://developers.braintreepayments.com/guides/paypal/testing-go-live/#linked-paypal-testing for details on linking your PayPal sandbox with Braintree.\"},PAYPAL_ACCOUNT_TOKENIZATION_FAILED:{type:BraintreeError.types.NETWORK,code:\"PAYPAL_ACCOUNT_TOKENIZATION_FAILED\",message:\"Could not tokenize user's PayPal account.\"},PAYPAL_FLOW_FAILED:{type:BraintreeError.types.NETWORK,code:\"PAYPAL_FLOW_FAILED\",message:\"Could not initialize PayPal flow.\"},PAYPAL_FLOW_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_FLOW_OPTION_REQUIRED\",message:\"PayPal flow property is invalid or missing.\"},PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED\"},PAYPAL_START_VAULT_INITIATED_CHECKOUT_SETUP_FAILED:{type:BraintreeError.types.NETWORK,code:\"PAYPAL_START_VAULT_INITIATED_CHECKOUT_SETUP_FAILED\",message:\"Something went wrong when setting up the checkout workflow.\"},PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED\",message:\"PayPal popup failed to open, make sure to initiate the vault checkout in response to a user action.\"},PAYPAL_START_VAULT_INITIATED_CHECKOUT_CANCELED:{type:BraintreeError.types.CUSTOMER,code:\"PAYPAL_START_VAULT_INITIATED_CHECKOUT_CANCELED\",message:\"Customer closed PayPal popup before authorizing.\"},PAYPAL_START_VAULT_INITIATED_CHECKOUT_IN_PROGRESS:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_START_VAULT_INITIATED_CHECKOUT_IN_PROGRESS\",message:\"Vault initiated checkout already in progress.\"},PAYPAL_INVALID_PAYMENT_OPTION:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_INVALID_PAYMENT_OPTION\",message:\"PayPal payment options are invalid.\"}}},{\"../lib/braintree-error\":98}],151:[function(_dereq_,module,exports){\"use strict\";var basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),PayPalCheckout=_dereq_(\"./paypal-checkout\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"PayPal Checkout\",client:options.client,authorization:options.authorization}).then((function(){return new PayPalCheckout(options)._initialize(options)}))})),isSupported:function(){return!0},VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"./paypal-checkout\":152,\"@braintree/wrap-promise\":30}],152:[function(_dereq_,module,exports){\"use strict\";var analytics=_dereq_(\"../lib/analytics\"),assign=_dereq_(\"../lib/assign\").assign,createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),Promise=_dereq_(\"../lib/promise\"),ExtendedPromise=_dereq_(\"@braintree/extended-promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),convertToBraintreeError=_dereq_(\"../lib/convert-to-braintree-error\"),errors=_dereq_(\"./errors\"),constants=_dereq_(\"../paypal/shared/constants\"),frameService=_dereq_(\"../lib/frame-service/external\"),methods=_dereq_(\"../lib/methods\"),useMin=_dereq_(\"../lib/use-min\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),INTEGRATION_TIMEOUT_MS=_dereq_(\"../lib/constants\").INTEGRATION_TIMEOUT_MS,REQUIRED_PARAMS_FOR_START_VAULT_INITIATED_CHECKOUT=[\"amount\",\"currency\",\"vaultInitiatedCheckoutPaymentMethodToken\"];function PayPalCheckout(options){this._merchantAccountId=options.merchantAccountId}PayPalCheckout.prototype._initialize=function(options){return this._clientPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"PayPal Checkout\"}).then((function(client){return this._configuration=client.getConfiguration(),this._merchantAccountId||(this._configuration.gatewayConfiguration.paypalEnabled?!0===this._configuration.gatewayConfiguration.paypal.environmentNoNetwork&&(this._setupError=new BraintreeError(errors.PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED)):this._setupError=new BraintreeError(errors.PAYPAL_NOT_ENABLED)),this._setupError?Promise.reject(this._setupError):(analytics.sendEvent(client,\"paypal-checkout.initialized\"),this._frameServicePromise=this._setupFrameService(client),client)}).bind(this)),options.client?this._clientPromise.then((function(){return this}).bind(this)):Promise.resolve(this)},PayPalCheckout.prototype._setupFrameService=function(client){var frameServicePromise=new ExtendedPromise,config=client.getConfiguration(),timeoutRef=setTimeout((function(){analytics.sendEvent(client,\"paypal-checkout.frame-service.timed-out\"),frameServicePromise.reject(new BraintreeError(errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_SETUP_FAILED))}),INTEGRATION_TIMEOUT_MS);return this._assetsUrl=config.gatewayConfiguration.paypal.assetsUrl+\"/web/3.60.0\",this._isDebug=config.isDebug,this._loadingFrameUrl=this._assetsUrl+\"/html/paypal-landing-frame\"+useMin(this._isDebug)+\".html\",frameService.create({name:\"braintreepaypallanding\",dispatchFrameUrl:this._assetsUrl+\"/html/dispatch-frame\"+useMin(this._isDebug)+\".html\",openFrameUrl:this._loadingFrameUrl},(function(service){this._frameService=service,clearTimeout(timeoutRef),frameServicePromise.resolve()}).bind(this)),frameServicePromise},PayPalCheckout.prototype.createPayment=function(options){return options&&constants.FLOW_ENDPOINTS.hasOwnProperty(options.flow)?(analytics.sendEvent(this._clientPromise,\"paypal-checkout.createPayment\"),this._createPaymentResource(options).then((function(response){return\"checkout\"===options.flow?response.paymentResource.redirectUrl.match(/EC-\\w+/)[0]:response.agreementSetup.tokenId}))):Promise.reject(new BraintreeError(errors.PAYPAL_FLOW_OPTION_REQUIRED))},PayPalCheckout.prototype._createPaymentResource=function(options,config){var self=this,endpoint=\"paypal_hermes/\"+constants.FLOW_ENDPOINTS[options.flow];return config=config||{},!0===options.offerCredit&&analytics.sendEvent(this._clientPromise,\"paypal-checkout.credit.offered\"),this._clientPromise.then((function(client){return client.request({endpoint:endpoint,method:\"post\",data:self._formatPaymentResourceData(options,config)})})).catch((function(err){return Promise.reject(self._setupError?self._setupError:422===(err.details&&err.details.httpStatus)?new BraintreeError({type:errors.PAYPAL_INVALID_PAYMENT_OPTION.type,code:errors.PAYPAL_INVALID_PAYMENT_OPTION.code,message:errors.PAYPAL_INVALID_PAYMENT_OPTION.message,details:{originalError:err}}):convertToBraintreeError(err,{type:errors.PAYPAL_FLOW_FAILED.type,code:errors.PAYPAL_FLOW_FAILED.code,message:errors.PAYPAL_FLOW_FAILED.message}))}))},PayPalCheckout.prototype.startVaultInitiatedCheckout=function(options){var missingRequiredParam,self=this;return this._vaultInitiatedCheckoutInProgress?(analytics.sendEvent(this._clientPromise,\"paypal-checkout.startVaultInitiatedCheckout.error.already-in-progress\"),Promise.reject(new BraintreeError(errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_IN_PROGRESS))):(REQUIRED_PARAMS_FOR_START_VAULT_INITIATED_CHECKOUT.forEach((function(param){options.hasOwnProperty(param)||(missingRequiredParam=param)})),missingRequiredParam?Promise.reject(new BraintreeError({type:errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED.type,code:errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED.code,message:\"Required param \"+missingRequiredParam+\" is missing.\"})):(this._vaultInitiatedCheckoutInProgress=!0,this._addModalBackdrop(options),options=assign({},options,{flow:\"checkout\"}),analytics.sendEvent(this._clientPromise,\"paypal-checkout.startVaultInitiatedCheckout.started\"),this._waitForVaultInitiatedCheckoutDependencies().then((function(){var frameCommunicationPromise=new ExtendedPromise,startVaultInitiatedCheckoutPromise=self._createPaymentResource(options,{returnUrl:self._constructVaultCheckutUrl(\"redirect-frame\"),cancelUrl:self._constructVaultCheckutUrl(\"cancel-frame\")}).then((function(response){return self._frameService.redirect(response.paymentResource.redirectUrl),frameCommunicationPromise}));return self._frameService.open({},self._createFrameServiceCallback(frameCommunicationPromise)),startVaultInitiatedCheckoutPromise})).catch((function(err){return self._vaultInitiatedCheckoutInProgress=!1,self._removeModalBackdrop(),\"FRAME_SERVICE_FRAME_CLOSED\"===err.code?(analytics.sendEvent(self._clientPromise,\"paypal-checkout.startVaultInitiatedCheckout.canceled.by-customer\"),Promise.reject(new BraintreeError(errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_CANCELED))):(self._frameService&&self._frameService.close(),err.code&&err.code.indexOf(\"FRAME_SERVICE_FRAME_OPEN_FAILED\")>-1?(analytics.sendEvent(self._clientPromise,\"paypal-checkout.startVaultInitiatedCheckout.failed.popup-not-opened\"),Promise.reject(new BraintreeError({code:errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED.code,type:errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED.type,message:errors.PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED.message,details:{originalError:err}}))):Promise.reject(err))})).then((function(response){return self._frameService.close(),self._vaultInitiatedCheckoutInProgress=!1,self._removeModalBackdrop(),analytics.sendEvent(self._clientPromise,\"paypal-checkout.startVaultInitiatedCheckout.succeeded\"),Promise.resolve(response)}))))},PayPalCheckout.prototype._addModalBackdrop=function(options){options.optOutOfModalBackdrop||(this._modalBackdrop||(this._modalBackdrop=document.createElement(\"div\"),this._modalBackdrop.setAttribute(\"data-braintree-paypal-vault-initiated-checkout-modal\",!0),this._modalBackdrop.style.position=\"fixed\",this._modalBackdrop.style.top=0,this._modalBackdrop.style.bottom=0,this._modalBackdrop.style.left=0,this._modalBackdrop.style.right=0,this._modalBackdrop.style.zIndex=9999,this._modalBackdrop.style.background=\"black\",this._modalBackdrop.style.opacity=\"0.7\",this._modalBackdrop.addEventListener(\"click\",(function(){this.focusVaultInitiatedCheckoutWindow()}).bind(this))),document.body.appendChild(this._modalBackdrop))},PayPalCheckout.prototype._removeModalBackdrop=function(){this._modalBackdrop&&this._modalBackdrop.parentNode&&this._modalBackdrop.parentNode.removeChild(this._modalBackdrop)},PayPalCheckout.prototype.closeVaultInitiatedCheckoutWindow=function(){return this._vaultInitiatedCheckoutInProgress&&analytics.sendEvent(this._clientPromise,\"paypal-checkout.startVaultInitiatedCheckout.canceled.by-merchant\"),this._waitForVaultInitiatedCheckoutDependencies().then((function(){this._frameService.close()}).bind(this))},PayPalCheckout.prototype.focusVaultInitiatedCheckoutWindow=function(){return this._waitForVaultInitiatedCheckoutDependencies().then((function(){this._frameService.focus()}).bind(this))},PayPalCheckout.prototype._createFrameServiceCallback=function(frameCommunicationPromise){var self=this;return function(err,payload){err?frameCommunicationPromise.reject(err):payload&&(self._frameService.redirect(self._loadingFrameUrl),self.tokenizePayment({paymentToken:payload.token,payerID:payload.PayerID,paymentID:payload.paymentId}).then((function(res){frameCommunicationPromise.resolve(res)})).catch((function(tokenizationError){frameCommunicationPromise.reject(tokenizationError)})))}},PayPalCheckout.prototype._waitForVaultInitiatedCheckoutDependencies=function(){var self=this;return this._clientPromise.then((function(){return self._frameServicePromise}))},PayPalCheckout.prototype._constructVaultCheckutUrl=function(frameName){var serviceId=this._frameService._serviceId;return this._assetsUrl+\"/html/\"+frameName+useMin(this._isDebug)+\".html?channel=\"+serviceId},PayPalCheckout.prototype.tokenizePayment=function(tokenizeOptions){var payload,self=this,shouldVault=!0,options={flow:tokenizeOptions.billingToken?\"vault\":\"checkout\",intent:tokenizeOptions.intent},params={ecToken:tokenizeOptions.paymentToken,billingToken:tokenizeOptions.billingToken,payerId:tokenizeOptions.payerID,paymentId:tokenizeOptions.paymentID,shippingOptionsId:tokenizeOptions.shippingOptionsId};return tokenizeOptions.hasOwnProperty(\"vault\")&&(shouldVault=tokenizeOptions.vault),options.vault=shouldVault,analytics.sendEvent(this._clientPromise,\"paypal-checkout.tokenization.started\"),this._clientPromise.then((function(client){return client.request({endpoint:\"payment_methods/paypal_accounts\",method:\"post\",data:self._formatTokenizeData(options,params)})})).then((function(response){return payload=self._formatTokenizePayload(response),analytics.sendEvent(self._clientPromise,\"paypal-checkout.tokenization.success\"),payload.creditFinancingOffered&&analytics.sendEvent(self._clientPromise,\"paypal-checkout.credit.accepted\"),payload})).catch((function(err){return self._setupError?Promise.reject(self._setupError):(analytics.sendEvent(self._clientPromise,\"paypal-checkout.tokenization.failed\"),Promise.reject(convertToBraintreeError(err,{type:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.type,code:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.code,message:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.message})))}))},PayPalCheckout.prototype.getClientId=function(){return this._clientPromise.then((function(client){return client.getConfiguration().gatewayConfiguration.paypal.clientId}))},PayPalCheckout.prototype._formatPaymentResourceData=function(options,config){var key,intent=options.intent,paymentResource={returnUrl:config.returnUrl||\"https://www.paypal.com/checkoutnow/error\",cancelUrl:config.cancelUrl||\"https://www.paypal.com/checkoutnow/error\",offerPaypalCredit:!0===options.offerCredit,merchantAccountId:this._merchantAccountId,experienceProfile:{brandName:options.displayName||this._configuration.gatewayConfiguration.paypal.displayName,localeCode:options.locale,noShipping:(!options.enableShippingAddress).toString(),addressOverride:!1===options.shippingAddressEditable,landingPageType:options.landingPageType},shippingOptions:options.shippingOptions};if(\"checkout\"===options.flow)for(key in paymentResource.amount=options.amount,paymentResource.currencyIsoCode=options.currency,intent&&(\"capture\"===intent&&(intent=\"sale\"),paymentResource.intent=intent),options.hasOwnProperty(\"lineItems\")&&(paymentResource.lineItems=options.lineItems),options.hasOwnProperty(\"vaultInitiatedCheckoutPaymentMethodToken\")&&(paymentResource.vaultInitiatedCheckoutPaymentMethodToken=options.vaultInitiatedCheckoutPaymentMethodToken),options.hasOwnProperty(\"shippingOptions\")&&(paymentResource.shippingOptions=options.shippingOptions),options.shippingAddressOverride)options.shippingAddressOverride.hasOwnProperty(key)&&(paymentResource[key]=options.shippingAddressOverride[key]);else paymentResource.shippingAddress=options.shippingAddressOverride,options.billingAgreementDescription&&(paymentResource.description=options.billingAgreementDescription);return paymentResource},PayPalCheckout.prototype._formatTokenizeData=function(options,params){var clientConfiguration=this._configuration,gatewayConfiguration=clientConfiguration.gatewayConfiguration,data={paypalAccount:{correlationId:params.billingToken||params.ecToken,options:{validate:\"vault\"===options.flow&&!(\"TOKENIZATION_KEY\"===clientConfiguration.authorizationType)&&options.vault}}};return params.billingToken?data.paypalAccount.billingAgreementToken=params.billingToken:(data.paypalAccount.paymentToken=params.paymentId,data.paypalAccount.payerId=params.payerId,data.paypalAccount.unilateral=gatewayConfiguration.paypal.unvettedMerchant,options.intent&&(data.paypalAccount.intent=options.intent)),this._merchantAccountId&&(data.merchantAccountId=this._merchantAccountId),data},PayPalCheckout.prototype._formatTokenizePayload=function(response){var payload,account={};return response.paypalAccounts&&(account=response.paypalAccounts[0]),payload={nonce:account.nonce,details:{},type:account.type},account.details&&account.details.payerInfo&&(payload.details=account.details.payerInfo),account.details&&account.details.creditFinancingOffered&&(payload.creditFinancingOffered=account.details.creditFinancingOffered),account.details&&account.details.shippingOptionId&&(payload.shippingOptionId=account.details.shippingOptionId),account.details&&account.details.cobrandedCardLabel&&(payload.cobrandedCardLabel=account.details.cobrandedCardLabel),payload},PayPalCheckout.prototype.teardown=function(){return convertMethodsToError(this,methods(PayPalCheckout.prototype)),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(PayPalCheckout)},{\"../lib/analytics\":93,\"../lib/assign\":95,\"../lib/braintree-error\":98,\"../lib/constants\":103,\"../lib/convert-methods-to-error\":104,\"../lib/convert-to-braintree-error\":105,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/frame-service/external\":115,\"../lib/methods\":130,\"../lib/promise\":132,\"../lib/use-min\":134,\"../paypal/shared/constants\":155,\"./errors\":150,\"@braintree/extended-promise\":22,\"@braintree/wrap-promise\":30}],153:[function(_dereq_,module,exports){(function(global){\"use strict\";var frameService=_dereq_(\"../../lib/frame-service/external\"),BraintreeError=_dereq_(\"../../lib/braintree-error\"),convertToBraintreeError=_dereq_(\"../../lib/convert-to-braintree-error\"),useMin=_dereq_(\"../../lib/use-min\"),once=_dereq_(\"../../lib/once\"),constants=_dereq_(\"../shared/constants\"),INTEGRATION_TIMEOUT_MS=_dereq_(\"../../lib/constants\").INTEGRATION_TIMEOUT_MS,analytics=_dereq_(\"../../lib/analytics\"),methods=_dereq_(\"../../lib/methods\"),deferred=_dereq_(\"../../lib/deferred\"),errors=_dereq_(\"../shared/errors\"),convertMethodsToError=_dereq_(\"../../lib/convert-methods-to-error\"),querystring=_dereq_(\"../../lib/querystring\"),Promise=_dereq_(\"../../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");function PayPal(options){this._client=options.client,this._assetsUrl=options.client.getConfiguration().gatewayConfiguration.paypal.assetsUrl+\"/web/3.60.0\",this._isDebug=options.client.getConfiguration().isDebug,this._loadingFrameUrl=this._assetsUrl+\"/html/paypal-landing-frame\"+useMin(this._isDebug)+\".html\",this._authorizationInProgress=!1}PayPal.prototype._initialize=function(){var self=this,client=this._client,failureTimeout=setTimeout((function(){analytics.sendEvent(client,\"paypal.load.timed-out\")}),INTEGRATION_TIMEOUT_MS);return new Promise((function(resolve){frameService.create({name:constants.LANDING_FRAME_NAME,dispatchFrameUrl:self._assetsUrl+\"/html/dispatch-frame\"+useMin(self._isDebug)+\".html\",openFrameUrl:self._loadingFrameUrl},(function(service){self._frameService=service,clearTimeout(failureTimeout),analytics.sendEvent(client,\"paypal.load.succeeded\"),resolve(self)}))}))},PayPal.prototype.tokenize=function(options,callback){var tokenizePromise,optionError,self=this,client=this._client;return callback&&(callback=once(deferred(callback))),options&&constants.FLOW_ENDPOINTS.hasOwnProperty(options.flow)?(tokenizePromise=new Promise((function(resolve,reject){self._authorizationInProgress?(analytics.sendEvent(client,\"paypal.tokenization.error.already-opened\"),reject(new BraintreeError(errors.PAYPAL_TOKENIZATION_REQUEST_ACTIVE))):(self._authorizationInProgress=!0,global.popupBridge||analytics.sendEvent(client,\"paypal.tokenization.opened\"),!0===options.offerCredit&&analytics.sendEvent(client,\"paypal.credit.offered\"),self._navigateFrameToAuth(options).catch(reject),self._frameService.open({},self._createFrameServiceCallback(options,resolve,reject)))})),callback?(tokenizePromise.then((function(res){callback(null,res)})).catch(callback),this._frameService.createHandler({beforeClose:function(){analytics.sendEvent(client,\"paypal.tokenization.closed.by-merchant\")}})):tokenizePromise):(optionError=new BraintreeError(errors.PAYPAL_FLOW_OPTION_REQUIRED),callback?(callback(optionError),this._frameService.createNoopHandler()):Promise.reject(optionError))},PayPal.prototype._createFrameServiceCallback=function(options,resolve,reject){var self=this,client=this._client;return global.popupBridge?function(err,payload){var canceled=payload&&payload.path&&\"/cancel\"===payload.path.substring(0,7);self._authorizationInProgress=!1,err||canceled?(analytics.sendEvent(client,\"paypal.tokenization.closed-popupbridge.by-user\"),reject(new BraintreeError(errors.PAYPAL_POPUP_CLOSED))):payload&&self._tokenizePayPal(options,payload.queryItems).then(resolve).catch(reject)}:function(err,params){self._authorizationInProgress=!1,err?\"FRAME_SERVICE_FRAME_CLOSED\"===err.code?(analytics.sendEvent(client,\"paypal.tokenization.closed.by-user\"),reject(new BraintreeError(errors.PAYPAL_POPUP_CLOSED))):err.code&&err.code.indexOf(\"FRAME_SERVICE_FRAME_OPEN_FAILED\")>-1&&reject(new BraintreeError({code:errors.PAYPAL_POPUP_OPEN_FAILED.code,type:errors.PAYPAL_POPUP_OPEN_FAILED.type,message:errors.PAYPAL_POPUP_OPEN_FAILED.message,details:{originalError:err}})):params&&self._tokenizePayPal(options,params).then(resolve).catch(reject)}},PayPal.prototype._tokenizePayPal=function(options,params){var self=this,client=this._client;return global.popupBridge||this._frameService.redirect(this._loadingFrameUrl),client.request({endpoint:\"payment_methods/paypal_accounts\",method:\"post\",data:this._formatTokenizeData(options,params)}).then((function(response){var payload=self._formatTokenizePayload(response);return analytics.sendEvent(client,global.popupBridge?\"paypal.tokenization.success-popupbridge\":\"paypal.tokenization.success\"),payload.creditFinancingOffered&&analytics.sendEvent(client,\"paypal.credit.accepted\"),self._frameService.close(),payload})).catch((function(err){return analytics.sendEvent(client,global.popupBridge?\"paypal.tokenization.failed-popupbridge\":\"paypal.tokenization.failed\"),self._frameService.close(),Promise.reject(convertToBraintreeError(err,{type:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.type,code:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.code,message:errors.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.message}))}))},PayPal.prototype._formatTokenizePayload=function(response){var payload,account={};return response.paypalAccounts&&(account=response.paypalAccounts[0]),payload={nonce:account.nonce,details:{},type:account.type},account.details&&account.details.payerInfo&&(payload.details=account.details.payerInfo),account.details&&account.details.creditFinancingOffered&&(payload.creditFinancingOffered=account.details.creditFinancingOffered),payload},PayPal.prototype._formatTokenizeData=function(options,params){var clientConfiguration=this._client.getConfiguration(),gatewayConfiguration=clientConfiguration.gatewayConfiguration,data={paypalAccount:{correlationId:params.ba_token||params.token,options:{validate:\"vault\"===options.flow&&!(\"TOKENIZATION_KEY\"===clientConfiguration.authorizationType)}}};return params.ba_token?data.paypalAccount.billingAgreementToken=params.ba_token:(data.paypalAccount.paymentToken=params.paymentId,data.paypalAccount.payerId=params.PayerID,data.paypalAccount.unilateral=gatewayConfiguration.paypal.unvettedMerchant,options.hasOwnProperty(\"intent\")&&(data.paypalAccount.intent=options.intent)),data},PayPal.prototype._navigateFrameToAuth=function(options){var self=this,client=this._client;return client.request({endpoint:\"paypal_hermes/\"+constants.FLOW_ENDPOINTS[options.flow],method:\"post\",data:this._formatPaymentResourceData(options)}).then((function(response){var redirectUrl;redirectUrl=\"checkout\"===options.flow?response.paymentResource.redirectUrl:response.agreementSetup.approvalUrl,\"commit\"===options.useraction&&(redirectUrl=querystring.queryify(redirectUrl,{useraction:\"commit\"})),global.popupBridge&&analytics.sendEvent(client,\"paypal.tokenization.opened-popupbridge\"),self._frameService.redirect(redirectUrl)})).catch((function(err){var status=err.details&&err.details.httpStatus;return self._frameService.close(),self._authorizationInProgress=!1,Promise.reject(422===status?new BraintreeError({type:errors.PAYPAL_INVALID_PAYMENT_OPTION.type,code:errors.PAYPAL_INVALID_PAYMENT_OPTION.code,message:errors.PAYPAL_INVALID_PAYMENT_OPTION.message,details:{originalError:err}}):convertToBraintreeError(err,{type:errors.PAYPAL_FLOW_FAILED.type,code:errors.PAYPAL_FLOW_FAILED.code,message:errors.PAYPAL_FLOW_FAILED.message}))}))},PayPal.prototype._formatPaymentResourceData=function(options){var key,gatewayConfiguration=this._client.getConfiguration().gatewayConfiguration,serviceId=this._frameService._serviceId,paymentResource={returnUrl:gatewayConfiguration.paypal.assetsUrl+\"/web/3.60.0/html/redirect-frame\"+useMin(this._isDebug)+\".html?channel=\"+serviceId,cancelUrl:gatewayConfiguration.paypal.assetsUrl+\"/web/3.60.0/html/cancel-frame\"+useMin(this._isDebug)+\".html?channel=\"+serviceId,offerPaypalCredit:!0===options.offerCredit,experienceProfile:{brandName:options.displayName||gatewayConfiguration.paypal.displayName,localeCode:options.locale,noShipping:(!options.enableShippingAddress).toString(),addressOverride:!1===options.shippingAddressEditable,landingPageType:options.landingPageType}};if(global.popupBridge&&\"function\"==typeof global.popupBridge.getReturnUrlPrefix&&(paymentResource.returnUrl=global.popupBridge.getReturnUrlPrefix()+\"return\",paymentResource.cancelUrl=global.popupBridge.getReturnUrlPrefix()+\"cancel\"),\"checkout\"===options.flow)for(key in paymentResource.amount=options.amount,paymentResource.currencyIsoCode=options.currency,options.hasOwnProperty(\"intent\")&&(paymentResource.intent=options.intent),options.shippingAddressOverride)options.shippingAddressOverride.hasOwnProperty(key)&&(paymentResource[key]=options.shippingAddressOverride[key]);else paymentResource.shippingAddress=options.shippingAddressOverride,options.billingAgreementDescription&&(paymentResource.description=options.billingAgreementDescription);return paymentResource},PayPal.prototype.closeWindow=function(){this._authorizationInProgress&&analytics.sendEvent(this._client,\"paypal.tokenize.closed.by-merchant\"),this._frameService.close()},PayPal.prototype.focusWindow=function(){this._frameService.focus()},PayPal.prototype.teardown=wrapPromise((function(){return this._frameService.teardown(),convertMethodsToError(this,methods(PayPal.prototype)),analytics.sendEvent(this._client,\"paypal.teardown-completed\"),Promise.resolve()})),module.exports=PayPal}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../lib/analytics\":93,\"../../lib/braintree-error\":98,\"../../lib/constants\":103,\"../../lib/convert-methods-to-error\":104,\"../../lib/convert-to-braintree-error\":105,\"../../lib/deferred\":109,\"../../lib/frame-service/external\":115,\"../../lib/methods\":130,\"../../lib/once\":131,\"../../lib/promise\":132,\"../../lib/querystring\":133,\"../../lib/use-min\":134,\"../shared/constants\":155,\"../shared/errors\":156,\"@braintree/wrap-promise\":30}],154:[function(_dereq_,module,exports){\"use strict\";var analytics=_dereq_(\"../lib/analytics\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),errors=_dereq_(\"./shared/errors\"),PayPal=_dereq_(\"./external/paypal\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),Promise=_dereq_(\"../lib/promise\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"PayPal\",client:options.client,authorization:options.authorization}).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"PayPal\"})})).then((function(client){var config=client.getConfiguration();return options.client=client,!0!==config.gatewayConfiguration.paypalEnabled?Promise.reject(new BraintreeError(errors.PAYPAL_NOT_ENABLED)):(analytics.sendEvent(options.client,\"paypal.initialized\"),new PayPal(options)._initialize())}))})),isSupported:function(){return!0},VERSION:\"3.60.0\"}},{\"../lib/analytics\":93,\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./external/paypal\":153,\"./shared/errors\":156,\"@braintree/wrap-promise\":30}],155:[function(_dereq_,module,exports){\"use strict\";module.exports={LANDING_FRAME_NAME:\"braintreepaypallanding\",FLOW_ENDPOINTS:{checkout:\"create_payment_resource\",vault:\"setup_billing_agreement\"}}},{}],156:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={PAYPAL_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_NOT_ENABLED\",message:\"PayPal is not enabled for this merchant.\"},PAYPAL_TOKENIZATION_REQUEST_ACTIVE:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_TOKENIZATION_REQUEST_ACTIVE\",message:\"Another tokenization request is active.\"},PAYPAL_ACCOUNT_TOKENIZATION_FAILED:{type:BraintreeError.types.NETWORK,code:\"PAYPAL_ACCOUNT_TOKENIZATION_FAILED\",message:\"Could not tokenize user's PayPal account.\"},PAYPAL_FLOW_FAILED:{type:BraintreeError.types.NETWORK,code:\"PAYPAL_FLOW_FAILED\",message:\"Could not initialize PayPal flow.\"},PAYPAL_FLOW_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_FLOW_OPTION_REQUIRED\",message:\"PayPal flow property is invalid or missing.\"},PAYPAL_POPUP_OPEN_FAILED:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_POPUP_OPEN_FAILED\",message:\"PayPal popup failed to open, make sure to tokenize in response to a user action.\"},PAYPAL_POPUP_CLOSED:{type:BraintreeError.types.CUSTOMER,code:\"PAYPAL_POPUP_CLOSED\",message:\"Customer closed PayPal popup before authorizing.\"},PAYPAL_INVALID_PAYMENT_OPTION:{type:BraintreeError.types.MERCHANT,code:\"PAYPAL_INVALID_PAYMENT_OPTION\",message:\"PayPal payment options are invalid.\"}}},{\"../../lib/braintree-error\":98}],157:[function(_dereq_,module,exports){\"use strict\";var wrapPromise=_dereq_(\"@braintree/wrap-promise\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),PreferredPaymentMethods=_dereq_(\"./preferred-payment-methods\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"PreferredPaymentMethods\",client:options.client,authorization:options.authorization}).then((function(){return(new PreferredPaymentMethods).initialize(options)}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"./preferred-payment-methods\":158,\"@braintree/wrap-promise\":30}],158:[function(_dereq_,module,exports){\"use strict\";var wrapPromise=_dereq_(\"@braintree/wrap-promise\"),analytics=_dereq_(\"../lib/analytics\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),Promise=_dereq_(\"../lib/promise\");function PreferredPaymentMethods(){}PreferredPaymentMethods.prototype.initialize=function(options){var self=this;return this._clientPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"PreferredPaymentMethods\"}).catch((function(err){return self._setupError=err,Promise.reject(err)})),analytics.sendEvent(this._clientPromise,\"preferred-payment-methods.initialized\"),Promise.resolve(this)},PreferredPaymentMethods.prototype.fetchPreferredPaymentMethods=function(){var client,self=this;return this._clientPromise.then((function(clientInstance){return(client=clientInstance).request({api:\"graphQLApi\",data:{query:\"query ClientConfiguration { clientConfiguration { paypal { paymentMethodAvailableOnDevice } } }\"}})})).then((function(result){var paypalPreferred=result.data.clientConfiguration.paypal.paymentMethodAvailableOnDevice;return analytics.sendEvent(client,\"preferred-payment-methods.paypal.api-detected.\"+paypalPreferred),{paypalPreferred:paypalPreferred}})).catch((function(){return self._setupError?Promise.reject(self._setupError):(analytics.sendEvent(client,\"preferred-payment-methods.api-error\"),{paypalPreferred:!1})}))},module.exports=wrapPromise.wrapPrototype(PreferredPaymentMethods)},{\"../lib/analytics\":93,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"@braintree/wrap-promise\":30}],159:[function(_dereq_,module,exports){(function(global){\"use strict\";var assign=_dereq_(\"../../../lib/assign\").assign,analytics=_dereq_(\"../../../lib/analytics\"),BraintreeError=_dereq_(\"../../../lib/braintree-error\"),Promise=_dereq_(\"../../../lib/promise\"),ExtendedPromise=_dereq_(\"@braintree/extended-promise\"),EventEmitter=_dereq_(\"@braintree/event-emitter\"),errors=_dereq_(\"../../shared/errors\"),iFramer=_dereq_(\"@braintree/iframer\"),Bus=_dereq_(\"../../../lib/bus\"),constants=_dereq_(\"../../shared/constants\"),uuid=_dereq_(\"../../../lib/vendor/uuid\"),events=_dereq_(\"../../shared/events\"),useMin=_dereq_(\"../../../lib/use-min\");function BaseFramework(options){EventEmitter.call(this),this._client=options.client,this._createPromise=options.createPromise,this._createOptions=options,this._client?(this._isDebug=this._client.getConfiguration().isDebug,this._assetsUrl=this._client.getConfiguration().gatewayConfiguration.assetsUrl):(this._isDebug=Boolean(options.isDebug),this._assetsUrl=options.assetsUrl),this._assetsUrl=this._assetsUrl+\"/web/3.60.0\"}EventEmitter.createChild(BaseFramework),BaseFramework.prototype._waitForClient=function(){return this._client?Promise.resolve():this._createPromise.then((function(client){this._client=client}).bind(this))},BaseFramework.prototype.setUpEventListeners=function(){throw new BraintreeError(errors.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},BaseFramework.prototype.verifyCard=function(options,privateOptions){var formattedOptions,error,self=this;return(error=this._checkForVerifyCardError(options,privateOptions=privateOptions||{}))?Promise.reject(error):(this._verifyCardInProgress=!0,formattedOptions=this._formatVerifyCardOptions(options),this._formatLookupData(formattedOptions).then((function(data){return analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.started\"),self._performLookup(formattedOptions.nonce,data)})).then((function(response){return analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.3ds-version.\"+response.lookup.threeDSecureVersion),self._onLookupComplete(response,formattedOptions)})).then((function(response){return self.initializeChallengeWithLookupResponse(response,formattedOptions)})).then((function(payload){return self._resetVerificationState(),analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.completed\"),payload})).catch((function(err){return self._resetVerificationState(),analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.failed\"),Promise.reject(err)})))},BaseFramework.prototype._checkForFrameworkSpecificVerifyCardErrors=function(){throw new BraintreeError(errors.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},BaseFramework.prototype._presentChallenge=function(){throw new BraintreeError(errors.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},BaseFramework.prototype.prepareLookup=function(){throw new BraintreeError(errors.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},BaseFramework.prototype._resetVerificationState=function(){this._verifyCardInProgress=!1,this._verifyCardPromisePlus=null},BaseFramework.prototype._performLookup=function(nonce,data){var self=this,url=\"payment_methods/\"+nonce+\"/three_d_secure/lookup\";return this._waitForClient().then((function(){return self._client.request({endpoint:url,method:\"post\",data:data}).catch((function(err){var lookupError,status=err&&err.details&&err.details.httpStatus,analyticsMessage=\"three-d-secure.verification-flow.lookup-failed\";return 404===status?(lookupError=errors.THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR,analyticsMessage+=\".404\"):422===status?(lookupError=errors.THREEDS_LOOKUP_VALIDATION_ERROR,analyticsMessage+=\".422\"):lookupError=errors.THREEDS_LOOKUP_ERROR,analytics.sendEvent(self._createPromise,analyticsMessage),Promise.reject(new BraintreeError({type:lookupError.type,code:lookupError.code,message:lookupError.message,details:{originalError:err}}))}))}))},BaseFramework.prototype._checkForVerifyCardError=function(options,privateOptions){var errorOption;return!0===this._verifyCardInProgress?new BraintreeError(errors.THREEDS_AUTHENTICATION_IN_PROGRESS):(options.nonce?options.amount||(errorOption=\"an amount\"):errorOption=\"a nonce\",errorOption||(errorOption=this._checkForFrameworkSpecificVerifyCardErrors(options,privateOptions)),errorOption?new BraintreeError({type:errors.THREEDS_MISSING_VERIFY_CARD_OPTION.type,code:errors.THREEDS_MISSING_VERIFY_CARD_OPTION.code,message:\"verifyCard options must include \"+errorOption+\".\"}):null)},BaseFramework.prototype.initializeChallengeWithLookupResponse=function(lookupResponse,options){var self=this;return options=options||{},this._lookupPaymentMethod=lookupResponse.paymentMethod,self._verifyCardPromisePlus=self._verifyCardPromisePlus||new ExtendedPromise,self._handleLookupResponse(lookupResponse,options),self._verifyCardPromisePlus.then((function(payload){return analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.liability-shifted.\"+String(payload.liabilityShifted)),analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.liability-shift-possible.\"+String(payload.liabilityShiftPossible)),payload}))},BaseFramework.prototype._handleLookupResponse=function(lookupResponse,options){var details,challengeShouldBePresented=Boolean(lookupResponse.lookup&&lookupResponse.lookup.acsUrl);analytics.sendEvent(this._createPromise,\"three-d-secure.verification-flow.challenge-presented.\"+String(challengeShouldBePresented)),challengeShouldBePresented?this._presentChallenge(lookupResponse,options):((details=this._formatAuthResponse(lookupResponse.paymentMethod,lookupResponse.threeDSecureInfo)).verificationDetails=lookupResponse.threeDSecureInfo,this._verifyCardPromisePlus.resolve(details))},BaseFramework.prototype._onLookupComplete=function(response){return this._lookupPaymentMethod=response.paymentMethod,this._verifyCardPromisePlus=new ExtendedPromise,Promise.resolve(response)},BaseFramework.prototype._formatAuthResponse=function(paymentMethod,threeDSecureInfo){return{nonce:paymentMethod.nonce,binData:paymentMethod.binData,details:paymentMethod.details,description:paymentMethod.description&&paymentMethod.description.replace(/\\+/g,\" \"),liabilityShifted:threeDSecureInfo&&threeDSecureInfo.liabilityShifted,liabilityShiftPossible:threeDSecureInfo&&threeDSecureInfo.liabilityShiftPossible,threeDSecureInfo:paymentMethod.threeDSecureInfo}},BaseFramework.prototype._formatVerifyCardOptions=function(options){return assign({},options)},BaseFramework.prototype._formatLookupData=function(options){return Promise.resolve({amount:options.amount})},BaseFramework.prototype._handleV1AuthResponse=function(data){var authResponse=JSON.parse(data.auth_response);authResponse.success?this._verifyCardPromisePlus.resolve(this._formatAuthResponse(authResponse.paymentMethod,authResponse.threeDSecureInfo)):authResponse.threeDSecureInfo&&authResponse.threeDSecureInfo.liabilityShiftPossible?this._verifyCardPromisePlus.resolve(this._formatAuthResponse(this._lookupPaymentMethod,authResponse.threeDSecureInfo)):this._verifyCardPromisePlus.reject(new BraintreeError({type:BraintreeError.types.UNKNOWN,code:\"UNKNOWN_AUTH_RESPONSE\",message:authResponse.error.message}))},BaseFramework.prototype.cancelVerifyCard=function(){var response,threeDSecureInfo;return this._verifyCardInProgress=!1,this._lookupPaymentMethod?(response=assign({},this._lookupPaymentMethod,{liabilityShiftPossible:(threeDSecureInfo=this._lookupPaymentMethod.threeDSecureInfo)&&threeDSecureInfo.liabilityShiftPossible,liabilityShifted:threeDSecureInfo&&threeDSecureInfo.liabilityShifted,verificationDetails:threeDSecureInfo&&threeDSecureInfo.verificationDetails}),Promise.resolve(response)):Promise.reject(new BraintreeError(errors.THREEDS_NO_VERIFICATION_PAYLOAD))},BaseFramework.prototype._setupV1Bus=function(options){var parentURL=global.location.href.split(\"#\")[0],lookupResponse=options.lookupResponse,bus=new Bus({channel:uuid(),merchantUrl:global.location.href}),authenticationCompleteBaseUrl=this._assetsUrl+\"/html/three-d-secure-authentication-complete-frame.html?channel=\"+encodeURIComponent(bus.channel)+\"&\";return bus.on(Bus.events.CONFIGURATION_REQUEST,(function(reply){reply({acsUrl:lookupResponse.acsUrl,pareq:lookupResponse.pareq,termUrl:lookupResponse.termUrl+\"&three_d_secure_version=3.60.0&authentication_complete_base_url=\"+encodeURIComponent(authenticationCompleteBaseUrl),md:lookupResponse.md,parentUrl:parentURL})})),bus.on(events.AUTHENTICATION_COMPLETE,options.handleAuthResponse),bus},BaseFramework.prototype._setupV1Iframe=function(options){var url=this._assetsUrl+\"/html/three-d-secure-bank-frame\"+useMin(this._isDebug)+\".html?showLoader=\"+options.showLoader;return iFramer({src:url,height:400,width:400,name:constants.LANDING_FRAME_NAME+\"_\"+this._v1Bus.channel,title:\"3D Secure Authorization Frame\"})},BaseFramework.prototype._setupV1Elements=function(options){this._v1Bus=this._setupV1Bus(options),this._v1Iframe=this._setupV1Iframe(options)},BaseFramework.prototype._teardownV1Elements=function(){this._v1Bus&&(this._v1Bus.teardown(),this._v1Bus=null),this._v1Iframe&&this._v1Iframe.parentNode&&(this._v1Iframe.parentNode.removeChild(this._v1Iframe),this._v1Iframe=null),this._onV1Keyup&&(document.removeEventListener(\"keyup\",this._onV1Keyup),this._onV1Keyup=null)},BaseFramework.prototype.teardown=function(){return analytics.sendEvent(this._createPromise,\"three-d-secure.teardown-completed\"),this._teardownV1Elements(),Promise.resolve()},module.exports=BaseFramework}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../../lib/analytics\":93,\"../../../lib/assign\":95,\"../../../lib/braintree-error\":98,\"../../../lib/bus\":101,\"../../../lib/promise\":132,\"../../../lib/use-min\":134,\"../../../lib/vendor/uuid\":136,\"../../shared/constants\":168,\"../../shared/errors\":169,\"../../shared/events\":170,\"@braintree/event-emitter\":21,\"@braintree/extended-promise\":22,\"@braintree/iframer\":23}],160:[function(_dereq_,module,exports){\"use strict\";var SongbirdFramework=_dereq_(\"./songbird\");function Bootstrap3ModalFramework(options){SongbirdFramework.call(this,options)}(Bootstrap3ModalFramework.prototype=Object.create(SongbirdFramework.prototype,{constructor:SongbirdFramework}))._createV1IframeModalElement=function(iframe){var modal=document.createElement(\"div\");return modal.innerHTML='<div class=\"modal fade in\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"CCAFrameModal-label\" aria-hidden=\"true\" style=\"display: block;\"><div class=\"modal-dialog\" style=\"width:440px;z-index:999999;\"><div class=\"modal-content\"><div class=\"modal-body\" data-braintree-v1-fallback-iframe-container><button type=\"button\" data-braintree-v1-fallback-close-button class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">×</button></div></div></div><div data-braintree-v1-fallback-backdrop style=\"position: fixed;cursor: pointer;z-index: 999998;top: 0;left: 0;width: 100%;height: 100%;\"></div></div>',modal.querySelector(\"[data-braintree-v1-fallback-iframe-container]\").appendChild(iframe),modal},Bootstrap3ModalFramework.prototype._createCardinalConfigurationOptions=function(setupOptions){var options=SongbirdFramework.prototype._createCardinalConfigurationOptions.call(this,setupOptions);return options.payment.framework=\"bootstrap3\",options},module.exports=Bootstrap3ModalFramework},{\"./songbird\":165}],161:[function(_dereq_,module,exports){\"use strict\";var SongbirdFramework=_dereq_(\"./songbird\");function CardinalModalFramework(options){SongbirdFramework.call(this,options)}(CardinalModalFramework.prototype=Object.create(SongbirdFramework.prototype,{constructor:SongbirdFramework}))._createV1IframeModalElement=function(iframe){var modal=document.createElement(\"div\"),addCloseButton=Boolean(this._createOptions&&this._createOptions.cardinalSDKConfig&&this._createOptions.cardinalSDKConfig.payment&&this._createOptions.cardinalSDKConfig.payment.displayExitButton);return modal.innerHTML='<div style=\"position: fixed;z-index: 999999;top: 50%;left: 50%;padding: 24px 20px;transform: translate(-50%,-50%);border-radius: 2px;background: #fff;max-width: 100%;overflow: auto;\"><div><button data-braintree-v1-fallback-close-button style=\"font-family: Helvetica,Arial,sans-serif;font-size: 25px;line-height: 12px;position: absolute;top: 2px;right: 0px;cursor: pointer;color: #999;border: 0;outline: none;background: none;\" onMouseOver=\"this.style.color=\\'#000\\'\" onMouseOut=\"this.style.color=\\'#999\\'\">×</button></div><div data-braintree-v1-fallback-iframe-container style=\"height: 400px;\"></div></div><div data-braintree-v1-fallback-backdrop style=\"position: fixed;z-index: 999998;cursor: pointer;top: 0;left: 0;width: 100%;height: 100%;transition: opacity 1ms ease;background: rgba(0,0,0,.6);\"></div>',addCloseButton||(modal.querySelector(\"[data-braintree-v1-fallback-close-button]\").style.display=\"none\"),modal.querySelector(\"[data-braintree-v1-fallback-iframe-container]\").appendChild(iframe),modal},module.exports=CardinalModalFramework},{\"./songbird\":165}],162:[function(_dereq_,module,exports){\"use strict\";var LegacyFramework=_dereq_(\"./legacy\"),CardinalModalFramework=_dereq_(\"./cardinal-modal\"),Bootstrap3ModalFramework=_dereq_(\"./bootstrap3-modal\"),InlineIframeFramework=_dereq_(\"./inline-iframe\");module.exports={legacy:LegacyFramework,\"cardinal-modal\":CardinalModalFramework,\"bootstrap3-modal\":Bootstrap3ModalFramework,\"inline-iframe\":InlineIframeFramework}},{\"./bootstrap3-modal\":160,\"./cardinal-modal\":161,\"./inline-iframe\":163,\"./legacy\":164}],163:[function(_dereq_,module,exports){\"use strict\";var SongbirdFramework=_dereq_(\"./songbird\"),BraintreeError=_dereq_(\"../../../lib/braintree-error\"),errors=_dereq_(\"../../shared/errors\"),enumerate=_dereq_(\"../../../lib/enumerate\");function InlineIframeFramework(options){SongbirdFramework.call(this,options)}InlineIframeFramework.prototype=Object.create(SongbirdFramework.prototype,{constructor:SongbirdFramework}),InlineIframeFramework.events=enumerate([\"AUTHENTICATION_IFRAME_AVAILABLE\"],\"inline-iframe-framework:\"),InlineIframeFramework.prototype.setUpEventListeners=function(reply){SongbirdFramework.prototype.setUpEventListeners.call(this,reply),this.on(InlineIframeFramework.events.AUTHENTICATION_IFRAME_AVAILABLE,(function(payload,next){reply(\"authentication-iframe-available\",payload,next)}))},InlineIframeFramework.prototype._createCardinalConfigurationOptions=function(setupOptions){var options=SongbirdFramework.prototype._createCardinalConfigurationOptions.call(this,setupOptions);return options.payment.framework=\"inline\",options},InlineIframeFramework.prototype._addV1IframeToPage=function(){this._emit(InlineIframeFramework.events.AUTHENTICATION_IFRAME_AVAILABLE,{element:this._v1Modal},(function(){}))},InlineIframeFramework.prototype._setupFrameworkSpecificListeners=function(){this.setCardinalListener(\"ui.inline.setup\",this._onInlineSetup.bind(this))},InlineIframeFramework.prototype._onInlineSetup=function(htmlTemplate,details,resolve,reject){var container,hasError;htmlTemplate&&details?(\"CCA\"!==details.paymentType||\"suppress\"!==details.data.mode&&\"static\"!==details.data.mode)&&(hasError=!0):hasError=!0,hasError?reject(new BraintreeError(errors.THREEDS_INLINE_IFRAME_DETAILS_INCORRECT)):((container=document.createElement(\"div\")).innerHTML=htmlTemplate,\"suppress\"===details.data.mode?(container.style.display=\"none\",document.body.appendChild(container),resolve()):\"static\"===details.data.mode&&this._emit(InlineIframeFramework.events.AUTHENTICATION_IFRAME_AVAILABLE,{element:container},(function(){resolve()})))},module.exports=InlineIframeFramework},{\"../../../lib/braintree-error\":98,\"../../../lib/enumerate\":111,\"../../shared/errors\":169,\"./songbird\":165}],164:[function(_dereq_,module,exports){\"use strict\";var BaseFramework=_dereq_(\"./base\"),deferred=_dereq_(\"../../../lib/deferred\");function LegacyFramework(options){BaseFramework.call(this,options)}(LegacyFramework.prototype=Object.create(BaseFramework.prototype,{constructor:LegacyFramework})).setUpEventListeners=function(){},LegacyFramework.prototype.transformV1CustomerBillingAddress=function(customer){return customer.billingAddress.line1=customer.billingAddress.streetAddress,customer.billingAddress.line2=customer.billingAddress.extendedAddress,customer.billingAddress.city=customer.billingAddress.locality,customer.billingAddress.state=customer.billingAddress.region,customer.billingAddress.countryCode=customer.billingAddress.countryCodeAlpha2,delete customer.billingAddress.streetAddress,delete customer.billingAddress.extendedAddress,delete customer.billingAddress.locality,delete customer.billingAddress.region,delete customer.billingAddress.countryCodeAlpha2,customer},LegacyFramework.prototype._createIframe=function(options){var self=this;return this._setupV1Elements({lookupResponse:options.lookupResponse,showLoader:options.showLoader,handleAuthResponse:function(data){self._handleAuthResponse(data,options)}}),this._v1Iframe},LegacyFramework.prototype._handleAuthResponse=function(data,options){this._v1Bus.teardown(),options.removeFrame(),deferred((function(){this._handleV1AuthResponse(data)}).bind(this))()},LegacyFramework.prototype._checkForFrameworkSpecificVerifyCardErrors=function(options){var errorOption;return\"function\"!=typeof options.addFrame?errorOption=\"an addFrame function\":\"function\"!=typeof options.removeFrame&&(errorOption=\"a removeFrame function\"),errorOption},LegacyFramework.prototype._formatVerifyCardOptions=function(options){var modifiedOptions=BaseFramework.prototype._formatVerifyCardOptions.call(this,options);return modifiedOptions.addFrame=deferred(options.addFrame),modifiedOptions.removeFrame=deferred(options.removeFrame),modifiedOptions.showLoader=!1!==options.showLoader,modifiedOptions},LegacyFramework.prototype._formatLookupData=function(options){var self=this;return BaseFramework.prototype._formatLookupData.call(this,options).then((function(data){return options.customer&&options.customer.billingAddress&&(data.customer=self.transformV1CustomerBillingAddress(options.customer)),data}))},LegacyFramework.prototype._presentChallenge=function(lookupResponse,options){options.addFrame(null,this._createIframe({showLoader:options.showLoader,lookupResponse:lookupResponse.lookup,removeFrame:options.removeFrame}))},module.exports=LegacyFramework},{\"../../../lib/deferred\":109,\"./base\":159}],165:[function(_dereq_,module,exports){(function(global){\"use strict\";var BaseFramework=_dereq_(\"./base\"),assign=_dereq_(\"../../../lib/assign\").assign,deferred=_dereq_(\"../../../lib/deferred\"),BraintreeError=_dereq_(\"../../../lib/braintree-error\"),convertToBraintreeError=_dereq_(\"../../../lib/convert-to-braintree-error\"),analytics=_dereq_(\"../../../lib/analytics\"),assets=_dereq_(\"../../../lib/assets\"),errors=_dereq_(\"../../shared/errors\"),enumerate=_dereq_(\"../../../lib/enumerate\"),constants=_dereq_(\"../../shared/constants\"),Promise=_dereq_(\"../../../lib/promise\"),ExtendedPromise=_dereq_(\"@braintree/extended-promise\"),INTEGRATION_TIMEOUT_MS=_dereq_(\"../../../lib/constants\").INTEGRATION_TIMEOUT_MS,PLATFORM=_dereq_(\"../../../lib/constants\").PLATFORM;function SongbirdFramework(options){BaseFramework.call(this,options),this._useV1Fallback=!1,this._clientMetadata={requestedThreeDSecureVersion:\"2\",sdkVersion:PLATFORM+\"/3.60.0\"},this._getDfReferenceIdPromisePlus=new ExtendedPromise,this.setupSongbird(options),this._cardinalEvents=[]}function extractAddressData(source,target,prefix){target[prefix+\"Line1\"]=source.streetAddress,target[prefix+\"Line2\"]=source.extendedAddress,target[prefix+\"Line3\"]=source.line3,target[prefix+\"City\"]=source.locality,target[prefix+\"State\"]=source.region,target[prefix+\"PostalCode\"]=source.postalCode,target[prefix+\"CountryCode\"]=source.countryCodeAlpha2}SongbirdFramework.prototype=Object.create(BaseFramework.prototype,{constructor:SongbirdFramework}),SongbirdFramework.events=enumerate([\"ON_LOOKUP_COMPLETE\"],\"songbird-framework:\"),SongbirdFramework.prototype.setUpEventListeners=function(reply){this.on(SongbirdFramework.events.ON_LOOKUP_COMPLETE,(function(data,next){reply(\"lookup-complete\",data,next)}))},SongbirdFramework.prototype.prepareLookup=function(options){var data=assign({},options),self=this;return this.getDfReferenceId().then((function(id){data.dfReferenceId=id})).then((function(){return self._triggerCardinalBinProcess(options.bin)})).catch((function(){})).then((function(){return self._waitForClient()})).then((function(){return data.clientMetadata=self._clientMetadata,data.authorizationFingerprint=self._client.getConfiguration().authorizationFingerprint,data.braintreeLibraryVersion=\"braintree/web/3.60.0\",data}))},SongbirdFramework.prototype.initializeChallengeWithLookupResponse=function(lookupResponse,options){return this.setupSongbird().then((function(){return BaseFramework.prototype.initializeChallengeWithLookupResponse.call(this,lookupResponse,options)}).bind(this))},SongbirdFramework.prototype._initiateV1Fallback=function(errorType){this._useV1Fallback=!0,analytics.sendEvent(this._createPromise,\"three-d-secure.v1-fallback.\"+errorType),this._songbirdPromise.resolve()},SongbirdFramework.prototype._triggerCardinalBinProcess=function(bin){var self=this,issuerStartTime=Date.now();return bin?global.Cardinal.trigger(\"bin.process\",bin).then((function(binResults){self._clientMetadata.issuerDeviceDataCollectionTimeElapsed=Date.now()-issuerStartTime,self._clientMetadata.issuerDeviceDataCollectionResult=binResults&&binResults.Status})):Promise.resolve()},SongbirdFramework.prototype.transformBillingAddress=function(additionalInformation,billingAddress){return billingAddress&&(extractAddressData(billingAddress,additionalInformation,\"billing\"),additionalInformation.billingPhoneNumber=billingAddress.phoneNumber,additionalInformation.billingGivenName=billingAddress.givenName,additionalInformation.billingSurname=billingAddress.surname),additionalInformation},SongbirdFramework.prototype.transformShippingAddress=function(additionalInformation){var shippingAddress=additionalInformation.shippingAddress;return shippingAddress&&(extractAddressData(shippingAddress,additionalInformation,\"shipping\"),delete additionalInformation.shippingAddress),additionalInformation},SongbirdFramework.prototype._createV1IframeModalElement=function(iframe){var modal=document.createElement(\"div\");return modal.innerHTML='<div data-braintree-v1-fallback-iframe-container=\"true\" style=\"height: 400px;\"></div>',modal.querySelector('[data-braintree-v1-fallback-iframe-container=\"true\"]').appendChild(iframe),modal},SongbirdFramework.prototype._createV1IframeModal=function(iframe){var modal=this._createV1IframeModalElement(iframe),btn=modal.querySelector(\"[data-braintree-v1-fallback-close-button]\"),backdrop=modal.querySelector(\"[data-braintree-v1-fallback-backdrop]\"),self=this;function closeHandler(){modal.parentNode.removeChild(modal),self.cancelVerifyCard(errors.THREEDS_CARDINAL_SDK_CANCELED),document.removeEventListener(\"keyup\",self._onV1Keyup),self._onV1Keyup=null}return this._onV1Keyup=function(e){\"Escape\"===e.key&&modal.parentNode&&closeHandler()},btn&&btn.addEventListener(\"click\",closeHandler),backdrop&&backdrop.addEventListener(\"click\",closeHandler),document.addEventListener(\"keyup\",this._onV1Keyup),modal},SongbirdFramework.prototype._addV1IframeToPage=function(){document.body.appendChild(this._v1Modal)},SongbirdFramework.prototype._handleAuthResponseFromV1Fallback=function(data){this._teardownV1Elements(),this._v1Modal.parentNode.removeChild(this._v1Modal),this._handleV1AuthResponse(data)},SongbirdFramework.prototype._presentChallengeWithV1Fallback=function(lookupResponse){var self=this;this._setupV1Elements({lookupResponse:lookupResponse,showLoader:!0,handleAuthResponse:function(data){self._handleAuthResponseFromV1Fallback(data)}}),this._v1Modal=this._createV1IframeModal(this._v1Iframe),this._addV1IframeToPage()},SongbirdFramework.prototype.setupSongbird=function(setupOptions){var self=this,startTime=Date.now();return this._songbirdPromise||(setupOptions=setupOptions||{},this._songbirdPromise=new ExtendedPromise,this._v2SetupFailureReason=\"reason-unknown\",self._loadCardinalScript(setupOptions).then((function(){return global.Cardinal?self._configureCardinalSdk({setupOptions:setupOptions,setupStartTime:startTime}):(self._v2SetupFailureReason=\"cardinal-global-unavailable\",Promise.reject(new BraintreeError(errors.THREEDS_CARDINAL_SDK_SETUP_FAILED)))})).catch((function(err){var error=convertToBraintreeError(err,{type:errors.THREEDS_CARDINAL_SDK_SETUP_FAILED.type,code:errors.THREEDS_CARDINAL_SDK_SETUP_FAILED.code,message:errors.THREEDS_CARDINAL_SDK_SETUP_FAILED.message});self._getDfReferenceIdPromisePlus.reject(error),global.clearTimeout(self._songbirdSetupTimeoutReference),analytics.sendEvent(self._client,\"three-d-secure.cardinal-sdk.init.setup-failed\"),self._initiateV1Fallback(\"cardinal-sdk-setup-failed.\"+self._v2SetupFailureReason)}))),this._songbirdPromise},SongbirdFramework.prototype._configureCardinalSdk=function(config){var self=this;return this._waitForClient().then((function(){var jwt=self._client.getConfiguration().gatewayConfiguration.threeDSecure.cardinalAuthenticationJWT,setupStartTime=config.setupStartTime,cardinalConfiguration=self._createCardinalConfigurationOptions(config.setupOptions);self.setCardinalListener(\"payments.setupComplete\",self._createPaymentsSetupCompleteCallback()),self._setupFrameworkSpecificListeners(),global.Cardinal.configure(cardinalConfiguration),global.Cardinal.setup(\"init\",{jwt:jwt}),self._clientMetadata.cardinalDeviceDataCollectionTimeElapsed=Date.now()-setupStartTime,self.setCardinalListener(\"payments.validated\",self._createPaymentsValidatedCallback())})).catch((function(err){return self._v2SetupFailureReason=\"cardinal-configuration-threw-error\",Promise.reject(err)}))},SongbirdFramework.prototype.setCardinalListener=function(eventName,cb){this._cardinalEvents.push(eventName),global.Cardinal.on(eventName,cb)},SongbirdFramework.prototype._setupFrameworkSpecificListeners=function(){},SongbirdFramework.prototype._createCardinalConfigurationOptions=function(setupOptions){var cardinalConfiguration=setupOptions.cardinalSDKConfig||{},paymentSettings=cardinalConfiguration.payment||{};return!cardinalConfiguration.logging&&setupOptions.loggingEnabled&&(cardinalConfiguration.logging={level:\"verbose\"}),cardinalConfiguration.payment={},paymentSettings.hasOwnProperty(\"displayLoading\")&&(cardinalConfiguration.payment.displayLoading=paymentSettings.displayLoading),paymentSettings.hasOwnProperty(\"displayExitButton\")&&(cardinalConfiguration.payment.displayExitButton=paymentSettings.displayExitButton),cardinalConfiguration},SongbirdFramework.prototype._loadCardinalScript=function(setupOptions){var self=this,scriptSource=constants.CARDINAL_SCRIPT_SOURCE.sandbox;return this._waitForClient().then((function(){var isProduction=\"production\"===self._client.getConfiguration().gatewayConfiguration.environment;return self._songbirdSetupTimeoutReference=global.setTimeout((function(){analytics.sendEvent(self._client,\"three-d-secure.cardinal-sdk.init.setup-timeout\"),self._initiateV1Fallback(\"cardinal-sdk-setup-timeout\")}),setupOptions.timeout||INTEGRATION_TIMEOUT_MS),isProduction&&(scriptSource=constants.CARDINAL_SCRIPT_SOURCE.production),assets.loadScript({src:scriptSource})})).catch((function(err){return self._v2SetupFailureReason=\"songbird-js-failed-to-load\",Promise.reject(convertToBraintreeError(err,errors.THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED))}))},SongbirdFramework.prototype._createPaymentsSetupCompleteCallback=function(){var self=this;return function(data){self._getDfReferenceIdPromisePlus.resolve(data.sessionId),global.clearTimeout(self._songbirdSetupTimeoutReference),analytics.sendEvent(self._createPromise,\"three-d-secure.cardinal-sdk.init.setup-completed\"),self._songbirdPromise.resolve()}},SongbirdFramework.prototype.getDfReferenceId=function(){return this._getDfReferenceIdPromisePlus},SongbirdFramework.prototype._performJWTValidation=function(jwt){var nonce=this._lookupPaymentMethod.nonce,url=\"payment_methods/\"+nonce+\"/three_d_secure/authenticate_from_jwt\",self=this;return analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.upgrade-payment-method.started\"),this._waitForClient().then((function(){return self._client.request({method:\"post\",endpoint:url,data:{jwt:jwt,paymentMethodNonce:nonce}})})).then((function(response){var formattedResponse=self._formatAuthResponse(response.paymentMethod||self._lookupPaymentMethod,response.threeDSecureInfo);return analytics.sendEvent(self._client,\"three-d-secure.verification-flow.upgrade-payment-method.succeeded\"),Promise.resolve(formattedResponse)})).catch((function(err){var error=new BraintreeError({type:errors.THREEDS_JWT_AUTHENTICATION_FAILED.type,code:errors.THREEDS_JWT_AUTHENTICATION_FAILED.code,message:errors.THREEDS_JWT_AUTHENTICATION_FAILED.message,details:{originalError:err}});return analytics.sendEvent(self._client,\"three-d-secure.verification-flow.upgrade-payment-method.errored\"),Promise.reject(error)}))},SongbirdFramework.prototype._createPaymentsValidatedCallback=function(){var self=this;return function(data,validatedJwt){var formattedError;if(analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.cardinal-sdk.action-code.\"+data.ActionCode.toLowerCase()),self._verifyCardPromisePlus)switch(data.ActionCode){case\"SUCCESS\":case\"NOACTION\":case\"FAILURE\":self._performJWTValidation(validatedJwt).then((function(result){self._verifyCardPromisePlus.resolve(result)})).catch((function(err){self._verifyCardPromisePlus.reject(err)}));break;case\"ERROR\":switch(analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.cardinal-sdk-error.\"+data.ErrorNumber),data.ErrorNumber){case 10001:case 10002:formattedError=new BraintreeError(errors.THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT);break;case 10003:case 10007:case 10009:formattedError=new BraintreeError(errors.THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT);break;case 10005:case 10006:formattedError=new BraintreeError(errors.THREEDS_CARDINAL_SDK_BAD_CONFIG);break;case 10008:case 10010:formattedError=new BraintreeError(errors.THREEDS_CARDINAL_SDK_BAD_JWT);break;case 10011:analytics.sendEvent(self._createPromise,\"three-d-secure.verification-flow.canceled\"),formattedError=new BraintreeError(errors.THREEDS_CARDINAL_SDK_CANCELED);break;default:formattedError=new BraintreeError(errors.THREEDS_CARDINAL_SDK_ERROR)}formattedError.details={originalError:{code:data.ErrorNumber,description:data.ErrorDescription}},self._verifyCardPromisePlus.reject(formattedError)}else self._initiateV1Fallback(\"cardinal-sdk-setup-error.number-\"+data.ErrorNumber)}},SongbirdFramework.prototype._checkForVerifyCardError=function(options,privateOptions){return BaseFramework.prototype._checkForVerifyCardError.call(this,options,privateOptions)},SongbirdFramework.prototype._checkForFrameworkSpecificVerifyCardErrors=function(options,privateOptions){var errorOption;return\"function\"==typeof options.onLookupComplete||privateOptions.ignoreOnLookupCompleteRequirement||(errorOption=\"an onLookupComplete function\"),errorOption},SongbirdFramework.prototype._formatVerifyCardOptions=function(options){var modifiedOptions=BaseFramework.prototype._formatVerifyCardOptions.call(this,options),additionalInformation=modifiedOptions.additionalInformation||{};return additionalInformation=this.transformBillingAddress(additionalInformation,options.billingAddress),additionalInformation=this.transformShippingAddress(additionalInformation),options.onLookupComplete&&(modifiedOptions.onLookupComplete=deferred(options.onLookupComplete)),options.email&&(additionalInformation.email=options.email),options.mobilePhoneNumber&&(additionalInformation.mobilePhoneNumber=options.mobilePhoneNumber),modifiedOptions.additionalInformation=additionalInformation,modifiedOptions},SongbirdFramework.prototype._onLookupComplete=function(lookupResponse,options){var self=this;return BaseFramework.prototype._onLookupComplete.call(this,lookupResponse).then((function(response){return new Promise((function(resolve,reject){function next(){resolve(response)}response.requiresUserAuthentication=Boolean(response.lookup&&response.lookup.acsUrl),self._verifyCardPromisePlus.catch(reject),options.onLookupComplete?options.onLookupComplete(response,next):self._emit(SongbirdFramework.events.ON_LOOKUP_COMPLETE,response,next)}))}))},SongbirdFramework.prototype._presentChallenge=function(lookupResponse){this._useV1Fallback?this._presentChallengeWithV1Fallback(lookupResponse.lookup):global.Cardinal.continue(\"cca\",{AcsUrl:lookupResponse.lookup.acsUrl,Payload:lookupResponse.lookup.pareq},{OrderDetails:{TransactionId:lookupResponse.lookup.transactionId}})},SongbirdFramework.prototype._formatLookupData=function(options){var self=this;return BaseFramework.prototype._formatLookupData.call(this,options).then((function(data){return data.additionalInfo=options.additionalInformation,options.challengeRequested&&(data.challengeRequested=options.challengeRequested),options.exemptionRequested&&(data.exemptionRequested=options.exemptionRequested),options.bin&&(data.bin=options.bin),self.prepareLookup(data)}))},SongbirdFramework.prototype.cancelVerifyCard=function(verifyCardError){var self=this;return BaseFramework.prototype.cancelVerifyCard.call(this).then((function(response){return self._verifyCardPromisePlus&&(verifyCardError=verifyCardError||new BraintreeError(errors.THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT),self._verifyCardPromisePlus.reject(verifyCardError)),response}))},SongbirdFramework.prototype.teardown=function(){return global.Cardinal&&this._cardinalEvents.forEach((function(eventName){global.Cardinal.off(eventName)})),BaseFramework.prototype.teardown.call(this)},module.exports=SongbirdFramework}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../../../lib/analytics\":93,\"../../../lib/assets\":94,\"../../../lib/assign\":95,\"../../../lib/braintree-error\":98,\"../../../lib/constants\":103,\"../../../lib/convert-to-braintree-error\":105,\"../../../lib/deferred\":109,\"../../../lib/enumerate\":111,\"../../../lib/promise\":132,\"../../shared/constants\":168,\"../../shared/errors\":169,\"./base\":159,\"@braintree/extended-promise\":22}],166:[function(_dereq_,module,exports){\"use strict\";var wrapPromise=_dereq_(\"@braintree/wrap-promise\"),methods=_dereq_(\"../../lib/methods\"),convertMethodsToError=_dereq_(\"../../lib/convert-methods-to-error\"),EventEmitter=_dereq_(\"@braintree/event-emitter\"),FRAMEWORKS=_dereq_(\"./frameworks\");function ThreeDSecure(options){var self=this,Framework=FRAMEWORKS[options.framework];EventEmitter.call(this),this._framework=new Framework(options),this._framework.setUpEventListeners((function(){self._emit.apply(self,arguments)}))}EventEmitter.createChild(ThreeDSecure),ThreeDSecure.prototype.verifyCard=function(options){var privateOptions;return this.hasListener(\"lookup-complete\")&&(privateOptions={ignoreOnLookupCompleteRequirement:!0}),this._framework.verifyCard(options,privateOptions)},ThreeDSecure.prototype.initializeChallengeWithLookupResponse=function(lookupResponse){return\"string\"==typeof lookupResponse&&(lookupResponse=JSON.parse(lookupResponse)),this._framework.initializeChallengeWithLookupResponse(lookupResponse)},ThreeDSecure.prototype.prepareLookup=function(options){return this._framework.prepareLookup(options).then((function(data){return JSON.stringify(data)}))},ThreeDSecure.prototype.cancelVerifyCard=function(){return this._framework.cancelVerifyCard()},ThreeDSecure.prototype.teardown=function(){var methodNames=methods(ThreeDSecure.prototype).concat(methods(EventEmitter.prototype));return convertMethodsToError(this,methodNames),this._framework.teardown()},module.exports=wrapPromise.wrapPrototype(ThreeDSecure)},{\"../../lib/convert-methods-to-error\":104,\"../../lib/methods\":130,\"./frameworks\":162,\"@braintree/event-emitter\":21,\"@braintree/wrap-promise\":30}],167:[function(_dereq_,module,exports){\"use strict\";var ThreeDSecure=_dereq_(\"./external/three-d-secure\"),isHTTPS=_dereq_(\"../lib/is-https\").isHTTPS,basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),analytics=_dereq_(\"../lib/analytics\"),errors=_dereq_(\"./shared/errors\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"3D Secure\",client:options.client,authorization:options.authorization}).then((function(){var assetsUrl=createAssetsUrl.create(options.authorization),framework=function(options){var version=String(options.version||\"\");if(!version||\"1\"===version)return\"legacy\";switch(version){case\"2\":case\"2-cardinal-modal\":return\"cardinal-modal\";case\"2-bootstrap3-modal\":return\"bootstrap3-modal\";case\"2-inline-iframe\":return\"inline-iframe\";default:throw new BraintreeError({code:errors.THREEDS_UNRECOGNIZED_VERSION.code,type:errors.THREEDS_UNRECOGNIZED_VERSION.type,message:\"Version `\"+options.version+\"` is not a recognized version. You may need to update the version of your Braintree SDK to support this version.\"})}}(options),createPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:assetsUrl,name:\"3D Secure\"}).then((function(client){var error,config=client.getConfiguration(),gwConfig=config.gatewayConfiguration;return options.client=client,gwConfig.threeDSecureEnabled||(error=errors.THREEDS_NOT_ENABLED),\"TOKENIZATION_KEY\"===config.authorizationType&&(error=errors.THREEDS_CAN_NOT_USE_TOKENIZATION_KEY),\"production\"===gwConfig.environment&&!isHTTPS()&&(error=errors.THREEDS_HTTPS_REQUIRED),\"legacy\"===framework||gwConfig.threeDSecure&&gwConfig.threeDSecure.cardinalAuthenticationJWT||(analytics.sendEvent(options.client,\"three-d-secure.initialization.failed.missing-cardinalAuthenticationJWT\"),error=errors.THREEDS_NOT_ENABLED_FOR_V2),error?Promise.reject(new BraintreeError(error)):(analytics.sendEvent(options.client,\"three-d-secure.initialized\"),client)})),instance=new ThreeDSecure({client:options.client,assetsUrl:assetsUrl,createPromise:createPromise,loggingEnabled:options.loggingEnabled,cardinalSDKConfig:options.cardinalSDKConfig,framework:framework});return options.client?createPromise.then((function(){return instance})):instance}))})),VERSION:\"3.60.0\"}},{\"../lib/analytics\":93,\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/is-https\":127,\"../lib/promise\":132,\"./external/three-d-secure\":166,\"./shared/errors\":169,\"@braintree/wrap-promise\":30}],168:[function(_dereq_,module,exports){\"use strict\";module.exports={LANDING_FRAME_NAME:\"braintreethreedsecurelanding\",CARDINAL_SCRIPT_SOURCE:{production:\"https://songbird.cardinalcommerce.com/edge/v1/songbird.js\",sandbox:\"https://songbirdstag.cardinalcommerce.com/edge/v1/songbird.js\"}}},{}],169:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={THREEDS_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_NOT_ENABLED\",message:\"3D Secure is not enabled for this merchant.\"},THREEDS_CAN_NOT_USE_TOKENIZATION_KEY:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_CAN_NOT_USE_TOKENIZATION_KEY\",message:\"3D Secure can not use a tokenization key for authorization.\"},THREEDS_HTTPS_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_HTTPS_REQUIRED\",message:\"3D Secure requires HTTPS.\"},THREEDS_NOT_ENABLED_FOR_V2:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_NOT_ENABLED_FOR_V2\",message:\"3D Secure version 2 is not enabled for this merchant. Contact Braintree Support for assistance at https://help.braintreepayments.com/\"},THREEDS_UNRECOGNIZED_VERSION:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_UNRECOGNIZED_VERSION\"},THREEDS_CARDINAL_SDK_SETUP_FAILED:{type:BraintreeError.types.UNKNOWN,code:\"THREEDS_CARDINAL_SDK_SETUP_FAILED\",message:\"Something went wrong setting up Cardinal's Songbird.js library.\"},THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED:{type:BraintreeError.types.NETWORK,code:\"THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED\",message:\"Cardinal's Songbird.js library could not be loaded.\"},THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT:{type:BraintreeError.types.UNKNOWN,code:\"THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT\",message:\"Cardinal's Songbird.js took too long to setup.\"},THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT:{type:BraintreeError.types.UNKNOWN,code:\"THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT\",message:\"Cardinal's API took too long to respond.\"},THREEDS_CARDINAL_SDK_BAD_CONFIG:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_CARDINAL_SDK_BAD_CONFIG\",message:\"JWT or other required field missing. Please check your setup configuration.\"},THREEDS_CARDINAL_SDK_BAD_JWT:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_CARDINAL_SDK_BAD_JWT\",message:\"Cardinal JWT missing or malformed. Please check your setup configuration.\"},THREEDS_CARDINAL_SDK_ERROR:{type:BraintreeError.types.UNKNOWN,code:\"THREEDS_CARDINAL_SDK_ERROR\",message:\"A general error has occurred with Cardinal. See description for more information.\"},THREEDS_CARDINAL_SDK_CANCELED:{type:BraintreeError.types.CUSTOMER,code:\"THREEDS_CARDINAL_SDK_CANCELED\",message:\"Canceled by user.\"},THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT\",message:\"3D Secure verfication canceled by merchant.\"},THREEDS_AUTHENTICATION_IN_PROGRESS:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_AUTHENTICATION_IN_PROGRESS\",message:\"Cannot call verifyCard while existing authentication is in progress.\"},THREEDS_MISSING_VERIFY_CARD_OPTION:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_MISSING_VERIFY_CARD_OPTION\"},THREEDS_JWT_AUTHENTICATION_FAILED:{type:BraintreeError.types.UNKNOWN,code:\"THREEDS_JWT_AUTHENTICATION_FAILED\",message:\"Something went wrong authenticating the JWT from Cardinal\"},THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR\",message:\"Either the payment method nonce passed to `verifyCard` does not exist, or it was already consumed\"},THREEDS_LOOKUP_VALIDATION_ERROR:{type:BraintreeError.types.CUSTOMER,code:\"THREEDS_LOOKUP_VALIDATION_ERROR\",message:\"The data passed in `verifyCard` did not pass validation checks. See details for more info\"},THREEDS_LOOKUP_ERROR:{type:BraintreeError.types.UNKNOWN,code:\"THREEDS_LOOKUP_ERROR\",message:\"Something went wrong during the 3D Secure lookup\"},THREEDS_INLINE_IFRAME_DETAILS_INCORRECT:{type:BraintreeError.types.UNKNOWN,code:\"THREEDS_INLINE_IFRAME_DETAILS_INCORRECT\",message:\"Something went wrong when attempting to add the authentication iframe to the page.\"},THREEDS_NO_VERIFICATION_PAYLOAD:{type:BraintreeError.types.MERCHANT,code:\"THREEDS_NO_VERIFICATION_PAYLOAD\",message:\"No verification payload available.\"},THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN:{type:BraintreeError.types.INTERNAL,code:\"THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN\",message:\"Term Url must be on a Braintree domain.\"},THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED:{type:BraintreeError.types.INTERNAL,code:\"THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED\",message:\"Method not implemented for this framework.\"}}},{\"../../lib/braintree-error\":98}],170:[function(_dereq_,module,exports){\"use strict\";var enumerate=_dereq_(\"../../lib/enumerate\");module.exports=enumerate([\"AUTHENTICATION_COMPLETE\"],\"threedsecure:\")},{\"../../lib/enumerate\":111}],171:[function(_dereq_,module,exports){\"use strict\";var UnionPay=_dereq_(\"./shared/unionpay\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),analytics=_dereq_(\"../lib/analytics\"),errors=_dereq_(\"./shared/errors\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"UnionPay\",client:options.client,authorization:options.authorization}).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"UnionPay\"})})).then((function(client){var config=client.getConfiguration();return options.client=client,config.gatewayConfiguration.unionPay&&!0===config.gatewayConfiguration.unionPay.enabled?(analytics.sendEvent(options.client,\"unionpay.initialized\"),new UnionPay(options)):Promise.reject(new BraintreeError(errors.UNIONPAY_NOT_ENABLED))}))})),VERSION:\"3.60.0\"}},{\"../lib/analytics\":93,\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./shared/errors\":173,\"./shared/unionpay\":174,\"@braintree/wrap-promise\":30}],172:[function(_dereq_,module,exports){\"use strict\";var enumerate=_dereq_(\"../../lib/enumerate\");module.exports={events:enumerate([\"HOSTED_FIELDS_FETCH_CAPABILITIES\",\"HOSTED_FIELDS_ENROLL\",\"HOSTED_FIELDS_TOKENIZE\"],\"union-pay:\"),HOSTED_FIELDS_FRAME_NAME:\"braintreeunionpayhostedfields\"}},{\"../../lib/enumerate\":111}],173:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={UNIONPAY_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"UNIONPAY_NOT_ENABLED\",message:\"UnionPay is not enabled for this merchant.\"},UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID:{type:BraintreeError.types.MERCHANT,code:\"UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID\",message:\"Found an invalid Hosted Fields instance. Please use a valid Hosted Fields instance.\"},UNIONPAY_HOSTED_FIELDS_INSTANCE_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"UNIONPAY_HOSTED_FIELDS_INSTANCE_REQUIRED\",message:\"Could not find the Hosted Fields instance.\"},UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED\",message:\"A card or a Hosted Fields instance is required. Please supply a card or a Hosted Fields instance.\"},UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES:{type:BraintreeError.types.MERCHANT,code:\"UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES\",message:\"Please supply either a card or a Hosted Fields instance, not both.\"},UNIONPAY_EXPIRATION_DATE_INCOMPLETE:{type:BraintreeError.types.MERCHANT,code:\"UNIONPAY_EXPIRATION_DATE_INCOMPLETE\",message:\"You must supply expiration month and year or neither.\"},UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID:{type:BraintreeError.types.CUSTOMER,code:\"UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID\",message:\"Enrollment failed due to user input error.\"},UNIONPAY_ENROLLMENT_NETWORK_ERROR:{type:BraintreeError.types.NETWORK,code:\"UNIONPAY_ENROLLMENT_NETWORK_ERROR\",message:\"Could not enroll UnionPay card.\"},UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR:{type:BraintreeError.types.NETWORK,code:\"UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR\",message:\"Could not fetch card capabilities.\"},UNIONPAY_TOKENIZATION_NETWORK_ERROR:{type:BraintreeError.types.NETWORK,code:\"UNIONPAY_TOKENIZATION_NETWORK_ERROR\",message:\"A tokenization network error occurred.\"},UNIONPAY_MISSING_MOBILE_PHONE_DATA:{type:BraintreeError.types.MERCHANT,code:\"UNIONPAY_MISSING_MOBILE_PHONE_DATA\",message:\"A `mobile` with `countryCode` and `number` is required.\"},UNIONPAY_FAILED_TOKENIZATION:{type:BraintreeError.types.CUSTOMER,code:\"UNIONPAY_FAILED_TOKENIZATION\",message:\"The supplied card data failed tokenization.\"}}},{\"../../lib/braintree-error\":98}],174:[function(_dereq_,module,exports){\"use strict\";var analytics=_dereq_(\"../../lib/analytics\"),BraintreeError=_dereq_(\"../../lib/braintree-error\"),Bus=_dereq_(\"../../lib/bus\"),constants=_dereq_(\"./constants\"),useMin=_dereq_(\"../../lib/use-min\"),convertMethodsToError=_dereq_(\"../../lib/convert-methods-to-error\"),errors=_dereq_(\"./errors\"),events=constants.events,iFramer=_dereq_(\"@braintree/iframer\"),methods=_dereq_(\"../../lib/methods\"),uuid=_dereq_(\"../../lib/vendor/uuid\"),Promise=_dereq_(\"../../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");function UnionPay(options){this._options=options}UnionPay.prototype.fetchCapabilities=function(options){var self=this,client=this._options.client,cardNumber=options.card?options.card.number:null,hostedFields=options.hostedFields;return cardNumber&&hostedFields?Promise.reject(new BraintreeError(errors.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):cardNumber?client.request({method:\"get\",endpoint:\"payment_methods/credit_cards/capabilities\",data:{_meta:{source:\"unionpay\"},creditCard:{number:cardNumber}}}).then((function(response){return analytics.sendEvent(client,\"unionpay.capabilities-received\"),response})).catch((function(err){var status=err.details&&err.details.httpStatus;return analytics.sendEvent(client,\"unionpay.capabilities-failed\"),Promise.reject(403===status?err:new BraintreeError({type:errors.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.type,code:errors.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.code,message:errors.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.message,details:{originalError:err}}))})):hostedFields?hostedFields._bus?self._initializeHostedFields().then((function(){return new Promise((function(resolve,reject){self._bus.emit(events.HOSTED_FIELDS_FETCH_CAPABILITIES,{hostedFields:hostedFields},(function(response){response.err?reject(new BraintreeError(response.err)):resolve(response.payload)}))}))})):Promise.reject(new BraintreeError(errors.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID)):Promise.reject(new BraintreeError(errors.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},UnionPay.prototype.enroll=function(options){var data,self=this,client=this._options.client,card=options.card,mobile=options.mobile,hostedFields=options.hostedFields;if(!mobile)return Promise.reject(new BraintreeError(errors.UNIONPAY_MISSING_MOBILE_PHONE_DATA));if(hostedFields)return hostedFields._bus?card?Promise.reject(new BraintreeError(errors.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):new Promise((function(resolve,reject){self._initializeHostedFields().then((function(){self._bus.emit(events.HOSTED_FIELDS_ENROLL,{hostedFields:hostedFields,mobile:mobile},(function(response){response.err?reject(new BraintreeError(response.err)):resolve(response.payload)}))}))})):Promise.reject(new BraintreeError(errors.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID));if(card&&card.number){if(data={_meta:{source:\"unionpay\"},unionPayEnrollment:{number:card.number,mobileCountryCode:mobile.countryCode,mobileNumber:mobile.number}},card.expirationDate)data.unionPayEnrollment.expirationDate=card.expirationDate;else if(card.expirationMonth||card.expirationYear){if(!card.expirationMonth||!card.expirationYear)return Promise.reject(new BraintreeError(errors.UNIONPAY_EXPIRATION_DATE_INCOMPLETE));data.unionPayEnrollment.expirationYear=card.expirationYear,data.unionPayEnrollment.expirationMonth=card.expirationMonth}return client.request({method:\"post\",endpoint:\"union_pay_enrollments\",data:data}).then((function(response){return analytics.sendEvent(client,\"unionpay.enrollment-succeeded\"),{enrollmentId:response.unionPayEnrollmentId,smsCodeRequired:response.smsCodeRequired}})).catch((function(err){var error,status=err.details&&err.details.httpStatus;return 403===status?error=err:status<500?(error=new BraintreeError(errors.UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID)).details={originalError:err}:(error=new BraintreeError(errors.UNIONPAY_ENROLLMENT_NETWORK_ERROR)).details={originalError:err},analytics.sendEvent(client,\"unionpay.enrollment-failed\"),Promise.reject(error)}))}return Promise.reject(new BraintreeError(errors.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},UnionPay.prototype.tokenize=function(options){var data,self=this,client=this._options.client,card=options.card,hostedFields=options.hostedFields;return card&&hostedFields?Promise.reject(new BraintreeError(errors.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):card?(data={_meta:{source:\"unionpay\"},creditCard:{number:options.card.number,options:{unionPayEnrollment:{id:options.enrollmentId}}}},options.smsCode&&(data.creditCard.options.unionPayEnrollment.smsCode=options.smsCode),card.expirationDate?data.creditCard.expirationDate=card.expirationDate:card.expirationMonth&&card.expirationYear&&(data.creditCard.expirationYear=card.expirationYear,data.creditCard.expirationMonth=card.expirationMonth),options.card.cvv&&(data.creditCard.cvv=options.card.cvv),client.request({method:\"post\",endpoint:\"payment_methods/credit_cards\",data:data}).then((function(response){var tokenizedCard=response.creditCards[0];return delete tokenizedCard.consumed,delete tokenizedCard.threeDSecureInfo,analytics.sendEvent(client,\"unionpay.nonce-received\"),tokenizedCard})).catch((function(err){var error,status=err.details&&err.details.httpStatus;return analytics.sendEvent(client,\"unionpay.nonce-failed\"),403===status?error=err:status<500?(error=new BraintreeError(errors.UNIONPAY_FAILED_TOKENIZATION)).details={originalError:err}:(error=new BraintreeError(errors.UNIONPAY_TOKENIZATION_NETWORK_ERROR)).details={originalError:err},Promise.reject(error)}))):hostedFields?hostedFields._bus?new Promise((function(resolve,reject){self._initializeHostedFields().then((function(){self._bus.emit(events.HOSTED_FIELDS_TOKENIZE,options,(function(response){response.err?reject(new BraintreeError(response.err)):resolve(response.payload)}))}))})):Promise.reject(new BraintreeError(errors.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID)):Promise.reject(new BraintreeError(errors.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},UnionPay.prototype.teardown=function(){return this._bus&&(this._hostedFieldsFrame.parentNode.removeChild(this._hostedFieldsFrame),this._bus.teardown()),convertMethodsToError(this,methods(UnionPay.prototype)),Promise.resolve()},UnionPay.prototype._initializeHostedFields=function(){var assetsUrl,isDebug,componentId=uuid(),self=this;return this._hostedFieldsInitializePromise||(this._hostedFieldsInitializePromise=new Promise((function(resolve){assetsUrl=self._options.client.getConfiguration().gatewayConfiguration.assetsUrl,isDebug=self._options.client.getConfiguration().isDebug,self._bus=new Bus({channel:componentId,merchantUrl:location.href}),self._hostedFieldsFrame=iFramer({name:constants.HOSTED_FIELDS_FRAME_NAME+\"_\"+componentId,src:assetsUrl+\"/web/3.60.0/html/unionpay-hosted-fields-frame\"+useMin(isDebug)+\".html\",height:0,width:0}),self._bus.on(Bus.events.CONFIGURATION_REQUEST,(function(reply){reply(self._options.client),resolve()})),document.body.appendChild(self._hostedFieldsFrame)}))),this._hostedFieldsInitializePromise},module.exports=wrapPromise.wrapPrototype(UnionPay)},{\"../../lib/analytics\":93,\"../../lib/braintree-error\":98,\"../../lib/bus\":101,\"../../lib/convert-methods-to-error\":104,\"../../lib/methods\":130,\"../../lib/promise\":132,\"../../lib/use-min\":134,\"../../lib/vendor/uuid\":136,\"./constants\":172,\"./errors\":173,\"@braintree/iframer\":23,\"@braintree/wrap-promise\":30}],175:[function(_dereq_,module,exports){\"use strict\";module.exports={PLAID_LINK_JS:\"https://cdn.plaid.com/link/v2/stable/link-initialize.js\"}},{}],176:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={US_BANK_ACCOUNT_OPTION_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"US_BANK_ACCOUNT_OPTION_REQUIRED\"},US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS:{type:BraintreeError.types.MERCHANT,code:\"US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS\"},US_BANK_ACCOUNT_LOGIN_LOAD_FAILED:{type:BraintreeError.types.NETWORK,code:\"US_BANK_ACCOUNT_LOGIN_LOAD_FAILED\",message:\"Bank login flow failed to load.\"},US_BANK_ACCOUNT_LOGIN_CLOSED:{type:BraintreeError.types.CUSTOMER,code:\"US_BANK_ACCOUNT_LOGIN_CLOSED\",message:\"Customer closed bank login flow before authorizing.\"},US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE:{type:BraintreeError.types.MERCHANT,code:\"US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE\",message:\"Another bank login tokenization request is active.\"},US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR:{type:BraintreeError.types.NETWORK,code:\"US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR\",message:\"A tokenization network error occurred.\"},US_BANK_ACCOUNT_FAILED_TOKENIZATION:{type:BraintreeError.types.CUSTOMER,code:\"US_BANK_ACCOUNT_FAILED_TOKENIZATION\",message:\"The supplied data failed tokenization.\"},US_BANK_ACCOUNT_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"US_BANK_ACCOUNT_NOT_ENABLED\",message:\"US bank account is not enabled.\"},US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED\",message:\"Bank login is not enabled.\"}}},{\"../lib/braintree-error\":98}],177:[function(_dereq_,module,exports){\"use strict\";var basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),errors=_dereq_(\"./errors\"),USBankAccount=_dereq_(\"./us-bank-account\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){var name=\"US Bank Account\";return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name})})).then((function(client){return options.client=client,options.client.getConfiguration().gatewayConfiguration.usBankAccount?new USBankAccount(options):Promise.reject(new BraintreeError(errors.US_BANK_ACCOUNT_NOT_ENABLED))}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./errors\":176,\"./us-bank-account\":178,\"@braintree/wrap-promise\":30}],178:[function(_dereq_,module,exports){(function(global){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\"),constants=_dereq_(\"./constants\"),errors=_dereq_(\"./errors\"),sharedErrors=_dereq_(\"../lib/errors\"),analytics=_dereq_(\"../lib/analytics\"),once=_dereq_(\"../lib/once\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),methods=_dereq_(\"../lib/methods\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),TOKENIZE_BANK_DETAILS_MUTATION=createGraphQLMutation(\"UsBankAccount\"),TOKENIZE_BANK_LOGIN_MUTATION=createGraphQLMutation(\"UsBankLogin\");function USBankAccount(options){this._client=options.client,this._isTokenizingBankLogin=!1,analytics.sendEvent(this._client,\"usbankaccount.initialized\")}function errorFrom(err){var error,status=err.details&&err.details.httpStatus;return(error=new BraintreeError(401===status?sharedErrors.BRAINTREE_API_ACCESS_RESTRICTED:status<500?errors.US_BANK_ACCOUNT_FAILED_TOKENIZATION:errors.US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR)).details={originalError:err},error}function formatTokenizeResponseFromGraphQL(response,type){var data=response.data[type].paymentMethod;return{nonce:data.id,details:{},description:\"US bank account ending in - \"+data.details.last4,type:\"us_bank_account\"}}function addLoadListeners(script,callback){function loadHandler(){var readyState=this.readyState;readyState&&\"loaded\"!==readyState&&\"complete\"!==readyState||(script.removeEventListener(\"error\",errorHandler),script.removeEventListener(\"load\",loadHandler),script.removeEventListener(\"readystatechange\",loadHandler),callback(null,global.Plaid))}function errorHandler(){script.parentNode.removeChild(script),callback(new BraintreeError(errors.US_BANK_ACCOUNT_LOGIN_LOAD_FAILED))}script.addEventListener(\"error\",errorHandler),script.addEventListener(\"load\",loadHandler),script.addEventListener(\"readystatechange\",loadHandler)}function formatBillingAddressForGraphQL(address){return{streetAddress:address.streetAddress,extendedAddress:address.extendedAddress,city:address.locality,state:address.region,zipCode:address.postalCode}}function formatDataForOwnershipType(data,details){\"personal\"===details.ownershipType?data.individualOwner={firstName:details.firstName,lastName:details.lastName}:\"business\"===details.ownershipType&&(data.businessOwner={businessName:details.businessName})}function createGraphQLMutation(type){return\"mutation Tokenize\"+type+\"($input: Tokenize\"+type+\"Input!) {  tokenize\"+type+\"(input: $input) {    paymentMethod {      id      details {        ... on UsBankAccountDetails {          last4        }      }    }  }}\"}USBankAccount.prototype.tokenize=function(options){return(options=options||{}).mandateText?options.bankDetails&&options.bankLogin?Promise.reject(new BraintreeError({type:errors.US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS.type,code:errors.US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS.code,message:\"tokenize must be called with bankDetails or bankLogin, not both.\"})):options.bankDetails?this._tokenizeBankDetails(options):options.bankLogin?this._tokenizeBankLogin(options):Promise.reject(new BraintreeError({type:errors.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:errors.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:\"tokenize must be called with bankDetails or bankLogin.\"})):Promise.reject(new BraintreeError({type:errors.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:errors.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:\"mandateText property is required.\"}))},USBankAccount.prototype._tokenizeBankDetails=function(options){var client=this._client,bankDetails=options.bankDetails,data={achMandate:options.mandateText,routingNumber:bankDetails.routingNumber,accountNumber:bankDetails.accountNumber,accountType:bankDetails.accountType.toUpperCase(),billingAddress:formatBillingAddressForGraphQL(bankDetails.billingAddress||{})};return formatDataForOwnershipType(data,bankDetails),client.request({api:\"graphQLApi\",data:{query:TOKENIZE_BANK_DETAILS_MUTATION,variables:{input:{usBankAccount:data}}}}).then((function(response){return analytics.sendEvent(client,\"usbankaccount.bankdetails.tokenization.succeeded\"),Promise.resolve(formatTokenizeResponseFromGraphQL(response,\"tokenizeUsBankAccount\"))})).catch((function(err){var error=errorFrom(err);return analytics.sendEvent(client,\"usbankaccount.bankdetails.tokenization.failed\"),Promise.reject(error)}))},USBankAccount.prototype._tokenizeBankLogin=function(options){var self=this,client=this._client,gatewayConfiguration=client.getConfiguration().gatewayConfiguration,isProduction=\"production\"===gatewayConfiguration.environment,plaidConfig=gatewayConfiguration.usBankAccount.plaid;return options.bankLogin.displayName?plaidConfig?this._isTokenizingBankLogin?Promise.reject(new BraintreeError(errors.US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE)):(this._isTokenizingBankLogin=!0,new Promise((function(resolve,reject){self._loadPlaid((function(plaidLoadErr,plaid){plaidLoadErr?reject(plaidLoadErr):(plaid.create({clientName:options.bankLogin.displayName,apiVersion:\"v2\",env:isProduction?\"production\":\"sandbox\",key:plaidConfig.publicKey,product:\"auth\",selectAccount:!0,onExit:function(){self._isTokenizingBankLogin=!1,analytics.sendEvent(client,\"usbankaccount.banklogin.tokenization.closed.by-user\"),reject(new BraintreeError(errors.US_BANK_ACCOUNT_LOGIN_CLOSED))},onSuccess:function(publicToken,metadata){var bankLogin=options.bankLogin,data={publicToken:publicToken,accountId:isProduction?metadata.account_id:\"plaid_account_id\",accountType:metadata.account.subtype.toUpperCase(),achMandate:options.mandateText,billingAddress:formatBillingAddressForGraphQL(bankLogin.billingAddress||{})};formatDataForOwnershipType(data,bankLogin),client.request({api:\"graphQLApi\",data:{query:TOKENIZE_BANK_LOGIN_MUTATION,variables:{input:{usBankLogin:data}}}}).then((function(response){self._isTokenizingBankLogin=!1,analytics.sendEvent(client,\"usbankaccount.banklogin.tokenization.succeeded\"),resolve(formatTokenizeResponseFromGraphQL(response,\"tokenizeUsBankLogin\"))})).catch((function(tokenizeErr){var error;self._isTokenizingBankLogin=!1,error=errorFrom(tokenizeErr),analytics.sendEvent(client,\"usbankaccount.banklogin.tokenization.failed\"),reject(error)}))}}).open(),analytics.sendEvent(client,\"usbankaccount.banklogin.tokenization.started\"))}))}))):Promise.reject(new BraintreeError(errors.US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED)):Promise.reject(new BraintreeError({type:errors.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:errors.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:\"displayName property is required when using bankLogin.\"}))},USBankAccount.prototype._loadPlaid=function(callback){var existingScript,script;callback=once(callback),global.Plaid?callback(null,global.Plaid):(existingScript=document.querySelector('script[src=\"'+constants.PLAID_LINK_JS+'\"]'))?addLoadListeners(existingScript,callback):((script=document.createElement(\"script\")).src=constants.PLAID_LINK_JS,script.async=!0,addLoadListeners(script,callback),document.body.appendChild(script),this._plaidScript=script)},USBankAccount.prototype.teardown=function(){return this._plaidScript&&document.body.removeChild(this._plaidScript),convertMethodsToError(this,methods(USBankAccount.prototype)),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(USBankAccount)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../lib/analytics\":93,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/errors\":112,\"../lib/methods\":130,\"../lib/once\":131,\"../lib/promise\":132,\"./constants\":175,\"./errors\":176,\"@braintree/wrap-promise\":30}],179:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={VAULT_MANAGER_DELETE_PAYMENT_METHOD_NONCE_REQUIRES_CLIENT_TOKEN:{type:BraintreeError.types.MERCHANT,code:\"VAULT_MANAGER_DELETE_PAYMENT_METHOD_NONCE_REQUIRES_CLIENT_TOKEN\",message:\"A client token with a customer id must be used to delete a payment method nonce.\"},VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND:{type:BraintreeError.types.MERCHANT,code:\"VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND\"},VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR:{type:BraintreeError.types.UNKNOWN,code:\"VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR\"}}},{\"../lib/braintree-error\":98}],180:[function(_dereq_,module,exports){\"use strict\";var basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),VaultManager=_dereq_(\"./vault-manager\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){var name=\"Vault Manager\";return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then((function(){return new VaultManager({createPromise:createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name})})}))})),VERSION:\"3.60.0\"}},{\"../lib/basic-component-verification\":96,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"./vault-manager\":181,\"@braintree/wrap-promise\":30}],181:[function(_dereq_,module,exports){\"use strict\";var analytics=_dereq_(\"../lib/analytics\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),errors=_dereq_(\"./errors\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),methods=_dereq_(\"../lib/methods\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");function VaultManager(options){this._createPromise=options.createPromise}function formatPaymentMethodPayload(paymentMethod){var formattedPaymentMethod={nonce:paymentMethod.nonce,default:paymentMethod.default,details:paymentMethod.details,hasSubscription:paymentMethod.hasSubscription,type:paymentMethod.type};return paymentMethod.description&&(formattedPaymentMethod.description=paymentMethod.description),paymentMethod.binData&&(formattedPaymentMethod.binData=paymentMethod.binData),formattedPaymentMethod}VaultManager.prototype.fetchPaymentMethods=function(options){var defaultFirst;return defaultFirst=!0===(options=options||{}).defaultFirst?1:0,this._createPromise.then((function(client){return client.request({endpoint:\"payment_methods\",method:\"get\",data:{defaultFirst:defaultFirst}})})).then((function(paymentMethodsPayload){return analytics.sendEvent(this._createPromise,\"vault-manager.fetch-payment-methods.succeeded\"),paymentMethodsPayload.paymentMethods.map(formatPaymentMethodPayload)}).bind(this))},VaultManager.prototype.deletePaymentMethod=function(paymentMethodNonce){return this._createPromise.then((function(client){return\"CLIENT_TOKEN\"===client.getConfiguration().authorizationType?client.request({api:\"graphQLApi\",data:{query:\"mutation DeletePaymentMethodFromSingleUseToken($input: DeletePaymentMethodFromSingleUseTokenInput!) {  deletePaymentMethodFromSingleUseToken(input: $input) {    clientMutationId  }}\",variables:{input:{singleUseTokenId:paymentMethodNonce}},operationName:\"DeletePaymentMethodFromSingleUseToken\"}}).then((function(){analytics.sendEvent(client,\"vault-manager.delete-payment-method.succeeded\")})).catch((function(error){var formattedError,originalError=error.details.originalError;return analytics.sendEvent(client,\"vault-manager.delete-payment-method.failed\"),originalError[0]&&\"NOT_FOUND\"===originalError[0].extensions.errorClass&&(formattedError=new BraintreeError({type:errors.VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND.type,code:errors.VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND.code,message:\"A payment method for payment method nonce `\"+paymentMethodNonce+\"` could not be found.\",details:{originalError:originalError}})),formattedError||(formattedError=new BraintreeError({type:errors.VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR.type,code:errors.VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR.code,message:\"An unknown error occured when attempting to delete the payment method assocaited with the payment method nonce `\"+paymentMethodNonce+\"`.\",details:{originalError:originalError}})),Promise.reject(formattedError)})):Promise.reject(new BraintreeError(errors.VAULT_MANAGER_DELETE_PAYMENT_METHOD_NONCE_REQUIRES_CLIENT_TOKEN))}))},VaultManager.prototype.teardown=function(){return convertMethodsToError(this,methods(VaultManager.prototype)),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(VaultManager)},{\"../lib/analytics\":93,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/methods\":130,\"../lib/promise\":132,\"./errors\":179,\"@braintree/wrap-promise\":30}],182:[function(_dereq_,module,exports){\"use strict\";var analytics=_dereq_(\"../lib/analytics\"),basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),errors=_dereq_(\"./shared/errors\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),Venmo=_dereq_(\"./venmo\"),Promise=_dereq_(\"../lib/promise\"),supportsVenmo=_dereq_(\"./shared/supports-venmo\");module.exports={create:wrapPromise((function(options){return basicComponentVerification.verify({name:\"Venmo\",client:options.client,authorization:options.authorization}).then((function(){var createPromise,instance;return options.profileId&&\"string\"!=typeof options.profileId?Promise.reject(new BraintreeError(errors.VENMO_INVALID_PROFILE_ID)):options.deepLinkReturnUrl&&\"string\"!=typeof options.deepLinkReturnUrl?Promise.reject(new BraintreeError(errors.VENMO_INVALID_DEEP_LINK_RETURN_URL)):(createPromise=createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:\"Venmo\"}).then((function(client){var configuration=client.getConfiguration();return options.client=client,configuration.gatewayConfiguration.payWithVenmo?client:Promise.reject(new BraintreeError(errors.VENMO_NOT_ENABLED))})),options.createPromise=createPromise,instance=new Venmo(options),analytics.sendEvent(createPromise,\"venmo.initialized\"),options.client?createPromise.then((function(){return instance})):instance)}))})),isBrowserSupported:function(options){return supportsVenmo.isBrowserSupported(options)},VERSION:\"3.60.0\"}},{\"../lib/analytics\":93,\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./shared/errors\":185,\"./shared/supports-venmo\":186,\"./venmo\":187,\"@braintree/wrap-promise\":30}],183:[function(_dereq_,module,exports){\"use strict\";var isAndroid=_dereq_(\"@braintree/browser-detection/is-android\"),isChrome=_dereq_(\"@braintree/browser-detection/is-chrome\"),isIos=_dereq_(\"@braintree/browser-detection/is-ios\"),isIosSafari=_dereq_(\"@braintree/browser-detection/is-ios-safari\"),isSamsungBrowser=_dereq_(\"@braintree/browser-detection/is-samsung\"),isMobileFirefox=_dereq_(\"@braintree/browser-detection/is-mobile-firefox\");module.exports={isAndroid:isAndroid,isChrome:isChrome,isIos:isIos,isIosSafari:isIosSafari,isSamsungBrowser:isSamsungBrowser,isMobileFirefox:isMobileFirefox}},{\"@braintree/browser-detection/is-android\":3,\"@braintree/browser-detection/is-chrome\":5,\"@braintree/browser-detection/is-ios\":16,\"@braintree/browser-detection/is-ios-safari\":13,\"@braintree/browser-detection/is-mobile-firefox\":17,\"@braintree/browser-detection/is-samsung\":18}],184:[function(_dereq_,module,exports){\"use strict\";module.exports={DOCUMENT_VISIBILITY_CHANGE_EVENT_DELAY:500,DEFAULT_PROCESS_RESULTS_DELAY:1e3,VENMO_OPEN_URL:\"https://venmo.com/braintree/checkout\"}},{}],185:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../../lib/braintree-error\");module.exports={VENMO_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"VENMO_NOT_ENABLED\",message:\"Venmo is not enabled for this merchant.\"},VENMO_TOKENIZATION_REQUEST_ACTIVE:{type:BraintreeError.types.MERCHANT,code:\"VENMO_TOKENIZATION_REQUEST_ACTIVE\",message:\"Another tokenization request is active.\"},VENMO_APP_FAILED:{type:BraintreeError.types.UNKNOWN,code:\"VENMO_APP_FAILED\",message:\"Venmo app encountered a problem.\"},VENMO_APP_CANCELED:{type:BraintreeError.types.CUSTOMER,code:\"VENMO_APP_CANCELED\",message:\"Venmo app authorization was canceled.\"},VENMO_CANCELED:{type:BraintreeError.types.CUSTOMER,code:\"VENMO_CANCELED\",message:\"User canceled Venmo authorization, or Venmo app is not available.\"},VENMO_INVALID_PROFILE_ID:{type:BraintreeError.types.MERCHANT,code:\"VENMO_INVALID_PROFILE_ID\",message:\"Venmo profile ID is invalid.\"},VENMO_INVALID_DEEP_LINK_RETURN_URL:{type:BraintreeError.types.MERCHANT,code:\"VENMO_INVALID_DEEP_LINK_RETURN_URL\",message:\"Venmo deep link return URL is invalid.\"}}},{\"../../lib/braintree-error\":98}],186:[function(_dereq_,module,exports){\"use strict\";var browserDetection=_dereq_(\"./browser-detection\");module.exports={isBrowserSupported:function(options){var isAndroidChrome=browserDetection.isAndroid()&&browserDetection.isChrome(),isIosChrome=browserDetection.isIos()&&browserDetection.isChrome(),supportsReturnToSameTab=browserDetection.isIosSafari()||isAndroidChrome,supportsReturnToNewTab=isIosChrome||browserDetection.isSamsungBrowser()||browserDetection.isMobileFirefox();return options=options||{allowNewBrowserTab:!0},supportsReturnToSameTab||options.allowNewBrowserTab&&supportsReturnToNewTab}}},{\"./browser-detection\":183}],187:[function(_dereq_,module,exports){(function(global){\"use strict\";var analytics=_dereq_(\"../lib/analytics\"),isBrowserSupported=_dereq_(\"./shared/supports-venmo\"),constants=_dereq_(\"./shared/constants\"),errors=_dereq_(\"./shared/errors\"),querystring=_dereq_(\"../lib/querystring\"),methods=_dereq_(\"../lib/methods\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),Promise=_dereq_(\"../lib/promise\"),ExtendedPromise=_dereq_(\"@braintree/extended-promise\");function Venmo(options){this._createPromise=options.createPromise,this._allowNewBrowserTab=!1!==options.allowNewBrowserTab,this._profileId=options.profileId,this._deepLinkReturnUrl=options.deepLinkReturnUrl}function getFragmentParameters(){return global.location.hash.substring(1).split(\"&\").reduce((function(toReturn,keyValue){var parts=keyValue.split(\"=\"),key=decodeURIComponent(parts[0]).replace(/\\W/g,\"\"),value=decodeURIComponent(parts[1]);return toReturn[key]=value,toReturn}),{})}function documentVisibilityChangeEventName(){var visibilityChange;return void 0!==global.document.hidden?visibilityChange=\"visibilitychange\":void 0!==global.document.msHidden?visibilityChange=\"msvisibilitychange\":void 0!==global.document.webkitHidden&&(visibilityChange=\"webkitvisibilitychange\"),visibilityChange}Venmo.prototype.getUrl=function(){return this._url?Promise.resolve(this._url):this._createPromise.then((function(client){var configuration=client.getConfiguration(),params={},currentUrl=this._deepLinkReturnUrl||global.location.href.replace(global.location.hash,\"\"),venmoConfiguration=configuration.gatewayConfiguration.payWithVenmo,analyticsMetadata=configuration.analyticsMetadata,braintreeData={_meta:{version:analyticsMetadata.sdkVersion,integration:analyticsMetadata.integration,platform:analyticsMetadata.platform,sessionId:analyticsMetadata.sessionId}};return params[\"x-success\"]=currentUrl+\"#venmoSuccess=1\",params[\"x-cancel\"]=currentUrl+\"#venmoCancel=1\",params[\"x-error\"]=currentUrl+\"#venmoError=1\",params.ua=global.navigator.userAgent,params.braintree_merchant_id=this._profileId||venmoConfiguration.merchantId,params.braintree_access_token=venmoConfiguration.accessToken,params.braintree_environment=venmoConfiguration.environment,params.braintree_sdk_data=btoa(JSON.stringify(braintreeData)),this._url=constants.VENMO_OPEN_URL+\"?\"+querystring.stringify(params),this._url}).bind(this))},Venmo.prototype.isBrowserSupported=function(){return isBrowserSupported.isBrowserSupported({allowNewBrowserTab:this._allowNewBrowserTab})},Venmo.prototype.hasTokenizationResult=function(){var params=getFragmentParameters();return void 0!==(params.venmoSuccess||params.venmoError||params.venmoCancel)},Venmo.prototype.tokenize=function(options){var self=this;return options=options||{},!0===this._tokenizationInProgress?Promise.reject(new BraintreeError(errors.VENMO_TOKENIZATION_REQUEST_ACTIVE)):this.hasTokenizationResult()?this._processResults():(this._tokenizationInProgress=!0,this._tokenizePromise=new ExtendedPromise,this._previousHash=global.location.hash,this._visibilityChangeListener=function(){var error;global.document.hidden||(self._tokenizationInProgress=!1,setTimeout((function(){self._processResults().catch((function(err){error=err})).then((function(res){global.location.hash=self._previousHash,self._removeVisibilityEventListener(),delete self._visibilityChangeListener,error?self._tokenizePromise.reject(error):self._tokenizePromise.resolve(res),delete self._tokenizePromise}))}),options.processResultsDelay||constants.DEFAULT_PROCESS_RESULTS_DELAY))},this.getUrl().then((function(url){return self._deepLinkReturnUrl?global.location=url:global.open(url),setTimeout((function(){global.document.addEventListener(documentVisibilityChangeEventName(),self._visibilityChangeListener)}),constants.DOCUMENT_VISIBILITY_CHANGE_EVENT_DELAY),self._tokenizePromise})))},Venmo.prototype.teardown=function(){return this._removeVisibilityEventListener(),convertMethodsToError(this,methods(Venmo.prototype)),Promise.resolve()},Venmo.prototype._removeVisibilityEventListener=function(){global.document.removeEventListener(documentVisibilityChangeEventName(),this._visibilityChangeListener)},Venmo.prototype._processResults=function(){var self=this,params=getFragmentParameters();return new Promise((function(resolve,reject){var fragmentParams;params.venmoSuccess?(analytics.sendEvent(self._createPromise,\"venmo.appswitch.handle.success\"),resolve({nonce:(fragmentParams=params).paymentMethodNonce,type:\"VenmoAccount\",details:{username:fragmentParams.username}})):params.venmoError?(analytics.sendEvent(self._createPromise,\"venmo.appswitch.handle.error\"),reject(new BraintreeError({type:errors.VENMO_APP_FAILED.type,code:errors.VENMO_APP_FAILED.code,message:errors.VENMO_APP_FAILED.message,details:{originalError:{message:decodeURIComponent(params.errorMessage),code:params.errorCode}}}))):params.venmoCancel?(analytics.sendEvent(self._createPromise,\"venmo.appswitch.handle.cancel\"),reject(new BraintreeError(errors.VENMO_APP_CANCELED))):(analytics.sendEvent(self._createPromise,\"venmo.appswitch.cancel-or-unavailable\"),reject(new BraintreeError(errors.VENMO_CANCELED))),\"function\"==typeof global.history.replaceState&&global.location.hash&&history.pushState({},\"\",global.location.href.slice(0,global.location.href.indexOf(\"#\")))}))},module.exports=wrapPromise.wrapPrototype(Venmo)}).call(this,\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:{})},{\"../lib/analytics\":93,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/methods\":130,\"../lib/promise\":132,\"../lib/querystring\":133,\"./shared/constants\":184,\"./shared/errors\":185,\"./shared/supports-venmo\":186,\"@braintree/extended-promise\":22,\"@braintree/wrap-promise\":30}],188:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\");module.exports={VISA_CHECKOUT_NOT_ENABLED:{type:BraintreeError.types.MERCHANT,code:\"VISA_CHECKOUT_NOT_ENABLED\",message:\"Visa Checkout is not enabled for this merchant.\"},VISA_CHECKOUT_INIT_OPTIONS_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"VISA_CHECKOUT_INIT_OPTIONS_REQUIRED\",message:\"initOptions requires an object.\"},VISA_CHECKOUT_PAYMENT_REQUIRED:{type:BraintreeError.types.MERCHANT,code:\"VISA_CHECKOUT_PAYMENT_REQUIRED\",message:\"tokenize requires callid, encKey, and encPaymentData.\"},VISA_CHECKOUT_TOKENIZATION:{type:BraintreeError.types.NETWORK,code:\"VISA_CHECKOUT_TOKENIZATION\",message:\"A network error occurred when processing the Visa Checkout payment.\"}}},{\"../lib/braintree-error\":98}],189:[function(_dereq_,module,exports){\"use strict\";var basicComponentVerification=_dereq_(\"../lib/basic-component-verification\"),BraintreeError=_dereq_(\"../lib/braintree-error\"),createDeferredClient=_dereq_(\"../lib/create-deferred-client\"),createAssetsUrl=_dereq_(\"../lib/create-assets-url\"),VisaCheckout=_dereq_(\"./visa-checkout\"),analytics=_dereq_(\"../lib/analytics\"),errors=_dereq_(\"./errors\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\");module.exports={create:wrapPromise((function(options){var name=\"Visa Checkout\";return basicComponentVerification.verify({name:name,client:options.client,authorization:options.authorization}).then((function(){return createDeferredClient.create({authorization:options.authorization,client:options.client,debug:options.debug,assetsUrl:createAssetsUrl.create(options.authorization),name:name})})).then((function(client){return options.client=client,options.client.getConfiguration().gatewayConfiguration.visaCheckout?(analytics.sendEvent(options.client,\"visacheckout.initialized\"),new VisaCheckout(options)):Promise.reject(new BraintreeError(errors.VISA_CHECKOUT_NOT_ENABLED))}))})),VERSION:\"3.60.0\"}},{\"../lib/analytics\":93,\"../lib/basic-component-verification\":96,\"../lib/braintree-error\":98,\"../lib/create-assets-url\":106,\"../lib/create-deferred-client\":108,\"../lib/promise\":132,\"./errors\":188,\"./visa-checkout\":190,\"@braintree/wrap-promise\":30}],190:[function(_dereq_,module,exports){\"use strict\";var BraintreeError=_dereq_(\"../lib/braintree-error\"),analytics=_dereq_(\"../lib/analytics\"),errors=_dereq_(\"./errors\"),jsonClone=_dereq_(\"../lib/json-clone\"),methods=_dereq_(\"../lib/methods\"),convertMethodsToError=_dereq_(\"../lib/convert-methods-to-error\"),Promise=_dereq_(\"../lib/promise\"),wrapPromise=_dereq_(\"@braintree/wrap-promise\"),cardTypeTransformMap={Visa:\"VISA\",MasterCard:\"MASTERCARD\",Discover:\"DISCOVER\",\"American Express\":\"AMEX\"};function VisaCheckout(options){this._client=options.client}VisaCheckout.prototype.createInitOptions=function(options){var initOptions,gatewayConfiguration=this._client.getConfiguration().gatewayConfiguration,visaCheckoutConfiguration=gatewayConfiguration.visaCheckout;if(!options)throw new BraintreeError(errors.VISA_CHECKOUT_INIT_OPTIONS_REQUIRED);return(initOptions=jsonClone(options)).apikey=initOptions.apikey||visaCheckoutConfiguration.apikey,initOptions.externalClientId=initOptions.externalClientId||visaCheckoutConfiguration.externalClientId,initOptions.settings=initOptions.settings||{},initOptions.settings.dataLevel=\"FULL\",initOptions.settings.payment=initOptions.settings.payment||{},initOptions.settings.payment.cardBrands||(initOptions.settings.payment.cardBrands=gatewayConfiguration.visaCheckout.supportedCardTypes.reduce((function(acc,type){return cardTypeTransformMap.hasOwnProperty(type)?acc.concat(cardTypeTransformMap[type]):acc}),[])),initOptions},VisaCheckout.prototype.tokenize=function(payment){var self=this;return payment.callid&&payment.encKey&&payment.encPaymentData?this._client.request({method:\"post\",endpoint:\"payment_methods/visa_checkout_cards\",data:{_meta:{source:\"visa-checkout\"},visaCheckoutCard:{callId:payment.callid,encryptedPaymentData:payment.encPaymentData,encryptedKey:payment.encKey}}}).then((function(response){return analytics.sendEvent(self._client,\"visacheckout.tokenize.succeeded\"),response.visaCheckoutCards[0]})).catch((function(err){return analytics.sendEvent(self._client,\"visacheckout.tokenize.failed\"),Promise.reject(new BraintreeError({type:errors.VISA_CHECKOUT_TOKENIZATION.type,code:errors.VISA_CHECKOUT_TOKENIZATION.code,message:errors.VISA_CHECKOUT_TOKENIZATION.message,details:{originalError:err}}))})):Promise.reject(new BraintreeError(errors.VISA_CHECKOUT_PAYMENT_REQUIRED))},VisaCheckout.prototype.teardown=function(){return convertMethodsToError(this,methods(VisaCheckout.prototype)),Promise.resolve()},module.exports=wrapPromise.wrapPrototype(VisaCheckout)},{\"../lib/analytics\":93,\"../lib/braintree-error\":98,\"../lib/convert-methods-to-error\":104,\"../lib/json-clone\":129,\"../lib/methods\":130,\"../lib/promise\":132,\"./errors\":188,\"@braintree/wrap-promise\":30}]},{},[91])(91)}}]);","extractedComments":[]}