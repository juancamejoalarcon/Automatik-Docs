function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"D5/R":function(e,t,n){"use strict";n.r(t),n.d(t,"CertifiedFormsModule",(function(){return tt}));var i=n("ofXK"),r=n("M0ag"),o=n("tyNb"),a=n("ey9i"),s=n("fXoL"),c=n("gusg"),l=n("5eHb"),d=n("3Pt+"),u=n("TYhg"),p=["emailInput"],_=["conditions"];function f(e,t){if(1&e&&(s.Qb(0,"div",15),s.Qb(1,"div",16),s.Qb(2,"div",17),s.Mb(3,"img",18),s.Pb(),s.Qb(4,"div",19),s.Qb(5,"h2",20),s.zc(6),s.Pb(),s.Qb(7,"div",21),s.Qb(8,"ul"),s.Qb(9,"li"),s.zc(10,"Descarga inmediata en formatos Word y PDF"),s.Pb(),s.Qb(11,"li"),s.zc(12,"Una vez comprado podr\xe1s retroceder, modificar el formulario y descargar de nuevo"),s.Pb(),s.Pb(),s.Pb(),s.Qb(13,"div",22),s.Qb(14,"span",23),s.zc(15,"Total:"),s.Pb(),s.Qb(16,"span",24),s.zc(17),s.Pb(),s.Pb(),s.Qb(18,"div",25),s.Qb(19,"span"),s.Mb(20,"img",26),s.Pb(),s.Qb(21,"span"),s.Mb(22,"img",27),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e){var n=s.dc();s.zb(3),s.jc("src",n.form.image,s.tc),s.zb(3),s.Ac(n.form.title),s.zb(11),s.Bc("",n.form.amount," \u20ac")}}function h(e,t){if(1&e){var n=s.Rb();s.Qb(0,"label",36),s.zc(1," \xbfTienes cuenta? "),s.Qb(2,"a",41),s.Zb("click",(function(){return s.rc(n),s.dc(2).goToAuth()})),s.zc(3,"Inicia sesi\xf3n"),s.Pb(),s.Pb()}}function m(e,t){1&e&&s.Mb(0,"br")}function E(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",28),s.Qb(1,"div",29),s.Qb(2,"h1",30),s.zc(3,"Direcci\xf3n de correo para recibir el documento"),s.Pb(),s.Mb(4,"label",31),s.Qb(5,"input",32,33),s.Zb("ngModelChange",(function(e){return s.rc(n),s.dc().email=e})),s.Pb(),s.yc(7,h,4,0,"label",34),s.yc(8,m,1,0,"br",35),s.Qb(9,"div",36),s.Qb(10,"label",37),s.Qb(11,"input",38,39),s.Zb("ngModelChange",(function(e){return s.rc(n),s.dc().conditionsChecked=e})),s.Pb(),s.Qb(13,"span"),s.zc(14,"Acepto las condiciones generales de venta "),s.Qb(15,"a",40),s.zc(16,"(leer las CGV)"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=s.dc();s.zb(5),s.ic("ngModel",i.email),s.zb(2),s.ic("appShowAuthed",!1),s.zb(1),s.ic("appShowAuthed",!0),s.zb(3),s.ic("ngModel",i.conditionsChecked)}}function b(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",46),s.Qb(1,"label",47),s.Qb(2,"div",48),s.Mb(3,"img",49),s.Mb(4,"img",50),s.Pb(),s.Qb(5,"div",51),s.Qb(6,"input",52),s.Zb("change",(function(){return s.rc(n),s.dc(2).onPaymentMethodSelected("card")})),s.Pb(),s.zc(7," con tarjeta "),s.Pb(),s.Pb(),s.Qb(8,"label",53),s.Qb(9,"div",48),s.Mb(10,"img",54),s.Pb(),s.Qb(11,"div",51),s.Qb(12,"input",55),s.Zb("change",(function(){return s.rc(n),s.dc(2).onPaymentMethodSelected("paypal")})),s.Pb(),s.zc(13," con paypal "),s.Pb(),s.Pb(),s.Pb()}}function y(e,t){if(1&e){var n=s.Rb();s.Qb(0,"form",56),s.Qb(1,"div",57),s.Qb(2,"label",58),s.zc(3,"Nombre"),s.Pb(),s.Qb(4,"input",59),s.Zb("ngModelChange",(function(e){return s.rc(n),s.dc(2).cardholdersName=e})),s.Pb(),s.Qb(5,"div",60),s.Qb(6,"div"),s.Qb(7,"label",61),s.zc(8,"Fecha v\xe1lida"),s.Pb(),s.Mb(9,"div",62),s.Qb(10,"small",63),s.zc(11,"Fecha de expiraci\xf3n inv\xe1lida"),s.Pb(),s.Pb(),s.Qb(12,"div"),s.Qb(13,"label",64),s.zc(14,"CVV / CVC *"),s.Pb(),s.Mb(15,"div",65),s.Qb(16,"small",63),s.zc(17,"CVV Inv\xe1lido"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(18,"div",66),s.Qb(19,"label",67),s.zc(20,"N\xfamero de la tarjeta"),s.Pb(),s.Mb(21,"div",68),s.Qb(22,"small",63),s.zc(23,"N\xfamero inv\xe1lido"),s.Pb(),s.Qb(24,"span",69),s.zc(25,"* El c\xf3digo CVV o CVC es un grupo de 3 o 4 n\xfameros situado en el reverso de la tarjeta de cr\xe9dito."),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=s.dc(2);s.zb(4),s.ic("ngModel",i.cardholdersName)}}function g(e,t){1&e&&s.Mb(0,"div",70)}function v(e,t){if(1&e&&(s.Qb(0,"div",42),s.yc(1,b,14,0,"div",43),s.yc(2,y,26,1,"form",44),s.yc(3,g,1,0,"div",45),s.Pb()),2&e){var n=s.dc();s.zb(1),s.ic("ngIf",!1===n.loadingPayment),s.zb(1),s.ic("ngIf",!1===n.loadingPayment&&"card"===n.paymentMethod),s.zb(1),s.ic("ngIf","paypal"===n.paymentMethod)}}function A(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",71),s.Qb(1,"h2"),s.zc(2),s.Pb(),s.Qb(3,"div",22),s.Qb(4,"span",72),s.zc(5),s.Pb(),s.Qb(6,"span",73),s.zc(7),s.Pb(),s.Pb(),s.Qb(8,"p",74),s.zc(9,"Recibir\xe1s un mensaje a "),s.Qb(10,"strong"),s.zc(11),s.Pb(),s.zc(12," con tu factura as\xed como los documentos. Durante los pr\xf3ximos 15 d\xedas podr\xe1s modificar el formulario de nuevo sin tener que pagar y volver a descargarlo, una vez terminado el plazo caducar\xe1."),s.Pb(),s.Qb(13,"div",75),s.Qb(14,"h3"),s.zc(15,"Descarga ahora"),s.Pb(),s.Qb(16,"span",76),s.Zb("click",(function(){return s.rc(n),s.dc().downloadWord()})),s.Pb(),s.Qb(17,"span",77),s.Zb("click",(function(){return s.rc(n),s.dc().downloadPdf()})),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=s.dc();s.zb(2),s.Bc("Transacci\xf3n: ",i.transactionId,""),s.zb(3),s.Ac(i.form.title),s.zb(2),s.Bc("",i.form.amount," \u20ac"),s.zb(4),s.Ac(i.email)}}var T=function(e){return{opacity:e}};function I(e,t){if(1&e){var n=s.Rb();s.Qb(0,"button",78),s.Zb("click",(function(){return s.rc(n),s.dc().moveStep("previous")})),s.zc(1,"Anterior"),s.Pb()}if(2&e){var i=s.dc();s.xc("display","cart"===i.steps[i.currentStep].type?"none":"block"),s.ic("ngStyle",s.lc(4,T,"cart"===i.steps[i.currentStep].type?0:1))("disabled","cart"===i.steps[i.currentStep].type)}}function N(e,t){if(1&e){var n=s.Rb();s.Qb(0,"button",79),s.Zb("click",(function(){return s.rc(n),s.dc().exitModal.emit()})),s.zc(1,"Anterior"),s.Pb()}}function P(e,t){if(1&e){var n=s.Rb();s.Qb(0,"button",79),s.Zb("click",(function(){return s.rc(n),s.dc().exitModal.emit()})),s.zc(1,"Anterior"),s.Pb()}}function O(e,t){if(1&e){var n=s.Rb();s.Qb(0,"button",80),s.Zb("click",(function(){return s.rc(n),s.dc().moveStep("next")})),s.zc(1,"Siguiente"),s.Pb()}if(2&e){var i=s.dc();s.ic("ngStyle",s.lc(2,T,"finish"===i.steps[i.currentStep].type?0:1))("disabled","finish"===i.steps[i.currentStep].type)}}function R(e,t){if(1&e){var n=s.Rb();s.Qb(0,"button",81),s.Zb("click",(function(){return s.rc(n),s.dc().onSubmit()})),s.Qb(1,"strong"),s.zc(2,"PAGAR"),s.Pb(),s.Pb()}}var S,C,w,D,L=function(e){return{"checkout-panel__body__progress-bar__step__active":e}},k=((S=function(){function e(t,n,i,r,o,a,c){_classCallCheck(this,e),this.userService=t,this.checkoutService=n,this.formService=i,this.commonsService=r,this.convertService=o,this.router=a,this.toastr=c,this.formPaid=new s.n,this.exitModal=new s.n,this.downloadPdfOutput=new s.n,this.downloadWordOutput=new s.n,this.currentStep=0,this.loadingPayment=!0,this.idsOfFields=["number","cvv","expirationDate"],this.paymentMethod="card",this.steps=[{type:"cart",stepNum:0},{type:"login",stepNum:1},{type:"payment",stepNum:2},{type:"finish",stepNum:3}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.userService.isAuthenticated.subscribe((function(t){e.email=t?e.userService.getCurrentUser().email:""})),this.form.fields[this.form.fields.length-1]&&(this.currentStep=this.form.fields[this.form.fields.length-1].checkoutProcess.phase,"payment"===this.steps[this.currentStep].type&&(this.currentStep=this.currentStep-1))}},{key:"moveStep",value:function(e){"next"===e?this.validateBeforeNextStep()&&(this.currentStep+=1):"previous"===e&&(this.currentStep-=1),this.form.fields[this.form.fields.length-1].checkoutProcess.phase=this.currentStep,this.paymentProcess()}},{key:"validateBeforeNextStep",value:function(){if("login"===this.steps[this.currentStep].type){if(""===this.email)return this.emailInput.nativeElement.style.borderBottom="3px solid red",this.toastr.error("Email no puede estar vac\xedo","Email vac\xedo",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}),!1;if(!this.conditions.nativeElement.checked)return this.toastr.error("Debe aceptar las condiciones de venta","Aceptar",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}),!1}return!0}},{key:"goToAuth",value:function(){window.sessionStorage&&(window.sessionStorage[this.form.title]=JSON.stringify(this.form),this.router.navigate(["/auth/login"],{queryParams:{formPath:this.router.url.substring(this.router.url.lastIndexOf("/")+1)}}))}},{key:"onSubmit",value:function(){this.tokenizeUserDetails()}},{key:"onPaymentMethodSelected",value:function(e){this.paymentMethod=e,this.paymentProcess()}},{key:"paymentProcess",value:function(){var e=this;"payment"===this.steps[this.currentStep].type?(this.commonsService.toggleSpinner(),this.checkoutService.getToken(this.paymentMethod).subscribe((function(t){e.loadingPayment=!1,e.clientToken=t,e.createBraintreeUI(t)}))):this.loadingPayment=!0}},{key:"tokenizeUserDetails",value:function(){var e=this;this.commonsService.toggleSpinner(),this.hostedFieldsInstance.tokenize({cardholderName:this.cardholdersName}).then((function(t){e.checkoutService.pay(JSON.stringify(e.form.fields),e.email,t.nonce,e.form.id,e.paymentMethod).subscribe((function(t){t.transaction?(e.commonsService.toggleSpinner(),e.moveStep("next"),e.onPaymentCompleted(t.transaction.transactionId),e.toastr.success("Pago completado","Finalizado",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"})):e.commonsService.toggleSpinner()}))})).catch((function(t){e.commonsService.toggleSpinner(),e.toastr.error("Ha ocurrido un error, int\xe9ntelo de nuevo","Error en el pago",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}),console.log(t),"HOSTED_FIELDS_FIELDS_INVALID"===t.code?e.idsOfFields.forEach((function(e){if(t.details.invalidFieldKeys.includes(e)){var n=document.getElementById(e);n.classList.add("hosted-fields-invalid"),n.nextElementSibling.hidden=!1}else{var i=document.getElementById(e);i.classList.remove("hosted-fields-invalid"),i.nextElementSibling.hidden=!0}})):"HOSTED_FIELDS_FIELDS_EMPTY"===t.code&&e.idsOfFields.forEach((function(e){var t=document.getElementById(e);t.classList.add("hosted-fields-invalid"),t.nextElementSibling.hidden=!1}))}))}},{key:"createBraintreeUI",value:function(e){var t=this;"card"===this.paymentMethod?c.client.create({authorization:e}).then((function(e){c.hostedFields.create({client:e,styles:{input:{"font-size":"16px",padding:"0.5rem 0.25rem 0.5rem","font-family":"Lato","font-weight":"300",color:"rgba(46, 46, 46, 0.8)"},"::placeholder":{transition:"transition: 100ms linear","font-weight":"300","font-family":"Lato",color:"#4ECDC4"},":focus":{"border-color":"#77db77","border-bottom":"3px solid #77db77"},"input:focus":{"border-color":"#77db77","border-bottom":"3px solid #77db77"}},fields:{number:{selector:"#"+t.idsOfFields[0],placeholder:"1234 5678 9101 1213"},cvv:{selector:"#"+t.idsOfFields[1],placeholder:"111"},expirationDate:{selector:"#"+t.idsOfFields[2],placeholder:"02/20"}}}).then((function(e){t.hostedFieldsInstance=e;var n=e.getState().fields;Object.keys(n).every((function(e){return n[e].isValid})),t.commonsService.toggleSpinner()}))})):"paypal"===this.paymentMethod&&(this.commonsService.toggleSpinner(),paypal.Button.render({braintree:c,env:"sandbox",client:{sandbox:e},style:{size:"medium"},payment:function(e,n){return t.commonsService.toggleSpinner(),n.payment.create({payment:{transactions:[{amount:{total:t.form.amount,currency:"EUR"}}]}})},onAuthorize:function(e,n){return t.commonsService.toggleSpinner(),n.payment.tokenize().then((function(e){t.commonsService.toggleSpinner(),t.checkoutService.pay(JSON.stringify(t.form.fields),t.email,e.nonce,t.form.id,t.paymentMethod).subscribe((function(e){t.commonsService.toggleSpinner(),t.moveStep("next"),t.onPaymentCompleted(e.transaction.transactionId),t.toastr.success("Pago completado","Finalizado",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"})}))}))},onCancel:function(e){console.log("checkout.js payment cancelled",JSON.stringify(e))},onError:function(e){this.commonsService.toggleSpinner(),this.toastr.error("Paypal error",e,{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"})}},"#paypal-button"))}},{key:"onPaymentCompleted",value:function(e){var t=this;this.transactionId=e,this.formService.getPaidCertifiedForm(e).subscribe((function(n){n.certifiedForm.transactionId=e,t.formPaid.emit(n.certifiedForm)}))}},{key:"downloadWord",value:function(){this.downloadWordOutput.emit()}},{key:"downloadPdf",value:function(){this.downloadPdfOutput.emit()}}]),e}()).\u0275fac=function(e){return new(e||S)(s.Lb(a.r),s.Lb(a.b),s.Lb(a.j),s.Lb(a.d),s.Lb(a.f),s.Lb(o.d),s.Lb(l.b))},S.\u0275cmp=s.Fb({type:S,selectors:[["app-checkout"]],viewQuery:function(e,t){var n;1&e&&(s.Dc(p,!0),s.Dc(_,!0)),2&e&&(s.oc(n=s.ac())&&(t.emailInput=n.first),s.oc(n=s.ac())&&(t.conditions=n.first))},inputs:{form:"form"},outputs:{formPaid:"formPaid",exitModal:"exitModal",downloadPdfOutput:"downloadPdfOutput",downloadWordOutput:"downloadWordOutput"},decls:18,vars:18,consts:[[1,"modal__content__top","modal__content__top--privacy"],[1,"checkout-panel__body__progress-bar"],[1,"checkout-panel__body__progress-bar__step","checkout-panel__body__progress-bar__step__active"],[1,"checkout-panel__body__progress-bar__step",3,"ngClass"],["id","modal-middle-privacy",1,"modal__content__modal-middle","modal__content__modal-middle--privacy",2,"border-bottom","none"],[1,"modal__content__modal-middle__container"],["class","checkout-panel__body__invoice",4,"ngIf"],["class","checkout-panel__body__email",4,"ngIf"],["class","payment-container",4,"ngIf"],["class","checkout-panel__body__success",4,"ngIf"],[1,"modal__content__modal-bottom","modal__content__modal-bottom--privacy","checkout-panel__footer"],["class","btn back-btn",3,"ngStyle","display","disabled","click",4,"ngIf"],["class","btn back-btn",3,"click",4,"ngIf"],["class","btn next-btn",3,"ngStyle","disabled","click",4,"ngIf"],["class","btn next-btn secondaryC-background-color",3,"click",4,"ngIf"],[1,"checkout-panel__body__invoice"],[1,"checkout-panel__body__invoice__container"],[1,"checkout-panel__body__invoice__document"],["alt","checkout-image",3,"src"],[1,"checkout-panel__body__invoice__text"],[1,"checkout-panel__body__invoice__text__title"],[1,"checkout-panel__body__invoice__text__description"],[1,"checkout-panel__body__invoice__text__total"],[1,"checkout-panel__body__invoice__text__total__right"],[1,"checkout-panel__body__invoice__text__total__left"],[1,"checkout-panel__body__invoice__text__more-info"],["src","/assets/images/ssl-secure-en.png","alt","secure payment"],["src","https://s3.amazonaws.com/braintree-badges/braintree-badge-dark.png"],[1,"checkout-panel__body__email"],[1,"checkout-panel__body__email__container"],[1,"checkout-panel__body__email__container__title"],["for","email"],["type","email","name","email","id","name","placeholder","Email",3,"ngModel","ngModelChange"],["emailInput",""],["class","checkout-panel__body__email__container__message",4,"appShowAuthed"],[4,"appShowAuthed"],[1,"checkout-panel__body__email__container__message"],["for","conditions"],["type","checkbox","name","conditions","id","conditions",1,"filled-in",3,"ngModel","ngModelChange"],["conditions",""],["routerLink","/static-pages/cgv","target","_blank",1,"trigger"],["href","javascript:void(0)",3,"click"],[1,"payment-container"],["class","checkout-panel__body__payment-method",4,"ngIf"],["class","checkout-panel__body__input-fields",4,"ngIf"],["id","paypal-button","style","height: 200px; margin-left: auto;margin-right:auto; display: flex;align-items: center;",4,"ngIf"],[1,"checkout-panel__body__payment-method"],["for","card",1,"checkout-panel__body__payment-method__method","card"],[1,"checkout-panel__body__payment-method__method__card-logos"],["src","https://designmodo.com/demo/checkout-panel/img/visa_logo.png"],["src","https://designmodo.com/demo/checkout-panel/img/mastercard_logo.png"],[1,"checkout-panel__body__payment-method__method__radio-input"],["id","card","type","radio","name","payment","value","card","checked","",3,"change"],["for","paypal",1,"checkout-panel__body__payment-method__method","paypal"],["src","https://designmodo.com/demo/checkout-panel/img/paypal_logo.png"],["id","paypal","type","radio","name","payment","value","paypal",3,"change"],[1,"checkout-panel__body__input-fields"],[1,"checkout-panel__body__input-fields__column-1"],["for","cardholder-name","name","cardholderName",1,"hosted-field--label"],["type","text","id","cardholder","placeholder","P. ej: Juan P\xe9rez \xc1lvarez","name","cardholderName",1,"name-custom-input",3,"ngModel","ngModelChange"],[1,"checkout-panel__body__input-fields__small-inputs"],["for","expirationDate"],["id","expirationDate",1,"hosted-fields"],["hidden","",1,"secondary-color"],["for","cvv"],["id","cvv","name","cvv",1,"hosted-fields"],[1,"checkout-panel__body__input-fields__column-2"],["for","number"],["id","number",1,"hosted-fields"],[1,"info"],["id","paypal-button",2,"height","200px","margin-left","auto","margin-right","auto","display","flex","align-items","center"],[1,"checkout-panel__body__success"],[1,"checkout-panel__body__invoice__text__total__right","total-success"],[1,"checkout-panel__body__invoice__text__total__left","total-success"],[1,"checkout-panel__body__success__message"],[1,"checkout-panel__body__success__download"],[1,"icon","icon-file-word-solid","trigger",3,"click"],[1,"icon","icon-file-pdf-solid",3,"click"],[1,"btn","back-btn",3,"ngStyle","disabled","click"],[1,"btn","back-btn",3,"click"],[1,"btn","next-btn",3,"ngStyle","disabled","click"],[1,"btn","next-btn","secondaryC-background-color",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Mb(2,"div",2),s.Mb(3,"div",3),s.Mb(4,"div",3),s.Mb(5,"div",3),s.Pb(),s.Pb(),s.Qb(6,"div",4),s.Qb(7,"div",5),s.yc(8,f,23,3,"div",6),s.yc(9,E,17,4,"div",7),s.yc(10,v,4,3,"div",8),s.yc(11,A,18,4,"div",9),s.Pb(),s.Pb(),s.Qb(12,"div",10),s.yc(13,I,2,6,"button",11),s.yc(14,N,2,0,"button",12),s.yc(15,P,2,0,"button",12),s.yc(16,O,2,4,"button",13),s.yc(17,R,3,0,"button",14),s.Pb()),2&e&&(s.zb(3),s.ic("ngClass",s.lc(12,L,t.steps[t.currentStep].stepNum>0)),s.zb(1),s.ic("ngClass",s.lc(14,L,t.steps[t.currentStep].stepNum>1)),s.zb(1),s.ic("ngClass",s.lc(16,L,t.steps[t.currentStep].stepNum>2)),s.zb(3),s.ic("ngIf","cart"===t.steps[t.currentStep].type),s.zb(1),s.ic("ngIf","login"===t.steps[t.currentStep].type),s.zb(1),s.ic("ngIf","payment"===t.steps[t.currentStep].type),s.zb(1),s.ic("ngIf","finish"===t.steps[t.currentStep].type),s.zb(2),s.ic("ngIf","finish"!==t.steps[t.currentStep].type),s.zb(1),s.ic("ngIf","cart"===t.steps[t.currentStep].type),s.zb(1),s.ic("ngIf","finish"===t.steps[t.currentStep].type),s.zb(1),s.ic("ngIf","payment"!==t.steps[t.currentStep].type),s.zb(1),s.ic("ngIf","payment"===t.steps[t.currentStep].type&&"card"===t.paymentMethod))},directives:[i.q,i.t,d.c,d.q,d.t,u.a,d.a,o.g,d.G,d.r,d.s,i.w],encapsulation:2}),S),M=n("2Vo4"),U=n("/uUt"),F=((C=function(){function e(){_classCallCheck(this,e),this.currentFormSubject=new M.a({}),this.currentForm=this.currentFormSubject.asObservable().pipe(Object(U.a)())}return _createClass(e,[{key:"setForm",value:function(e){this.currentFormSubject.next(Object.assign({},e))}},{key:"getCurrentForm",value:function(){return this.currentFormSubject.value}}]),e}()).\u0275fac=function(e){return new(e||C)},C.\u0275prov=s.Hb({token:C,factory:C.\u0275fac}),C),x=n("KlD3"),z=((D=function(){function e(t,n){_classCallCheck(this,e),this.commonsService=t,this.convertService=n,this.scrollToelement=!1}return _createClass(e,[{key:"init",value:function(e){var t=this;return this.createEditorFromURI("fillForm","editorContainer",e),new Promise((function(e,n){var i=setInterval((function(){window.editor&&window.editor.getEditorSession()&&document.getElementsByTagName("office:text").length&&(t.originalDocumentBodyClone=document.getElementsByTagName("office:text")[0].cloneNode(!0),clearInterval(i),e("Document ready"))}),300)}))}},{key:"destroy",value:function(){this.commonsService.isBrowser()&&(x.closeAndDestroyEditor(),window.removeEventListener("resize",this.resizeEvent))}},{key:"createEditorFromURI",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"editorContainer",n=arguments.length>2?arguments[2]:void 0,i=atob(n.split(",")[1]),r=n.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(i.length),a=new Uint8Array(o),s=0;s<i.length;s++)a[s]=i.charCodeAt(s);var c=new Blob([o],{type:r}),l=URL.createObjectURL(c);window.DOCUMENTOURL=l,x.createEditor(e,t)}},{key:"getEditorSession",value:function(){return x.getEditorSession()}},{key:"saveUri",value:function(){var e=new FileReader;return new Promise((function(t,n){x.getEditor().getDocumentAsByteArray((function(n,i){if(n)alert(n);else{var r=new Blob([i.buffer],{type:"application/vnd.oasis.opendocument.text"});e.readAsDataURL(r),e.onloadend=function(){t(e.result)}}}))}))}},{key:"resizeDocumentContainer",value:function(){this.resizeEvent=function(){setTimeout((function(){document.getElementById("webodfeditor-editor1").style.height="100%",document.getElementById("webodfeditor-editor1").style.width="100%",x.documentToFitScreen()}),100)},window.addEventListener("resize",this.resizeEvent),x.documentToFitScreen()}},{key:"buildDocument",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.currentDocumentBodyClone=this.originalDocumentBodyClone.cloneNode(!0),n?(this.currentDocumentBodyClone=this.documentBodyCloneJustForReplacements.cloneNode(!0),this.currentDocumentBodyClone.querySelectorAll(".highlight-disapear").forEach((function(e){e.classList.remove("highlight-disapear"),e.classList.remove("focused")}))):this.structuralChanges(e),this.replacements(e),document.getElementsByTagName("office:text")[0].parentElement.replaceChild(this.currentDocumentBodyClone.cloneNode(!0),document.getElementsByTagName("office:text")[0]),this.getEditorSession().getOdfCanvas().refreshSize(),t&&this.scrollToElementWithClass("focused")}},{key:"scrollToElementWithClass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=document.querySelector("."+e);if(t){var n=document.getElementById("webodfeditor-canvascontainer1"),i=n.clientHeight/2,r=t.getBoundingClientRect().top;n.scrollTo({top:n.scrollTop+r-i,behavior:"smooth"})}}},{key:"dateToSpanishFormat",value:function(e){var t=new Date(e),n="";return e&&(n=t.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})),n}},{key:"showIndicationInsideText",value:function(e,t){var n=document.querySelector("[data-identifier=".concat(e,"]")),i=document.createElement("div");i.innerHTML='<div class="indicator-content not-selectable">\n                        <button id="close-indication">&#10006;</button>\n                        <span class="not-selectable" style="margin:auto; width:100%">'.concat(t,"\n                        </span>\n                    </div>"),i.style.top=n.getBoundingClientRect().top.toString(),i.style.left=n.getBoundingClientRect().left.toString(),i.classList.add("indicator"),i.classList.add("smooth-intro"),i.classList.add("not-selectable"),n.appendChild(i),window.addEventListener("click",(function e(t){window.innerWidth>885?t.target.classList.contains("icon-info-circle-solid")||t.target.classList.contains("indication")?document.querySelectorAll(".indicator").length>=2&&(i.parentNode.removeChild(i),window.removeEventListener("click",e)):(i.parentNode.removeChild(i),window.removeEventListener("click",e)):"scrollToTop"!==t.target.id&&"close-indication"!==t.target.id||(i.parentNode.removeChild(i),window.removeEventListener("click",e))})),this.scrollToElementWithClass("indicator",i.offsetHeight)}},{key:"structuralChanges",value:function(e){var t=this;e.forEach((function(e){"iRadioC"===e.type?t.buildForRadioC(e):"iCheckbox"===e.type?t.buildForCheckbox(e):"iForEach"===e.type&&t.buildForEach(e)})),this.documentBodyCloneJustForReplacements=this.currentDocumentBodyClone.cloneNode(!0)}},{key:"buildForEach",value:function(e){var t=this;e.content.forEach((function(n){var i=t.findword(n.wordToReplace);if(i.textContent===n.wordToReplace)n.modifiedReplacements.slice().reverse().forEach((function(r,o){var a,s=new RegExp(e.wordToReplace,"g");if(o!==n.modifiedReplacements.length-1){var c=i.cloneNode(!0);i.parentNode.insertBefore(c,i.nextSibling),e.forEachFocused&&function(){var e=document.createElement("span");for(e.classList.add("highlight-disapear","focused"),c.childNodes.forEach((function(t){e.appendChild(t)}));c.firstChild;)c.removeChild(c.firstChild);c.appendChild(e)}(),a=c}else a=i;(a=t.findExactContainingElement(e.wordToReplace,a)).innerHTML=a.innerHTML.replace(s,r)})),n.modifiedExtraReplacements.slice().reverse().forEach((function(e,n){e.forEach((function(e){var n=t.findword(e[0].identifier);e.slice().reverse().forEach((function(i,r){var o,a=new RegExp(i.identifier,"g");if(r!==e.length-1){var s=n.cloneNode(!0);n.parentNode.insertBefore(s,n.nextSibling),o=t.findExactContainingElement(i.identifier,s)}else o=t.findExactContainingElement(i.identifier,n);o.innerHTML=o.innerHTML.replace(a,i.replacement)}))}))}));else if(i.textContent.includes(n.wordToReplace)&&i.childElementCount<=1){var r=n.modifiedReplacements.slice().reverse(),o=new RegExp(e.wordToReplace,"g"),a=i.textContent,s=a.slice(0,a.indexOf(n.wordToReplace)),c=a.slice(a.indexOf(n.wordToReplace),a.length).replace(o,"");r.forEach((function(e,t){c=e+c})),i.innerHTML="<span>".concat(s+c,"</span>")}})),e.forEachFocused=!1}},{key:"buildForRadioC",value:function(e){var t,n=this,i=this.findword(e.wordToReplace),r=new RegExp(e.wordToReplace,"g");for(e.radios.forEach((function(i){i.checked&&(t=e.isFocused||e.radioCfocused?'<span class="highlight-disapear focused">'.concat(i.replacement,"</span>"):i.replacement,e.extraReplacements.forEach((function(e,t){var r,o=new RegExp(e.wordToReplace,"g"),a=n.findword(e.wordToReplace),s=n.findExactContainingElement(e.wordToReplace,a);i.extraReplacements.forEach((function(t){t.insideId===e.insideId&&(r=t.replacement)})),s.innerHTML=s.innerHTML.replace(o,r)})))})),i=this.findExactContainingElement(e.wordToReplace,i);null!==i.firstElementChild&&!this.allElementsAreBr(i);)i=i.firstElementChild;i.innerHTML=i.innerHTML.replace(r,t),e.radioCfocused=!1}},{key:"allElementsAreBr",value:function(e){for(var t,n=!0,i=e.children;t<i.length;t++)"BR"!==i[t].tagName&&(n=!1);return i.length||(n=!1),n}},{key:"buildForCheckbox",value:function(e){var t=this.findword(e.wordToReplace),n=e.replacement;e.checkboxes.forEach((function(t){if(e.replacement.includes(t.wordToReplace))if(t.checked){var i=new RegExp(t.wordToReplace,"g");n=n.replace(i,t.replacement)}else{var r=new RegExp(t.wordToReplace,"g");n=n.replace(r,"")}})),t.innerHTML===e.wordToReplace&&(t.innerHTML=n)}},{key:"replacements",value:function(e){var t=this;e.forEach((function(e){if("iText"===e.type||"iDate"===e.type||"iNumber"===e.type){var n=t.findAllwords(e.wordToReplace),i=new RegExp(e.wordToReplace,"g");n.forEach((function(n){var r=n,o=e.replacement;r.innerHTML!==e.wordToReplace&&(r=t.findExactContainingElement(e.wordToReplace,r)),"iDate"===e.type&&(o=t.dateToSpanishFormat(e.replacement)),e.isEmpty&&(""!==e.replacement?(e.isEmpty.prepend&&(o.slice(0,e.isEmpty.prepend.length)===e.isEmpty.prepend&&(o=o.slice(e.isEmpty.prepend.length,o.length)),o=e.isEmpty.prepend+o),e.isEmpty.append&&(o.slice(-e.isEmpty.append.length)===e.isEmpty.append&&(o=o.slice(0,-e.isEmpty.prepend.length)),o+=e.isEmpty.append)):e.isEmpty.defaultValue&&(o=e.isEmpty.defaultValue)),r&&(r.innerHTML=r.innerHTML.replace(i,'<span class="'.concat(e.isFocused?"highlight focused":"",'" data-identifier="').concat(e.wordToReplace,'">').concat(o,"</span>")))}))}else if("iRadioB"===e.type){var r=t.findAllwords(e.wordToReplace),o=new RegExp(e.wordToReplace,"g");r.forEach((function(n){e.radios.forEach((function(i){if(i.checked){i.replacement;var r=n;r.innerHTML!==e.wordToReplace&&(r=t.findExactContainingElement(e.wordToReplace,r)),r&&(r.innerHTML=r.innerHTML.replace(o,'<span class=" '.concat(e.isFocused?"highlight focused":"",'" data-identifier="').concat(e.wordToReplace,'">').concat(e.replacement,"</span>")))}}))}))}e.extraReplacements&&e.extraReplacements.length&&e.extraReplacements.forEach((function(e){var n=t.findAllwords(e.wordToReplace),i=new RegExp(e.wordToReplace,"g");n.forEach((function(n){var r=n,o=e.replacement;r.innerHTML!==e.wordToReplace&&(r=t.findExactContainingElement(e.wordToReplace,r)),r&&(r.innerHTML=r.innerHTML.replace(i,'<span class="'.concat(e.isFocused?"highlight focused":"",'" data-identifier="').concat(e.wordToReplace,'">').concat(o,"</span>")))}))}))}))}},{key:"findword",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentDocumentBodyClone,n=t.childNodes,i=0;i<n.length;i++)if(!this.elementIsExcluded(n[i])&&(n[i].innerHTML.includes(e)||n[i].textContent.includes(e)))return n[i]}},{key:"findAllwords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentDocumentBodyClone,n=[],i=t.childNodes,r=0;r<i.length;r++)this.elementIsExcluded(i[r])||i[r].innerHTML.includes(e)&&n.push(i[r]);return n}},{key:"findExactContainingElement",value:function(e,t){for(var n=t;n.childNodes&&n.childNodes.length>0&&n.innerHTML.includes(e);)n.childNodes.forEach((function(t){"#text"!==t.nodeName?t.innerHTML.includes(e)&&(n=t):t.textContent.includes(e)&&(n=t)}));return"#text"===n.nodeName&&(n=n.parentNode),n}},{key:"elementIsExcluded",value:function(e){return["office:text","text:sequence-decls","text:sequence-decl","draw:frame","draw:image","office:annotation","office:annotation-end","dc:creator","dc:date"].includes(e.nodeName)}},{key:"downloadWord",value:function(e,t){var n=this;this.commonsService.toggleSpinner(),this.saveUri().then((function(t){n.convertService.toWord(e,t).subscribe((function(e){for(var t=atob(e.word.split(",")[1]),i=e.word.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r),a=0;a<t.length;a++)o[a]=t.charCodeAt(a);var s=new Blob([r],{type:i}),c=URL.createObjectURL(s);console.log(c);var l=document.createElement("a");l.href=c,l.download="word.doc",l.click(),n.commonsService.toggleSpinner()}))}))}},{key:"downloadPdf",value:function(e,t){var n=this;this.commonsService.toggleSpinner(),this.saveUri().then((function(t){n.convertService.toPdf(e,t).subscribe((function(e){for(var t=atob(e.pdf.split(",")[1]),i=e.pdf.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r),a=0;a<t.length;a++)o[a]=t.charCodeAt(a);var s=new Blob([r],{type:i}),c=URL.createObjectURL(s);console.log(c);var l=document.createElement("a");l.href=c,l.download="document.pdf",l.click(),n.commonsService.toggleSpinner()}))}))}}]),e}()).\u0275fac=function(e){return new(e||D)(s.Vb(a.d),s.Vb(a.f))},D.\u0275prov=s.Hb({token:D,factory:D.\u0275fac}),D),H=((w=function(){function e(t,n){_classCallCheck(this,e),this.documentCreatorService=t,this.commonsService=n}return _createClass(e,[{key:"init",value:function(e){this.steps=e,this.cacheSteps=JSON.parse(JSON.stringify(this.steps))}},{key:"refreshCache",value:function(){this.cacheSteps=JSON.parse(JSON.stringify(this.steps))}},{key:"setInitialState",value:function(){var e=this;if(!this.steps[0].inited)for(var t=0;t<5;t++)e.steps.forEach((function(t){switch(t.type){case"start":t.inited=!0;break;case"iText":case"iNumber":case"iDate":e.input(t.replacement,t.wordToReplace,!1);break;case"iForEach":e.buildForEach(t.value,t.wordToReplace,!1);break;case"iRadioB":t.radios.forEach((function(n){n.checked&&e.onInputRadioBSelected(n.radioId,t.wordToReplace,!1,!0)}));break;case"iRadioC":var n=!0;t.radios.forEach((function(i){i.checked&&(n=!1,e.onInputRadioCSelected(i.radioId,t.wordToReplace,!1))})),n&&e.onInputRadioCSelected(t.defaultRadioId,t.wordToReplace,!1)}}));this.buildDocument(!1)}},{key:"buildDocument",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&this.checkCache(),this.documentCreatorService.buildDocument(this.steps,e,t)}},{key:"checkCache",value:function(){var e=this;this.steps.forEach((function(t){e.checkIfIsOfType(["iText","iNumber","iDate","iRadioB"],t)&&e.cacheSteps.forEach((function(n){t.wordToReplace===n.wordToReplace&&("iRadioB"===t.type?n.radios.forEach((function(n){n.checked&&e.onInputRadioBSelected(n.radioId,t.wordToReplace,!1,!0)})):t.replacement=n.replacement)}))}))}},{key:"checkIfIsOfType",value:function(e,t){return e.forEach((function(e){if(t.type===e)return!0})),!1}},{key:"input",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.findStep(t,!0,"wordToReplace"),o=r.step,a=r.index;o.replacement=e,o.isFocused=!0,"iNumber"===o.type&&this.rulesForInumber(o,a),n&&this.buildDocument(!0,i)}},{key:"findStep",value:function(e,t,n){var i,r;return this.steps.forEach((function(o,a){o[n]===e?(i=o,r=a):t&&(o.isFocused=!1)})),{step:i,index:r}}},{key:"rulesForInumber",value:function(e,t){var n=this;e.rules&&e.rules.length&&e.rules.forEach((function(t){"extraReplacementToCharacter"===t.rulename&&e.extraReplacements&&n.extraReplacementToCharacter(e,t),"extraReplacementAletras"===t.rulename&&e.extraReplacements&&n.extraReplacementAletras(e,t)}))}},{key:"extraReplacementToCharacter",value:function(e,t){e.extraReplacements.forEach((function(n,i){n.wordToReplace===t.wordToReplace&&e.extraReplacements.splice(i,1)})),e.extraReplacements.push({wordToReplace:t.wordToReplace,replacement:this.commonsService.precioALetras(e.replacement,{plural:"euros",singular:"euro",centPlural:"centavos",centSingular:"centavo"})})}},{key:"extraReplacementAletras",value:function(e,t){e.extraReplacements.forEach((function(n,i){n.wordToReplace===t.wordToReplace&&e.extraReplacements.splice(i,1)})),e.extraReplacements.push({wordToReplace:t.wordToReplace,replacement:this.commonsService.numeroALetras(e.replacement)})}},{key:"buildForEach",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=[],s=[],c=this.findStep(t,!1,"wordToReplace"),l=c.step,d=c.index;l.forEachFocused=r,l.value=e,this.cleanPreviouslyAddedSteps(d,l.identifier),l.content.forEach((function(t,i){t.modifiedReplacements=[],t.modifiedExtraReplacements=[];var r=[];t.extraReplacements.forEach((function(){r.push([])}));for(var o=function(o){var c=t.replacementOriginal;t.extraReplacements.forEach((function(e,t){r[t].push({identifier:e.identifier,replacement:e.replacementOriginal})})),t.subSteps.forEach((function(u,p){var _=l.identifier+u.identifier+o.toString()+p.toString();c=c.replace(u.identifier,_),t.extraReplacements.forEach((function(e,t){var n=u.extraReplacements[t],i=r[t][o];i.wordToReplace=e.identifier+o.toString()+p.toString();var a=l.identifier+n.identifier+o.toString()+p.toString();i.replacement=i.replacement.replace(n.identifier,a),n.wordToReplace=a,n.identifier=a}));var f=JSON.parse(JSON.stringify(u));n.cacheSteps.forEach((function(e){e.wordToReplace==_&&((f=JSON.parse(JSON.stringify(e))).cached=!0)})),f.identifier=_,f.wordToReplace=_,f.hasIndex&&(f.question=1===parseInt(e)?f.questionOriginal.replace("->(index)",""):f.questionOriginal.replace("->(index)",o+1)),n.steps.splice(d+1+p+o*t.subSteps.length+parseInt(e)*i*t.subSteps.length,0,f),"iRadioB"===f.type&&a.push(f),"iRadioC"===f.type&&(f.radios.forEach((function(e){e.subSteps.forEach((function(t){var n=_+t.identifier,i=new RegExp(t.identifier,"g");e.replacementOriginal=e.replacementOriginal.replace(i,n),t.wordToReplace=n,t.identifier=n}))})),s.push(f))})),t.modifiedReplacements.push(c)},c=0;c<parseInt(e);c++)o(c);t.modifiedExtraReplacements.push(r)})),a.forEach((function(e){e.radios.forEach((function(t){t.checked&&n.onInputRadioBSelected(t.radioId,e.wordToReplace,!1,!0)}))})),i&&(s.forEach((function(e){e.cached?e.radios.forEach((function(t){t.checked&&n.onInputRadioCSelected(t.radioId,e.wordToReplace,!1)})):n.onInputRadioCSelected(e.defaultRadioId,e.wordToReplace,!1)})),this.buildDocument(!0,!1,o))}},{key:"cleanPreviouslyAddedSteps",value:function(e,t){for(;this.steps[e+1]&&this.steps[e+1].wordToReplace.includes(t);)this.steps.splice(e+1,1)}},{key:"onInputRadioBSelected",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.findStep(t,!1,"wordToReplace"),o=r.step;o.isFocused=!i,o.radios.forEach((function(t){t.radioId===e?(o.replacement=t.replacementOriginal,t.checked=!0,o.extraReplacements&&o.extraReplacements.forEach((function(e,n){e.replacement=t.extraReplacements[n].replacement}))):t.checked=!1})),n&&this.buildDocument()}},{key:"onInputRadioCSelected",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=[],s=[],c=[],l=[],d=function(e,t,i){n.cleanPreviouslyAddedSteps(t,e.wordToReplace);var r=i.replacementOriginal;i.extraReplacements.forEach((function(e){e.replacement=e.replacementOriginal})),i.subSteps.forEach((function(o,d){o.wordToReplace=e.identifier+o.identifier;var u=new RegExp(o.identifier,"g");r=r.replace(u,o.wordToReplace),i.extraReplacements.forEach((function(e){e.replacement=e.replacement.replace(o.identifier,o.wordToReplace)})),"iCheckbox"===o.type&&o.checkboxes.forEach((function(e){e.checked=!1})),"iRadioC"===o.type&&(o.inheritFromRadioC=o.wordToReplace,o.radios.forEach((function(e){e.subSteps.forEach((function(t){var n=o.wordToReplace+t.identifier,i=new RegExp(t.identifier,"g");e.replacementOriginal=e.replacementOriginal.replace(i,n),t.wordToReplace=n,t.identifier=n,t.inherited=!0}))})),l.push(o)),"iForEach"===o.type&&(o.content.forEach((function(e){var t=new RegExp(e.wordToReplace,"g");e.replacementOriginal=e.replacementOriginal.replace(t,o.wordToReplace),e.subSteps.forEach((function(e){e.wordToReplace=e.wordToReplace.replace(t,o.wordToReplace),e.identifier=e.identifier.replace(t,o.wordToReplace)})),e.wordToReplace=o.wordToReplace,e.identifier=o.wordToReplace})),a.push(o)),"iNumber"===o.type&&(o.rules.forEach((function(e){if("extraReplacementToCharacter"===e.rulename){var t="i"+Math.random().toString(36).substring(7)+e.identifier;e.wordToReplace=t;var n=new RegExp(e.identifier,"g");r=r.replace(n,t)}})),o.rules.length&&s.push(o)),"iRadioB"===o.type&&c.push(o),n.steps.splice(t+1+d,0,o)})),i.replacement=r,i.checked=!0};this.steps.forEach((function(n,i){(n.identifier===t||n.inheritFromRadioC&&n.inheritFromRadioC===t)&&n.radios.forEach((function(t){t.radioId===e?d(n,i,t):t.checked=!1})),n.wordToReplace===t?(n.isFocused=!0,n.radioCfocused=r):n.isFocused=!1})),a.forEach((function(e){n.buildForEach(e.value,e.wordToReplace,!1,!0)})),l.forEach((function(e){e.radios.forEach((function(t){t.checked&&n.onInputRadioCSelected(t.radioId,e.wordToReplace,!1)}))})),s.forEach((function(e){n.input(e.replacement,e.wordToReplace,!1)})),c.forEach((function(e){e.radios.forEach((function(t){t.checked&&n.onInputRadioBSelected(t.radioId,e.wordToReplace,!1,!0)}))})),i&&this.buildDocument(!0,!1,o)}},{key:"onInputCheckboxSelected",value:function(e,t,n){var i=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.steps.forEach((function(r,o){if(r.wordToReplace===t){var a=r.replacementOriginal;r.checkboxes.forEach((function(t){if(t.wordToReplace=r.wordToReplace+t.identifier,a=a.replace(t.identifier,t.wordToReplace),t.identifier===e){for(var s=i.steps.length-o,c=0;c<s;c++)i.steps[o+1+c]&&i.steps[o+1+c].wordToReplace.includes(t.identifier)&&i.steps.splice(o+1+c,1);if(n){var l=t.replacementOriginal;t.subSteps.forEach((function(e,n){e.wordToReplace=t.wordToReplace+e.identifier,l=l.replace(e.identifier,e.wordToReplace),i.steps.splice(o+1+n,0,e)})),t.replacement=l}t.checked=n}})),r.replacement=a,r.rules&&r.rules.length&&r.rules.forEach((function(e){if("noneIsChecked"===e.condition){var t=!1;r.checkboxes.forEach((function(e){e.checked&&(t=!0)})),t?e.isFulfilled=!1:(r.replacement=e.replacement,e.isFulfilled=!0)}}))}})),r&&this.buildDocument()}},{key:"getStepsModel",value:function(){return this.steps}}]),e}()).\u0275fac=function(e){return new(e||w)(s.Vb(z),s.Vb(a.d))},w.\u0275prov=s.Hb({token:w,factory:w.\u0275fac}),w);function V(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",12),s.Qb(1,"span",13),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}var Q=function(e){return{borderBottom:e}};function B(e,t){if(1&e){var n=s.Rb();s.Qb(0,"input",14,15),s.Zb("keyup",(function(e){return s.rc(n),s.dc().onInput(e)}))("click",(function(e){return s.rc(n),s.dc().onInput(e)})),s.Pb()}if(2&e){var i=s.dc();s.ic("value",i.step.replacement)("placeholder",i.step.placeholder?i.step.placeholder:"")("ngStyle",s.lc(3,Q,i.inputInvalid?"3px solid red":""))}}function Y(e,t){if(1&e){var n=s.Rb();s.Qb(0,"textarea",16,15),s.Zb("keyup",(function(e){return s.rc(n),s.dc().onInput(e)}))("click",(function(e){return s.rc(n),s.dc().onInput(e)})),s.Pb()}if(2&e){var i=s.dc();s.ic("value",i.step.replacement)("placeholder",i.step.placeholder?i.step.placeholder:"")("ngStyle",s.lc(3,Q,i.inputInvalid?"3px solid red":""))}}function K(e,t){1&e&&(s.Qb(0,"span",17),s.zc(1," Obligatorio * "),s.Pb())}var W,j=((W=function(){function e(t){_classCallCheck(this,e),this.stepModelService=t,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"showIndication",value:function(){this.emitIndication.emit()}},{key:"onInput",value:function(e){this.stepModelService.input(e.srcElement.value,this.step.wordToReplace,!0,!0)}}]),e}()).\u0275fac=function(e){return new(e||W)(s.Lb(H))},W.\u0275cmp=s.Fb({type:W,selectors:[["app-i-text"]],inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:13,vars:5,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__question"],["type","text",3,"value","placeholder","ngStyle","keyup","click",4,"ngIf"],["cols","30","rows","6",3,"value","placeholder","ngStyle","keyup","click",4,"ngIf"],[1,"form-creator__fields-area__field__bottom"],["class","form-creator__fields-area__field__bottom__mandatory-label",4,"ngIf"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"],["type","text",3,"value","placeholder","ngStyle","keyup","click"],["input",""],["cols","30","rows","6",3,"value","placeholder","ngStyle","keyup","click"],[1,"form-creator__fields-area__field__bottom__mandatory-label"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,V,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"span",7),s.zc(8),s.Pb(),s.yc(9,B,2,5,"input",8),s.yc(10,Y,2,5,"textarea",9),s.Pb(),s.Qb(11,"div",10),s.yc(12,K,2,0,"span",11),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(3),s.Ac(t.step.question),s.zb(1),s.ic("ngIf","textarea"!==t.step.subType),s.zb(1),s.ic("ngIf","textarea"===t.step.subType),s.zb(2),s.ic("ngIf",t.step.mandatory))},directives:[i.t,i.w],encapsulation:2}),W);function G(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",13),s.Qb(1,"span",14),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}function q(e,t){1&e&&(s.Qb(0,"span",15),s.zc(1," Obligatorio * "),s.Pb())}var Z,J=function(e){return{borderBottom:e}},X=((Z=function(){function e(t){_classCallCheck(this,e),this.stepModelService=t,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"showIndication",value:function(){this.emitIndication.emit()}},{key:"onInput",value:function(e,t){this.stepModelService.input(e,t,!0,!0)}}]),e}()).\u0275fac=function(e){return new(e||Z)(s.Lb(H))},Z.\u0275cmp=s.Fb({type:Z,selectors:[["app-i-date"]],inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:14,vars:7,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__date-container"],[1,"form-creator__fields-area__field__middle__question"],["type","date",3,"value","ngStyle","change"],["input",""],[1,"form-creator__fields-area__field__bottom"],["class","form-creator__fields-area__field__bottom__mandatory-label",4,"ngIf"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"],[1,"form-creator__fields-area__field__bottom__mandatory-label"]],template:function(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,G,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"div",7),s.Qb(8,"span",8),s.zc(9),s.Pb(),s.Qb(10,"input",9,10),s.Zb("change",(function(){s.rc(n);var e=s.pc(11);return t.onInput(e.value,t.step.wordToReplace)})),s.Pb(),s.Pb(),s.Pb(),s.Qb(12,"div",11),s.yc(13,q,2,0,"span",12),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()}2&e&&(s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(4),s.Ac(t.step.question),s.zb(1),s.ic("value",t.step.replacement)("ngStyle",s.lc(5,J,t.inputInvalid?"3px solid red":"")),s.zb(3),s.ic("ngIf",t.step.mandatory))},directives:[i.t,i.w],encapsulation:2}),Z),$=["input"];function ee(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",12),s.Qb(1,"span",13),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}function te(e,t){1&e&&(s.Qb(0,"span",14),s.zc(1," Obligatorio * "),s.Pb())}var ne,ie=function(e){return{borderBottom:e}},re=((ne=function(){function e(t,n){_classCallCheck(this,e),this.stepModelService=t,this.toastr=n,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onInputNumberChanged",value:function(e){var t=e.srcElement.value;isNaN(t)?(this.toastr.error("N\xfamero no v\xe1lido","Debe ser un n\xfamero",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}),this.input.nativeElement.style.borderBottom="3px solid red"):(this.input.nativeElement.style.borderBottom="",t.includes(",")&&(t=t.replace(",","")),t.includes(".")&&(t=t.replace(".","")),this.stepModelService.input(t,this.step.wordToReplace,!0,!0))}},{key:"showIndication",value:function(){this.emitIndication.emit()}}]),e}()).\u0275fac=function(e){return new(e||ne)(s.Lb(H),s.Lb(l.b))},ne.\u0275cmp=s.Fb({type:ne,selectors:[["app-i-number"]],viewQuery:function(e,t){var n;1&e&&s.Dc($,!0),2&e&&s.oc(n=s.ac())&&(t.input=n.first)},inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:13,vars:8,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__question"],["type","text",3,"value","placeholder","ngStyle","keyup","click"],["input",""],[1,"form-creator__fields-area__field__bottom"],["class","form-creator__fields-area__field__bottom__mandatory-label",4,"ngIf"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"],[1,"form-creator__fields-area__field__bottom__mandatory-label"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,ee,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"span",7),s.zc(8),s.Pb(),s.Qb(9,"input",8,9),s.Zb("keyup",(function(e){return t.onInputNumberChanged(e)}))("click",(function(e){return t.onInputNumberChanged(e)})),s.Pb(),s.Pb(),s.Qb(11,"div",10),s.yc(12,te,2,0,"span",11),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(3),s.Ac(t.step.question),s.zb(1),s.ic("value",t.step.replacement)("placeholder",t.step.placeholder?t.step.placeholder:"")("ngStyle",s.lc(6,ie,t.inputInvalid?"3px solid red":"")),s.zb(3),s.ic("ngIf",t.step.mandatory))},directives:[i.t,i.w],encapsulation:2}),ne);function oe(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",11),s.Qb(1,"span",12),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}function ae(e,t){if(1&e){var n=s.Rb();s.Qb(0,"p"),s.Qb(1,"label"),s.Qb(2,"input",13),s.Zb("change",(function(){s.rc(n);var e=t.$implicit,i=s.dc();return i.onInputSelected(e.radioId,i.step.wordToReplace)})),s.Pb(),s.Qb(3,"span"),s.zc(4),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=t.$implicit;s.zb(2),s.ic("checked",i.checked),s.zb(2),s.Ac(i.label)}}var se,ce=((se=function(){function e(t,n){_classCallCheck(this,e),this.stepModelService=t,this.documentCreatorService=n,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"showIndication",value:function(){this.emitIndication.emit()}},{key:"onInputSelected",value:function(e,t){this.stepModelService.onInputRadioBSelected(e,t)}}]),e}()).\u0275fac=function(e){return new(e||se)(s.Lb(H),s.Lb(z))},se.\u0275cmp=s.Fb({type:se,selectors:[["app-i-radio-b"]],inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:12,vars:3,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__question"],[1,"form-creator__fields-area__field__middle__radio-input--fill-form","radio"],[4,"ngFor","ngForOf"],[1,"form-creator__fields-area__field__bottom"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"],["name","group1","type","radio","value","Valor de la pregunta numero 1",1,"with-gap",3,"checked","change"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,oe,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"span",7),s.zc(8),s.Pb(),s.Qb(9,"div",8),s.yc(10,ae,5,2,"p",9),s.Pb(),s.Pb(),s.Mb(11,"div",10),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(3),s.Ac(t.step.question),s.zb(2),s.ic("ngForOf",t.step.radios))},directives:[i.t,i.s],encapsulation:2}),se);function le(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",11),s.Qb(1,"span",12),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}function de(e,t){if(1&e){var n=s.Rb();s.Qb(0,"p"),s.Qb(1,"label"),s.Qb(2,"input",13),s.Zb("change",(function(){s.rc(n);var e=t.$implicit,i=s.dc();return i.onRadioCchanged(e.radioId,i.step.wordToReplace)})),s.Pb(),s.Qb(3,"span"),s.zc(4),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=t.$implicit;s.zb(2),s.ic("checked",i.checked),s.zb(2),s.Ac(i.label)}}var ue,pe=((ue=function(){function e(t,n){_classCallCheck(this,e),this.stepModelService=t,this.documentCreatorService=n,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"showIndication",value:function(){this.emitIndication.emit()}},{key:"onRadioCchanged",value:function(e,t){this.stepModelService.refreshCache(),this.stepModelService.onInputRadioCSelected(e,t,!0,!0,!0)}}]),e}()).\u0275fac=function(e){return new(e||ue)(s.Lb(H),s.Lb(z))},ue.\u0275cmp=s.Fb({type:ue,selectors:[["app-i-radio-c"]],inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:12,vars:3,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__question"],[1,"form-creator__fields-area__field__middle__radio-input--fill-form","radio"],[4,"ngFor","ngForOf"],[1,"form-creator__fields-area__field__bottom"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"],["name","group1","type","radio","value","Valor de la pregunta numero 1",1,"with-gap",3,"checked","change"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,le,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"span",7),s.zc(8),s.Pb(),s.Qb(9,"div",8),s.yc(10,de,5,2,"p",9),s.Pb(),s.Pb(),s.Mb(11,"div",10),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(3),s.Ac(t.step.question),s.zb(2),s.ic("ngForOf",t.step.radios))},directives:[i.t,i.s],encapsulation:2}),ue);function _e(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",12),s.Qb(1,"span",13),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}var fe,he=((fe=function(){function e(t,n){_classCallCheck(this,e),this.stepModelService=t,this.documentCreatorService=n,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"showIndication",value:function(){this.emitIndication.emit()}},{key:"onInput",value:function(e,t){this.stepModelService.refreshCache(),this.stepModelService.buildForEach(e,t,!0,!0,!0)}}]),e}()).\u0275fac=function(e){return new(e||fe)(s.Lb(H),s.Lb(z))},fe.\u0275cmp=s.Fb({type:fe,selectors:[["app-i-for-each"]],inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:16,vars:6,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__question"],[1,"slider-range-container"],["type","range",1,"range-slider",3,"min","max","value","change"],["input",""],[1,"form-creator__fields-area__field__bottom"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"]],template:function(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,_e,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"span",7),s.zc(8),s.Pb(),s.Qb(9,"div",8),s.Qb(10,"input",9,10),s.Zb("change",(function(){s.rc(n);var e=s.pc(11);return t.onInput(e.value,t.step.wordToReplace)})),s.Pb(),s.Qb(12,"p"),s.Qb(13,"span"),s.zc(14),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Mb(15,"div",11),s.Pb(),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=s.pc(11);s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(3),s.Ac(t.step.question),s.zb(2),s.jc("min",t.step.min),s.jc("max",t.step.max),s.ic("value",t.step.value),s.zb(4),s.Ac(i.value)}},directives:[i.t],encapsulation:2}),fe);function me(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",12),s.Qb(1,"span",13),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}function Ee(e,t){if(1&e&&(s.Qb(0,"option",14),s.zc(1),s.Pb()),2&e){var n=t.$implicit;s.jc("value",n.radioId),s.ic("selected",n.checked),s.zb(1),s.Bc(" ",n.label," ")}}var be,ye=((be=function(){function e(t,n){_classCallCheck(this,e),this.stepModelService=t,this.documentCreatorService=n,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"onInputSelectChanged",value:function(e){"iRadioC"===this.step.type?this.stepModelService.onInputRadioCSelected(e.target.value,this.step.wordToReplace):"iRadioB"===this.step.type&&this.stepModelService.onInputRadioBSelected(e.target.value,this.step.wordToReplace)}},{key:"showIndication",value:function(){this.emitIndication.emit()}}]),e}()).\u0275fac=function(e){return new(e||be)(s.Lb(H),s.Lb(z))},be.\u0275cmp=s.Fb({type:be,selectors:[["app-i-select"]],inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:13,vars:3,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__question"],[1,"input-select"],[1,"browser-default",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],[1,"form-creator__fields-area__field__bottom"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"],[3,"value","selected"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,me,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"span",7),s.zc(8),s.Pb(),s.Qb(9,"div",8),s.Qb(10,"select",9),s.Zb("change",(function(e){return t.onInputSelectChanged(e)})),s.yc(11,Ee,2,3,"option",10),s.Pb(),s.Pb(),s.Pb(),s.Mb(12,"div",11),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(3),s.Ac(t.step.question),s.zb(3),s.ic("ngForOf",t.step.radios))},directives:[i.t,i.s,d.v,d.F],encapsulation:2}),be);function ge(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",12),s.Qb(1,"span",13),s.Zb("click",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb(),s.Pb()}}function ve(e,t){if(1&e){var n=s.Rb();s.Qb(0,"label"),s.Qb(1,"input",14,15),s.Zb("change",(function(){s.rc(n);var e=t.$implicit,i=s.pc(2),r=s.dc();return r.onInputCheckboxSelected(e.identifier,r.step.wordToReplace,i.checked)})),s.Pb(),s.Qb(3,"span"),s.zc(4),s.Pb(),s.Pb()}if(2&e){var i=t.$implicit;s.zb(1),s.ic("checked",i.checked),s.zb(3),s.Bc("",i.label,".")}}var Ae,Te=((Ae=function(){function e(t,n){_classCallCheck(this,e),this.stepModelService=t,this.documentCreatorService=n,this.emitIndication=new s.n}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"showIndication",value:function(){this.emitIndication.emit()}},{key:"onInputCheckboxSelected",value:function(e,t,n){this.stepModelService.onInputCheckboxSelected(e,t,n)}}]),e}()).\u0275fac=function(e){return new(e||Ae)(s.Lb(H),s.Lb(z))},Ae.\u0275cmp=s.Fb({type:Ae,selectors:[["app-i-checkbox"]],inputs:{step:"step",inputInvalid:"inputInvalid"},outputs:{emitIndication:"emitIndication"},decls:14,vars:3,consts:[[1,"form-creator__fields-area__middle__container","fade-in"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__field__field-area","form-creator__fields-area__field__field-area--input-text"],[1,"form-creator__fields-area__field__top","form-creator__fields-area__field__top--fill-form"],["class","indication",4,"ngIf"],[1,"form-creator__fields-area__field__middle"],[1,"form-creator__fields-area__field__middle__question"],[1,"form-creator__fields-area__field__middle__checkbox-input"],[4,"ngFor","ngForOf"],[1,"form-creator__fields-area__field__bottom"],[1,"form-creator__fields-area__field__bottom__mandatory-label"],[1,"indication"],[1,"icon","icon-info-circle-solid","trigger",3,"click"],["type","checkbox",1,"filled-in",3,"checked","change"],["input",""]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"div",4),s.yc(5,ge,2,0,"div",5),s.Pb(),s.Qb(6,"div",6),s.Qb(7,"span",7),s.zc(8),s.Pb(),s.Qb(9,"div",8),s.yc(10,ve,5,2,"label",9),s.Pb(),s.Pb(),s.Qb(11,"div",10),s.Qb(12,"span",11),s.zc(13," Obligatorio * "),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(5),s.ic("ngIf",t.step.indications&&t.step.indications.areIndications),s.zb(3),s.Ac(t.step.question),s.zb(2),s.ic("ngForOf",t.step.checkboxes))},directives:[i.t,i.s],encapsulation:2}),Ae),Ie=["modal"],Ne=["modalEnd"],Pe=["modalDownload"],Oe=["modalIndication"],Re=["input"],Se=["progressBar"];function Ce(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",43),s.Qb(1,"div",44),s.Qb(2,"span",45),s.Qb(3,"div",46),s.Mb(4,"img",47),s.Pb(),s.Qb(5,"span",48),s.zc(6,"Silvia Camejo Alarc\xf3n"),s.Pb(),s.Pb(),s.Qb(7,"span",49),s.Qb(8,"span"),s.zc(9,"Actualizado:"),s.Pb(),s.zc(10),s.Pb(),s.Pb(),s.Qb(11,"div",50),s.Qb(12,"div",51),s.Qb(13,"span",52),s.Zb("click",(function(){s.rc(n);var e=s.dc(),t=s.pc(27);return e.toogleModal(t)})),s.Pb(),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=s.dc();s.zb(10),s.Bc(" ",i.form.updated," ")}}function we(e,t){if(1&e&&(s.Qb(0,"div",53),s.Qb(1,"div",54),s.Qb(2,"span",null,55),s.zc(4),s.Pb(),s.Pb(),s.Pb()),2&e){var n=s.dc();s.zb(2),s.xc("width",n.progresBarPercentage),s.zb(2),s.Ac(n.progresBarPercentage)}}function De(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",56),s.Qb(1,"div",57),s.Qb(2,"h3",58),s.zc(3),s.Pb(),s.Qb(4,"span",59),s.zc(5),s.Pb(),s.Qb(6,"button",60),s.Zb("click",(function(){s.rc(n);var e=s.dc(),t=s.pc(27);return e.toogleModal(t)})),s.zc(7," Rellenar formulario "),s.Pb(),s.Pb(),s.Pb()}if(2&e){var i=s.dc();s.zb(3),s.Bc(" ",i.steps[i.currentStep].title," "),s.zb(2),s.Bc(" ",i.steps[i.currentStep].description," ")}}function Le(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-text",61),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])("inputInvalid",i.inputInvalid)}}function ke(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-date",61),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])("inputInvalid",i.inputInvalid)}}function Me(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-number",61),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])("inputInvalid",i.inputInvalid)}}function Ue(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-for-each",62),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])}}function Fe(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-radio-b",62),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])}}function xe(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-radio-c",62),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])}}function ze(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-select",62),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])}}function He(e,t){if(1&e){var n=s.Rb();s.Qb(0,"app-i-checkbox",62),s.Zb("emitIndication",(function(){return s.rc(n),s.dc().showIndication()})),s.Pb()}if(2&e){var i=s.dc();s.ic("step",i.steps[i.currentStep])}}function Ve(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",56),s.Qb(1,"div",63),s.Qb(2,"div",64),s.Qb(3,"div",65),s.Qb(4,"div",66),s.Mb(5,"span",67),s.Qb(6,"h1"),s.zc(7,"Finalizado"),s.Pb(),s.Qb(8,"button",68),s.Zb("click",(function(){return s.rc(n),s.dc().toogleCheckout()})),s.zc(9,"Descargar"),s.Pb(),s.Qb(10,"div",69),s.Mb(11,"span",70),s.Mb(12,"span",71),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()}}function Qe(e,t){1&e&&(s.Qb(0,"div",72),s.Qb(1,"div",73),s.Mb(2,"span",74),s.Qb(3,"span",75),s.zc(4,"1."),s.Pb(),s.Qb(5,"span",76),s.zc(6,"Elige un documento"),s.Pb(),s.Pb(),s.Qb(7,"div",73),s.Mb(8,"span",77),s.Qb(9,"span",75),s.zc(10,"2."),s.Pb(),s.Qb(11,"span",76),s.zc(12,"Rellena el formulario"),s.Pb(),s.Pb(),s.Qb(13,"div",73),s.Mb(14,"span",78),s.Qb(15,"span",75),s.zc(16,"3."),s.Pb(),s.Qb(17,"span",76),s.zc(18,"Gu\xe1rdalo e impr\xedmelo"),s.Pb(),s.Pb(),s.Pb())}function Be(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",81),s.Zb("click",(function(){return s.rc(n),s.dc(2).moveStep("next")})),s.Qb(1,"span",83),s.zc(2,"Siguiente"),s.Pb(),s.Mb(3,"span",86),s.Pb()}}function Ye(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",79),s.Qb(1,"div",80),s.Qb(2,"div",81),s.Zb("click",(function(){return s.rc(n),s.dc().moveStep("previous")})),s.Mb(3,"span",82),s.Qb(4,"span",83),s.zc(5,"Anterior"),s.Pb(),s.Pb(),s.Qb(6,"div",84),s.Zb("click",(function(){return s.rc(n),s.dc().previewDocumentButton(!0)})),s.zc(7," Preview "),s.Qb(8,"span"),s.zc(9,"\u2b07"),s.Pb(),s.Pb(),s.yc(10,Be,4,0,"div",85),s.Pb(),s.Pb()}if(2&e){var i=s.dc();s.zb(10),s.ic("ngIf","end"!==(null==i.steps[i.currentStep]?null:i.steps[i.currentStep].type))}}var Ke,We=((Ke=function(){function e(t,n,i,r,o,s,c,l){_classCallCheck(this,e),this.stepModelService=t,this.commonsService=n,this.sharedService=i,this.documentCreatorService=r,this.formsService=o,this.toastr=s,this.checkoutService=c,this.route=l,this.form=new a.h,this.currentStep=0,this.progresBarPercentage="0%",this.steps=[],this.formAlreadyPaid=!1,this.indications={areIndications:!0,indicationsType:"outsideText",value:""},this.inputInvalid=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.commonsService.isBrowser()&&(this.commonsService.toggleSpinner(),this.route.params.subscribe((function(t){e.route.queryParams.subscribe((function(n){n.transactionId?(e.formAlreadyPaid=!0,e.formsService.getPaidCertifiedForm(n.transactionId).subscribe((function(n){if(n.certifiedForm){var i=n.certifiedForm;e.form.fields=JSON.parse(i.fields),e.steps=e.form.fields,e.form.title=i.title,e.form.uri=i.uri,e.form.id=t.id,e.form.amount=i.amount,e.form.topLabelTitle=i.topLabelTitle,e.form.information=i.information,e.form.updated=i.updated,e.setInitiaState()}else n.transactionNotFound?e.commonsService.toastMessage("error","Transaction Id does not exist","Transaction id not found"):n.formExpired&&e.commonsService.toastMessage("error","The period of 30 days to change the document has expired","Transaction expired")}))):window.sessionStorage&&window.sessionStorage[t.id]?(e.form=JSON.parse(window.sessionStorage[t.id]),e.steps=e.form.fields,e.formAlreadyPaid=e.form.alreadyPaid,e.setInitiaState()):e.formsService.getCertifiedForm(t.id).subscribe((function(n){e.steps=n.steps,e.form.fields=e.steps,e.form.title=n.title,e.form.uri=n.uri,e.form.id=t.id,e.form.amount=n.amount,e.form.image=n.image,e.form.topLabelTitle=n.topLabelTitle,e.form.information=n.information,e.form.updated=n.updated,e.setInitiaState()}))}))})))}},{key:"ngAfterViewInit",value:function(){this.commonsService.resizeEditor(!1)}},{key:"ngOnDestroy",value:function(){this.documentCreatorService.destroy(),window.removeEventListener("resize",this.commonsService.resizeEditor.bind(this)),this.commonsService.setFormCreatorPlayground(!0)}},{key:"setInitiaState",value:function(){var e=this;this.stepModelService.init(this.form.fields),this.sharedService.setForm(this.form),this.form.fields.forEach((function(t,n){t.isCurrentStep&&(e.currentStep=n,e.updateProgressBarPercentage(),"end"===e.steps[e.currentStep].type&&e.steps[e.currentStep].checkoutProcess.isInited&&!e.formAlreadyPaid&&e.toogleModal(e.modalEnd.nativeElement))})),this.documentCreatorService.init(this.form.uri).then((function(t){e.commonsService.setFormCreatorPlayground(!1),e.commonsService.resizeEditor(!0),window.addEventListener("resize",e.commonsService.resizeEditor.bind(e)),e.documentCreatorService.resizeDocumentContainer(),e.stepModelService.buildDocument(!1),e.stepModelService.setInitialState(),e.documentCreatorService.resizeEvent(),e.commonsService.toggleSpinner()}))}},{key:"toogleModal",value:function(e){this.commonsService.toggleModal(e,!0)}},{key:"moveStep",value:function(e){"next"===e?this.validateBeforeNextStep(this.steps[this.currentStep])&&(this.steps[this.currentStep].isCurrentStep=!1,this.steps[this.currentStep+1].isCurrentStep=!0,this.currentStep+=1):"previous"===e&&(this.steps[this.currentStep].isCurrentStep=!1,this.steps[this.currentStep-1].isCurrentStep=!0,this.currentStep-=1),this.updateProgressBarPercentage(),"end"===this.steps[this.currentStep].type&&this.prepareForCheckout()}},{key:"validateBeforeNextStep",value:function(e){if(e.mandatory){if(""===e.replacement)return this.toastr.error("Form cannot be empty","Empty field",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}),this.inputInvalid=!0,!1;this.inputInvalid=!1}return!0}},{key:"updateProgressBarPercentage",value:function(){var e=this;this.progressBar&&this.currentStep?function(){for(var t=Math.round(e.currentStep/(e.steps.length-1)*100),n=parseInt(e.progresBarPercentage,10),i=t>n?t-n:n-t,r=function(i){setTimeout((function(){var r=t>n?n+i:n-i;e.progressBar.nativeElement.style.width=r+"%",e.progresBarPercentage=r+"%"}),10*i)},o=0;o<i+1;o++)r(o)}():this.progresBarPercentage=Math.round(this.currentStep/(this.steps.length-1)*100)+"%"}},{key:"showIndication",value:function(){var e=this.steps[this.currentStep];e.indications.areIndications&&("outsideText"===e.indications.indicationsType||window.innerWidth<885?(this.indications=e.indications,this.toogleModal(this.modalIndication.nativeElement)):this.documentCreatorService.showIndicationInsideText(e.wordToReplace,e.indications.value))}},{key:"prepareForCheckout",value:function(){this.form.fields=this.steps,this.sharedService.setForm(this.form)}},{key:"startCheckout",value:function(){this.steps[this.currentStep].checkoutProcess.isInited=!0}},{key:"onFormPaid",value:function(e){this.documentCreatorService.destroy(),window.removeEventListener("resize",this.commonsService.resizeEditor.bind(this)),this.formAlreadyPaid=!0,this.form.alreadyPaid=!0,this.form.uri=e.uri,this.form.fields=JSON.parse(e.fields),this.setInitiaState(),this.commonsService.toggleSpinner(),this.sendEmail(e.transactionId)}},{key:"previewDocumentButton",value:function(e){this.commonsService.previewDocumentButton(e),this.documentCreatorService.resizeEvent()}},{key:"onExitPayment",value:function(){this.toogleModal(this.modalEnd.nativeElement)}},{key:"toogleCheckout",value:function(){this.formAlreadyPaid?this.toogleModal(this.modalDownload.nativeElement):(this.toogleModal(this.modalEnd.nativeElement),this.startCheckout())}},{key:"downloadWord",value:function(){this.documentCreatorService.downloadWord(this.form.id,this.form.uri)}},{key:"downloadPdf",value:function(){this.documentCreatorService.downloadPdf(this.form.id,this.form.uri)}},{key:"sendEmail",value:function(e){var t=this;setTimeout((function(){t.documentCreatorService.saveUri().then((function(n){t.checkoutService.sendMail(e,n).subscribe((function(e){console.log(e)}))}))}),1e3)}}]),e}()).\u0275fac=function(e){return new(e||Ke)(s.Lb(H),s.Lb(a.d),s.Lb(F),s.Lb(z),s.Lb(a.j),s.Lb(l.b),s.Lb(a.b),s.Lb(o.a))},Ke.\u0275cmp=s.Fb({type:Ke,selectors:[["app-form"]],viewQuery:function(e,t){var n;1&e&&(s.Dc(Ie,!0),s.Dc(Ne,!0),s.Dc(Pe,!0),s.Dc(Oe,!0),s.Dc(Re,!0),s.Dc(Se,!0)),2&e&&(s.oc(n=s.ac())&&(t.modal=n.first),s.oc(n=s.ac())&&(t.modalEnd=n.first),s.oc(n=s.ac())&&(t.modalDownload=n.first),s.oc(n=s.ac())&&(t.modalIndication=n.first),s.oc(n=s.ac())&&(t.input=n.first),s.oc(n=s.ac())&&(t.progressBar=n.first))},decls:63,vars:17,consts:[[1,"form-creator__container"],["id","fields-area",1,"form-creator__fields-area"],[1,"form-creator__fields-area__container"],[1,"form-creator__fields-area__top"],["class","form-creator__fields-area__top__container",4,"ngIf"],["class","progress-container",4,"ngIf"],[1,"form-creator__fields-area__middle"],["class","form-creator__fields-area__middle__container",4,"ngIf"],[3,"step","inputInvalid","emitIndication",4,"ngIf"],[3,"step","emitIndication",4,"ngIf"],["class","form-creator__fields-area__bottom form-creator__fields-area__bottom--initial-screen",4,"ngIf"],["class","form-creator__fields-area__bottom",4,"ngIf"],["id","text-area",1,"form-creator__text-area"],["id","wodoautomatikdocs",2,"width","100%","height","100%","margin","0px","padding","0px"],["id","editorContainer",2,"width","100%","height","100%","margin","0px","padding","0px"],["id","scrollToTop",1,"button-filled","button-filled--preview-document",2,"display","none",3,"click"],[2,"font-size","20px"],[1,"modal"],["modal",""],[1,"modal__content","modal__content--privacy"],[1,"modal__content__top","modal__content__top--privacy"],[1,"text-center"],["id","modal-middle-privacy",1,"modal__content__modal-middle","modal__content__modal-middle--privacy"],[1,"modal__content__modal-middle__container"],[3,"innerHTML"],[1,"modal__content__modal-bottom","modal__content__modal-bottom--privacy"],["id","modal-button",1,"button-filled",3,"click"],["modalEnd",""],[1,"modal__content","modal__content--privacy",3,"form","formPaid","exitModal","downloadWordOutput","downloadPdfOutput"],["modalDownload",""],[1,"modal__content",2,"padding","2rem"],[1,"modal__content__modal-middle","modal__content__modal-middle--change-password"],[1,"download-documents-modal"],[1,"icon","icon-file-word-solid","trigger",3,"click"],[1,"icon","icon-file-pdf-solid",3,"click"],[1,"modal__content__modal-bottom"],["modalIndication",""],[1,"modal__content","modal__content--question-indication"],[1,"modal__content__top","modal__content__top--indication"],[1,"modal__content__modal-middle","modal__content__modal-middle--question-indication"],[1,"modal__content__modal-middle__container",3,"innerHTML"],[1,"new-modal-content__footer","new-modal-content__footer--indicactions"],[1,"btn","next-btn",3,"click"],[1,"form-creator__fields-area__top__container"],[1,"form-creator__fields-area__top__author-date"],[1,"form-creator__fields-area__top__author-date__author"],[1,"form-creator__fields-area__top__author-date__author__image-container"],["src","/assets/images/silvia-avatar.jpeg","alt","avatar"],["routerLink","/static-pages/silvia-profile"],[1,"form-creator__fields-area__top__author-date__date"],[1,"form-creator__fields-area__top__before-start-button"],[1,"form-creator__fields-area__top__before-start-button__information-modal-icon","trigger"],[1,"icon","icon-info-solid",3,"click"],[1,"progress-container"],[1,"progress","progress-large"],["progressBar",""],[1,"form-creator__fields-area__middle__container"],[1,"form-creator__fields-area__middle__initial-screen"],[1,"form-creator__fields-area__middle__initial-screen__form-title"],[1,"form-creator__fields-area__middle__initial-screen__description"],[1,"button-filled","button-filled--start-form",3,"click"],[3,"step","inputInvalid","emitIndication"],[3,"step","emitIndication"],[1,"form-creator__fields-area__field"],[1,"form-creator__fields-area__field__container"],[1,"form-creator__fields-area__end-step"],[1,"form-creator__fields-area__end-step__container"],[1,"form-creator__fields-area__end-step__check","icon","icon-check-circle-solid"],[1,"button-filled","button-filled--start-form","trigger",3,"click"],[1,"form-creator__fields-area__end-step__icons"],[1,"icon","icon-file-word-solid","trigger"],[1,"icon","icon-file-pdf-solid"],[1,"form-creator__fields-area__bottom","form-creator__fields-area__bottom--initial-screen"],[1,"form-creator__fields-area__bottom__step"],[1,"icon","icon-file-regular"],[1,"form-creator__fields-area__bottom__step__number"],[1,"form-creator__fields-area__bottom__step__description"],[1,"icon","icon-list-alt-regular"],[1,"icon","icon-print-solid"],[1,"form-creator__fields-area__bottom"],[1,"form-creator__fields-area__bottom__container"],[1,"form-creator__fields-area__bottom__arrow-button",3,"click"],[1,"icon","icon-chevron-left-solid"],[1,"form-creator__fields-area__bottom__arrow-button__label"],[1,"form-creator__fields-area__bottom__preview-button",3,"click"],["class","form-creator__fields-area__bottom__arrow-button",3,"click",4,"ngIf"],[1,"icon","icon-chevron-right-solid"]],template:function(e,t){if(1&e){var n=s.Rb();s.Qb(0,"div",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.yc(4,Ce,14,1,"div",4),s.yc(5,we,5,3,"div",5),s.Pb(),s.Qb(6,"div",6),s.yc(7,De,8,2,"div",7),s.yc(8,Le,1,2,"app-i-text",8),s.yc(9,ke,1,2,"app-i-date",8),s.yc(10,Me,1,2,"app-i-number",8),s.yc(11,Ue,1,1,"app-i-for-each",9),s.yc(12,Fe,1,1,"app-i-radio-b",9),s.yc(13,xe,1,1,"app-i-radio-c",9),s.yc(14,ze,1,1,"app-i-select",9),s.yc(15,He,1,1,"app-i-checkbox",9),s.yc(16,Ve,13,0,"div",7),s.Pb(),s.yc(17,Qe,19,0,"div",10),s.yc(18,Ye,11,1,"div",11),s.Pb(),s.Pb(),s.Qb(19,"div",12),s.Qb(20,"div",13),s.Mb(21,"div",14),s.Pb(),s.Qb(22,"button",15),s.Zb("click",(function(){return t.previewDocumentButton(!1)})),s.zc(23,"Form "),s.Qb(24,"span",16),s.zc(25,"\u2191"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(26,"div",17,18),s.Qb(28,"div",19),s.Qb(29,"div",20),s.Qb(30,"h2",21),s.zc(31,"Indicaciones antes de comenzar el formulario"),s.Pb(),s.Pb(),s.Qb(32,"div",22),s.Qb(33,"div",23),s.Mb(34,"div",24),s.Pb(),s.Pb(),s.Qb(35,"div",25),s.Qb(36,"button",26),s.Zb("click",(function(){s.rc(n);var e=s.pc(27);return t.toogleModal(e),t.moveStep("next")})),s.zc(37,"Rellenar"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(38,"div",17,27),s.Qb(40,"app-checkout",28),s.Zb("formPaid",(function(e){return t.onFormPaid(e)}))("exitModal",(function(){return t.onExitPayment()}))("downloadWordOutput",(function(){return t.downloadWord()}))("downloadPdfOutput",(function(){return t.downloadPdf()})),s.Pb(),s.Pb(),s.Qb(41,"div",17,29),s.Qb(43,"div",30),s.Qb(44,"div",31),s.Qb(45,"div",23),s.Qb(46,"div",32),s.Qb(47,"span",33),s.Zb("click",(function(){return t.downloadWord()})),s.Pb(),s.Qb(48,"span",34),s.Zb("click",(function(){return t.downloadPdf()})),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(49,"div",35),s.Qb(50,"button",26),s.Zb("click",(function(){s.rc(n);var e=s.pc(42);return t.toogleModal(e)})),s.zc(51,"Cancelar"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(52,"div",17,36),s.Qb(54,"div",37),s.Qb(55,"div",38),s.Qb(56,"h2"),s.zc(57,"Indicaciones"),s.Pb(),s.Pb(),s.Qb(58,"div",39),s.Mb(59,"div",40),s.Pb(),s.Qb(60,"div",41),s.Qb(61,"button",42),s.Zb("click",(function(){s.rc(n);var e=s.pc(53);return t.toogleModal(e)})),s.zc(62,"Entendido"),s.Pb(),s.Pb(),s.Pb(),s.Pb()}2&e&&(s.zb(4),s.ic("ngIf","start"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","start"!==(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(2),s.ic("ngIf","start"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","iText"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","iDate"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","iNumber"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","iForEach"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","iRadioB"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)&&"select"!==(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].subType)),s.zb(1),s.ic("ngIf","iRadioC"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)&&"select"!==(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].subType)),s.zb(1),s.ic("ngIf","iRadioC"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)&&"select"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].subType)||"iRadioB"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)&&"select"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].subType)),s.zb(1),s.ic("ngIf","iCheckbox"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","end"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","start"===(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(1),s.ic("ngIf","start"!==(null==t.steps[t.currentStep]?null:t.steps[t.currentStep].type)),s.zb(16),s.ic("innerHTML",t.form.information,s.sc),s.zb(6),s.ic("form",t.form),s.zb(19),s.ic("innerHTML",t.indications.value,s.sc))},directives:[i.t,k,o.e,j,X,re,he,ce,pe,ye,Te],encapsulation:2}),Ke),je=["subMenu"],Ge=["loginModal"];function qe(e,t){if(1&e&&(s.Qb(0,"li",8),s.zc(1),s.Pb()),2&e){var n=s.dc();s.zb(1),s.Bc(" ",n.form.topLabelTitle," ")}}var Ze,Je,Xe,$e=[{path:":id",component:(Ze=function(){function e(t,n,i,r,o,s,c){_classCallCheck(this,e),this.commonsService=t,this.formsService=n,this.userService=i,this.sharedService=r,this.router=o,this.route=s,this.toastr=c,this.form=new a.h,this.originalForm=new a.h,this.currentStep=0,this.updatingForm=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.commonsService.addTags(""),this.sharedService.currentForm.subscribe((function(t){e.commonsService.isObjectEmpty(t)||(e.form=t,e.currentStep=t.currentStep)})),this.userService.isAuthenticated.subscribe((function(t){e.isAuth=!!t})),this.commonsService.isBrowser()&&window.addEventListener("unload",this.saveInSessionStorage.bind(this))}},{key:"ngOnDestroy",value:function(){this.saveInSessionStorage(),window.removeEventListener("unload",this.saveInSessionStorage),document.title="Automatik Docs"}},{key:"topMenuNav",value:function(e){this.commonsService.subMenuNav(e,this.subMenu.nativeElement)}},{key:"saveForm",value:function(){var e=this;this.isAuth?(this.form.type="Certified",this.validateForm(),this.formsService.save(this.form).subscribe((function(t){e.toastr.success("Has been saved",t.title,{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"})}),(function(t){console.log(t),e.toastr.error("Un error ha ocurrido. Int\xe9ntalo de nuevo","Error",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"})}))):(window.sessionStorage&&(window.sessionStorage[this.form.id]=JSON.stringify(this.form)),this.router.navigate(["/auth/login"],{queryParams:{formPath:this.router.url.substring(this.router.url.lastIndexOf("/")+1)}}))}},{key:"saveInSessionStorage",value:function(){window.sessionStorage&&(window.sessionStorage[this.form.id]=JSON.stringify(this.form))}},{key:"toogleModal",value:function(e){this.commonsService.toggleModal(e,!0)}},{key:"validateForm",value:function(){this.form.description="blabla",this.form.text="blaw"}}]),e}(),Ze.\u0275fac=function(e){return new(e||Ze)(s.Lb(a.d),s.Lb(a.j),s.Lb(a.r),s.Lb(F),s.Lb(o.d),s.Lb(o.a),s.Lb(l.b))},Ze.\u0275cmp=s.Fb({type:Ze,selectors:[["app-certified-forms"]],viewQuery:function(e,t){var n;1&e&&(s.Dc(je,!0),s.Dc(Ge,!0)),2&e&&(s.oc(n=s.ac())&&(t.subMenu=n.first),s.oc(n=s.ac())&&(t.loginModal=n.first))},decls:9,vars:2,consts:[[1,"sub-menu"],["subMenu",""],[1,"sub-menu__container","sub-menu__container--fill-form"],[1,"sub-menu__left-button","sub-menu__left-button--fill-form"],[1,"button-filled","button-filled--sub-menu-fill-form","icon","icon-save-solid",3,"hidden","click"],[1,"sub-menu__nav","sub-menu__nav--fill-form",2,"justify-content","center"],["class","sub-menu__nav__button sub-menu__nav__button--without-hover",4,"ngIf"],["id","form-creator",1,"form-creator"],[1,"sub-menu__nav__button","sub-menu__nav__button--without-hover"]],template:function(e,t){1&e&&(s.Qb(0,"div",0,1),s.Qb(2,"div",2),s.Qb(3,"div",3),s.Qb(4,"button",4),s.Zb("click",(function(){return t.saveForm()})),s.Pb(),s.Pb(),s.Qb(5,"ul",5),s.yc(6,qe,2,1,"li",6),s.Pb(),s.Pb(),s.Pb(),s.Qb(7,"div",7),s.Mb(8,"app-form"),s.Pb()),2&e&&(s.zb(4),s.ic("hidden",!t.currentStep),s.zb(2),s.ic("ngIf",t.form))},directives:[i.t,We],encapsulation:2}),Ze),children:[]}],et=((Xe=function e(){_classCallCheck(this,e)}).\u0275mod=s.Jb({type:Xe}),Xe.\u0275inj=s.Ib({factory:function(e){return new(e||Xe)},imports:[[o.h.forChild($e)],o.h]}),Xe),tt=((Je=function e(){_classCallCheck(this,e)}).\u0275mod=s.Jb({type:Je}),Je.\u0275inj=s.Ib({factory:function(e){return new(e||Je)},providers:[F,z,H],imports:[[i.c,r.a,et]]}),Je)},gusg:function(e,t,n){e.exports=function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,(function(e){return r(t[a][1][e]||e)}),l,l.exports,e,t,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){(function(n){"use strict";var i=e("promise-polyfill");t.exports=n.Promise||i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"promise-polyfill":39}],2:[function(e,t,n){"use strict";var i=e("./lib/promise"),r={};function o(e){var t,n,o,a,s=JSON.stringify(e);return!e.forceScriptReload&&(a=r[s])||(o=document.createElement("script"),t=e.dataAttributes||{},n=e.container||document.head,o.src=e.src,o.id=e.id,o.async=!0,e.crossorigin&&o.setAttribute("crossorigin",e.crossorigin),Object.keys(t).forEach((function(e){o.setAttribute("data-"+e,t[e])})),a=new i((function(t,i){o.addEventListener("load",(function(){t(o)})),o.addEventListener("error",(function(){i(new Error(e.src+" failed to load."))})),o.addEventListener("abort",(function(){i(new Error(e.src+" has aborted."))})),n.appendChild(o)})),r[s]=a),a}o.clearCache=function(){r={}},t.exports=o},{"./lib/promise":1}],3:[function(e,t,n){(function(e){"use strict";t.exports=function(t){return/Android/.test(t=t||e.navigator.userAgent)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){(function(e){"use strict";t.exports=function(t){return/CrOS/i.test(t=t||e.navigator.userAgent)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){"use strict";var i=e("./is-edge"),r=e("./is-samsung");t.exports=function(e){return!(-1===(e=e||navigator.userAgent).indexOf("Chrome")&&-1===e.indexOf("CriOS")||i(e)||r(e))}},{"./is-edge":6,"./is-samsung":18}],6:[function(e,t,n){"use strict";t.exports=function(e){return-1!==(e=e||navigator.userAgent).indexOf("Edge/")}},{}],7:[function(e,t,n){(function(e){"use strict";t.exports=function(t){return/Firefox/i.test(t=t||e.navigator.userAgent)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t,n){(function(n){"use strict";var i=e("./is-ie11");t.exports=function(e){return-1!==(e=e||n.navigator.userAgent).indexOf("MSIE")||i(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-ie11":10}],9:[function(e,t,n){"use strict";t.exports=function(e){return-1!==(e=e||navigator.userAgent).indexOf("MSIE 10")}},{}],10:[function(e,t,n){"use strict";t.exports=function(e){return-1!==(e=e||navigator.userAgent).indexOf("Trident/7")}},{}],11:[function(e,t,n){"use strict";t.exports=function(e){return-1!==(e=e||navigator.userAgent).indexOf("MSIE 9")}},{}],12:[function(e,t,n){(function(e){"use strict";t.exports=function(t){return/FxiOS/i.test(t=t||e.navigator.userAgent)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e,t,n){"use strict";var i=e("./is-ios"),r=/webkit/i;t.exports=function(e){return e=e||navigator.userAgent,i(e)&&function(e){return e.match(r)}(e)&&-1===e.indexOf("CriOS")}},{"./is-ios":16}],14:[function(e,t,n){(function(n){"use strict";var i=e("./is-ios");t.exports=function(e){return!!i(e=e||n.navigator.userAgent)&&(!!function(e){return/\bGSA\b/.test(e)}(e)||/.+AppleWebKit(?!.*Safari)/.test(e))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-ios":16}],15:[function(e,t,n){(function(n){"use strict";var i=e("./is-ios-webview");t.exports=function(e,t){return t=void 0!==t?t:n.statusbar.visible,i(e)&&t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-ios-webview":14}],16:[function(e,t,n){(function(e){"use strict";t.exports=function(t){return/iPhone|iPod|iPad/i.test(t=t||e.navigator.userAgent)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(e,t,n){(function(n){"use strict";var i=e("./is-ios-firefox"),r=e("./is-firefox");t.exports=function(e){return i(e=e||n.navigator.userAgent)||/iPhone|iPod|iPad|Mobile|Tablet/i.test(e)&&r(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-firefox":7,"./is-ios-firefox":12}],18:[function(e,t,n){(function(e){"use strict";t.exports=function(t){return/SamsungBrowser/i.test(t=t||e.navigator.userAgent)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(e,t,n){(function(n){"use strict";var i=e("./is-android"),r=e("./is-ios-firefox"),o=e("./is-ios-webview"),a=e("./is-chrome"),s=e("./is-samsung");function c(e){return(e=e||n.navigator.userAgent).indexOf("Opera Mini")>-1}t.exports=function(e){return!(o(e=e||n.navigator.userAgent)||r(e)||function(e){return!!i(e=e||n.navigator.userAgent)&&/Version\/[\d\.]+/.test(e)&&!c(e)}(e)||c(e)||function(e){var t;return!!(t=(e=e||n.navigator.userAgent).match(/CriOS\/(\d+)\./))&&parseInt(t[1],10)<48}(e)||function(e){return!a(e)&&!s(e)&&/samsung/i.test(e)}(e))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-android":3,"./is-chrome":5,"./is-ios-firefox":12,"./is-ios-webview":14,"./is-samsung":18}],20:[function(e,t,n){"use strict";function i(e){return e.className.trim().split(/\s+/)}function r(e){var t=Array.prototype.slice.call(arguments,1),n=i(e).filter((function(e){return-1===t.indexOf(e)})).concat(t).join(" ");e.className=n}function o(e){var t=Array.prototype.slice.call(arguments,1),n=i(e).filter((function(e){return-1===t.indexOf(e)})).join(" ");e.className=n}t.exports={add:r,remove:o,toggle:function(e,t,n){n?r(e,t):o(e,t)}}},{}],21:[function(e,t,n){"use strict";function i(){this._events={}}i.prototype.on=function(e,t){this._events[e]?this._events[e].push(t):this._events[e]=[t]},i.prototype.off=function(e,t){var n,i=this._events[e];i&&(n=i.indexOf(t),i.splice(n,1))},i.prototype._emit=function(e){var t,n=this._events[e];n&&(t=Array.prototype.slice.call(arguments,1),n.forEach((function(e){e.apply(null,t)})))},i.prototype.hasListener=function(e){var t=this._events[e];return!!t&&t.length>0},i.createChild=function(e){e.prototype=Object.create(i.prototype,{constructor:e})},t.exports=i},{}],22:[function(e,t,n){(function(e){"use strict";function n(e){var t=this;return"function"==typeof e?new n.Promise(e):(this._promise=new n.Promise((function(e,n){t._resolveFunction=e,t._rejectFunction=n})),this._onResolve=(e=e||{}).onResolve||n.defaultOnResolve,this._onReject=e.onReject||n.defaultOnReject,function(e){return e.hasOwnProperty("suppressUnhandledPromiseMessage")?Boolean(e.suppressUnhandledPromiseMessage):Boolean(n.suppressUnhandledPromiseMessage)}(e)&&this._promise.catch((function(){})),this._resetState(),this._promise.resolve=this.resolve.bind(this),this._promise.reject=this.reject.bind(this),this._promise)}["all","allSettled","race","reject","resolve"].forEach((function(e){n[e]=function(){var t=Array.prototype.slice.call(arguments);return n.Promise[e].apply(n.Promise,t)}})),n.setPromise=function(e){n.Promise=e},n.setPromise(e.Promise),n.defaultOnResolve=function(e){return n.Promise.resolve(e)},n.defaultOnReject=function(e){return n.Promise.reject(e)},n.prototype.resolve=function(e){var t=this;return this._promise.isFulfilled||(this._setResolved(),n.Promise.resolve().then((function(){return t._onResolve(e)})).then(this._resolveFunction).catch((function(e){t._resetState(),t._promise.reject(e)}))),this._promise},n.prototype.reject=function(e){var t=this;return this._promise.isFulfilled||(this._setRejected(),n.Promise.resolve().then((function(){return t._onReject(e)})).then((function(e){t._setResolved(),t._resolveFunction(e)})).catch(this._rejectFunction)),this._promise},n.prototype._resetState=function(){this._promise.isFulfilled=!1,this._promise.isResolved=!1,this._promise.isRejected=!1},n.prototype._setResolved=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!0,this._promise.isRejected=!1},n.prototype._setRejected=function(){this._promise.isFulfilled=!0,this._promise.isResolved=!1,this._promise.isRejected=!0},t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],23:[function(e,t,n){"use strict";var i=e("./lib/set-attributes"),r=e("./lib/default-attributes"),o=e("./lib/assign");t.exports=function(e){var t=document.createElement("iframe"),n=o({},r,e);return n.style&&"string"!=typeof n.style&&(o(t.style,n.style),delete n.style),i(t,n),t.getAttribute("id")||(t.id=t.name),t}},{"./lib/assign":24,"./lib/default-attributes":25,"./lib/set-attributes":26}],24:[function(e,t,n){"use strict";t.exports=function(e){var t=Array.prototype.slice.call(arguments,1);return t.forEach((function(t){"object"==typeof t&&Object.keys(t).forEach((function(n){e[n]=t[n]}))})),e}},{}],25:[function(e,t,n){"use strict";t.exports={src:"about:blank",frameBorder:0,allowtransparency:!0,scrolling:"no"}},{}],26:[function(e,t,n){"use strict";t.exports=function(e,t){var n;for(var i in t)t.hasOwnProperty(i)&&(null==(n=t[i])?e.removeAttribute(i):e.setAttribute(i,n))}},{}],27:[function(e,t,n){"use strict";t.exports=function(e){return function(){var t=arguments;setTimeout((function(){try{e.apply(null,t)}catch(n){console.log("Error in callback function"),console.log(n)}}),1)}}},{}],28:[function(e,t,n){"use strict";t.exports=function(e){var t=!1;return function(){t||(t=!0,e.apply(null,arguments))}}},{}],29:[function(e,t,n){"use strict";t.exports=function(e,t){if(!t)return e;e.then((function(e){t(null,e)})).catch((function(e){t(e)}))}},{}],30:[function(e,t,n){"use strict";var i=e("./lib/deferred"),r=e("./lib/once"),o=e("./lib/promise-or-callback");function a(e){return function(){var t,n=Array.prototype.slice.call(arguments),a=n[n.length-1];return"function"==typeof a&&(t=n.pop(),t=r(i(t))),o(e.apply(this,n),t)}}a.wrapPrototype=function(e,t){var n,i;return n=(t=t||{}).ignoreMethods||[],i=!0===t.transformPrivateMethods,Object.getOwnPropertyNames(e.prototype).filter((function(t){var r,o="constructor"!==t&&"function"==typeof e.prototype[t],a=-1===n.indexOf(t);return r=!!i||"_"!==t.charAt(0),o&&r&&a})).forEach((function(t){e.prototype[t]=a(e.prototype[t])})),e},t.exports=a},{"./lib/deferred":27,"./lib/once":28,"./lib/promise-or-callback":29}],31:[function(e,t,n){"use strict";var i,r=e("./lib/card-types"),o=e("./lib/clone"),a=e("./lib/find-best-match"),s=e("./lib/is-valid-input-type"),c=e("./lib/add-matching-cards-to-results"),l={},d={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"},u=[d.VISA,d.MASTERCARD,d.AMERICAN_EXPRESS,d.DINERS_CLUB,d.DISCOVER,d.JCB,d.UNIONPAY,d.MAESTRO,d.ELO,d.MIR,d.HIPER,d.HIPERCARD];function p(e){return l[e]||r[e]}function _(e,t){var n=i.indexOf(e);if(!t&&-1===n)throw new Error('"'+e+'" is not a supported card type.');return n}function f(e){var t,n=[];return s(e)?0===e.length?i.map((function(e){return o(p(e))})):(i.forEach((function(t){var i=p(t);c(e,i,n)})),(t=a(n))?[t]:n):[]}i=o(u),f.getTypeInfo=function(e){return o(p(e))},f.removeCard=function(e){var t=_(e);i.splice(t,1)},f.addCard=function(e){var t=_(e.type,!0);l[e.type]=e,-1===t&&i.push(e.type)},f.updateCard=function(e,t){var n,i=l[e]||r[e];if(!i)throw new Error('"'+e+'" is not a recognized type. Use `addCard` instead.');if(t.type&&i.type!==t.type)throw new Error("Cannot overwrite type parameter.");n=o(i,!0),Object.keys(n).forEach((function(e){t[e]&&(n[e]=t[e])})),l[n.type]=n},f.changeOrder=function(e,t){var n=_(e);i.splice(n,1),i.splice(t,0,e)},f.resetModifications=function(){i=o(u),l={}},f.types=d,t.exports=f},{"./lib/add-matching-cards-to-results":32,"./lib/card-types":33,"./lib/clone":34,"./lib/find-best-match":35,"./lib/is-valid-input-type":36}],32:[function(e,t,n){"use strict";var i=e("./clone"),r=e("./matches");t.exports=function(e,t,n){var o,a,s,c;for(o=0;o<t.patterns.length;o++)if(r(e,a=t.patterns[o])){c=i(t),s=Array.isArray(a)?String(a[0]).length:String(a).length,e.length>=s&&(c.matchStrength=s),n.push(c);break}}},{"./clone":34,"./matches":37}],33:[function(e,t,n){"use strict";t.exports={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[624,626],[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[622019,622999],[62207,62209],[622126,622925],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}}},{}],34:[function(e,t,n){"use strict";t.exports=function(e){return e?JSON.parse(JSON.stringify(e)):null}},{}],35:[function(e,t,n){"use strict";t.exports=function(e){if(function(e){var t=e.filter((function(e){return e.matchStrength})).length;return t>0&&t===e.length}(e))return e.reduce((function(e,t){return e?e.matchStrength<t.matchStrength?t:e:t}))}},{}],36:[function(e,t,n){"use strict";t.exports=function(e){return"string"==typeof e||e instanceof String}},{}],37:[function(e,t,n){"use strict";t.exports=function(e,t){return Array.isArray(t)?function(e,t,n){var i=String(t).length,r=e.substr(0,i),o=parseInt(r,10);return t=parseInt(String(t).substr(0,r.length),10),n=parseInt(String(n).substr(0,r.length),10),o>=t&&o<=n}(e,t[0],t[1]):function(e,t){return(t=String(t)).substring(0,e.length)===e.substring(0,t.length)}(e,t)}},{}],38:[function(e,t,n){(function(e){"use strict";var n,i,r=[],o={},a="/*framebus*/";function s(e){var t,i=d(this);return!u(e)&&!u(i)&&!1!==(t=p(e,Array.prototype.slice.call(arguments,1),i))&&(b(n.top||n.self,t,i),!0)}function c(e,t){var n=d(this);return!g(e,t,n)&&(o[n]=o[n]||{},o[n][e]=o[n][e]||[],o[n][e].push(t),!0)}function l(e,t){var n,i,r=d(this);if(g(e,t,r))return!1;if(!(i=o[r]&&o[r][e]))return!1;for(n=0;n<i.length;n++)if(i[n]===t)return i.splice(n,1),!0;return!1}function d(e){return e&&e._origin||"*"}function u(e){return"string"!=typeof e}function p(e,t,n){var i=!1,r={event:e,origin:n},o=t[t.length-1];"function"==typeof o&&(r.reply=y(o,n),t=t.slice(0,-1)),r.args=t;try{i=a+JSON.stringify(r)}catch(s){throw new Error("Could not stringify event: "+s.message)}return i}function _(e){var t,n,i,r;if(e.data.slice(0,a.length)!==a)return!1;try{t=JSON.parse(e.data.slice(a.length))}catch(o){return!1}return null!=t.reply&&(n=e.origin,i=e.source,r=t.reply,t.reply=function(e){var t;return!!i&&!1!==(t=p(r,[e],n))&&void i.postMessage(t,n)},t.args.push(t.reply)),t}function f(t){n||((n=t||e).addEventListener?n.addEventListener("message",m,!1):n.attachEvent?n.attachEvent("onmessage",m):null===n.onmessage?n.onmessage=m:n=null)}function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function m(e){var t;u(e.data)||(t=_(e))&&(E("*",t.event,t.args,e),E(e.origin,t.event,t.args,e),function(e,t,n){var i,o;for(i=r.length-1;i>=0;i--)!0===(o=r[i]).closed?r=r.slice(i,1):n!==o&&b(o.top,e,t)}(e.data,t.origin,e.source))}function E(e,t,n,i){var r;if(o[e]&&o[e][t])for(r=0;r<o[e][t].length;r++)o[e][t][r].apply(i,n)}function b(e,t,n){var i,r=0;try{for(e.postMessage(t,n),function(e){return e.top===e&&null!=e.opener&&e.opener!==e&&!0!==e.opener.closed}(e)&&b(e.opener.top,t,n);i=e.frames[r];)b(i,t,n),r++}catch(o){}}function y(e,t){var n=h();return i.target(t).subscribe(n,(function r(o,a){e(o,a),i.target(t).unsubscribe(n,r)})),n}function g(e,t,n){return!!u(e)||"function"!=typeof t||!!u(n)}f(),t.exports=i={target:function(e){var t,n={};for(t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);return n._origin=e||"*",n},_packagePayload:p,_unpackPayload:_,_attach:f,_detach:function(){null!=n&&(n.removeEventListener?n.removeEventListener("message",m,!1):n.detachEvent?n.detachEvent("onmessage",m):n.onmessage===m&&(n.onmessage=null),n=null,r=[],o={})},_dispatch:E,_broadcast:b,_subscribeReplier:y,_subscriptionArgsInvalid:g,_onmessage:m,_uuid:h,_getSubscribers:function(){return o},_win:function(){return n},include:function(e){return null!=e&&null!=e.Window&&e.constructor===e.Window&&(r.push(e),!0)},publish:s,pub:s,trigger:s,emit:s,subscribe:c,sub:c,on:c,unsubscribe:l,unsub:l,off:l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(e,t,n){"use strict";var i=setTimeout;function r(e){return Boolean(e&&void 0!==e.length)}function o(){}function a(e){if(!(this instanceof a))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],p(e,this)}function s(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,a._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var i;try{i=n(e._value)}catch(r){return void l(t.promise,r)}c(t.promise,i)}else(1===e._state?c:l)(t.promise,e._value)}))):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof a)return e._state=3,e._value=t,void d(e);if("function"==typeof n)return void p((i=n,r=t,function(){i.apply(r,arguments)}),e)}e._state=1,e._value=t,d(e)}catch(o){l(e,o)}var i,r}function l(e,t){e._state=2,e._value=t,d(e)}function d(e){2===e._state&&0===e._deferreds.length&&a._immediateFn((function(){e._handled||a._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function p(e,t){var n=!1;try{e((function(e){n||(n=!0,c(t,e))}),(function(e){n||(n=!0,l(t,e))}))}catch(i){if(n)return;n=!0,l(t,i)}}a.prototype.catch=function(e){return this.then(null,e)},a.prototype.then=function(e,t){var n=new this.constructor(o);return s(this,new u(e,t,n)),n},a.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))},a.all=function(e){return new a((function(t,n){if(!r(e))return n(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);var o=i.length;function a(e,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var s=r.then;if("function"==typeof s)return void s.call(r,(function(t){a(e,t)}),n)}i[e]=r,0==--o&&t(i)}catch(c){n(c)}}for(var s=0;s<i.length;s++)a(s,i[s])}))},a.resolve=function(e){return e&&"object"==typeof e&&e.constructor===a?e:new a((function(t){t(e)}))},a.reject=function(e){return new a((function(t,n){n(e)}))},a.race=function(e){return new a((function(t,n){if(!r(e))return n(new TypeError("Promise.race accepts an array"));for(var i=0,o=e.length;i<o;i++)a.resolve(e[i]).then(t,n)}))},a._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){i(e,0)},a._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.exports=a},{}],40:[function(e,t,n){(function(n){"use strict";var i=n.navigator&&n.navigator.userAgent,r=e("@braintree/browser-detection/is-android"),o=e("@braintree/browser-detection/is-chrome-os"),a=e("@braintree/browser-detection/is-chrome"),s=e("@braintree/browser-detection/is-ios"),c=e("@braintree/browser-detection/is-ie9"),l=/Version\/\d\.\d* Chrome\/\d*\.0\.0\.0/;t.exports={isIE9:c,isAndroidChrome:function(e){var t=e||i;return(r(t)||o(t))&&a(t)},isIos:s,isKitKatWebview:function(e){var t=e||i;return r(t)&&l.test(t)},isSamsungBrowser:function(e){return/SamsungBrowser/.test(e=e||i)||function(e){return!a(e)&&e.indexOf("Samsung")>-1}(e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@braintree/browser-detection/is-android":3,"@braintree/browser-detection/is-chrome":5,"@braintree/browser-detection/is-chrome-os":4,"@braintree/browser-detection/is-ie9":11,"@braintree/browser-detection/is-ios":16}],41:[function(e,t,n){"use strict";var i=e("./lib/device");t.exports=function(){return!i.isSamsungBrowser()}},{"./lib/device":40}],42:[function(e,t,n){"use strict";var i=e("../lib/braintree-error"),r=e("./errors"),o=e("../lib/assign").assign,a=e("../lib/promise"),s=e("../lib/methods"),c=e("../lib/convert-methods-to-error"),l=e("@braintree/wrap-promise");function d(e){this._client=e.client}d.prototype.getRewardsBalance=function(e){var t,n=e.nonce;return n?(delete(t=o({_meta:{source:"american-express"},paymentMethodNonce:n},e)).nonce,this._client.request({method:"get",endpoint:"payment_methods/amex_rewards_balance",data:t}).catch((function(e){return a.reject(new i({type:r.AMEX_NETWORK_ERROR.type,code:r.AMEX_NETWORK_ERROR.code,message:"A network error occurred when getting the American Express rewards balance.",details:{originalError:e}}))}))):a.reject(new i({type:r.AMEX_NONCE_REQUIRED.type,code:r.AMEX_NONCE_REQUIRED.code,message:"getRewardsBalance must be called with a nonce."}))},d.prototype.getExpressCheckoutProfile=function(e){return e.nonce?this._client.request({method:"get",endpoint:"payment_methods/amex_express_checkout_cards/"+e.nonce,data:{_meta:{source:"american-express"},paymentMethodNonce:e.nonce}}).catch((function(e){return a.reject(new i({type:r.AMEX_NETWORK_ERROR.type,code:r.AMEX_NETWORK_ERROR.code,message:"A network error occurred when getting the American Express Checkout nonce profile.",details:{originalError:e}}))})):a.reject(new i({type:r.AMEX_NONCE_REQUIRED.type,code:r.AMEX_NONCE_REQUIRED.code,message:"getExpressCheckoutProfile must be called with a nonce."}))},d.prototype.teardown=function(){return c(this,s(d.prototype)),a.resolve()},t.exports=l.wrapPrototype(d)},{"../lib/assign":95,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/methods":130,"../lib/promise":132,"./errors":43,"@braintree/wrap-promise":30}],43:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={AMEX_NONCE_REQUIRED:{type:i.types.MERCHANT,code:"AMEX_NONCE_REQUIRED"},AMEX_NETWORK_ERROR:{type:i.types.NETWORK,code:"AMEX_NETWORK_ERROR"}}},{"../lib/braintree-error":98}],44:[function(e,t,n){"use strict";var i=e("./american-express"),r=e("../lib/basic-component-verification"),o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("@braintree/wrap-promise");t.exports={create:s((function(e){var t="American Express";return r.verify({name:t,client:e.client,authorization:e.authorization}).then((function(){return o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:t})})).then((function(t){return e.client=t,new i(e)}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"./american-express":42,"@braintree/wrap-promise":30}],45:[function(e,t,n){(function(n){"use strict";var i=e("../lib/braintree-error"),r=e("../lib/analytics"),o=e("./errors"),a=e("../lib/promise"),s=e("../lib/methods"),c=e("../lib/convert-methods-to-error"),l=e("@braintree/wrap-promise");function d(e){this._instantiatedWithClient=Boolean(!e.useDeferredClient),this._client=e.client,this._createPromise=e.createPromise,this._client&&this._setMerchantIdentifier()}d.prototype._waitForClient=function(){return this._client?a.resolve():this._createPromise.then((function(e){this._client=e,this._setMerchantIdentifier()}).bind(this))},d.prototype._setMerchantIdentifier=function(){var e=this._client.getConfiguration().gatewayConfiguration.applePayWeb;e&&Object.defineProperty(this,"merchantIdentifier",{value:e.merchantIdentifier,configurable:!1,writable:!1})},d.prototype.createPaymentRequest=function(e){return this._instantiatedWithClient?this._createPaymentRequestSynchronously(e):this._waitForClient().then((function(){return this._createPaymentRequestSynchronously(e)}).bind(this))},d.prototype._createPaymentRequestSynchronously=function(e){var t=this._client.getConfiguration().gatewayConfiguration.applePayWeb,n={countryCode:t.countryCode,currencyCode:t.currencyCode,merchantCapabilities:t.merchantCapabilities||["supports3DS"],supportedNetworks:t.supportedNetworks.map((function(e){return"mastercard"===e?"masterCard":e}))};return Object.assign({},n,e)},d.prototype.performValidation=function(e){var t=this;return e&&e.validationURL?this._waitForClient().then((function(){var i={validationUrl:e.validationURL,domainName:e.domainName||n.location.hostname,merchantIdentifier:e.merchantIdentifier||t.merchantIdentifier};return null!=e.displayName&&(i.displayName=e.displayName),t._client.request({method:"post",endpoint:"apple_pay_web/sessions",data:{_meta:{source:"apple-pay"},applePayWebSession:i}})})).then((function(e){return r.sendEvent(t._client,"applepay.performValidation.succeeded"),a.resolve(e)})).catch((function(e){return r.sendEvent(t._client,"applepay.performValidation.failed"),a.reject(new i("CLIENT_REQUEST_ERROR"===e.code?{type:o.APPLE_PAY_MERCHANT_VALIDATION_FAILED.type,code:o.APPLE_PAY_MERCHANT_VALIDATION_FAILED.code,message:o.APPLE_PAY_MERCHANT_VALIDATION_FAILED.message,details:{originalError:e.details.originalError}}:{type:o.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.type,code:o.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.code,message:o.APPLE_PAY_MERCHANT_VALIDATION_NETWORK.message,details:{originalError:e}}))})):a.reject(new i(o.APPLE_PAY_VALIDATION_URL_REQUIRED))},d.prototype.tokenize=function(e){var t=this;return e.token?this._waitForClient().then((function(){return t._client.request({method:"post",endpoint:"payment_methods/apple_payment_tokens",data:{_meta:{source:"apple-pay"},applePaymentToken:Object.assign({},e.token,{paymentData:btoa(JSON.stringify(e.token.paymentData))})}})})).then((function(e){return r.sendEvent(t._client,"applepay.tokenize.succeeded"),a.resolve(e.applePayCards[0])})).catch((function(e){return r.sendEvent(t._client,"applepay.tokenize.failed"),a.reject(new i({type:o.APPLE_PAY_TOKENIZATION.type,code:o.APPLE_PAY_TOKENIZATION.code,message:o.APPLE_PAY_TOKENIZATION.message,details:{originalError:e}}))})):a.reject(new i(o.APPLE_PAY_PAYMENT_TOKEN_REQUIRED))},d.prototype.teardown=function(){return c(this,s(d.prototype)),a.resolve()},t.exports=l.wrapPrototype(d)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/analytics":93,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/methods":130,"../lib/promise":132,"./errors":46,"@braintree/wrap-promise":30}],46:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={APPLE_PAY_NOT_ENABLED:{type:i.types.MERCHANT,code:"APPLE_PAY_NOT_ENABLED",message:"Apple Pay is not enabled for this merchant."},APPLE_PAY_VALIDATION_URL_REQUIRED:{type:i.types.MERCHANT,code:"APPLE_PAY_VALIDATION_URL_REQUIRED",message:"performValidation must be called with a validationURL."},APPLE_PAY_MERCHANT_VALIDATION_NETWORK:{type:i.types.NETWORK,code:"APPLE_PAY_MERCHANT_VALIDATION_NETWORK",message:"A network error occurred when validating the Apple Pay merchant."},APPLE_PAY_MERCHANT_VALIDATION_FAILED:{type:i.types.MERCHANT,code:"APPLE_PAY_MERCHANT_VALIDATION_FAILED",message:"Make sure you have registered your domain name in the Braintree Control Panel."},APPLE_PAY_PAYMENT_TOKEN_REQUIRED:{type:i.types.MERCHANT,code:"APPLE_PAY_PAYMENT_TOKEN_REQUIRED",message:"tokenize must be called with a payment token."},APPLE_PAY_TOKENIZATION:{type:i.types.NETWORK,code:"APPLE_PAY_TOKENIZATION",message:"A network error occurred when processing the Apple Pay payment."}}},{"../lib/braintree-error":98}],47:[function(e,t,n){"use strict";var i=e("./apple-pay"),r=e("../lib/analytics"),o=e("../lib/braintree-error"),a=e("../lib/basic-component-verification"),s=e("../lib/create-assets-url"),c=e("../lib/create-deferred-client"),l=e("../lib/promise"),d=e("./errors"),u=e("@braintree/wrap-promise");t.exports={create:u((function(e){return a.verify({name:"Apple Pay",client:e.client,authorization:e.authorization}).then((function(){var t,n=c.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:s.create(e.authorization),name:"Apple Pay"}).then((function(e){return e.getConfiguration().gatewayConfiguration.applePayWeb?(r.sendEvent(e,"applepay.initialized"),e):l.reject(new o(d.APPLE_PAY_NOT_ENABLED))}));return e.createPromise=n,t=new i(e),e.useDeferredClient?t:n.then((function(e){return t._client=e,t}))}))})),VERSION:"3.60.0"}},{"../lib/analytics":93,"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./apple-pay":45,"./errors":46,"@braintree/wrap-promise":30}],48:[function(e,t,n){"use strict";var i=e("@braintree/browser-detection/is-ie"),r=e("@braintree/browser-detection/is-ie9");t.exports={isIe:i,isIe9:r}},{"@braintree/browser-detection/is-ie":8,"@braintree/browser-detection/is-ie9":11}],49:[function(e,t,n){"use strict";var i=e("./constants").BRAINTREE_VERSION,r=e("./request/graphql"),o=e("./request"),a=e("../lib/is-verified-domain"),s=e("../lib/braintree-error"),c=e("../lib/convert-to-braintree-error"),l=e("./get-configuration").getConfiguration,d=e("../lib/create-authorization-data"),u=e("../lib/add-metadata"),p=e("../lib/promise"),_=e("@braintree/wrap-promise"),f=e("../lib/once"),h=e("../lib/deferred"),m=e("../lib/assign").assign,E=e("../lib/analytics"),b=e("./errors"),y=e("../lib/constants").VERSION,g=e("../lib/constants").GRAPHQL_URLS,v=e("../lib/methods"),A=e("../lib/convert-methods-to-error"),T=e("../lib/assets"),I=e("../lib/constants").FRAUDNET_FNCLS,N=e("../lib/constants").FRAUDNET_SOURCE,P=e("../lib/constants").FRAUDNET_URL,O={};function R(e){var t,n;if(e=e||{},t=JSON.stringify(e),!(n=e.gatewayConfiguration))throw new s(b.CLIENT_MISSING_GATEWAY_CONFIGURATION);["assetsUrl","clientApiUrl","configUrl"].forEach((function(e){if(e in n&&!a(n[e]))throw new s({type:b.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.type,code:b.CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN.code,message:e+" property is on an invalid domain."})})),this.getConfiguration=function(){return JSON.parse(t)},this._request=o,this._configuration=this.getConfiguration(),this._clientApiBaseUrl=n.clientApiUrl+"/v1/",n.graphQL&&(this._graphQL=new r({graphQL:n.graphQL}))}R.initialize=function(e){var t,n,i=O[e.authorization];if(i)return E.sendEvent(i,"custom.client.load.cached"),i;try{n=d(e.authorization)}catch(r){return p.reject(new s(b.CLIENT_INVALID_AUTHORIZATION))}return i=l(n).then((function(n){return e.debug&&(n.isDebug=!0),n.authorization=e.authorization,t=new R(n)})),O[e.authorization]=i,E.sendEvent(i,"custom.client.load.initialized"),i.then((function(e){return E.sendEvent(t,"custom.client.load.succeeded"),e})).catch((function(t){return delete O[e.authorization],p.reject(t)}))},R.clearCache=function(){O={}},R.prototype._findOrCreateFraudnetJSON=function(e){var t,n,i,r,o=document.querySelector('script[fncls="'+I+'"]');o||((o=document.body.appendChild(document.createElement("script"))).type="application/json",o.setAttribute("fncls",I)),t=this.getConfiguration(),n={rda_tenant:"bt_card",mid:t.gatewayConfiguration.merchantId},(i=t.authorizationFingerprint)&&i.split("&").forEach((function(e){var t=e.split("=");"customer_id"===t[0]&&t.length>1&&(n.cid=t[1])})),r={f:e.substr(0,32),fp:n,bu:!1,s:N},o.text=JSON.stringify(r)},R.prototype.request=function(e,t){var n=this,r=new p((function(t,r){var o,a,l,d,p,_=Boolean("payment_methods/credit_cards"===e.endpoint&&n.getConfiguration().gatewayConfiguration.creditCards.collectDeviceData);if("graphQLApi"!==e.api&&(e.method?e.endpoint||(o="options.endpoint"):o="options.method"),o)throw new s({type:b.CLIENT_OPTION_REQUIRED.type,code:b.CLIENT_OPTION_REQUIRED.code,message:o+" is required when making a request."});if(d={method:e.method,graphQL:n._graphQL,timeout:e.timeout,metadata:n._configuration.analyticsMetadata},"clientApi"===(a="api"in e?e.api:"clientApi"))l=n._clientApiBaseUrl,d.data=u(n._configuration,e.data);else{if("graphQLApi"!==a)throw new s({type:b.CLIENT_OPTION_INVALID.type,code:b.CLIENT_OPTION_INVALID.code,message:"options.api is invalid."});l=g[n._configuration.gatewayConfiguration.environment],e.endpoint="",d.method="post",d.data=m({clientSdkMetadata:{source:n._configuration.analyticsMetadata.source,integration:n._configuration.analyticsMetadata.integration,sessionId:n._configuration.analyticsMetadata.sessionId}},e.data),d.headers={Authorization:"Bearer "+((p=n._configuration).authorizationFingerprint||p.authorization),"Braintree-Version":i}}d.url=l+e.endpoint,d.sendAnalyticsEvent=function(e){E.sendEvent(n,e)},n._request(d,(function(e,i,o){var l,d;(d=function(e,t){var n;if(-1===e?n=new s(b.CLIENT_REQUEST_TIMEOUT):403===e?n=new s(b.CLIENT_AUTHORIZATION_INSUFFICIENT):429===e?n=new s(b.CLIENT_RATE_LIMITED):e>=500?n=new s(b.CLIENT_GATEWAY_NETWORK):(e<200||e>=400)&&(n=c(t,{type:b.CLIENT_REQUEST_ERROR.type,code:b.CLIENT_REQUEST_ERROR.code,message:b.CLIENT_REQUEST_ERROR.message})),n)return n.details=n.details||{},n.details.httpStatus=e,n}(o,e))?r(d):"graphQLApi"===a&&i.errors?r(c(i.errors,{type:b.CLIENT_GRAPHQL_REQUEST_ERROR.type,code:b.CLIENT_GRAPHQL_REQUEST_ERROR.code,message:b.CLIENT_GRAPHQL_REQUEST_ERROR.message})):(l=m({_httpStatus:o},i),_&&l.creditCards&&l.creditCards.length>0&&(n._findOrCreateFraudnetJSON(l.creditCards[0].nonce),T.loadScript({src:P,forceScriptReload:!0})),t(l))}))}));return"function"==typeof t?(t=f(h(t)),void r.then((function(e){t(null,e,e._httpStatus)})).catch((function(e){t(e,null,e&&e.details&&e.details.httpStatus)}))):r},R.prototype.toJSON=function(){return this.getConfiguration()},R.prototype.getVersion=function(){return y},R.prototype.teardown=_((function(){return delete O[this.getConfiguration().authorization],A(this,v(R.prototype)),p.resolve()})),t.exports=R},{"../lib/add-metadata":92,"../lib/analytics":93,"../lib/assets":94,"../lib/assign":95,"../lib/braintree-error":98,"../lib/constants":103,"../lib/convert-methods-to-error":104,"../lib/convert-to-braintree-error":105,"../lib/create-authorization-data":107,"../lib/deferred":109,"../lib/is-verified-domain":128,"../lib/methods":130,"../lib/once":131,"../lib/promise":132,"./constants":50,"./errors":51,"./get-configuration":52,"./request":64,"./request/graphql":62,"@braintree/wrap-promise":30}],50:[function(e,t,n){"use strict";t.exports={BRAINTREE_VERSION:"2018-05-10"}},{}],51:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN:{type:i.types.MERCHANT,code:"CLIENT_GATEWAY_CONFIGURATION_INVALID_DOMAIN"},CLIENT_OPTION_REQUIRED:{type:i.types.MERCHANT,code:"CLIENT_OPTION_REQUIRED"},CLIENT_OPTION_INVALID:{type:i.types.MERCHANT,code:"CLIENT_OPTION_INVALID"},CLIENT_MISSING_GATEWAY_CONFIGURATION:{type:i.types.INTERNAL,code:"CLIENT_MISSING_GATEWAY_CONFIGURATION",message:"Missing gatewayConfiguration."},CLIENT_INVALID_AUTHORIZATION:{type:i.types.MERCHANT,code:"CLIENT_INVALID_AUTHORIZATION",message:"Authorization is invalid. Make sure your client token or tokenization key is valid."},CLIENT_GATEWAY_NETWORK:{type:i.types.NETWORK,code:"CLIENT_GATEWAY_NETWORK",message:"Cannot contact the gateway at this time."},CLIENT_REQUEST_TIMEOUT:{type:i.types.NETWORK,code:"CLIENT_REQUEST_TIMEOUT",message:"Request timed out waiting for a reply."},CLIENT_REQUEST_ERROR:{type:i.types.NETWORK,code:"CLIENT_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_GRAPHQL_REQUEST_ERROR:{type:i.types.NETWORK,code:"CLIENT_GRAPHQL_REQUEST_ERROR",message:"There was a problem with your request."},CLIENT_RATE_LIMITED:{type:i.types.MERCHANT,code:"CLIENT_RATE_LIMITED",message:"You are being rate-limited; please try again in a few minutes."},CLIENT_AUTHORIZATION_INSUFFICIENT:{type:i.types.MERCHANT,code:"CLIENT_AUTHORIZATION_INSUFFICIENT",message:"The authorization used has insufficient privileges."}}},{"../lib/braintree-error":98}],52:[function(e,t,n){(function(n){"use strict";var i=e("../lib/braintree-error"),r=e("../lib/promise"),o=e("@braintree/wrap-promise"),a=e("./request"),s=e("../lib/vendor/uuid"),c=e("../lib/constants"),l=e("./errors"),d=e("./request/graphql"),u=e("../lib/constants").GRAPHQL_URLS,p=e("../lib/is-date-string-before-or-on"),_=e("./constants").BRAINTREE_VERSION;t.exports={getConfiguration:o((function(e){return new r((function(t,r){var o,f,h,m=s(),E={merchantAppId:n.location.host,platform:c.PLATFORM,sdkVersion:c.VERSION,source:c.SOURCE,integration:c.INTEGRATION,integrationType:c.INTEGRATION,sessionId:m};f=e.configUrl,(o=e.attrs)._meta=E,o.braintreeLibraryVersion=c.BRAINTREE_LIBRARY_VERSION,o.configVersion="3",h={url:f,method:"GET",data:o},o.authorizationFingerprint&&e.graphQL?(p(e.graphQL.date,_)&&(h.graphQL=new d({graphQL:{url:e.graphQL.url,features:["configuration"]}})),h.metadata=E):o.tokenizationKey&&(h.graphQL=new d({graphQL:{url:u[e.environment],features:["configuration"]}}),h.metadata=E),a(h,(function(e,n,a){var s;e?r(new i({type:(s=403===a?l.CLIENT_AUTHORIZATION_INSUFFICIENT:l.CLIENT_GATEWAY_NETWORK).type,code:s.code,message:s.message,details:{originalError:e}})):t({authorizationType:o.tokenizationKey?"TOKENIZATION_KEY":"CLIENT_TOKEN",authorizationFingerprint:o.authorizationFingerprint,analyticsMetadata:E,gatewayConfiguration:n})}))}))}))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/braintree-error":98,"../lib/constants":103,"../lib/is-date-string-before-or-on":126,"../lib/promise":132,"../lib/vendor/uuid":136,"./constants":50,"./errors":51,"./request":64,"./request/graphql":62,"@braintree/wrap-promise":30}],53:[function(e,t,n){"use strict";var i=e("../lib/braintree-error"),r=e("./client"),o=e("../lib/promise"),a=e("@braintree/wrap-promise"),s=e("../lib/errors");t.exports={create:a((function(e){return e.authorization?r.initialize(e):o.reject(new i({type:s.INSTANTIATION_OPTION_REQUIRED.type,code:s.INSTANTIATION_OPTION_REQUIRED.code,message:"options.authorization is required when instantiating a client."}))})),VERSION:"3.60.0"}},{"../lib/braintree-error":98,"../lib/errors":112,"../lib/promise":132,"./client":49,"@braintree/wrap-promise":30}],54:[function(e,t,n){"use strict";var i=e("../../lib/querystring"),r=e("../../lib/assign").assign,o=e("./prep-body"),a=e("./parse-body"),s=e("./xhr"),c=s.isAvailable,l=e("./graphql/request"),d=e("./default-request");t.exports={request:function(e,t){!function e(t,n,u){var p,_,f,h,m,E,b,y=t.url,g=t.graphQL,v=t.timeout,A=s.getRequestObject(),T=u,I=Boolean(g&&g.isGraphQLRequest(y,t.data));t.headers=r({"Content-Type":"application/json"},t.headers),y=(f=I?new l(t):new d(t)).getUrl(),h=f.getBody(),m=f.getMethod(),E=f.getHeaders(),"GET"===m&&(y=i.queryify(y,h),h=null),c?A.onreadystatechange=function(){if(4===A.readyState){if(0===A.status&&I)return delete t.graphQL,void e(t,n,u);if(b=a(A.responseText),_=f.adaptResponseBody(b),(p=f.determineStatus(A.status,b))>=400||p<200){if(I&&function(e){var t=!e.data&&e.errors&&e.errors[0]&&e.errors[0].extensions&&e.errors[0].extensions.errorClass;return"UNKNOWN"===t||"INTERNAL"===t}(b))return delete t.graphQL,void e(t,n,u);if(n<1&&function(e){return!e||408===e}(p))return n++,void e(t,n,u);T(_||"error",null,p||500)}else T(null,_,p)}}:(t.headers&&(y=i.queryify(y,E)),A.onload=function(){T(null,a(A.responseText),A.status)},A.onerror=function(){T("error",null,500)},A.onprogress=function(){},A.ontimeout=function(){T("timeout",null,-1)});try{A.open(m,y,!0)}catch(N){if(!I)throw N;return delete t.graphQL,void e(t,n,u)}A.timeout=v,c&&Object.keys(E).forEach((function(e){A.setRequestHeader(e,E[e])}));try{A.send(o(m,h))}catch(P){}}(e,0,t)}}},{"../../lib/assign":95,"../../lib/querystring":133,"./default-request":55,"./graphql/request":63,"./parse-body":67,"./prep-body":68,"./xhr":69}],55:[function(e,t,n){"use strict";function i(e){this._url=e.url,this._data=e.data,this._method=e.method,this._headers=e.headers}i.prototype.getUrl=function(){return this._url},i.prototype.getBody=function(){return this._data},i.prototype.getMethod=function(){return this._method},i.prototype.getHeaders=function(){return this._headers},i.prototype.adaptResponseBody=function(e){return e},i.prototype.determineStatus=function(e){return e},t.exports=i},{}],56:[function(e,t,n){(function(e){"use strict";t.exports=function(){return e.navigator.userAgent}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],57:[function(e,t,n){"use strict";var i=e("./error"),r=e("../../../../lib/assign").assign,o={AMERICAN_EXPRESS:"American Express",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",SOLO:"Solo",UK_MAESTRO:"UK Maestro",UNION_PAY:"UnionPay",VISA:"Visa"},a={VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex"},s={VISA:"Visa",MASTERCARD:"MasterCard",DISCOVER:"Discover",AMERICAN_EXPRESS:"American Express"},c={VISA:"visa",MASTERCARD:"mastercard",DISCOVER:"discover",AMERICAN_EXPRESS:"amex"},l={VISA:"visa",MASTERCARD:"master",DISCOVER:"discover",AMERICAN_EXPRESS:"amex",DINERS:"diners",INTERNATIONAL_MAESTRO:"maestro",JCB:"jcb"};function d(e,t){return e.reduce((function(e,n){return t.hasOwnProperty(n)?e.concat(t[n]):e}),[])}t.exports=function(e,t){return e.data&&!e.errors?function(e,t){var n,i=e.data.clientConfiguration;return n={environment:i.environment.toLowerCase(),clientApiUrl:i.clientApiUrl,assetsUrl:i.assetsUrl,analytics:{url:i.analyticsUrl},merchantId:i.merchantId,venmo:"off"},i.supportedFeatures&&(n.graphQL={url:t._graphQL._config.url,features:i.supportedFeatures.map((function(e){return e.toLowerCase()}))}),i.braintreeApi&&(n.braintreeApi=i.braintreeApi),i.applePayWeb&&(n.applePayWeb=i.applePayWeb,n.applePayWeb.supportedNetworks=d(i.applePayWeb.supportedCardBrands,a),delete n.applePayWeb.supportedCardBrands),i.ideal&&(n.ideal=i.ideal),i.kount&&(n.kount={kountMerchantId:i.kount.merchantId}),i.creditCard?(n.challenges=i.creditCard.challenges.map((function(e){return e.toLowerCase()})),n.creditCards={supportedCardTypes:d(i.creditCard.supportedCardBrands,o)},n.threeDSecureEnabled=i.creditCard.threeDSecureEnabled,n.threeDSecure=i.creditCard.threeDSecure):(n.challenges=[],n.creditCards={supportedCardTypes:[]},n.threeDSecureEnabled=!1),i.googlePay&&(n.androidPay={displayName:i.googlePay.displayName,enabled:!0,environment:i.googlePay.environment.toLowerCase(),googleAuthorizationFingerprint:i.googlePay.googleAuthorization,supportedNetworks:d(i.googlePay.supportedCardBrands,c)}),i.venmo&&(n.payWithVenmo={merchantId:i.venmo.merchantId,accessToken:i.venmo.accessToken,environment:i.venmo.environment.toLowerCase()}),i.paypal?(n.paypalEnabled=!0,n.paypal=r({},i.paypal),n.paypal.currencyIsoCode=n.paypal.currencyCode,n.paypal.environment=n.paypal.environment.toLowerCase(),delete n.paypal.currencyCode):n.paypalEnabled=!1,i.unionPay&&(n.unionPay={enabled:!0,merchantAccountId:i.unionPay.merchantAccountId}),i.visaCheckout&&(n.visaCheckout={apikey:i.visaCheckout.apiKey,externalClientId:i.visaCheckout.externalClientId,supportedCardTypes:d(i.visaCheckout.supportedCardBrands,s)}),i.masterpass&&(n.masterpass={merchantCheckoutId:i.masterpass.merchantCheckoutId,supportedNetworks:d(i.masterpass.supportedCardBrands,l)}),i.usBankAccount&&(n.usBankAccount={routeId:i.usBankAccount.routeId,plaid:{publicKey:i.usBankAccount.plaidPublicKey}}),n}(e,t):i(e)}},{"../../../../lib/assign":95,"./error":59}],58:[function(e,t,n){"use strict";var i=e("./error"),r={AMERICAN_EXPRESS:"American Express",DINERS:"Discover",DISCOVER:"Discover",INTERNATIONAL_MAESTRO:"Maestro",JCB:"JCB",MASTERCARD:"MasterCard",UK_MAESTRO:"Maestro",UNION_PAY:"Union Pay",VISA:"Visa"},o={YES:"Yes",NO:"No",UNKNOWN:"Unknown"},a={PSDTWO:"psd2"};t.exports=function(e){return e.data&&!e.errors?(l=(c=(s=e.data.tokenizeCreditCard).creditCard).last4?c.last4.substr(2,4):"",(d=c.binData)&&(["commercial","debit","durbinRegulated","healthcare","payroll","prepaid"].forEach((function(e){d[e]=d[e]?o[d[e]]:"Unknown"})),["issuingBank","countryOfIssuance","productId"].forEach((function(e){d[e]||(d[e]="Unknown")}))),t={creditCards:[{binData:d,consumed:!1,description:l?"ending in "+l:"",nonce:s.token,details:{expirationMonth:c.expirationMonth,expirationYear:c.expirationYear,bin:c.bin||"",cardType:r[c.brandCode]||"Unknown",lastFour:c.last4||"",lastTwo:l},type:"CreditCard",threeDSecureInfo:null}]},s.authenticationInsight&&(t.creditCards[0].authenticationInsight={regulationEnvironment:a[n=s.authenticationInsight.customerAuthenticationRegulationEnvironment]||n.toLowerCase()}),t):i(e);var t,n,s,c,l,d}},{"./error":59}],59:[function(e,t,n){"use strict";t.exports=function(e){var t=e.errors&&e.errors[0]&&e.errors[0].extensions&&e.errors[0].extensions.errorClass;return"VALIDATION"===t?function(e){var t,n,i=function(e){var t=[];return e.forEach((function(e){e.extensions&&e.extensions.inputPath&&function e(t,n,i){var r,o=n.extensions.legacyCode,a=t[0];1!==t.length?(i.forEach((function(e){e.field===a&&(r=e)})),r||i.push(r={field:a,fieldErrors:[]}),e(t.slice(1),n,r.fieldErrors)):i.push({code:o,field:a,message:n.message})}(e.extensions.inputPath.slice(1),e,t)})),t}(e.errors);return 0===i.length?{error:{message:e.errors[0].message}}:{error:{message:(t=i,n=t[0].field,{creditCard:"Credit card is invalid"}[n])},fieldErrors:i}}(e):t?function(e){return{error:{message:e.errors[0].message},fieldErrors:[]}}(e):{error:{message:"There was a problem serving your request"},fieldErrors:[]}}},{}],60:[function(e,t,n){"use strict";t.exports=function(){return{query:"query ClientConfiguration {   clientConfiguration {     analyticsUrl     environment     merchantId     assetsUrl     clientApiUrl     creditCard {       supportedCardBrands       challenges       threeDSecureEnabled       threeDSecure {         cardinalAuthenticationJWT       }     }     applePayWeb {       countryCode       currencyCode       merchantIdentifier       supportedCardBrands     }     googlePay {       displayName       supportedCardBrands       environment       googleAuthorization     }     ideal {       routeId       assetsUrl     }     kount {       merchantId     }     masterpass {       merchantCheckoutId       supportedCardBrands     }     paypal {       displayName       clientId       privacyUrl       userAgreementUrl       assetsUrl       environment       environmentNoNetwork       unvettedMerchant       braintreeClientId       billingAgreementsEnabled       merchantAccountId       currencyCode       payeeEmail     }     unionPay {       merchantAccountId     }     usBankAccount {       routeId       plaidPublicKey     }     venmo {       merchantId       accessToken       environment     }     visaCheckout {       apiKey       externalClientId       supportedCardBrands     }     braintreeApi {       accessToken       url     }     supportedFeatures   } }",operationName:"ClientConfiguration"}}},{}],61:[function(e,t,n){"use strict";var i=e("../../../../lib/assign").assign;function r(e,t){var n=e.creditCard,r=n&&n.billingAddress,o=n&&n.expirationDate,a=n&&(n.expirationMonth||o&&o.split("/")[0].trim()),s=n&&(n.expirationYear||o&&o.split("/")[1].trim()),c={input:{creditCard:{number:n&&n.number,expirationMonth:a,expirationYear:s,cvv:n&&n.cvv,cardholderName:n&&n.cardholderName},options:{}}};return t.hasAuthenticationInsight&&(c.authenticationInsightInput={merchantAccountId:e.merchantAccountId}),r&&(c.input.creditCard.billingAddress=r),c.input=function(e,t){var n;return e.creditCard&&e.creditCard.options&&"boolean"==typeof e.creditCard.options.validate?n=e.creditCard.options.validate:e.authorizationFingerprint&&e.tokenizationKey||e.authorizationFingerprint?n=!0:e.tokenizationKey&&(n=!1),"boolean"==typeof n&&(t.options=i({validate:n},t.options)),t}(e,c.input),c}t.exports=function(e){var t,n,i,o={hasAuthenticationInsight:Boolean(e.authenticationInsight&&e.merchantAccountId)};return{query:(t=o,n=t.hasAuthenticationInsight,i="mutation TokenizeCreditCard($input: TokenizeCreditCardInput!",n&&(i+=", $authenticationInsightInput: AuthenticationInsightInput!"),i+=") {   tokenizeCreditCard(input: $input) {     token     creditCard {       bin       brandCode       last4       expirationMonth      expirationYear      binData {         prepaid         healthcare         debit         durbinRegulated         commercial         payroll         issuingBank         countryOfIssuance         productId       }     } ",n&&(i+="    authenticationInsight(input: $authenticationInsightInput) {      customerAuthenticationRegulationEnvironment    }"),i+="  } }"),variables:r(e,o),operationName:"TokenizeCreditCard"}}},{"../../../../lib/assign":95}],62:[function(e,t,n){"use strict";var i=e("../../browser-detection"),r={tokenize_credit_cards:"payment_methods/credit_cards",configuration:"configuration"},o=["creditCard.options.unionPayEnrollment"];function a(e){this._config=e.graphQL}a.prototype.getGraphQLEndpoint=function(){return this._config.url},a.prototype.isGraphQLRequest=function(e,t){var n,a=this.getClientApiPath(e);return!(!this._isGraphQLEnabled()||!a||i.isIe9())&&(n=this._config.features.some((function(e){return r[e]===a})),!function(e){return o.some((function(t){return void 0!==t.split(".").reduce((function(e,t){return e&&e[t]}),e)}))}(t)&&n)},a.prototype.getClientApiPath=function(e){var t,n=e.split("/client_api/v1/");return n.length>1&&(t=n[1].split("?")[0]),t},a.prototype._isGraphQLEnabled=function(){return Boolean(this._config)},t.exports=a},{"../../browser-detection":48}],63:[function(e,t,n){"use strict";var i=e("../../constants").BRAINTREE_VERSION,r=e("../../../lib/assign").assign,o=e("./generators/credit-card-tokenization"),a=e("./adapters/credit-card-tokenization"),s=e("./generators/configuration"),c=e("./adapters/configuration"),l={"payment_methods/credit_cards":o,configuration:s},d={"payment_methods/credit_cards":a,configuration:c};function u(e){var t=e.graphQL.getClientApiPath(e.url);this._graphQL=e.graphQL,this._data=e.data,this._method=e.method,this._headers=e.headers,this._clientSdkMetadata={source:e.metadata.source,integration:e.metadata.integration,sessionId:e.metadata.sessionId},this._sendAnalyticsEvent=e.sendAnalyticsEvent||Function.prototype,this._generator=l[t],this._adapter=d[t],this._sendAnalyticsEvent("graphql.init")}u.prototype.getUrl=function(){return this._graphQL.getGraphQLEndpoint()},u.prototype.getBody=function(){var e=function e(t){var n={};return Object.keys(t).forEach((function(i){var r,o=-1===(r=i).indexOf("_")?r:r.toLowerCase().replace(/(\_\w)/g,(function(e){return e[1].toUpperCase()}));n[o]="object"==typeof t[i]?e(t[i]):"number"==typeof t[i]?String(t[i]):t[i]})),n}(this._data),t=this._generator(e),n=r({clientSdkMetadata:this._clientSdkMetadata},t);return JSON.stringify(n)},u.prototype.getMethod=function(){return"POST"},u.prototype.getHeaders=function(){var e;return this._data.authorizationFingerprint?(this._sendAnalyticsEvent("graphql.authorization-fingerprint"),e=this._data.authorizationFingerprint):(this._sendAnalyticsEvent("graphql.tokenization-key"),e=this._data.tokenizationKey),r({},this._headers,{Authorization:"Bearer "+e,"Braintree-Version":i})},u.prototype.adaptResponseBody=function(e){return this._adapter(e,this)},u.prototype.determineStatus=function(e,t){var n,i;return 200===e?(i=t.errors&&t.errors[0]&&t.errors[0].extensions&&t.errors[0].extensions.errorClass,n=t.data&&!t.errors?200:"VALIDATION"===i?422:"AUTHORIZATION"===i?403:"AUTHENTICATION"===i?401:function(e,t){return!e&&t.errors[0].message}(i,t)?403:500):n=e||500,this._sendAnalyticsEvent("graphql.status."+e),this._sendAnalyticsEvent("graphql.determinedStatus."+n),n},t.exports=u},{"../../../lib/assign":95,"../../constants":50,"./adapters/configuration":57,"./adapters/credit-card-tokenization":58,"./generators/configuration":60,"./generators/credit-card-tokenization":61}],64:[function(e,t,n){"use strict";var i,r=e("../../lib/once"),o=e("./jsonp-driver"),a=e("./ajax-driver"),s=e("./get-user-agent"),c=e("./is-http");t.exports=function(e,t){t=r(t||Function.prototype),e.method=(e.method||"GET").toUpperCase(),e.timeout=null==e.timeout?6e4:e.timeout,e.data=e.data||{},null==i&&(i=!(c()&&/MSIE\s(8|9)/.test(s()))),i?a.request(e,t):o.request(e,t)}},{"../../lib/once":131,"./ajax-driver":54,"./get-user-agent":56,"./is-http":65,"./jsonp-driver":66}],65:[function(e,t,n){(function(e){"use strict";t.exports=function(){return"http:"===e.location.protocol}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],66:[function(e,t,n){(function(n){"use strict";var i,r=e("../../lib/vendor/uuid"),o=e("../../lib/querystring"),a={};function s(e){try{delete n[e]}catch(t){n[e]=null}}t.exports={request:function(e,t){var c,l="callback_json_"+r().replace(/-/g,""),d=e.url,u=e.method,p=e.timeout;d=o.queryify(d,e.data),function(e,t,i){n[i]=function(n){var r=n.status||500,o=null,c=null;delete n.status,r>=400||r<200?o=n:c=n,s(i),function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(e),clearTimeout(a[i]),t(o,c,r)}}(c=function(e,t){var i=document.createElement("script"),r=!1;return i.src=e,i.async=!0,i.onerror=function(){n[t]({message:"error",status:500})},i.onload=i.onreadystatechange=function(){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r=!0,i.onload=i.onreadystatechange=null)},i}(d=o.queryify(d,{_method:u,callback:l}),l),t,l),function(e,t){a[t]=setTimeout((function(){a[t]=null,n[t]({error:"timeout",status:-1}),n[t]=function(){s(t)}}),e)}(p,l),i||(i=document.getElementsByTagName("head")[0]),i.appendChild(c)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../lib/querystring":133,"../../lib/vendor/uuid":136}],67:[function(e,t,n){"use strict";t.exports=function(e){try{e=JSON.parse(e)}catch(t){}return e}},{}],68:[function(e,t,n){"use strict";t.exports=function(e,t){if("string"!=typeof e)throw new Error("Method must be a string");return"get"!==e.toLowerCase()&&null!=t&&(t="string"==typeof t?t:JSON.stringify(t)),t}},{}],69:[function(e,t,n){(function(e){"use strict";var n=e.XMLHttpRequest&&"withCredentials"in new e.XMLHttpRequest;t.exports={isAvailable:n,getRequestObject:function(){return n?new e.XMLHttpRequest:new e.XDomainRequest}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],70:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={DATA_COLLECTOR_KOUNT_NOT_ENABLED:{type:i.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_NOT_ENABLED",message:"Kount is not enabled for this merchant."},DATA_COLLECTOR_KOUNT_ERROR:{type:i.types.MERCHANT,code:"DATA_COLLECTOR_KOUNT_ERROR"},DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS:{type:i.types.MERCHANT,code:"DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS",message:"Data Collector must be created with Kount and/or PayPal."}}},{"../lib/braintree-error":98}],71:[function(e,t,n){"use strict";var i,r=e("../lib/constants").FRAUDNET_FNCLS,o=e("../lib/constants").FRAUDNET_SOURCE,a=e("../lib/constants").FRAUDNET_URL,s=e("../lib/assets").loadScript,c=e("../lib/promise");function l(){}function d(e){e&&e.parentNode&&e.parentNode.removeChild(e)}l.prototype.initialize=function(){var e,t,n,c=this;return this.sessionId=i=function(){var e,t="";for(e=0;e<32;e++)t+=Math.floor(16*Math.random()).toString(16);return t}(),this._beaconId="https://b.stats.paypal.com/counter.cgi?i=127.0.0.1&p="+this.sessionId+"&t="+(new Date).getTime()/1e3+"&a=14",this._parameterBlock=(e=this.sessionId,t=this._beaconId,(n=document.body.appendChild(document.createElement("script"))).type="application/json",n.setAttribute("fncls",r),n.text=JSON.stringify({f:e,s:o,b:t}),n),s({src:a}).then((function(e){return c._thirdPartyBlock=e,c})).catch((function(){return null}))},l.prototype.teardown=function(){d(document.querySelector('iframe[title="ppfniframe"]')),d(document.querySelector('iframe[title="pbf"]')),d(this._parameterBlock),d(this._thirdPartyBlock)},t.exports={setup:function(){var e=new l;return i?(e.sessionId=i,c.resolve(e)):e.initialize()},clearSessionIdCache:function(){i=null}}},{"../lib/assets":94,"../lib/constants":103,"../lib/promise":132}],72:[function(e,t,n){"use strict";var i=e("./kount"),r=e("./fraudnet"),o=e("../lib/braintree-error"),a=e("../lib/basic-component-verification"),s=e("../lib/create-deferred-client"),c=e("../lib/create-assets-url"),l=e("../lib/methods"),d=e("../lib/convert-methods-to-error"),u=e("../lib/promise"),p=e("@braintree/wrap-promise"),_=e("./errors");t.exports={create:p((function(e){var t,n="Data Collector",f={_instances:[]};return a.verify({name:n,client:e.client,authorization:e.authorization}).then((function(){return f._instantiatedWithAClient=!e.useDeferredClient,f._createPromise=s.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:c.create(e.authorization),name:n}).then((function(n){var r,a=n.getConfiguration();if(!0===e.kount&&a.gatewayConfiguration.kount){try{r=i.setup({environment:a.gatewayConfiguration.environment,merchantId:a.gatewayConfiguration.kount.kountMerchantId})}catch(s){return u.reject(new o({type:_.DATA_COLLECTOR_KOUNT_ERROR.type,code:_.DATA_COLLECTOR_KOUNT_ERROR.code,message:s.message}))}t=r.deviceData,f._instances.push(r)}else t={};return u.resolve()})).then((function(){return r.setup().then((function(e){e&&(t.correlation_id=e.sessionId,f._instances.push(e))}))})).then((function(){return 0===f._instances.length?u.reject(new o(_.DATA_COLLECTOR_REQUIRES_CREATE_OPTIONS)):(f.deviceData=JSON.stringify(t),f.rawDeviceData=t,f)})),f.teardown=function(e){return p((function(){return e._createPromise.then((function(){e._instances.forEach((function(e){e&&e.teardown()})),d(e,l(e))}))}))}(f),f.getDeviceData=function(e){return p((function(t){return t=t||{},e._createPromise.then((function(){return u.resolve(t.raw?e.rawDeviceData:e.deviceData)}))}))}(f),f._instantiatedWithAClient?f._createPromise:f}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/methods":130,"../lib/promise":132,"./errors":70,"./fraudnet":71,"./kount":73,"@braintree/wrap-promise":30}],73:[function(e,t,n){"use strict";var i=e("./vendor/sjcl"),r=e("../lib/camel-case-to-snake-case"),o="https://assets.qa.braintreepayments.com/data",a={development:o,qa:o,sandbox:"https://assets.braintreegateway.com/sandbox/data",production:"https://assets.braintreegateway.com/data"},s={};function c(e){var t=c.getCachedDeviceData(e.merchantId);if(t)return this.deviceData=t,void(this._isCached=!0);this._currentEnvironment=this._initializeEnvironment(e),i.random.startCollectors(),this._deviceSessionId=this._generateDeviceSessionId(),this.deviceData=this._getDeviceData(),c.setCachedDeviceData(e.merchantId,this.deviceData),this._iframe=this._setupIFrame()}c.getCachedDeviceData=function(e){return s[e]},c.setCachedDeviceData=function(e,t){s[e]=t},c.prototype.teardown=function(){this._isCached||(i.random.stopCollectors(),this._removeIframe())},c.prototype._removeIframe=function(){this._iframe.parentNode.removeChild(this._iframe)},c.prototype._getDeviceData=function(){return r({deviceSessionId:this._deviceSessionId,fraudMerchantId:this._currentEnvironment.id})},c.prototype._generateDeviceSessionId=function(){var e;return e=i.random.randomWords(4,0),i.codec.hex.fromBits(e)},c.prototype._setupIFrame=function(){var e,t,n=this;return e="?m="+this._currentEnvironment.id+"&s="+this._deviceSessionId,(t=document.createElement("iframe")).width=1,t.id="braintreeDataFrame-"+this._deviceSessionId,t.height=1,t.frameBorder=0,t.scrolling="no",t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",t.title="Braintree-Kount-iframe",t.setAttribute("aria-hidden","true"),document.body.appendChild(t),setTimeout((function(){t.src=n._currentEnvironment.url+"/logo.htm"+e,t.innerHTML='<img src="'+n._currentEnvironment.url+"/logo.gif"+e+'" alt="" />'}),10),t},c.prototype._initializeEnvironment=function(e){var t=a[e.environment];if(null==t)throw new Error(e.environment+" is not a valid environment for kount.environment");return{url:t,name:e.environment,id:e.merchantId}},t.exports={setup:function(e){return new c(null!=e?e:{})},Kount:c,environmentUrls:a}},{"../lib/camel-case-to-snake-case":102,"./vendor/sjcl":74}],74:[function(e,t,n){"use strict";var i={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};function r(e,t,n){if(4!==t.length)throw new i.exception.invalid("invalid aes block size");var r=e.b[n],o=t[0]^r[0],a=t[n?3:1]^r[1],s=t[2]^r[2];t=t[n?1:3]^r[3];var c,l,d,u,p=r.length/4-2,_=4,f=[0,0,0,0];e=(c=e.l[n])[0];var h=c[1],m=c[2],E=c[3],b=c[4];for(u=0;u<p;u++)c=e[o>>>24]^h[a>>16&255]^m[s>>8&255]^E[255&t]^r[_],l=e[a>>>24]^h[s>>16&255]^m[t>>8&255]^E[255&o]^r[_+1],d=e[s>>>24]^h[t>>16&255]^m[o>>8&255]^E[255&a]^r[_+2],t=e[t>>>24]^h[o>>16&255]^m[a>>8&255]^E[255&s]^r[_+3],_+=4,o=c,a=l,s=d;for(u=0;4>u;u++)f[n?3&-u:u]=b[o>>>24]<<24^b[a>>16&255]<<16^b[s>>8&255]<<8^b[255&t]^r[_++],c=o,o=a,a=s,s=t,t=c;return f}function o(e,t){var n,i,r,o=e.u,a=e.b,s=o[0],c=o[1],l=o[2],d=o[3],u=o[4],p=o[5],_=o[6],f=o[7];for(n=0;64>n;n++)i=(i=16>n?t[n]:t[15&n]=((i=t[n+1&15])>>>7^i>>>18^i>>>3^i<<25^i<<14)+((r=t[n+14&15])>>>17^r>>>19^r>>>10^r<<15^r<<13)+t[15&n]+t[n+9&15]|0)+f+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(_^u&(p^_))+a[n],f=_,_=p,p=u,u=d+i|0,d=l,l=c,s=i+((c=s)&l^d&(c^l))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;o[0]=o[0]+s|0,o[1]=o[1]+c|0,o[2]=o[2]+l|0,o[3]=o[3]+d|0,o[4]=o[4]+u|0,o[5]=o[5]+p|0,o[6]=o[6]+_|0,o[7]=o[7]+f|0}function a(e,t){var n,r=i.random.B[e],o=[];for(n in r)r.hasOwnProperty(n)&&o.push(r[n]);for(n=0;n<o.length;n++)o[n](t)}function s(e,t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy((new Date).valueOf(),t,"loadtime")}function c(e){e.b=l(e).concat(l(e)),e.C=new i.cipher.aes(e.b)}function l(e){for(var t=0;4>t&&(e.g[t]=e.g[t]+1|0,!e.g[t]);t++);return e.C.encrypt(e.g)}function d(e,t){return function(){t.apply(e,arguments)}}i.cipher.aes=function(e){this.l[0][0][0]||this.G();var t,n,r,o,a=this.l[0][4],s=this.l[1],c=1;if(4!==(t=e.length)&&6!==t&&8!==t)throw new i.exception.invalid("invalid aes key size");for(this.b=[r=e.slice(0),o=[]],e=t;e<4*t+28;e++)n=r[e-1],(0==e%t||8===t&&4==e%t)&&(n=a[n>>>24]<<24^a[n>>16&255]<<16^a[n>>8&255]<<8^a[255&n],0==e%t&&(n=n<<8^n>>>24^c<<24,c=c<<1^283*(c>>7))),r[e]=r[e-t]^n;for(t=0;e;t++,e--)n=r[3&t?e:e-4],o[t]=4>=e||4>t?n:s[0][a[n>>>24]]^s[1][a[n>>16&255]]^s[2][a[n>>8&255]]^s[3][a[255&n]]},i.cipher.aes.prototype={encrypt:function(e){return r(this,e,0)},decrypt:function(e){return r(this,e,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){var e,t,n,i,r,o,a,s=this.l[0],c=this.l[1],l=s[4],d=c[4],u=[],p=[];for(e=0;256>e;e++)p[(u[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!l[t];t^=i||1,n=p[n]||1)for(l[t]=o=(o=n^n<<1^n<<2^n<<3^n<<4)>>8^255&o^99,d[o]=t,a=16843009*(r=u[e=u[i=u[t]]])^65537*e^257*i^16843008*t,r=257*u[o]^16843008*o,e=0;4>e;e++)s[e][t]=r=r<<24^r>>>8,c[e][o]=a=a<<24^a>>>8;for(e=0;5>e;e++)s[e]=s[e].slice(0),c[e]=c[e].slice(0)}},i.bitArray={bitSlice:function(e,t,n){return e=i.bitArray.M(e.slice(t/32),32-(31&t)).slice(1),void 0===n?e:i.bitArray.clamp(e,n-t)},extract:function(e,t,n){var i=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-i^e[t/32+1|0]>>>i:e[t/32|0]>>>i)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],r=i.bitArray.getPartial(n);return 32===r?e.concat(t):i.bitArray.M(t,r,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+i.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;var n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,0<n&&t&&(e[n-1]=i.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(i.bitArray.bitLength(e)!==i.bitArray.bitLength(t))return!1;var n,r=0;for(n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r},M:function(e,t,n,r){var o;for(o=0,void 0===r&&(r=[]);32<=t;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(o=0;o<e.length;o++)r.push(n|e[o]>>>t),n=e[o]<<32-t;return e=i.bitArray.getPartial(o=e.length?e[e.length-1]:0),r.push(i.bitArray.partial(t+e&31,32<t+e?n:r.pop(),1)),r},Y:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)e[t]=(n=e[t])>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},i.codec.utf8String={fromBits:function(e){var t,n,r="",o=i.bitArray.bitLength(e);for(t=0;t<o/8;t++)0==(3&t)&&(n=e[t/4]),r+=String.fromCharCode(n>>>8>>>8>>>8),n<<=8;return decodeURIComponent(escape(r))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,n=[],r=0;for(t=0;t<e.length;t++)r=r<<8|e.charCodeAt(t),3==(3&t)&&(n.push(r),r=0);return 3&t&&n.push(i.bitArray.partial(8*(3&t),r)),n}},i.codec.hex={fromBits:function(e){var t,n="";for(t=0;t<e.length;t++)n+=(0xf00000000000+(0|e[t])).toString(16).substr(4);return n.substr(0,i.bitArray.bitLength(e)/4)},toBits:function(e){var t,n,r=[];for(n=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",t=0;t<e.length;t+=8)r.push(0^parseInt(e.substr(t,8),16));return i.bitArray.clamp(r,4*n)}},i.hash.sha256=function(e){this.b[0]||this.G(),e?(this.u=e.u.slice(0),this.o=e.o.slice(0),this.h=e.h):this.reset()},i.hash.sha256.hash=function(e){return(new i.hash.sha256).update(e).finalize()},i.hash.sha256.prototype={blockSize:512,reset:function(){return this.u=this.K.slice(0),this.o=[],this.h=0,this},update:function(e){"string"==typeof e&&(e=i.codec.utf8String.toBits(e));var t,n=this.o=i.bitArray.concat(this.o,e);if(9007199254740991<(e=this.h=(t=this.h)+i.bitArray.bitLength(e)))throw new i.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var r=new Uint32Array(n),a=0;for(t=512+t-(512+t&511);t<=e;t+=512)o(this,r.subarray(16*a,16*(a+1))),a+=1;n.splice(0,16*a)}else for(t=512+t-(512+t&511);t<=e;t+=512)o(this,n.splice(0,16));return this},finalize:function(){var e,t,n=this.u;for(e=(t=i.bitArray.concat(t=this.o,[i.bitArray.partial(1,1)])).length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this.h/4294967296)),t.push(0|this.h);t.length;)o(this,t.splice(0,16));return this.reset(),n},K:[],b:[],G:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}for(var t,n,i=0,r=2;64>i;r++){for(n=!0,t=2;t*t<=r;t++)if(0==r%t){n=!1;break}n&&(8>i&&(this.K[i]=e(Math.pow(r,.5))),this.b[i]=e(Math.pow(r,1/3)),i++)}}},i.prng=function(e){this.c=[new i.hash.sha256],this.i=[0],this.H=0,this.v={},this.F=0,this.J={},this.L=this.f=this.j=this.T=0,this.b=[0,0,0,0,0,0,0,0],this.g=[0,0,0,0],this.C=void 0,this.D=e,this.s=!1,this.B={progress:{},seeded:{}},this.m=this.S=0,this.w=1,this.A=2,this.O=65536,this.I=[0,48,64,96,128,192,256,384,512,768,1024],this.P=3e4,this.N=80},i.prng.prototype={randomWords:function(e,t){var n,r,o=[];if((n=this.isReady(t))===this.m)throw new i.exception.notReady("generator isn't seeded");if(n&this.A){n=!(n&this.w);var a,s=0;for(this.L=(r=[])[0]=(new Date).valueOf()+this.P,a=0;16>a;a++)r.push(4294967296*Math.random()|0);for(a=0;a<this.c.length&&(r=r.concat(this.c[a].finalize()),s+=this.i[a],this.i[a]=0,n||!(this.H&1<<a));a++);for(this.H>=1<<this.c.length&&(this.c.push(new i.hash.sha256),this.i.push(0)),this.f-=s,s>this.j&&(this.j=s),this.H++,this.b=i.hash.sha256.hash(this.b.concat(r)),this.C=new i.cipher.aes(this.b),n=0;4>n&&(this.g[n]=this.g[n]+1|0,!this.g[n]);n++);}for(n=0;n<e;n+=4)0==(n+1)%this.O&&c(this),r=l(this),o.push(r[0],r[1],r[2],r[3]);return c(this),o.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw new i.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.D=e},addEntropy:function(e,t,n){n=n||"user";var r,o,s=(new Date).valueOf(),c=this.v[n],l=this.isReady(),d=0;switch(void 0===(r=this.J[n])&&(r=this.J[n]=this.T++),void 0===c&&(c=this.v[n]=0),this.v[n]=(this.v[n]+1)%this.c.length,typeof e){case"number":void 0===t&&(t=1),this.c[c].update([r,this.F++,1,t,s,1,0|e]);break;case"object":if("[object Uint32Array]"===(n=Object.prototype.toString.call(e))){for(o=[],n=0;n<e.length;n++)o.push(e[n]);e=o}else for("[object Array]"!==n&&(d=1),n=0;n<e.length&&!d;n++)"number"!=typeof e[n]&&(d=1);if(!d){if(void 0===t)for(n=t=0;n<e.length;n++)for(o=e[n];0<o;)t++,o>>>=1;this.c[c].update([r,this.F++,2,t,s,e.length].concat(e))}break;case"string":void 0===t&&(t=e.length),this.c[c].update([r,this.F++,3,t,s,e.length]),this.c[c].update(e);break;default:d=1}if(d)throw new i.exception.bug("random: addEntropy only supports number, array of numbers or string");this.i[c]+=t,this.f+=t,l===this.m&&(this.isReady()!==this.m&&a("seeded",Math.max(this.j,this.f)),a("progress",this.getProgress()))},isReady:function(e){return e=this.I[void 0!==e?e:this.D],this.j&&this.j>=e?this.i[0]>this.N&&(new Date).valueOf()>this.L?this.A|this.w:this.w:this.f>=e?this.A|this.m:this.m},getProgress:function(e){return this.j>=(e=this.I[e||this.D])||this.f>e?1:this.f/e},startCollectors:function(){if(!this.s){if(this.a={loadTimeCollector:d(this,this.V),mouseCollector:d(this,this.W),keyboardCollector:d(this,this.U),accelerometerCollector:d(this,this.R),touchCollector:d(this,this.X)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new i.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.s=!0}},stopCollectors:function(){this.s&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.s=!1)},addEventListener:function(e,t){this.B[e][this.S++]=t},removeEventListener:function(e,t){var n,i,r=this.B[e],o=[];for(i in r)r.hasOwnProperty(i)&&r[i]===t&&o.push(i);for(n=0;n<o.length;n++)delete r[i=o[n]]},U:function(){s(this,1)},W:function(e){var t,n;try{t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch(i){n=t=0}0!=t&&0!=n&&this.addEntropy([t,n],2,"mouse"),s(this,0)},X:function(e){this.addEntropy([(e=e.touches[0]||e.changedTouches[0]).pageX||e.clientX,e.pageY||e.clientY],1,"touch"),s(this,0)},V:function(){s(this,2)},R:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;"number"==typeof t&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),s(this,0)}},i.random=new i.prng(6);e:try{var u,p,_,f;if(f=void 0!==t&&t.exports){var h;try{h=e("crypto")}catch(m){h=null}f=p=h}if(f&&p.randomBytes)u=p.randomBytes(128),u=new Uint32Array(new Uint8Array(u).buffer),i.random.addEntropy(u,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(_=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(_);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break e;window.msCrypto.getRandomValues(_)}i.random.addEntropy(_,1024,"crypto['getRandomValues']")}}catch(m){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(m))}void 0!==t&&t.exports&&(t.exports=i)},{crypto:void 0}],75:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={GOOGLE_PAYMENT_NOT_ENABLED:{type:i.types.MERCHANT,code:"GOOGLE_PAYMENT_NOT_ENABLED",message:"Google Pay is not enabled for this merchant."},GOOGLE_PAYMENT_GATEWAY_ERROR:{code:"GOOGLE_PAYMENT_GATEWAY_ERROR",message:"There was an error when tokenizing the Google Pay payment method.",type:i.types.UNKNOWN},GOOGLE_PAYMENT_UNSUPPORTED_VERSION:{code:"GOOGLE_PAYMENT_UNSUPPORTED_VERSION",type:i.types.MERCHANT}}},{"../lib/braintree-error":98}],76:[function(e,t,n){"use strict";var i=e("../lib/analytics"),r=e("../lib/assign").assign,o=e("../lib/convert-methods-to-error"),a=e("../lib/find"),s=e("../lib/generate-google-pay-configuration"),c=e("../lib/braintree-error"),l=e("./errors"),d=e("../lib/methods"),u=e("../lib/promise"),p=e("@braintree/wrap-promise"),_={1:"_createV1PaymentDataRequest",2:"_createV2PaymentDataRequest"};function f(e){if(this._createPromise=e.createPromise,this._client=e.client,this._useDeferredClient=e.useDeferredClient,this._googlePayVersion=e.googlePayVersion||1,this._googleMerchantId=e.googleMerchantId,this._isUnsupportedGooglePayAPIVersion())throw new c({code:l.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.code,message:"The Braintree SDK does not support Google Pay version "+this._googlePayVersion+". Please upgrade the version of your Braintree SDK and contact support if this error persists.",type:l.GOOGLE_PAYMENT_UNSUPPORTED_VERSION.type})}f.prototype._waitForClient=function(){return this._client?u.resolve():this._createPromise.then((function(e){this._client=e}).bind(this))},f.prototype._isUnsupportedGooglePayAPIVersion=function(){return!(this._googlePayVersion in _)},f.prototype._getDefaultConfig=function(){return this._defaultConfig||(this._defaultConfig=s(this._client.getConfiguration(),this._googlePayVersion,this._googleMerchantId)),this._defaultConfig},f.prototype._createV1PaymentDataRequest=function(e){var t=this._getDefaultConfig(),n=e.cardRequirements&&e.cardRequirements.allowedCardNetworks||t.cardRequirements.allowedCardNetworks;return(e=r({},t,e)).cardRequirements.allowedCardNetworks=n,e},f.prototype._createV2PaymentDataRequest=function(e){var t=this._getDefaultConfig();return e.allowedPaymentMethods&&e.allowedPaymentMethods.forEach((function(e){var n=a(t.allowedPaymentMethods,"type",e.type);n&&function(e,t){Object.keys(t).forEach((function(n){e[n]="object"==typeof t[n]?r({},t[n],e[n]):e[n]||t[n]}))}(e,n)})),r({},t,e)},f.prototype.createPaymentDataRequest=function(e){return this._useDeferredClient?this._waitForClient().then((function(){return this._createPaymentDataRequestSyncronously(e)}).bind(this)):this._createPaymentDataRequestSyncronously(e)},f.prototype._createPaymentDataRequestSyncronously=function(e){var t=r({},e),n=this._googlePayVersion,o=_[n];return i.sendEvent(this._createPromise,"google-payment.v"+n+".createPaymentDataRequest"),this[o](t)},f.prototype.parseResponse=function(e){var t=this;return u.resolve().then((function(){var n,r=JSON.parse(2===e.apiVersion?e.paymentMethodData.tokenizationData.token:e.paymentMethodToken.token),o=r.error;return o?u.reject(o):(i.sendEvent(t._createPromise,"google-payment.parseResponse.succeeded"),r.paypalAccounts?(n=r.paypalAccounts[0],i.sendEvent(t._createPromise,"google-payment.parseResponse.succeeded.paypal"),u.resolve({nonce:n.nonce,type:n.type,description:n.description})):(n=r.androidPayCards[0],i.sendEvent(t._createPromise,"google-payment.parseResponse.succeeded.google-payment"),u.resolve({nonce:n.nonce,type:n.type,description:n.description,details:{cardType:n.details.cardType,lastFour:n.details.lastFour,lastTwo:n.details.lastTwo,isNetworkTokenized:n.details.isNetworkTokenized},binData:n.binData})))})).catch((function(e){return i.sendEvent(t._createPromise,"google-payment.parseResponse.failed"),u.reject(new c({code:l.GOOGLE_PAYMENT_GATEWAY_ERROR.code,message:l.GOOGLE_PAYMENT_GATEWAY_ERROR.message,type:l.GOOGLE_PAYMENT_GATEWAY_ERROR.type,details:{originalError:e}}))}))},f.prototype.teardown=function(){return o(this,d(f.prototype)),u.resolve()},t.exports=p.wrapPrototype(f)},{"../lib/analytics":93,"../lib/assign":95,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/find":113,"../lib/generate-google-pay-configuration":125,"../lib/methods":130,"../lib/promise":132,"./errors":75,"@braintree/wrap-promise":30}],77:[function(e,t,n){"use strict";var i=e("./google-payment"),r=e("../lib/braintree-error"),o=e("../lib/promise"),a=e("../lib/create-assets-url"),s=e("../lib/create-deferred-client"),c=e("../lib/basic-component-verification"),l=e("@braintree/wrap-promise"),d=e("./errors");t.exports={create:l((function(e){return c.verify({name:"Google Pay",client:e.client,authorization:e.authorization}).then((function(){var t,n;return t=s.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:"Google Pay"}).then((function(t){var n=t.getConfiguration();return e.client=t,n.gatewayConfiguration.androidPay?t:o.reject(new r(d.GOOGLE_PAYMENT_NOT_ENABLED))})),e.createPromise=t,n=new i(e),e.useDeferredClient?n:t.then((function(e){return n._client=e,n}))}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./errors":75,"./google-payment":76,"@braintree/wrap-promise":30}],78:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error"),r=e("../shared/errors"),o=e("../shared/constants").allowedAttributes;t.exports=function(e,t){var n;return o.hasOwnProperty(e)?null==t||function(e,t){return"string"===o[e]?"string"==typeof t||"number"==typeof t:"boolean"===o[e]&&("true"===String(t)||"false"===String(t))}(e,t)||(n=new i({type:r.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.type,code:r.HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED.code,message:'Value "'+t+'" is not allowed for "'+e+'" attribute.'})):n=new i({type:r.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.type,code:r.HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED.code,message:'The "'+e+'" attribute is not supported in Hosted Fields.'}),n}},{"../../lib/braintree-error":98,"../shared/constants":86,"../shared/errors":87}],79:[function(e,t,n){"use strict";var i=e("../shared/constants"),r=e("../../lib/use-min");t.exports=function(e,t,n){return e+"/web/"+i.VERSION+"/html/hosted-fields-frame"+r(n)+".html#"+t}},{"../../lib/use-min":134,"../shared/constants":86}],80:[function(e,t,n){"use strict";var i=e("../shared/constants").navigationDirections,r=e("../shared/browser-detection"),o=e("../shared/focus-intercept"),a=e("../shared/find-parent-tags"),s=["INPUT","SELECT","TEXTAREA"],c=["hidden","button","reset","submit","checkbox","radio","file"];function l(e){return r.hasSoftwareKeyboard()?s.indexOf(e.tagName)>-1&&c.indexOf(e.type)<0:"hidden"!==e.type}function d(e){var t,n;for(t=0;t<e.length;t++)if(l(n=e[t]))return n;return null}t.exports={removeExtraFocusElements:function(e,t){var n=Array.prototype.slice.call(e.elements);[d(n),d(n.reverse())].forEach((function(e){e&&o.matchFocusElement(e.getAttribute("id"))&&t(e.getAttribute("id"))}))},createFocusChangeHandler:function(e){return function(t,n){var r,s,c,d,u=document.getElementById("bt-"+t+"-"+n);if(u)if(c=a(u,"form")[0],document.forms.length<1||!c)e.onRemoveFocusIntercepts();else{r=(c=[].slice.call(c.elements)).indexOf(u),d=function(e,t){switch(e){case i.BACK:return{checkIndexBounds:function(e){return e<0},indexChange:-1};case i.FORWARD:return{checkIndexBounds:function(e){return e>t-1},indexChange:1}}return{}}(n,c.length);do{if(d.checkIndexBounds(r+=d.indexChange))return;s=c[r]}while(!l(s));o.matchFocusElement(s.getAttribute("id"))?e.onTriggerInputFocus(s.getAttribute("data-braintree-type")):s.focus()}}}}},{"../shared/browser-detection":85,"../shared/constants":86,"../shared/find-parent-tags":88,"../shared/focus-intercept":89}],81:[function(e,t,n){"use strict";var i=e("../shared/constants").allowedStyles;t.exports=function(e){var t,n=document.createElement("input"),r={};return"."===e[0]&&(e=e.substring(1)),n.className=e,n.style.display="none !important",n.style.position="fixed !important",n.style.left="-99999px !important",n.style.top="-99999px !important",document.body.appendChild(n),t=window.getComputedStyle(n),i.forEach((function(e){var n=t[e];n&&(r[e]=n)})),document.body.removeChild(n),r}},{"../shared/constants":86}],82:[function(e,t,n){(function(n){"use strict";var i=e("../../lib/assign").assign,r=e("../../lib/create-assets-url"),o=e("../../lib/destructor"),a=e("@braintree/class-list"),s=e("@braintree/iframer"),c=e("../../lib/bus"),l=e("../../lib/create-deferred-client"),d=e("../../lib/braintree-error"),u=e("./compose-url"),p=e("./get-styles-from-class"),_=e("../shared/constants"),f=e("../shared/errors"),h=e("../../lib/constants").INTEGRATION_TIMEOUT_MS,m=e("../../lib/vendor/uuid"),E=e("../shared/find-parent-tags"),b=e("../shared/browser-detection"),y=_.events,g=e("@braintree/event-emitter"),v=e("./inject-frame"),A=e("../../lib/analytics"),T=_.allowedFields,I=e("../../lib/methods"),N=e("../../lib/convert-methods-to-error"),P=e("../../lib/errors"),O=e("../shared/get-card-types"),R=e("./attribute-validation-error"),S=e("../../lib/promise"),C=e("@braintree/wrap-promise"),w=e("./focus-change"),D=e("../shared/focus-intercept").destroy;function L(e){var t,E,T,R,C,k=this,M={},U={},F=[],x=m();if(this._merchantConfigurationOptions=i({},e),e.client?(T=(E=e.client.getConfiguration()).gatewayConfiguration.assetsUrl,R=E.isDebug):(T=r.create(e.authorization),R=Boolean(e.isDebug)),this._clientPromise=l.create({client:e.client,authorization:e.authorization,debug:R,assetsUrl:T,name:"Hosted Fields"}),C=u(T,x,R),!e.fields||0===Object.keys(e.fields).length)throw new d({type:P.INSTANTIATION_OPTION_REQUIRED.type,code:P.INSTANTIATION_OPTION_REQUIRED.code,message:"options.fields is required when instantiating Hosted Fields."});g.call(this),this._injectedNodes=[],this._destructor=new o,this._fields=M,this._state={fields:{},cards:O("")},this._bus=new c({channel:x,merchantUrl:location.href}),this._destructor.registerFunctionForTeardown((function(){k._bus.teardown()})),A.sendEvent(this._clientPromise,e.client?"custom.hosted-fields.initialized":"custom.hosted-fields.initialized.deferred-client"),Object.keys(e.fields).forEach((function(t){var n,i,r,o;if(!_.allowedFields.hasOwnProperty(t))throw new d({type:f.HOSTED_FIELDS_INVALID_FIELD_KEY.type,code:f.HOSTED_FIELDS_INVALID_FIELD_KEY.code,message:'"'+t+'" is not a valid field.'});if("string"==typeof(i=(n=e.fields[t]).container||n.selector)&&(i=document.querySelector(i)),!i||1!==i.nodeType)throw new d({type:f.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.type,code:f.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.code,message:f.HOSTED_FIELDS_INVALID_FIELD_SELECTOR.message,details:{fieldSelector:n.selector,fieldContainer:n.container,fieldKey:t}});if(i.querySelector('iframe[name^="braintree-"]'))throw new d({type:f.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.type,code:f.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.code,message:f.HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME.message,details:{fieldSelector:n.selector,fieldContainer:n.container,fieldKey:t}});if(n.maxlength&&"number"!=typeof n.maxlength)throw new d({type:f.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:f.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:"The value for maxlength must be a number.",details:{fieldKey:t}});if(n.minlength&&"number"!=typeof n.minlength)throw new d({type:f.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:f.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:"The value for minlength must be a number.",details:{fieldKey:t}});r=s({type:t,name:"braintree-hosted-field-"+t,style:_.defaultIFrameStyle,title:"Secure Credit Card Frame - "+_.allowedFields[t].label}),this._injectedNodes.push.apply(this._injectedNodes,v(r,i,(function(){k._bus.emit(y.TRIGGER_INPUT_FOCUS,t)}))),this._setupLabelFocus(t,i),M[t]={frameElement:r,containerElement:i},o=new S((function(e){U[t]=e})),F.push(o),this._state.fields[t]={isEmpty:!0,isValid:!1,isPotentiallyValid:!0,isFocused:!1,container:i},setTimeout((function(){b.isIE()||b.isEdge()?(r.src="about:blank",setTimeout((function(){r.src=C}),0)):r.src=C}),0)}).bind(this)),this._merchantConfigurationOptions.styles&&Object.keys(this._merchantConfigurationOptions.styles).forEach((function(e){var t=k._merchantConfigurationOptions.styles[e];"string"==typeof t&&(k._merchantConfigurationOptions.styles[e]=p(t))})),this._bus.on(y.REMOVE_FOCUS_INTERCEPTS,D),this._bus.on(y.TRIGGER_FOCUS_CHANGE,w.createFocusChangeHandler({onRemoveFocusIntercepts:function(e){k._bus.emit(y.REMOVE_FOCUS_INTERCEPTS,e)},onTriggerInputFocus:function(e){k._bus.emit(y.TRIGGER_INPUT_FOCUS,e)}})),this._bus.on(y.READY_FOR_CLIENT,(function(e){k._clientPromise.then((function(t){e(t)}))})),this._bus.on(y.CARD_FORM_ENTRY_HAS_BEGUN,(function(){A.sendEvent(k._clientPromise,"hosted-fields.input.started")})),this._bus.on(y.BIN_AVAILABLE,(function(e){k._emit("binAvailable",{bin:e})})),t=setTimeout((function(){A.sendEvent(k._clientPromise,"custom.hosted-fields.load.timed-out"),k._emit("timeout")}),h),S.all(F).then((function(e){var n,r=e[0];clearTimeout(t),r(((n=i({},k._merchantConfigurationOptions)).fields=i({},n.fields),Object.keys(n.fields).forEach((function(e){n.fields[e]=i({},n.fields[e]),delete n.fields[e].container})),n)),k._cleanUpFocusIntercepts(),k._emit("ready")})),this._bus.on(y.FRAME_READY,(function(e,t){U[e.field](t)})),this._bus.on(y.INPUT_EVENT,function(e){return function(t){var n,i=t.merchantPayload,r=i.emittedBy,o=e[r].containerElement;Object.keys(i.fields).forEach((function(t){i.fields[t].container=e[t].containerElement})),n=i.fields[r],"blur"===t.type&&function(e){var t;b.isIos()&&document.activeElement===document.body&&((t=e.querySelector("input"))||((t=document.createElement("input")).type="button",t.style.height="0px",t.style.width="0px",t.style.opacity="0",t.style.padding="0",t.style.position="absolute",t.style.left="-200%",t.style.top="0px",e.insertBefore(t,e.firstChild)),t.focus(),t.blur())}(o),a.toggle(o,_.externalClasses.FOCUSED,n.isFocused),a.toggle(o,_.externalClasses.VALID,n.isValid),a.toggle(o,_.externalClasses.INVALID,!n.isPotentiallyValid),this._state={cards:i.cards,fields:i.fields},this._emit(t.type,i)}}(M).bind(this)),b.isIos()&&this._bus.on(y.TRIGGER_INPUT_FOCUS,(function(e){var t=M[e].containerElement;setTimeout((function(){var e,i,r;e=t.getBoundingClientRect(),i=Math.floor(e.height/2),r=Math.floor(e.width/2),e.top<(n.innerHeight-i||document.documentElement.clientHeight-i)&&e.right>r&&e.bottom>i&&e.left<(n.innerWidth-r||document.documentElement.clientWidth-r)||t.scrollIntoView()}),5)})),this._destructor.registerFunctionForTeardown((function(){var e,t,n;for(e=0;e<k._injectedNodes.length;e++)(n=(t=k._injectedNodes[e]).parentNode).removeChild(t),a.remove(n,_.externalClasses.FOCUSED,_.externalClasses.INVALID,_.externalClasses.VALID)})),this._destructor.registerFunctionForTeardown((function(){D()})),this._destructor.registerFunctionForTeardown((function(){var e=I(L.prototype).concat(I(g.prototype));N(k,e)}))}g.createChild(L),L.prototype._setupLabelFocus=function(e,t){var n,i,r=b.isIos(),o=this._bus;if(!r&&null!=t.id){for(n=(n=Array.prototype.slice.call(document.querySelectorAll('label[for="'+t.id+'"]'))).concat(E(t,"label")),i=0;i<n.length;i++)n[i].addEventListener("click",a,!1);this._destructor.registerFunctionForTeardown((function(){for(i=0;i<n.length;i++)n[i].removeEventListener("click",a,!1)}))}function a(){o.emit(y.TRIGGER_INPUT_FOCUS,e)}},L.prototype._getAnyFieldContainer=function(){var e=this;return Object.keys(this._fields).reduce((function(t,n){return t||e._fields[n].containerElement}),null)},L.prototype._cleanUpFocusIntercepts=function(){var e,t;document.forms.length<1?this._bus.emit(y.REMOVE_FOCUS_INTERCEPTS):(e=this._getAnyFieldContainer(),(t=E(e,"form")[0])?w.removeExtraFocusElements(t,(function(e){this._bus.emit(y.REMOVE_FOCUS_INTERCEPTS,e)}).bind(this)):this._bus.emit(y.REMOVE_FOCUS_INTERCEPTS))},L.prototype._attachInvalidFieldContainersToError=function(e){e.details&&e.details.invalidFieldKeys&&e.details.invalidFieldKeys.length>0&&(e.details.invalidFields={},e.details.invalidFieldKeys.forEach((function(t){e.details.invalidFields[t]=this._fields[t].containerElement}).bind(this)))},L.prototype.getChallenges=function(){return this._clientPromise.then((function(e){return e.getConfiguration().gatewayConfiguration.challenges}))},L.prototype.getSupportedCardTypes=function(){return this._clientPromise.then((function(e){return e.getConfiguration().gatewayConfiguration.creditCards.supportedCardTypes.map((function(e){return"MasterCard"===e?"Mastercard":e}))}))},L.prototype.teardown=function(){var e=this;return new S((function(t,n){e._destructor.teardown((function(i){A.sendEvent(e._clientPromise,"custom.hosted-fields.teardown-completed"),i?n(i):t()}))}))},L.prototype.tokenize=function(e){var t=this;return e||(e={}),new S((function(n,i){t._bus.emit(y.TOKENIZATION_REQUEST,e,(function(e){var r=e[0],o=e[1];r?(t._attachInvalidFieldContainersToError(r),i(new d(r))):n(o)}))}))},L.prototype.addClass=function(e,t){var n;return T.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(y.ADD_CLASS,e,t):n=new d({type:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot add class to "'+e+'" field because it is not part of the current Hosted Fields options.'}):n=new d({type:f.HOSTED_FIELDS_FIELD_INVALID.type,code:f.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when adding a class.'}),n?S.reject(n):S.resolve()},L.prototype.removeClass=function(e,t){var n;return T.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(y.REMOVE_CLASS,e,t):n=new d({type:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove class from "'+e+'" field because it is not part of the current Hosted Fields options.'}):n=new d({type:f.HOSTED_FIELDS_FIELD_INVALID.type,code:f.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when removing a class.'}),n?S.reject(n):S.resolve()},L.prototype.setAttribute=function(e){var t,n;return T.hasOwnProperty(e.field)?this._fields.hasOwnProperty(e.field)?(t=R(e.attribute,e.value))?n=t:this._bus.emit(y.SET_ATTRIBUTE,e.field,e.attribute,e.value):n=new d({type:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot set attribute for "'+e.field+'" field because it is not part of the current Hosted Fields options.'}):n=new d({type:f.HOSTED_FIELDS_FIELD_INVALID.type,code:f.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e.field+'" is not a valid field. You must use a valid field option when setting an attribute.'}),n?S.reject(n):S.resolve()},L.prototype.setMonthOptions=function(e){var t,n=this,i=this._merchantConfigurationOptions.fields;return i.expirationMonth?i.expirationMonth.select||(t="Expiration month field must be a select element."):t="Expiration month field must exist to use setMonthOptions.",t?S.reject(new d({type:f.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.type,code:f.HOSTED_FIELDS_FIELD_PROPERTY_INVALID.code,message:t})):new S((function(t){n._bus.emit(y.SET_MONTH_OPTIONS,e,t)}))},L.prototype.setMessage=function(e){this._bus.emit(y.SET_MESSAGE,e.field,e.message)},L.prototype.removeAttribute=function(e){var t,n;return T.hasOwnProperty(e.field)?this._fields.hasOwnProperty(e.field)?(t=R(e.attribute))?n=t:this._bus.emit(y.REMOVE_ATTRIBUTE,e.field,e.attribute):n=new d({type:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot remove attribute for "'+e.field+'" field because it is not part of the current Hosted Fields options.'}):n=new d({type:f.HOSTED_FIELDS_FIELD_INVALID.type,code:f.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e.field+'" is not a valid field. You must use a valid field option when removing an attribute.'}),n?S.reject(n):S.resolve()},L.prototype.setPlaceholder=function(e,t){return this.setAttribute({field:e,attribute:"placeholder",value:t})},L.prototype.clear=function(e){var t;return T.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(y.CLEAR_FIELD,e):t=new d({type:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot clear "'+e+'" field because it is not part of the current Hosted Fields options.'}):t=new d({type:f.HOSTED_FIELDS_FIELD_INVALID.type,code:f.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when clearing a field.'}),t?S.reject(t):S.resolve()},L.prototype.focus=function(e){var t;return T.hasOwnProperty(e)?this._fields.hasOwnProperty(e)?this._bus.emit(y.TRIGGER_INPUT_FOCUS,e):t=new d({type:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.type,code:f.HOSTED_FIELDS_FIELD_NOT_PRESENT.code,message:'Cannot focus "'+e+'" field because it is not part of the current Hosted Fields options.'}):t=new d({type:f.HOSTED_FIELDS_FIELD_INVALID.type,code:f.HOSTED_FIELDS_FIELD_INVALID.code,message:'"'+e+'" is not a valid field. You must use a valid field option when focusing a field.'}),t?S.reject(t):S.resolve()},L.prototype.getState=function(){return this._state},t.exports=C.wrapPrototype(L)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../lib/analytics":93,"../../lib/assign":95,"../../lib/braintree-error":98,"../../lib/bus":101,"../../lib/constants":103,"../../lib/convert-methods-to-error":104,"../../lib/create-assets-url":106,"../../lib/create-deferred-client":108,"../../lib/destructor":110,"../../lib/errors":112,"../../lib/methods":130,"../../lib/promise":132,"../../lib/vendor/uuid":136,"../shared/browser-detection":85,"../shared/constants":86,"../shared/errors":87,"../shared/find-parent-tags":88,"../shared/focus-intercept":89,"../shared/get-card-types":90,"./attribute-validation-error":78,"./compose-url":79,"./focus-change":80,"./get-styles-from-class":81,"./inject-frame":83,"@braintree/class-list":20,"@braintree/event-emitter":21,"@braintree/iframer":23,"@braintree/wrap-promise":30}],83:[function(e,t,n){"use strict";var i=e("../shared/focus-intercept"),r=e("../shared/constants").navigationDirections;t.exports=function(e,t,n){var o=e.getAttribute("type"),a=document.createElement("div"),s=document.createDocumentFragment(),c=i.generate(o,r.BACK,n),l=i.generate(o,r.FORWARD,n);return a.style.clear="both",s.appendChild(c),s.appendChild(e),s.appendChild(l),s.appendChild(a),t.appendChild(s),[e,a]}},{"../shared/constants":86,"../shared/focus-intercept":89}],84:[function(e,t,n){"use strict";var i=e("./external/hosted-fields"),r=e("../lib/basic-component-verification"),o=e("./shared/errors"),a=e("restricted-input/supports-input-formatting"),s=e("@braintree/wrap-promise"),c=e("../lib/braintree-error"),l=e("../lib/promise");t.exports={supportsInputFormatting:a,create:s((function(e){return r.verify({name:"Hosted Fields",authorization:e.authorization,client:e.client}).then((function(){var t=new i(e);return new l((function(e,n){t.on("ready",(function(){e(t)})),t.on("timeout",(function(){n(new c(o.HOSTED_FIELDS_TIMEOUT))}))}))}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/promise":132,"./external/hosted-fields":82,"./shared/errors":87,"@braintree/wrap-promise":30,"restricted-input/supports-input-formatting":41}],85:[function(e,t,n){"use strict";var i=e("@braintree/browser-detection/is-android"),r=e("@braintree/browser-detection/is-chrome-os"),o=e("@braintree/browser-detection/is-ios");t.exports={isIE:e("@braintree/browser-detection/is-ie"),isEdge:e("@braintree/browser-detection/is-edge"),isIe9:e("@braintree/browser-detection/is-ie9"),isIe10:e("@braintree/browser-detection/is-ie10"),isAndroid:i,isChromeOS:r,isFirefox:e("@braintree/browser-detection/is-firefox"),isIos:o,isIosWebview:e("@braintree/browser-detection/is-ios-webview"),hasSoftwareKeyboard:function(){return i()||r()||o()}}},{"@braintree/browser-detection/is-android":3,"@braintree/browser-detection/is-chrome-os":4,"@braintree/browser-detection/is-edge":6,"@braintree/browser-detection/is-firefox":7,"@braintree/browser-detection/is-ie":8,"@braintree/browser-detection/is-ie10":9,"@braintree/browser-detection/is-ie9":11,"@braintree/browser-detection/is-ios":16,"@braintree/browser-detection/is-ios-webview":14}],86:[function(e,t,n){"use strict";var i=e("../../lib/enumerate"),r=e("./errors"),o={VERSION:"3.60.0",maxExpirationYearAge:19,externalEvents:{FOCUS:"focus",BLUR:"blur",EMPTY:"empty",NOT_EMPTY:"notEmpty",VALIDITY_CHANGE:"validityChange",CARD_TYPE_CHANGE:"cardTypeChange"},defaultMaxLengths:{number:19,postalCode:8,expirationDate:7,expirationMonth:2,expirationYear:4,cvv:3},externalClasses:{FOCUSED:"braintree-hosted-fields-focused",INVALID:"braintree-hosted-fields-invalid",VALID:"braintree-hosted-fields-valid"},navigationDirections:{BACK:"before",FORWARD:"after"},defaultIFrameStyle:{border:"none",width:"100%",height:"100%",float:"left"},tokenizationErrorCodes:{81724:r.HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE,81736:r.HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED},allowedStyles:["-moz-appearance","-moz-osx-font-smoothing","-moz-tap-highlight-color","-moz-transition","-webkit-appearance","-webkit-font-smoothing","-webkit-tap-highlight-color","-webkit-transition","appearance","color","direction","font","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-weight","letter-spacing","line-height","margin","opacity","outline","padding","text-shadow","transition"],allowedFields:{number:{name:"credit-card-number",label:"Credit Card Number"},cvv:{name:"cvv",label:"CVV"},expirationDate:{name:"expiration",label:"Expiration Date"},expirationMonth:{name:"expiration-month",label:"Expiration Month"},expirationYear:{name:"expiration-year",label:"Expiration Year"},postalCode:{name:"postal-code",label:"Postal Code"}},allowedAttributes:{"aria-invalid":"boolean","aria-required":"boolean",disabled:"boolean",placeholder:"string"},autocompleteMappings:{"credit-card-number":"cc-number",expiration:"cc-exp","expiration-month":"cc-exp-month","expiration-year":"cc-exp-year",cvv:"cc-csc","postal-code":"billing postal-code"}};o.events=i(["ADD_CLASS","AUTOFILL_EXPIRATION_DATE","BIN_AVAILABLE","CARD_FORM_ENTRY_HAS_BEGUN","CLEAR_FIELD","CONFIGURATION","FRAME_READY","INPUT_EVENT","READY_FOR_CLIENT","REMOVE_ATTRIBUTE","REMOVE_CLASS","REMOVE_FOCUS_INTERCEPTS","SET_ATTRIBUTE","SET_MESSAGE","SET_MONTH_OPTIONS","TOKENIZATION_REQUEST","TRIGGER_FOCUS_CHANGE","TRIGGER_INPUT_FOCUS","VALIDATE_STRICT"],"hosted-fields:"),t.exports=o},{"../../lib/enumerate":111,"./errors":87}],87:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={HOSTED_FIELDS_TIMEOUT:{type:i.types.UNKNOWN,code:"HOSTED_FIELDS_TIMEOUT",message:"Hosted Fields timed out when attempting to set up."},HOSTED_FIELDS_INVALID_FIELD_KEY:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_INVALID_FIELD_KEY"},HOSTED_FIELDS_INVALID_FIELD_SELECTOR:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_INVALID_FIELD_SELECTOR",message:"Selector does not reference a valid DOM node."},HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_DUPLICATE_IFRAME",message:"Element already contains a Braintree iframe."},HOSTED_FIELDS_FIELD_INVALID:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_INVALID"},HOSTED_FIELDS_FIELD_NOT_PRESENT:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_NOT_PRESENT"},HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR:{type:i.types.NETWORK,code:"HOSTED_FIELDS_TOKENIZATION_NETWORK_ERROR",message:"A tokenization network error occurred."},HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE:{type:i.types.CUSTOMER,code:"HOSTED_FIELDS_TOKENIZATION_FAIL_ON_DUPLICATE",message:"This credit card already exists in the merchant's vault."},HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED:{type:i.types.CUSTOMER,code:"HOSTED_FIELDS_TOKENIZATION_CVV_VERIFICATION_FAILED",message:"CVV verification failed during tokenization."},HOSTED_FIELDS_FAILED_TOKENIZATION:{type:i.types.CUSTOMER,code:"HOSTED_FIELDS_FAILED_TOKENIZATION",message:"The supplied card data failed tokenization."},HOSTED_FIELDS_FIELDS_EMPTY:{type:i.types.CUSTOMER,code:"HOSTED_FIELDS_FIELDS_EMPTY",message:"All fields are empty. Cannot tokenize empty card fields."},HOSTED_FIELDS_FIELDS_INVALID:{type:i.types.CUSTOMER,code:"HOSTED_FIELDS_FIELDS_INVALID",message:"Some payment input fields are invalid. Cannot tokenize invalid card fields."},HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_ATTRIBUTE_NOT_SUPPORTED"},HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_ATTRIBUTE_VALUE_NOT_ALLOWED"},HOSTED_FIELDS_FIELD_PROPERTY_INVALID:{type:i.types.MERCHANT,code:"HOSTED_FIELDS_FIELD_PROPERTY_INVALID"}}},{"../../lib/braintree-error":98}],88:[function(e,t,n){"use strict";t.exports=function(e,t){for(var n=e.parentNode,i=[];null!=n;)null!=n.tagName&&n.tagName.toLowerCase()===t&&i.push(n),n=n.parentNode;return i}},{}],89:[function(e,t,n){"use strict";var i=e("./browser-detection"),r=e("@braintree/class-list"),o=e("./constants"),a=Object.keys(o.allowedFields),s=o.navigationDirections,c={generate:function(e,t,n){var o=document.createElement("input");return i.hasSoftwareKeyboard()||i.isFirefox()||i.isIE()?(o.setAttribute("aria-hidden","true"),o.setAttribute("autocomplete","off"),o.setAttribute("data-braintree-direction",t),o.setAttribute("data-braintree-type",e),o.setAttribute("id","bt-"+e+"-"+t),o.setAttribute("style",JSON.stringify({border:"none !important",display:"block !important",height:"1px !important",left:"-1px !important",opacity:"0 !important",position:"absolute !important",top:"-1px !important",width:"1px !important"}).replace(/[{}"]/g,"").replace(/,/g,";")),r.add(o,"focus-intercept"),o.addEventListener("focus",(function(e){n(e),i.hasSoftwareKeyboard()||o.blur()})),o):document.createDocumentFragment()},destroy:function(e){var t;e?t=[document.getElementById(e)]:(t=document.querySelectorAll("[data-braintree-direction]"),t=[].slice.call(t)),t.forEach((function(e){e&&1===e.nodeType&&c.matchFocusElement(e.getAttribute("id"))&&e.parentNode.removeChild(e)}))},matchFocusElement:function(e){var t,n,i;return!!e&&3===(t=e.split("-")).length&&(n="bt"===t[0],i=a.indexOf(t[1])>-1,Boolean(n&&i&&(t[2]===s.BACK||t[2]===s.FORWARD)))}};t.exports=c},{"./browser-detection":85,"./constants":86,"@braintree/class-list":20}],90:[function(e,t,n){"use strict";var i=e("credit-card-type");t.exports=function(e){var t=i(e);return t.forEach((function(e){"mastercard"===e.type&&(e.type="master-card")})),t}},{"credit-card-type":31}],91:[function(e,t,n){"use strict";var i=e("./american-express"),r=e("./apple-pay"),o=e("./client"),a=e("./data-collector"),s=e("./hosted-fields"),c=e("./local-payment"),l=e("./masterpass"),d=e("./payment-request"),u=e("./paypal"),p=e("./paypal-checkout"),_=e("./google-payment"),f=e("./three-d-secure"),h=e("./unionpay"),m=e("./us-bank-account"),E=e("./vault-manager"),b=e("./venmo"),y=e("./visa-checkout"),g=e("./preferred-payment-methods");t.exports={americanExpress:i,applePay:r,client:o,dataCollector:a,hostedFields:s,localPayment:c,masterpass:l,googlePayment:_,paymentRequest:d,paypal:u,paypalCheckout:p,threeDSecure:f,unionpay:h,usBankAccount:m,vaultManager:E,venmo:b,visaCheckout:y,preferredPaymentMethods:g,VERSION:"3.60.0"}},{"./american-express":44,"./apple-pay":47,"./client":53,"./data-collector":72,"./google-payment":77,"./hosted-fields":84,"./local-payment":139,"./masterpass":142,"./payment-request":147,"./paypal":154,"./paypal-checkout":151,"./preferred-payment-methods":157,"./three-d-secure":167,"./unionpay":171,"./us-bank-account":177,"./vault-manager":180,"./venmo":182,"./visa-checkout":189}],92:[function(e,t,n){"use strict";var i=e("./create-authorization-data"),r=e("./json-clone"),o=e("./constants");t.exports=function(e,t){var n,a=t?r(t):{},s=i(e.authorization).attrs,c=r(e.analyticsMetadata);for(n in a.braintreeLibraryVersion=o.BRAINTREE_LIBRARY_VERSION,a._meta)a._meta.hasOwnProperty(n)&&(c[n]=a._meta[n]);return a._meta=c,s.tokenizationKey?a.tokenizationKey=s.tokenizationKey:a.authorizationFingerprint=s.authorizationFingerprint,a}},{"./constants":103,"./create-authorization-data":107,"./json-clone":129}],93:[function(e,t,n){"use strict";var i=e("./promise"),r=e("./constants"),o=e("./add-metadata");t.exports={sendEvent:function(e,t,n){var a=Date.now();return i.resolve(e).then((function(e){var i=Date.now(),s=e.getConfiguration(),c=e._request,l=s.gatewayConfiguration.analytics.url,d={analytics:[{kind:r.ANALYTICS_PREFIX+t,isAsync:Math.floor(i/1e3)!==Math.floor(a/1e3),timestamp:a}]};c({url:l,method:"post",data:o(s,d),timeout:r.ANALYTICS_REQUEST_TIMEOUT_MS},n)}))}}},{"./add-metadata":92,"./constants":103,"./promise":132}],94:[function(e,t,n){"use strict";var i=e("@braintree/asset-loader/load-script");t.exports={loadScript:i}},{"@braintree/asset-loader/load-script":2}],95:[function(e,t,n){"use strict";function i(e){var t,n,i;for(t=1;t<arguments.length;t++)for(i in n=arguments[t])n.hasOwnProperty(i)&&(e[i]=n[i]);return e}t.exports={assign:"function"==typeof Object.assign?Object.assign:i,_assign:i}},{}],96:[function(e,t,n){"use strict";var i=e("./braintree-error"),r=e("./promise"),o=e("./errors");t.exports={verify:function(e){var t,n,a;return e?(a=e.name,n=e.authorization,(t=e.client)||n?n||"3.60.0"===t.getVersion()?r.resolve():r.reject(new i({type:o.INCOMPATIBLE_VERSIONS.type,code:o.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+t.getVersion()+") and "+a+" (version 3.60.0) components must be from the same SDK version."})):r.reject(new i({type:o.INSTANTIATION_OPTION_REQUIRED.type,code:o.INSTANTIATION_OPTION_REQUIRED.code,message:"options.client is required when instantiating "+a+"."}))):r.reject(new i({type:o.INVALID_USE_OF_INTERNAL_FUNCTION.type,code:o.INVALID_USE_OF_INTERNAL_FUNCTION.code,message:"Options must be passed to basicComponentVerification function."}))}}},{"./braintree-error":98,"./errors":112,"./promise":132}],97:[function(e,t,n){"use strict";var i=e("./once");function r(e,t){0===e.length?(e(),t(null)):e(t)}t.exports=function(e,t){var n,o=e.length,a=o,s=i(t);if(0!==o)for(n=0;n<o;n++)r(e[n],c);else s(null);function c(e){e?s(e):0==(a-=1)&&s(null)}}},{"./once":131}],98:[function(e,t,n){"use strict";var i=e("./enumerate");function r(e){if(!r.types.hasOwnProperty(e.type))throw new Error(e.type+" is not a valid type.");if(!e.code)throw new Error("Error code required.");if(!e.message)throw new Error("Error message required.");this.name="BraintreeError",this.code=e.code,this.message=e.message,this.type=e.type,this.details=e.details}(r.prototype=Object.create(Error.prototype)).constructor=r,r.types=i(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),r.findRootError=function(e){return e instanceof r&&e.details&&e.details.originalError?r.findRootError(e.details.originalError):e},t.exports=r},{"./enumerate":111}],99:[function(e,t,n){"use strict";var i=e("../is-verified-domain");t.exports={checkOrigin:function(e,t){var n,r=document.createElement("a");return r.href=t,n="https:"===r.protocol?r.host.replace(/:443$/,""):"http:"===r.protocol?r.host.replace(/:80$/,""):r.host,r.protocol+"//"+n===e||(r.href=e,i(e))}}},{"../is-verified-domain":128}],100:[function(e,t,n){"use strict";var i=e("../enumerate");t.exports=i(["CONFIGURATION_REQUEST"],"bus:")},{"../enumerate":111}],101:[function(e,t,n){"use strict";var i=e("framebus"),r=e("./events"),o=e("./check-origin").checkOrigin,a=e("../braintree-error");function s(e){if(this.channel=(e=e||{}).channel,!this.channel)throw new a({type:a.types.INTERNAL,code:"MISSING_CHANNEL_ID",message:"Channel ID must be specified."});this.merchantUrl=e.merchantUrl,this._isDestroyed=!1,this._isVerbose=!1,this._listeners=[],this._log("new bus on channel "+this.channel,[location.href])}s.prototype.on=function(e,t){var n,r,a=t,s=this;this._isDestroyed||(this.merchantUrl&&(a=function(){o(this.origin,s.merchantUrl)&&t.apply(this,arguments)}),n=this._namespaceEvent(e),(r=Array.prototype.slice.call(arguments))[0]=n,r[1]=a,this._log("on",r),i.on.apply(i,r),this._listeners.push({eventName:e,handler:a,originalHandler:t}))},s.prototype.emit=function(e){var t;this._isDestroyed||((t=Array.prototype.slice.call(arguments))[0]=this._namespaceEvent(e),this._log("emit",t),i.emit.apply(i,t))},s.prototype._offDirect=function(e){var t=Array.prototype.slice.call(arguments);this._isDestroyed||(t[0]=this._namespaceEvent(e),this._log("off",t),i.off.apply(i,t))},s.prototype.off=function(e,t){var n,i,r=t;if(!this._isDestroyed){if(this.merchantUrl)for(n=0;n<this._listeners.length;n++)(i=this._listeners[n]).originalHandler===t&&(r=i.handler);this._offDirect(e,r)}},s.prototype._namespaceEvent=function(e){return["braintree",this.channel,e].join(":")},s.prototype.teardown=function(){var e,t;for(t=0;t<this._listeners.length;t++)this._offDirect((e=this._listeners[t]).eventName,e.handler);this._listeners.length=0,this._isDestroyed=!0},s.prototype._log=function(e,t){this._isVerbose&&console.log(e,t)},s.events=r,t.exports=s},{"../braintree-error":98,"./check-origin":99,"./events":100,framebus:38}],102:[function(e,t,n){"use strict";t.exports=function(e){return Object.keys(e).reduce((function(t,n){return t[function(e){return e.replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1_$2").toLowerCase()}(n)]=e[n],t}),{})}},{}],103:[function(e,t,n){"use strict";t.exports={ANALYTICS_PREFIX:"web.",ANALYTICS_REQUEST_TIMEOUT_MS:2e3,ASSETS_URLS:{production:"https://assets.braintreegateway.com",sandbox:"https://assets.braintreegateway.com"},CLIENT_API_URLS:{production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"},FRAUDNET_SOURCE:"BRAINTREE_SIGNIN",FRAUDNET_FNCLS:"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99",FRAUDNET_URL:"https://c.paypal.com/da/r/fb.js",GRAPHQL_URLS:{production:"https://payments.braintree-api.com/graphql",sandbox:"https://payments.sandbox.braintree-api.com/graphql"},INTEGRATION_TIMEOUT_MS:6e4,VERSION:"3.60.0",INTEGRATION:"custom",SOURCE:"client",PLATFORM:"web",BRAINTREE_LIBRARY_VERSION:"braintree/web/3.60.0"}},{}],104:[function(e,t,n){"use strict";var i=e("./braintree-error"),r=e("./errors");t.exports=function(e,t){t.forEach((function(t){e[t]=function(){throw new i({type:r.METHOD_CALLED_AFTER_TEARDOWN.type,code:r.METHOD_CALLED_AFTER_TEARDOWN.code,message:t+" cannot be called after teardown."})}}))}},{"./braintree-error":98,"./errors":112}],105:[function(e,t,n){"use strict";var i=e("./braintree-error");t.exports=function(e,t){return e instanceof i?e:new i({type:t.type,code:t.code,message:t.message,details:{originalError:e}})}},{"./braintree-error":98}],106:[function(e,t,n){"use strict";var i=e("./constants").ASSETS_URLS;t.exports={create:function(e){return i.production}}},{"./constants":103}],107:[function(e,t,n){"use strict";var i=e("../lib/vendor/polyfill").atob,r=e("../lib/constants").CLIENT_API_URLS;t.exports=function(e){var t,n,o,a,s={attrs:{},configUrl:""};return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(e)?(a=(o=e.split("_"))[0],n={merchantId:o.slice(2).join("_"),environment:a},s.environment=n.environment,s.attrs.tokenizationKey=e,s.configUrl=r[n.environment]+"/merchants/"+n.merchantId+"/client_api/v1/configuration"):(t=JSON.parse(i(e)),s.environment=t.environment,s.attrs.authorizationFingerprint=t.authorizationFingerprint,s.configUrl=t.configUrl,s.graphQL=t.graphQL),s}},{"../lib/constants":103,"../lib/vendor/polyfill":135}],108:[function(e,t,n){(function(n){"use strict";var i=e("./braintree-error"),r=e("./promise"),o=e("./assets"),a=e("./errors");t.exports={create:function(e){var t=r.resolve();return e.client?r.resolve(e.client):(n.braintree&&n.braintree.client||(t=o.loadScript({src:e.assetsUrl+"/web/3.60.0/js/client.min.js"}).catch((function(e){return r.reject(new i({type:a.CLIENT_SCRIPT_FAILED_TO_LOAD.type,code:a.CLIENT_SCRIPT_FAILED_TO_LOAD.code,message:a.CLIENT_SCRIPT_FAILED_TO_LOAD.message,details:{originalError:e}}))}))),t.then((function(){return"3.60.0"!==n.braintree.client.VERSION?r.reject(new i({type:a.INCOMPATIBLE_VERSIONS.type,code:a.INCOMPATIBLE_VERSIONS.code,message:"Client (version "+n.braintree.client.VERSION+") and "+e.name+" (version 3.60.0) components must be from the same SDK version."})):n.braintree.client.create({authorization:e.authorization,debug:e.debug})})))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./assets":94,"./braintree-error":98,"./errors":112,"./promise":132}],109:[function(e,t,n){"use strict";t.exports=function(e){return function(){var t=arguments;setTimeout((function(){e.apply(null,t)}),1)}}},{}],110:[function(e,t,n){"use strict";var i=e("./batch-execute-functions");function r(){this._teardownRegistry=[],this._isTearingDown=!1}r.prototype.registerFunctionForTeardown=function(e){"function"==typeof e&&this._teardownRegistry.push(e)},r.prototype.teardown=function(e){this._isTearingDown?e(new Error("Destructor is already tearing down")):(this._isTearingDown=!0,i(this._teardownRegistry,(function(t){this._teardownRegistry=[],this._isTearingDown=!1,"function"==typeof e&&e(t)}).bind(this)))},t.exports=r},{"./batch-execute-functions":97}],111:[function(e,t,n){"use strict";t.exports=function(e,t){return t=null==t?"":t,e.reduce((function(e,n){return e[n]=t+n,e}),{})}},{}],112:[function(e,t,n){"use strict";var i=e("./braintree-error");t.exports={INVALID_USE_OF_INTERNAL_FUNCTION:{type:i.types.INTERNAL,code:"INVALID_USE_OF_INTERNAL_FUNCTION"},INSTANTIATION_OPTION_REQUIRED:{type:i.types.MERCHANT,code:"INSTANTIATION_OPTION_REQUIRED"},INCOMPATIBLE_VERSIONS:{type:i.types.MERCHANT,code:"INCOMPATIBLE_VERSIONS"},CLIENT_SCRIPT_FAILED_TO_LOAD:{type:i.types.NETWORK,code:"CLIENT_SCRIPT_FAILED_TO_LOAD",message:"Braintree client script could not be loaded."},METHOD_CALLED_AFTER_TEARDOWN:{type:i.types.MERCHANT,code:"METHOD_CALLED_AFTER_TEARDOWN"}}},{"./braintree-error":98}],113:[function(e,t,n){"use strict";t.exports=function(e,t,n){var i;for(i=0;i<e.length;i++)if(e[i].hasOwnProperty(t)&&e[i][t]===n)return e[i];return null}},{}],114:[function(e,t,n){(function(n){"use strict";var i=e("./strategies/popup"),r=e("./strategies/popup-bridge"),o=e("./strategies/modal"),a=e("../../bus"),s=e("../shared/events"),c=e("../shared/errors"),l=e("../shared/constants"),d=e("../../vendor/uuid"),u=e("@braintree/iframer"),p=e("../../braintree-error"),_=e("../shared/browser-detection"),f=e("../../is-https"),h=e("./../../assign").assign,m=["name","dispatchFrameUrl","openFrameUrl"];function E(){}function b(e){!function(e){if(!e)throw new Error("Valid configuration is required");if(m.forEach((function(t){if(!e.hasOwnProperty(t))throw new Error("A valid frame "+t+" must be provided")})),!/^[\w_]+$/.test(e.name))throw new Error("A valid frame name must be provided")}(e),this._serviceId=d().replace(/-/g,""),this._options={name:e.name+"_"+this._serviceId,dispatchFrameUrl:e.dispatchFrameUrl,openFrameUrl:e.openFrameUrl,height:e.height,width:e.width,top:e.top,left:e.left},this.state=e.state||{},this._bus=new a({channel:this._serviceId}),this._setBusEvents()}b.prototype.initialize=function(e){var t=(function(){e(),this._bus.off(s.DISPATCH_FRAME_READY,t)}).bind(this);this._bus.on(s.DISPATCH_FRAME_READY,t),this._writeDispatchFrame()},b.prototype._writeDispatchFrame=function(){var e=l.DISPATCH_FRAME_NAME+"_"+this._serviceId;this._dispatchFrame=u({"aria-hidden":!0,name:e,title:e,src:this._options.dispatchFrameUrl,class:l.DISPATCH_FRAME_CLASS,height:0,width:0,style:{position:"absolute",left:"-9999px"}}),document.body.appendChild(this._dispatchFrame)},b.prototype._setBusEvents=function(){this._bus.on(s.DISPATCH_FRAME_REPORT,(function(e,t){this._onCompleteCallback&&this._onCompleteCallback.call(null,e.err,e.payload),this._frame.close(),this._onCompleteCallback=null,t&&t()}).bind(this)),this._bus.on(a.events.CONFIGURATION_REQUEST,(function(e){e(this.state)}).bind(this))},b.prototype.open=function(e,t){if(this._frame=this._getFrameForEnvironment(e=e||{}),this._frame.initialize(t),!(this._frame instanceof r)){if(h(this.state,e.state),this._onCompleteCallback=t,this._frame.open(),this.isFrameClosed())return this._cleanupFrame(),void(t&&t(_.isIE()&&!f.isHTTPS()?new p(c.FRAME_SERVICE_FRAME_OPEN_FAILED_IE_BUG):new p(c.FRAME_SERVICE_FRAME_OPEN_FAILED)));this._pollForPopupClose()}},b.prototype.redirect=function(e){this._frame&&!this.isFrameClosed()&&this._frame.redirect(e)},b.prototype.close=function(){this.isFrameClosed()||this._frame.close()},b.prototype.focus=function(){this.isFrameClosed()||this._frame.focus()},b.prototype.createHandler=function(e){return e=e||{},{close:(function(){e.beforeClose&&e.beforeClose(),this.close()}).bind(this),focus:(function(){e.beforeFocus&&e.beforeFocus(),this.focus()}).bind(this)}},b.prototype.createNoopHandler=function(){return{close:E,focus:E}},b.prototype.teardown=function(){this.close(),this._dispatchFrame.parentNode.removeChild(this._dispatchFrame),this._dispatchFrame=null,this._cleanupFrame()},b.prototype.isFrameClosed=function(){return null==this._frame||this._frame.isClosed()},b.prototype._cleanupFrame=function(){this._frame=null,clearInterval(this._popupInterval),this._popupInterval=null},b.prototype._pollForPopupClose=function(){return this._popupInterval=setInterval((function(){this.isFrameClosed()&&(this._cleanupFrame(),this._onCompleteCallback&&this._onCompleteCallback(new p(c.FRAME_SERVICE_FRAME_CLOSED)))}).bind(this),l.POPUP_POLL_INTERVAL),this._popupInterval},b.prototype._getFrameForEnvironment=function(e){var t=_.supportsPopups(),a=Boolean(n.popupBridge),s=h({},this._options,e);return a?new r(s):t?new i(s):new o(s)},t.exports=b}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../braintree-error":98,"../../bus":101,"../../is-https":127,"../../vendor/uuid":136,"../shared/browser-detection":121,"../shared/constants":122,"../shared/errors":123,"../shared/events":124,"./../../assign":95,"./strategies/modal":116,"./strategies/popup":119,"./strategies/popup-bridge":117,"@braintree/iframer":23}],115:[function(e,t,n){"use strict";var i=e("./frame-service");t.exports={create:function(e,t){var n=new i(e);n.initialize((function(){t(n)}))}}},{"./frame-service":114}],116:[function(e,t,n){(function(n){"use strict";var i=e("@braintree/iframer"),r=e("../../../assign").assign,o=e("../../shared/browser-detection"),a={position:"fixed",top:0,left:0,bottom:0,padding:0,margin:0,border:0,outline:"none",zIndex:20001,background:"#FFFFFF"};function s(){}function c(e){this._closed=null,this._frame=null,this._options=e||{},this._container=this._options.container||document.body}c.prototype.initialize=s,c.prototype.open=function(){var e={src:this._options.openFrameUrl,name:this._options.name,scrolling:"yes",height:"100%",width:"100%",style:r({},a),title:"Lightbox Frame"};o.isIos()?(o.isIosWKWebview()&&(this._lockScrolling(),e.style={}),this._el=document.createElement("div"),r(this._el.style,a,{height:"100%",width:"100%",overflow:"auto","-webkit-overflow-scrolling":"touch"}),this._frame=i(e),this._el.appendChild(this._frame)):this._el=this._frame=i(e),this._closed=!1,this._container.appendChild(this._el)},c.prototype.focus=s,c.prototype.close=function(){this._container.removeChild(this._el),this._frame=null,this._closed=!0,o.isIosWKWebview()&&this._unlockScrolling()},c.prototype.isClosed=function(){return Boolean(this._closed)},c.prototype.redirect=function(e){this._frame.src=e},c.prototype._unlockScrolling=function(){document.body.style.overflow=this._savedBodyProperties.overflowStyle,document.body.style.position=this._savedBodyProperties.positionStyle,n.scrollTo(this._savedBodyProperties.left,this._savedBodyProperties.top),delete this._savedBodyProperties},c.prototype._lockScrolling=function(){var e=document.documentElement;this._savedBodyProperties={left:(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0),top:(n.pageYOffset||e.scrollTop)-(e.clientTop||0),overflowStyle:document.body.style.overflow,positionStyle:document.body.style.position},document.body.style.overflow="hidden",document.body.style.position="fixed",n.scrollTo(0,0)},t.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../assign":95,"../../shared/browser-detection":121,"@braintree/iframer":23}],117:[function(e,t,n){(function(n){"use strict";var i=e("../../../braintree-error"),r=e("../../shared/errors");function o(){}function a(e){this._closed=null,this._options=e}a.prototype.initialize=function(e){var t=this;n.popupBridge.onComplete=function(n,o){var a=!o&&!n;t._closed=!0,n||a?e(new i(r.FRAME_SERVICE_FRAME_CLOSED)):e(null,o)}},a.prototype.open=function(e){var t;t=(e=e||{}).openFrameUrl||this._options.openFrameUrl,this._closed=!1,n.popupBridge.open(t)},a.prototype.focus=o,a.prototype.close=o,a.prototype.isClosed=function(){return Boolean(this._closed)},a.prototype.redirect=function(e){this.open({openFrameUrl:e})},t.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../braintree-error":98,"../../shared/errors":123}],118:[function(e,t,n){"use strict";var i=e("../../../shared/constants"),r=e("./position");function o(e,t,n){return void 0!==t?t:r[e](n)}t.exports=function(e){var t=e.height||i.DEFAULT_POPUP_HEIGHT,n=e.width||i.DEFAULT_POPUP_WIDTH,r=o("top",e.top,t),a=o("left",e.left,n);return[i.POPUP_BASE_OPTIONS,"height="+t,"width="+n,"top="+r,"left="+a].join(",")}},{"../../../shared/constants":122,"./position":120}],119:[function(e,t,n){(function(n){"use strict";var i=e("./compose-options");function r(e){this._frame=null,this._options=e||{},this.open()}r.prototype.initialize=function(){},r.prototype.open=function(){this._frame=n.open(this._options.openFrameUrl,this._options.name,i(this._options))},r.prototype.focus=function(){this._frame.focus()},r.prototype.close=function(){this._frame.closed||this._frame.close()},r.prototype.isClosed=function(){return!this._frame||Boolean(this._frame.closed)},r.prototype.redirect=function(e){this._frame.location.href=e},t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./compose-options":118}],120:[function(e,t,n){(function(e){"use strict";function n(e,t,n){return(e-t)/2+n}t.exports={top:function(t){return n(e.outerHeight||document.documentElement.clientHeight,t,null==e.screenY?e.screenTop:e.screenY)},left:function(t){return n(e.outerWidth||document.documentElement.clientWidth,t,null==e.screenX?e.screenLeft:e.screenX)},center:n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],121:[function(e,t,n){"use strict";t.exports={isIos:e("@braintree/browser-detection/is-ios"),isIosWKWebview:e("@braintree/browser-detection/is-ios-wkwebview"),isIE:e("@braintree/browser-detection/is-ie"),supportsPopups:e("@braintree/browser-detection/supports-popups")}},{"@braintree/browser-detection/is-ie":8,"@braintree/browser-detection/is-ios":16,"@braintree/browser-detection/is-ios-wkwebview":15,"@braintree/browser-detection/supports-popups":19}],122:[function(e,t,n){"use strict";t.exports={DISPATCH_FRAME_NAME:"dispatch",DISPATCH_FRAME_CLASS:"braintree-dispatch-frame",POPUP_BASE_OPTIONS:"resizable,scrollbars",DEFAULT_POPUP_WIDTH:450,DEFAULT_POPUP_HEIGHT:535,POPUP_POLL_INTERVAL:100,POPUP_CLOSE_TIMEOUT:100}},{}],123:[function(e,t,n){"use strict";var i=e("../../braintree-error");t.exports={FRAME_SERVICE_FRAME_CLOSED:{type:i.types.INTERNAL,code:"FRAME_SERVICE_FRAME_CLOSED",message:"Frame closed before tokenization could occur."},FRAME_SERVICE_FRAME_OPEN_FAILED:{type:i.types.INTERNAL,code:"FRAME_SERVICE_FRAME_OPEN_FAILED",message:"Frame failed to open."},FRAME_SERVICE_FRAME_OPEN_FAILED_IE_BUG:{type:i.types.INTERNAL,code:"FRAME_SERVICE_FRAME_OPEN_FAILED_IE_BUG",message:"Could not open frame. This may be due to a bug in IE browsers when attempting to open an HTTPS page from a HTTP page. https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11324352/"}}},{"../../braintree-error":98}],124:[function(e,t,n){"use strict";var i=e("../../enumerate");t.exports=i(["DISPATCH_FRAME_READY","DISPATCH_FRAME_REPORT"],"frameService:")},{"../../enumerate":111}],125:[function(e,t,n){"use strict";var i=e("./assign").assign;function r(e,t){var n=e.analyticsMetadata,r={gateway:"braintree","braintree:merchantId":e.gatewayConfiguration.merchantId,"braintree:apiVersion":"v1","braintree:sdkVersion":"3.60.0","braintree:metadata":JSON.stringify({source:n.source,integration:n.integration,sessionId:n.sessionId,version:"3.60.0",platform:n.platform})};return i({},r,t)}t.exports=function(e,t,n){var i,o,a=e.gatewayConfiguration.androidPay,s="production"===e.gatewayConfiguration.environment?"PRODUCTION":"TEST";return 2===t?(i={apiVersion:2,apiVersionMinor:0,environment:s,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:a.supportedNetworks.map((function(e){return e.toUpperCase()}))},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:r(e,{"braintree:authorizationFingerprint":a.googleAuthorizationFingerprint})}}]},n&&(i.merchantInfo={merchantId:n}),a.paypalClientId&&(o={type:"PAYPAL",parameters:{purchase_context:{purchase_units:[{payee:{client_id:a.paypalClientId},recurring_payment:!0}]}},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:r(e,{"braintree:paypalClientId":a.paypalClientId})}},i.allowedPaymentMethods.push(o))):(i={environment:s,allowedPaymentMethods:["CARD","TOKENIZED_CARD"],paymentMethodTokenizationParameters:{tokenizationType:"PAYMENT_GATEWAY",parameters:r(e,{"braintree:authorizationFingerprint":a.googleAuthorizationFingerprint})},cardRequirements:{allowedCardNetworks:a.supportedNetworks.map((function(e){return e.toUpperCase()}))}},"TOKENIZATION_KEY"===e.authorizationType&&(i.paymentMethodTokenizationParameters.parameters["braintree:clientKey"]=e.authorization),n&&(i.merchantId=n),t&&(i.apiVersion=t)),i}},{"./assign":95}],126:[function(e,t,n){"use strict";function i(e){var t=e.split("-");return new Date(t[0],t[1],t[2])}t.exports=function(e,t){return i(e)<=i(t)}},{}],127:[function(e,t,n){(function(e){"use strict";t.exports={isHTTPS:function(t){return"https:"===(t||e.location.protocol)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],128:[function(e,t,n){"use strict";var i,r={"paypal.com":1,"braintreepayments.com":1,"braintreegateway.com":1,"braintree-api.com":1};t.exports=function(e){var t;return e=e.toLowerCase(),!!/^https:/.test(e)&&((i=i||document.createElement("a")).href=e,t=i.hostname.split(".").slice(-2).join("."),r.hasOwnProperty(t))}},{}],129:[function(e,t,n){"use strict";t.exports=function(e){return JSON.parse(JSON.stringify(e))}},{}],130:[function(e,t,n){"use strict";t.exports=function(e){return Object.keys(e).filter((function(t){return"function"==typeof e[t]}))}},{}],131:[function(e,t,n){arguments[4][28][0].apply(n,arguments)},{dup:28}],132:[function(e,t,n){(function(n){"use strict";var i=n.Promise||e("promise-polyfill"),r=e("@braintree/extended-promise");r.suppressUnhandledPromiseMessage=!0,r.setPromise(i),t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"@braintree/extended-promise":22,"promise-polyfill":39}],133:[function(e,t,n){(function(e){"use strict";function n(e,t){var i,r,o,a,s=[];for(o in e)e.hasOwnProperty(o)&&(r=e[o],i=t?(a=e)&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"===Object.prototype.toString.call(a)?t+"[]":t+"["+o+"]":o,s.push("object"==typeof r?n(r,i):encodeURIComponent(i)+"="+encodeURIComponent(r)));return s.join("&")}t.exports={parse:function(t){return/\?/.test(t=t||e.location.href)?t.replace(/#.*$/,"").replace(/^.*\?/,"").split("&").reduce((function(e,t){var n=t.split("="),i=decodeURIComponent(n[0]),r=decodeURIComponent(n[1]);return e[i]=r,e}),{}):{}},stringify:n,queryify:function(e,t){return e=e||"",null!=t&&"object"==typeof t&&function(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}(t)&&(e+=-1===e.indexOf("?")?"?":"",e+=-1!==e.indexOf("=")?"&":"",e+=n(t)),e}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],134:[function(e,t,n){"use strict";t.exports=function(e){return e?"":".min"}},{}],135:[function(e,t,n){(function(e){"use strict";var n="function"==typeof e.atob?e.atob:i;function i(e){var t,n,i,r,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";if(!new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$").test(e))throw new Error("Non base64 encoded input passed to window.atob polyfill");a=0;do{i=s.indexOf(e.charAt(a++)),t=(15&(r=s.indexOf(e.charAt(a++))))<<4|(o=s.indexOf(e.charAt(a++)))>>2&15,n=(3&o)<<6|63&s.indexOf(e.charAt(a++)),c+=String.fromCharCode((63&i)<<2|r>>4&3)+(t?String.fromCharCode(t):"")+(n?String.fromCharCode(n):"")}while(a<e.length);return c}t.exports={atob:function(t){return n.call(e,t)},_atob:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],136:[function(e,t,n){"use strict";t.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},{}],137:[function(e,t,n){"use strict";t.exports={REQUIRED_OPTIONS_FOR_START_PAYMENT:["onPaymentStart","paymentType","amount","fallback"]}},{}],138:[function(e,t,n){(function(n){"use strict";var i=e("../../lib/frame-service/external"),r=e("../../lib/braintree-error"),o=e("../../lib/use-min"),a=e("../../lib/constants").INTEGRATION_TIMEOUT_MS,s=e("../../lib/analytics"),c=e("../../lib/methods"),l=e("../../lib/convert-methods-to-error"),d=e("../../lib/convert-to-braintree-error"),u=e("../../lib/promise"),p=e("../../lib/querystring"),_=e("@braintree/wrap-promise"),f=e("./constants"),h=e("../shared/errors");function m(e){this._client=e.client,this._assetsUrl=e.client.getConfiguration().gatewayConfiguration.assetsUrl+"/web/3.60.0",this._isDebug=e.client.getConfiguration().isDebug,this._loadingFrameUrl=this._assetsUrl+"/html/local-payment-landing-frame"+o(this._isDebug)+".html",this._authorizationInProgress=!1,this._paymentType="unknown",this._merchantAccountId=e.merchantAccountId}m.prototype._initialize=function(){var e=this,t=this._client,n=setTimeout((function(){s.sendEvent(t,"local-payment.load.timed-out")}),a);return new u((function(r){i.create({name:"localpaymentlandingpage",dispatchFrameUrl:e._assetsUrl+"/html/dispatch-frame"+o(e._isDebug)+".html",openFrameUrl:e._loadingFrameUrl},(function(i){e._frameService=i,clearTimeout(n),s.sendEvent(t,"local-payment.load.succeeded"),r(e)}))}))},m.prototype.startPayment=function(e){var t,n,i=this,a=this._frameService._serviceId;return function(e){var t;if(!e)return!0;for(t=0;t<f.REQUIRED_OPTIONS_FOR_START_PAYMENT.length;t++)if(!e.hasOwnProperty(f.REQUIRED_OPTIONS_FOR_START_PAYMENT[t]))return!0;return!e.fallback.url||!e.fallback.buttonText}(e)?u.reject(new r(h.LOCAL_PAYMENT_START_PAYMENT_MISSING_REQUIRED_OPTION)):(t=e.address||{},n={intent:"sale",returnUrl:p.queryify(i._assetsUrl+"/html/local-payment-redirect-frame"+o(i._isDebug)+".html",{channel:a,r:e.fallback.url,t:e.fallback.buttonText}),cancelUrl:p.queryify(i._assetsUrl+"/html/cancel-frame"+o(i._isDebug)+".html",{channel:a}),experienceProfile:{noShipping:!e.shippingAddressRequired},fundingSource:e.paymentType,amount:e.amount,currencyIsoCode:e.currencyCode,firstName:e.givenName,lastName:e.surname,payerEmail:e.email,phone:e.phone,line1:t.streetAddress,line2:t.extendedAddress,city:t.locality,state:t.region,postalCode:t.postalCode,countryCode:t.countryCode,merchantAccountId:i._merchantAccountId},i._paymentType=e.paymentType.toLowerCase(),i._authorizationInProgress?(s.sendEvent(i._client,i._paymentType+".local-payment.start-payment.error.already-opened"),u.reject(new r(h.LOCAL_PAYMENT_ALREADY_IN_PROGRESS))):(i._authorizationInProgress=!0,new u((function(t,o){i._startPaymentCallback=i._createStartPaymentCallback(t,o),i._frameService.open({},i._startPaymentCallback),i._client.request({method:"post",endpoint:"local_payments/create",data:n}).then((function(t){s.sendEvent(i._client,i._paymentType+".local-payment.start-payment.opened"),i._startPaymentOptions=e,e.onPaymentStart({paymentId:t.paymentResource.paymentToken},(function(){i._frameService.redirect(t.paymentResource.redirectUrl)}))})).catch((function(e){var t=e.details&&e.details.httpStatus;i._frameService.close(),i._authorizationInProgress=!1,o(422!==t?d(e,{type:h.LOCAL_PAYMENT_START_PAYMENT_FAILED.type,code:h.LOCAL_PAYMENT_START_PAYMENT_FAILED.code,message:h.LOCAL_PAYMENT_START_PAYMENT_FAILED.message}):new r({type:h.LOCAL_PAYMENT_INVALID_PAYMENT_OPTION.type,code:h.LOCAL_PAYMENT_INVALID_PAYMENT_OPTION.code,message:h.LOCAL_PAYMENT_INVALID_PAYMENT_OPTION.message,details:{originalError:e}}))}))}))))},m.prototype.tokenize=function(e){var t=this,i=this._client;return e=e||p.parse(),i.request({endpoint:"payment_methods/paypal_accounts",method:"post",data:this._formatTokenizeData(e)}).then((function(e){var r=t._formatTokenizePayload(e);return s.sendEvent(i,n.popupBridge?t._paymentType+".local-payment.tokenization.success-popupbridge":t._paymentType+".local-payment.tokenization.success"),r})).catch((function(e){return s.sendEvent(i,t._paymentType+".local-payment.tokenization.failed"),u.reject(d(e,{type:h.LOCAL_PAYMENT_TOKENIZATION_FAILED.type,code:h.LOCAL_PAYMENT_TOKENIZATION_FAILED.code,message:h.LOCAL_PAYMENT_TOKENIZATION_FAILED.message}))}))},m.prototype.closeWindow=function(){this._authoriztionInProgress&&s.sendEvent(this._client,this._paymentType+".local-payment.start-payment.closed.by-merchant"),this._frameService.close()},m.prototype.focusWindow=function(){this._frameService.focus()},m.prototype._createStartPaymentCallback=function(e,t){var i=this,o=this._client;return function(a,c){i._authorizationInProgress=!1,a?"FRAME_SERVICE_FRAME_CLOSED"===a.code?(s.sendEvent(o,i._paymentType+".local-payment.tokenization.closed.by-user"),t(new r(h.LOCAL_PAYMENT_WINDOW_CLOSED))):a.code&&a.code.indexOf("FRAME_SERVICE_FRAME_OPEN_FAILED")>-1&&t(new r({code:h.LOCAL_PAYMENT_WINDOW_OPEN_FAILED.code,type:h.LOCAL_PAYMENT_WINDOW_OPEN_FAILED.type,message:h.LOCAL_PAYMENT_WINDOW_OPEN_FAILED.message,details:{originalError:a}})):c&&(n.popupBridge||i._frameService.redirect(i._loadingFrameUrl),i.tokenize(c).then(e).catch(t).then((function(){i._frameService.close()})))}},m.prototype._formatTokenizePayload=function(e){var t,n={};return e.paypalAccounts&&(n=e.paypalAccounts[0]),t={nonce:n.nonce,details:{},type:n.type},n.details&&(n.details.payerInfo&&(t.details=n.details.payerInfo),n.details.correlationId&&(t.correlationId=n.details.correlationId)),t},m.prototype.hasTokenizationParams=function(){var e=p.parse();return Boolean(e.btLpToken&&e.btLpPaymentId&&e.btLpPayerId)},m.prototype._formatTokenizeData=function(e){var t=this._client.getConfiguration();return{merchantAccountId:this._merchantAccountId,paypalAccount:{correlationId:e.btLpToken||e.token,paymentToken:e.btLpPaymentId||e.paymentId,payerId:e.btLpPayerId||e.PayerID,unilateral:t.gatewayConfiguration.paypal.unvettedMerchant,intent:"sale"}}},m.prototype.teardown=function(){return this._frameService.teardown(),l(this,c(m.prototype)),s.sendEvent(this._client,"local-payment.teardown-completed"),u.resolve()},t.exports=_.wrapPrototype(m)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../lib/analytics":93,"../../lib/braintree-error":98,"../../lib/constants":103,"../../lib/convert-methods-to-error":104,"../../lib/convert-to-braintree-error":105,"../../lib/frame-service/external":115,"../../lib/methods":130,"../../lib/promise":132,"../../lib/querystring":133,"../../lib/use-min":134,"../shared/errors":140,"./constants":137,"@braintree/wrap-promise":30}],139:[function(e,t,n){"use strict";var i=e("../lib/analytics"),r=e("../lib/basic-component-verification"),o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("./external/local-payment"),c=e("../lib/promise"),l=e("@braintree/wrap-promise"),d=e("../lib/braintree-error"),u=e("./shared/errors");t.exports={create:l((function(e){var t="Local Payment";return r.verify({name:t,client:e.client,authorization:e.authorization}).then((function(){return o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:t})})).then((function(t){var n=t.getConfiguration();return e.client=t,!0!==n.gatewayConfiguration.paypalEnabled?c.reject(new d(u.LOCAL_PAYMENT_NOT_ENABLED)):(i.sendEvent(t,"local-payment.initialized"),new s(e)._initialize())}))})),VERSION:"3.60.0"}},{"../lib/analytics":93,"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./external/local-payment":138,"./shared/errors":140,"@braintree/wrap-promise":30}],140:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={LOCAL_PAYMENT_NOT_ENABLED:{type:i.types.MERCHANT,code:"LOCAL_PAYMENT_NOT_ENABLED",message:"LocalPayment is not enabled for this merchant."},LOCAL_PAYMENT_ALREADY_IN_PROGRESS:{type:i.types.MERCHANT,code:"LOCAL_PAYMENT_ALREADY_IN_PROGRESS",message:"LocalPayment payment is already in progress."},LOCAL_PAYMENT_WINDOW_CLOSED:{type:i.types.CUSTOMER,code:"LOCAL_PAYMENT_WINDOW_CLOSED",message:"Customer closed LocalPayment window before authorizing."},LOCAL_PAYMENT_WINDOW_OPEN_FAILED:{type:i.types.MERCHANT,code:"LOCAL_PAYMENT_WINDOW_OPEN_FAILED",message:"LocalPayment window failed to open; make sure startPayment was called in response to a user action."},LOCAL_PAYMENT_START_PAYMENT_FAILED:{type:i.types.NETWORK,code:"LOCAL_PAYMENT_START_PAYMENT_FAILED",message:"LocalPayment startPayment failed."},LOCAL_PAYMENT_START_PAYMENT_MISSING_REQUIRED_OPTION:{type:i.types.MERCHANT,code:"LOCAL_PAYMENT_START_PAYMENT_MISSING_REQUIRED_OPTION",message:"Missing required option for startPayment."},LOCAL_PAYMENT_TOKENIZATION_FAILED:{type:i.types.NETWORK,code:"LOCAL_PAYMENT_TOKENIZATION_FAILED",message:"Could not tokenize user's local payment method."},LOCAL_PAYMENT_INVALID_PAYMENT_OPTION:{type:i.types.MERCHANT,code:"LOCAL_PAYMENT_INVALID_PAYMENT_OPTION",message:"Local payment options are invalid."}}},{"../../lib/braintree-error":98}],141:[function(e,t,n){(function(n){"use strict";var i=e("../../lib/promise"),r=e("../../lib/frame-service/external"),o=e("../../lib/braintree-error"),a=e("../shared/errors"),s=e("../../lib/methods"),c=e("@braintree/wrap-promise"),l=e("../../lib/analytics"),d=e("../../lib/convert-methods-to-error"),u=e("../../lib/convert-to-braintree-error"),p=e("../shared/constants"),_=e("../../lib/constants").INTEGRATION_TIMEOUT_MS;function f(e){var t=e.client.getConfiguration();this._client=e.client,this._assetsUrl=t.gatewayConfiguration.assetsUrl+"/web/3.60.0",this._isDebug=t.isDebug,this._authInProgress=!1,this._callbackUrl=n.popupBridge&&"function"==typeof n.popupBridge.getReturnUrlPrefix?n.popupBridge.getReturnUrlPrefix()+"return":this._assetsUrl+"/html/redirect-frame"+(this._isDebug?"":".min")+".html"}f.prototype._initialize=function(){var e=this;return new i((function(t){var n=setTimeout((function(){l.sendEvent(e._client,"masterpass.load.timed-out")}),_);r.create({name:p.LANDING_FRAME_NAME,height:p.POPUP_HEIGHT,width:p.POPUP_WIDTH,dispatchFrameUrl:e._assetsUrl+"/html/dispatch-frame"+(e._isDebug?"":".min")+".html",openFrameUrl:e._assetsUrl+"/html/masterpass-landing-frame"+(e._isDebug?"":".min")+".html"},(function(i){e._frameService=i,clearTimeout(n),l.sendEvent(e._client,"masterpass.load.succeeded"),t(e)}))}))},f.prototype.tokenize=function(e){var t=this;return!e||function(e){var t;for(t=0;t<p.REQUIRED_OPTIONS_FOR_TOKENIZE.length;t++)if(!e.hasOwnProperty(p.REQUIRED_OPTIONS_FOR_TOKENIZE[t]))return!0;return!1}(e)?i.reject(new o(a.MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION)):t._authInProgress?i.reject(new o(a.MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS)):new i((function(n,i){t._navigateFrameToLoadingPage(e).catch(i),t._frameService.open(e.frameOptions,t._createFrameOpenHandler(n,i))}))},f.prototype._navigateFrameToLoadingPage=function(e){var t=this;return this._authInProgress=!0,this._client.request({method:"post",endpoint:"masterpass/request_token",data:{requestToken:{originUrl:n.location.protocol+"//"+n.location.hostname,subtotal:e.subtotal,currencyCode:e.currencyCode,callbackUrl:this._callbackUrl}}}).then((function(n){var i,r=t._assetsUrl+"/html/masterpass-loading-frame"+(t._isDebug?"":".min")+".html?",o=t._client.getConfiguration().gatewayConfiguration,a=e.config||{};i={environment:o.environment,requestToken:n.requestToken,callbackUrl:t._callbackUrl,merchantCheckoutId:o.masterpass.merchantCheckoutId,allowedCardTypes:o.masterpass.supportedNetworks,version:p.MASTERPASS_VERSION},Object.keys(a).forEach((function(e){"function"!=typeof a[e]&&(i[e]=a[e])})),r+=Object.keys(i).map((function(e){return e+"="+i[e]})).join("&"),t._frameService.redirect(r)})).catch((function(e){var n=e.details&&e.details.httpStatus;return t._closeWindow(),i.reject(u(e,422===n?a.MASTERPASS_INVALID_PAYMENT_OPTION:a.MASTERPASS_FLOW_FAILED))}))},f.prototype._createFrameOpenHandler=function(e,t){var i=this;return n.popupBridge?function(n,r){return i._authInProgress=!1,n?(l.sendEvent(i._client,"masterpass.tokenization.closed-popupbridge.by-user"),void t(u(n,a.MASTERPASS_POPUP_CLOSED))):r.queryItems?void i._tokenizeMasterpass(r.queryItems).then(e).catch(t):(l.sendEvent(i._client,"masterpass.tokenization.failed-popupbridge"),void t(new o(a.MASTERPASS_FLOW_FAILED)))}:function(n,r){if(n)return i._authInProgress=!1,"FRAME_SERVICE_FRAME_CLOSED"===n.code?(l.sendEvent(i._client,"masterpass.tokenization.closed.by-user"),void t(new o(a.MASTERPASS_POPUP_CLOSED))):n.code&&n.code.indexOf("FRAME_SERVICE_FRAME_OPEN_FAILED")>-1?(l.sendEvent(i._client,"masterpass.tokenization.failed.to-open"),void t(new o({code:a.MASTERPASS_POPUP_OPEN_FAILED.code,type:a.MASTERPASS_POPUP_OPEN_FAILED.type,message:a.MASTERPASS_POPUP_OPEN_FAILED.message,details:{originalError:n}}))):(l.sendEvent(i._client,"masterpass.tokenization.failed"),i._closeWindow(),void t(u(n,a.MASTERPASS_FLOW_FAILED)));i._tokenizeMasterpass(r).then(e).catch(t)}},f.prototype._tokenizeMasterpass=function(e){var t=this;return"success"!==e.mpstatus?(l.sendEvent(t._client,"masterpass.tokenization.closed.by-user"),t._closeWindow(),i.reject(new o(a.MASTERPASS_POPUP_CLOSED))):function(e){return[e.oauth_verifier,e.oauth_token,e.checkout_resource_url].some((function(e){return null==e||"null"===e}))}(e)?(l.sendEvent(t._client,"masterpass.tokenization.closed.missing-payload"),t._closeWindow(),i.reject(new o(a.MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS))):t._client.request({endpoint:"payment_methods/masterpass_cards",method:"post",data:{masterpassCard:{checkoutResourceUrl:e.checkout_resource_url,requestToken:e.oauth_token,verifierToken:e.oauth_verifier}}}).then((function(e){return t._closeWindow(),l.sendEvent(t._client,n.popupBridge?"masterpass.tokenization.success-popupbridge":"masterpass.tokenization.success"),e.masterpassCards[0]})).catch((function(e){return t._closeWindow(),l.sendEvent(t._client,n.popupBridge?"masterpass.tokenization.failed-popupbridge":"masterpass.tokenization.failed"),i.reject(u(e,a.MASTERPASS_ACCOUNT_TOKENIZATION_FAILED))}))},f.prototype._closeWindow=function(){this._authInProgress=!1,this._frameService.close()},f.prototype.teardown=function(){var e=this;return new i((function(t){e._frameService.teardown(),d(e,s(f.prototype)),l.sendEvent(e._client,"masterpass.teardown-completed"),t()}))},t.exports=c.wrapPrototype(f)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../lib/analytics":93,"../../lib/braintree-error":98,"../../lib/constants":103,"../../lib/convert-methods-to-error":104,"../../lib/convert-to-braintree-error":105,"../../lib/frame-service/external":115,"../../lib/methods":130,"../../lib/promise":132,"../shared/constants":144,"../shared/errors":145,"@braintree/wrap-promise":30}],142:[function(e,t,n){(function(n){"use strict";var i=e("../lib/braintree-error"),r=e("../lib/basic-component-verification"),o=e("./shared/browser-detection"),a=e("./external/masterpass"),s=e("../lib/create-deferred-client"),c=e("../lib/create-assets-url"),l=e("./shared/errors"),d=e("../lib/promise"),u=e("@braintree/wrap-promise");function p(){return Boolean(n.popupBridge||o.supportsPopups())}t.exports={create:u((function(e){return r.verify({name:"Masterpass",client:e.client,authorization:e.authorization}).then((function(){return p()?d.resolve():d.reject(new i(l.MASTERPASS_BROWSER_NOT_SUPPORTED))})).then((function(){return s.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:c.create(e.authorization),name:"Masterpass"})})).then((function(t){return e.client=t,e.client.getConfiguration().gatewayConfiguration.masterpass?new a(e)._initialize():d.reject(new i(l.MASTERPASS_NOT_ENABLED))}))})),isSupported:p,VERSION:"3.60.0"}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./external/masterpass":141,"./shared/browser-detection":143,"./shared/errors":145,"@braintree/wrap-promise":30}],143:[function(e,t,n){"use strict";t.exports={supportsPopups:e("@braintree/browser-detection/supports-popups")}},{"@braintree/browser-detection/supports-popups":19}],144:[function(e,t,n){"use strict";t.exports={LANDING_FRAME_NAME:"braintreemasterpasslanding",POPUP_WIDTH:450,POPUP_HEIGHT:660,MASTERPASS_VERSION:"v6",REQUIRED_OPTIONS_FOR_TOKENIZE:["subtotal","currencyCode"]}},{}],145:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={MASTERPASS_BROWSER_NOT_SUPPORTED:{type:i.types.CUSTOMER,code:"MASTERPASS_BROWSER_NOT_SUPPORTED",message:"Browser is not supported."},MASTERPASS_NOT_ENABLED:{type:i.types.MERCHANT,code:"MASTERPASS_NOT_ENABLED",message:"Masterpass is not enabled for this merchant."},MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION:{type:i.types.MERCHANT,code:"MASTERPASS_TOKENIZE_MISSING_REQUIRED_OPTION",message:"Missing required option for tokenize."},MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS:{type:i.types.MERCHANT,code:"MASTERPASS_TOKENIZATION_ALREADY_IN_PROGRESS",message:"Masterpass tokenization is already in progress."},MASTERPASS_ACCOUNT_TOKENIZATION_FAILED:{type:i.types.NETWORK,code:"MASTERPASS_ACCOUNT_TOKENIZATION_FAILED",message:"Could not tokenize user's Masterpass account."},MASTERPASS_POPUP_OPEN_FAILED:{type:i.types.MERCHANT,code:"MASTERPASS_POPUP_OPEN_FAILED",message:"Masterpass popup failed to open. Make sure to tokenize in response to a user action, such as a click."},MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS:{type:i.types.MERCHANT,code:"MASTERPASS_POPUP_MISSING_REQUIRED_PARAMETERS",message:"Masterpass popup failed to return all required parameters needed to continue tokenization."},MASTERPASS_POPUP_CLOSED:{type:i.types.CUSTOMER,code:"MASTERPASS_POPUP_CLOSED",message:"Customer closed Masterpass popup before authorizing."},MASTERPASS_INVALID_PAYMENT_OPTION:{type:i.types.MERCHANT,code:"MASTERPASS_INVALID_PAYMENT_OPTION",message:"Masterpass payment options are invalid."},MASTERPASS_FLOW_FAILED:{type:i.types.NETWORK,code:"MASTERPASS_FLOW_FAILED",message:"Could not initialize Masterpass flow."}}},{"../../lib/braintree-error":98}],146:[function(e,t,n){(function(n){"use strict";var i=e("../../lib/analytics"),r=e("../../lib/assign").assign,o=e("../../lib/bus"),a=e("../../lib/convert-methods-to-error"),s=e("../../lib/generate-google-pay-configuration"),c=e("@braintree/iframer"),l=e("../../lib/vendor/uuid"),d=e("../../lib/use-min"),u=e("../../lib/methods"),p=e("../../lib/promise"),_=e("@braintree/event-emitter"),f=e("../../lib/braintree-error"),h=e("../shared/constants"),m=h.events,E=h.errors,b=e("@braintree/wrap-promise"),y={Visa:"visa",MasterCard:"mastercard","American Express":"amex","Diners Club":"diners",Discover:"discover",JCB:"jcb",UnionPay:"unionpay",Maestro:"maestro"};function g(e){var t=e.enabledPaymentMethods||{};_.call(this),this._componentId=l(),this._client=e.client,this._enabledPaymentMethods={basicCard:!1!==t.basicCard,googlePay:!1!==t.googlePay},this._googlePayVersion=2===e.googlePayVersion?2:1,this._googleMerchantId="18278000977346790994",this._supportedPaymentMethods=this._constructDefaultSupportedPaymentMethods(),this._defaultSupportedPaymentMethods=Object.keys(this._supportedPaymentMethods).map((function(e){return this._supportedPaymentMethods[e]}).bind(this)),this._bus=new o({channel:this._componentId})}_.createChild(g),g.prototype._constructDefaultSupportedPaymentMethods=function(){var e=this._client.getConfiguration(),t=e.gatewayConfiguration.androidPay,n=e.gatewayConfiguration.creditCards,i={};return this._enabledPaymentMethods.basicCard&&n&&n.supportedCardTypes.length>0&&(i.basicCard={supportedMethods:"basic-card",data:{supportedNetworks:n.supportedCardTypes.reduce((function(e,t){return t in y&&e.push(y[t]),e}),[])}}),this._enabledPaymentMethods.googlePay&&t&&t.enabled&&(i.googlePay={supportedMethods:"https://google.com/pay",data:s(e,this._googlePayVersion,this._googleMerchantId)}),i},g.prototype.initialize=function(){var e=this._client.getConfiguration(),t=this;return this._frame=c({allowPaymentRequest:!0,name:"braintree-payment-request-frame",class:"braintree-payment-request-frame",height:0,width:0,style:{position:"absolute",left:"-9999px"},title:"Secure Payment Frame"}),0===this._defaultSupportedPaymentMethods.length?p.reject(new f(E.PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS)):new p((function(n){var r;t._bus.on(m.FRAME_READY,(function(e){e(t._client)})),t._bus.on(m.FRAME_CAN_MAKE_REQUESTS,(function(){i.sendEvent(t._client,"payment-request.initialized"),t._bus.on(m.SHIPPING_ADDRESS_CHANGE,(function(e){var n={target:{shippingAddress:e},updateWith:function(e){t._bus.emit(m.UPDATE_SHIPPING_ADDRESS,e)}};t._emit("shippingAddressChange",n),t._emit("shippingaddresschange",n)})),t._bus.on(m.SHIPPING_OPTION_CHANGE,(function(e){var n={target:{shippingOption:e},updateWith:function(e){t._bus.emit(m.UPDATE_SHIPPING_OPTION,e)}};t._emit("shippingOptionChange",n),t._emit("shippingoptionchange",n)})),n(t)})),t._frame.src=(r=t._componentId,e.gatewayConfiguration.assetsUrl+"/web/3.60.0/html/payment-request-frame"+d(e.isDebug)+".html#"+r),document.body.appendChild(t._frame)}))},g.prototype.createSupportedPaymentMethodsConfiguration=function(e,t){var n;if(!e)throw new f(E.PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE);if(!this._enabledPaymentMethods[e])throw new f(E.PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED);return(n=r({},this._supportedPaymentMethods[e])).data=r({},n.data,t),n},g.prototype.tokenize=function(e){var t=this;return new p((function(n,r){t._bus.emit(m.PAYMENT_REQUEST_INITIALIZED,{supportedPaymentMethods:e.supportedPaymentMethods||t._defaultSupportedPaymentMethods,details:e.details,options:e.options},(function(e){var o=e[0],a=e[1];o?r(t._formatTokenizationError(o)):(i.sendEvent(t._client,"payment-request.tokenize.succeeded"),n({nonce:a.nonce,type:a.type,description:a.description,details:{rawPaymentResponse:a.details.rawPaymentResponse,cardType:a.details.cardType,lastFour:a.details.lastFour,lastTwo:a.details.lastTwo},binData:a.binData}))}))}))},g.prototype.canMakePayment=function(e){var t,r=this;return n.PaymentRequest?e.supportedPaymentMethods&&(e.supportedPaymentMethods.forEach((function(e){var n=e.supportedMethods;n in h.SUPPORTED_METHODS||(t=n)})),t)?p.reject(new f({type:E.PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD.type,code:E.PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD.code,message:t+" is not a supported payment method."})):new p((function(t,n){r._bus.emit(m.CAN_MAKE_PAYMENT,{supportedPaymentMethods:e.supportedPaymentMethods||r._defaultSupportedPaymentMethods,details:e.details,options:e.options},(function(e){var o=e[0],a=e[1];o?n(r._formatCanMakePaymentError(o)):(i.sendEvent(r._client,"payment-request.can-make-payment."+a),t(a))}))})):(i.sendEvent(r._client,"payment-request.can-make-payment.not-available"),p.resolve(!1))},g.prototype.teardown=function(){return this._bus.teardown(),this._frame.parentNode.removeChild(this._frame),a(this,u(g.prototype)),i.sendEvent(this._client,"payment-request.teardown-completed"),p.resolve()},g.prototype._formatTokenizationError=function(e){var t;switch(e.name){case"AbortError":return t=new f({type:E.PAYMENT_REQUEST_CANCELED.type,code:E.PAYMENT_REQUEST_CANCELED.code,message:E.PAYMENT_REQUEST_CANCELED.message,details:{originalError:e}}),i.sendEvent(this._client,"payment-request.tokenize.canceled"),t;case"PAYMENT_REQUEST_INITIALIZATION_FAILED":t=new f({type:E.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.type,code:E.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.code,message:E.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.message,details:{originalError:e}});break;case"BRAINTREE_GATEWAY_GOOGLE_PAYMENT_TOKENIZATION_ERROR":t=new f({type:E.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.type,code:E.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.code,message:E.PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE.message,details:{originalError:e}});break;case"BRAINTREE_GATEWAY_GOOGLE_PAYMENT_PARSING_ERROR":t=new f({type:E.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.type,code:E.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.code,message:E.PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR.message,details:{originalError:e}});break;default:t=new f({code:E.PAYMENT_REQUEST_NOT_COMPLETED.code,type:e.type||f.types.CUSTOMER,message:E.PAYMENT_REQUEST_NOT_COMPLETED.message,details:{originalError:e}})}return i.sendEvent(this._client,"payment-request.tokenize.failed"),t},g.prototype._formatCanMakePaymentError=function(e){var t;switch(e.name){case"PAYMENT_REQUEST_INITIALIZATION_FAILED":t=new f({type:E.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.type,code:E.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.code,message:E.PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED.message,details:{originalError:e}});break;case"NotAllowedError":t=new f({type:E.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED.type,code:E.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED.code,message:E.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED.message,details:{originalError:e}});break;default:t=new f({code:E.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED.code,type:E.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED.type,message:E.PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED.message,details:{originalError:e}})}return i.sendEvent(this._client,"payment-request.can-make-payment.failed"),t},t.exports=b.wrapPrototype(g)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../lib/analytics":93,"../../lib/assign":95,"../../lib/braintree-error":98,"../../lib/bus":101,"../../lib/convert-methods-to-error":104,"../../lib/generate-google-pay-configuration":125,"../../lib/methods":130,"../../lib/promise":132,"../../lib/use-min":134,"../../lib/vendor/uuid":136,"../shared/constants":148,"@braintree/event-emitter":21,"@braintree/iframer":23,"@braintree/wrap-promise":30}],147:[function(e,t,n){"use strict";var i=e("./external/payment-request"),r=e("../lib/basic-component-verification"),o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("@braintree/wrap-promise");t.exports={create:s((function(e){var t="Payment Request";return r.verify({name:t,client:e.client,authorization:e.authorization}).then((function(){return o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:t})})).then((function(t){return e.client=t,new i(e).initialize()}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"./external/payment-request":146,"@braintree/wrap-promise":30}],148:[function(e,t,n){"use strict";var i=e("../../lib/enumerate"),r=e("./errors"),o={};o.events=i(["CAN_MAKE_PAYMENT","FRAME_READY","FRAME_CAN_MAKE_REQUESTS","PAYMENT_REQUEST_INITIALIZED","SHIPPING_ADDRESS_CHANGE","UPDATE_SHIPPING_ADDRESS","SHIPPING_OPTION_CHANGE","UPDATE_SHIPPING_OPTION"],"payment-request:"),o.errors=r,o.SUPPORTED_METHODS={"basic-card":!0,"https://google.com/pay":!0},t.exports=o},{"../../lib/enumerate":111,"./errors":149}],149:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS:{type:i.types.MERCHANT,code:"PAYMENT_REQUEST_NO_VALID_SUPPORTED_PAYMENT_METHODS",message:"There are no supported payment methods associated with this account."},PAYMENT_REQUEST_CANCELED:{type:i.types.CUSTOMER,code:"PAYMENT_REQUEST_CANCELED",message:"Payment request was canceled."},PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED:{type:i.types.MERCHANT,code:"PAYMENT_REQUEST_INITIALIZATION_MISCONFIGURED",message:"Something went wrong when configuring the payment request."},PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED:{type:i.types.UNKNOWN,code:"PAYMENT_REQUEST_CAN_MAKE_PAYMENT_FAILED",message:"Something went wrong when calling `canMakePayment`"},PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED:{type:i.types.MERCHANT,code:"PAYMENT_REQUEST_CAN_MAKE_PAYMENT_NOT_ALLOWED",message:"Something went wrong when calling `canMakePayment`. Most likely, `canMakePayment` was called multiple times with different supportedMethods configurations."},PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD:{type:i.types.MERCHANT,code:"PAYMENT_REQUEST_UNSUPPORTED_PAYMENT_METHOD"},PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE:{type:i.types.MERCHANT,code:"PAYMENT_REQUEST_GOOGLE_PAYMENT_FAILED_TO_TOKENIZE",message:"Something went wrong when tokenizing the Google Pay card."},PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR:{type:i.types.UNKNOWN,code:"PAYMENT_REQUEST_GOOGLE_PAYMENT_PARSING_ERROR",message:"Something went wrong when tokenizing the Google Pay card."},PAYMENT_REQUEST_NOT_COMPLETED:{code:"PAYMENT_REQUEST_NOT_COMPLETED",message:"Payment request could not be completed."},PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE:{type:i.types.MERCHANT,code:"PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_MUST_INCLUDE_TYPE",message:"createSupportedPaymentMethodsConfiguration must include a type parameter."},PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED:{type:i.types.MERCHANT,code:"PAYMENT_REQUEST_CREATE_SUPPORTED_PAYMENT_METHODS_CONFIGURATION_TYPE_NOT_ENABLED",message:"createSupportedPaymentMethodsConfiguration type parameter must be valid or enabled."}}},{"../../lib/braintree-error":98}],150:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={PAYPAL_NOT_ENABLED:{type:i.types.MERCHANT,code:"PAYPAL_NOT_ENABLED",message:"PayPal is not enabled for this merchant."},PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED:{type:i.types.MERCHANT,code:"PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED",message:"A linked PayPal Sandbox account is required to use PayPal Checkout in Sandbox. See https://developers.braintreepayments.com/guides/paypal/testing-go-live/#linked-paypal-testing for details on linking your PayPal sandbox with Braintree."},PAYPAL_ACCOUNT_TOKENIZATION_FAILED:{type:i.types.NETWORK,code:"PAYPAL_ACCOUNT_TOKENIZATION_FAILED",message:"Could not tokenize user's PayPal account."},PAYPAL_FLOW_FAILED:{type:i.types.NETWORK,code:"PAYPAL_FLOW_FAILED",message:"Could not initialize PayPal flow."},PAYPAL_FLOW_OPTION_REQUIRED:{type:i.types.MERCHANT,code:"PAYPAL_FLOW_OPTION_REQUIRED",message:"PayPal flow property is invalid or missing."},PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED:{type:i.types.MERCHANT,code:"PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED"},PAYPAL_START_VAULT_INITIATED_CHECKOUT_SETUP_FAILED:{type:i.types.NETWORK,code:"PAYPAL_START_VAULT_INITIATED_CHECKOUT_SETUP_FAILED",message:"Something went wrong when setting up the checkout workflow."},PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED:{type:i.types.MERCHANT,code:"PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED",message:"PayPal popup failed to open, make sure to initiate the vault checkout in response to a user action."},PAYPAL_START_VAULT_INITIATED_CHECKOUT_CANCELED:{type:i.types.CUSTOMER,code:"PAYPAL_START_VAULT_INITIATED_CHECKOUT_CANCELED",message:"Customer closed PayPal popup before authorizing."},PAYPAL_START_VAULT_INITIATED_CHECKOUT_IN_PROGRESS:{type:i.types.MERCHANT,code:"PAYPAL_START_VAULT_INITIATED_CHECKOUT_IN_PROGRESS",message:"Vault initiated checkout already in progress."},PAYPAL_INVALID_PAYMENT_OPTION:{type:i.types.MERCHANT,code:"PAYPAL_INVALID_PAYMENT_OPTION",message:"PayPal payment options are invalid."}}},{"../lib/braintree-error":98}],151:[function(e,t,n){"use strict";var i=e("../lib/basic-component-verification"),r=e("@braintree/wrap-promise"),o=e("./paypal-checkout");t.exports={create:r((function(e){return i.verify({name:"PayPal Checkout",client:e.client,authorization:e.authorization}).then((function(){return new o(e)._initialize(e)}))})),isSupported:function(){return!0},VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"./paypal-checkout":152,"@braintree/wrap-promise":30}],152:[function(e,t,n){"use strict";var i=e("../lib/analytics"),r=e("../lib/assign").assign,o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("../lib/promise"),c=e("@braintree/extended-promise"),l=e("@braintree/wrap-promise"),d=e("../lib/braintree-error"),u=e("../lib/convert-to-braintree-error"),p=e("./errors"),_=e("../paypal/shared/constants"),f=e("../lib/frame-service/external"),h=e("../lib/methods"),m=e("../lib/use-min"),E=e("../lib/convert-methods-to-error"),b=e("../lib/constants").INTEGRATION_TIMEOUT_MS,y=["amount","currency","vaultInitiatedCheckoutPaymentMethodToken"];function g(e){this._merchantAccountId=e.merchantAccountId}g.prototype._initialize=function(e){return this._clientPromise=o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:"PayPal Checkout"}).then((function(e){return this._configuration=e.getConfiguration(),this._merchantAccountId||(this._configuration.gatewayConfiguration.paypalEnabled?!0===this._configuration.gatewayConfiguration.paypal.environmentNoNetwork&&(this._setupError=new d(p.PAYPAL_SANDBOX_ACCOUNT_NOT_LINKED)):this._setupError=new d(p.PAYPAL_NOT_ENABLED)),this._setupError?s.reject(this._setupError):(i.sendEvent(e,"paypal-checkout.initialized"),this._frameServicePromise=this._setupFrameService(e),e)}).bind(this)),e.client?this._clientPromise.then((function(){return this}).bind(this)):s.resolve(this)},g.prototype._setupFrameService=function(e){var t=new c,n=e.getConfiguration(),r=setTimeout((function(){i.sendEvent(e,"paypal-checkout.frame-service.timed-out"),t.reject(new d(p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_SETUP_FAILED))}),b);return this._assetsUrl=n.gatewayConfiguration.paypal.assetsUrl+"/web/3.60.0",this._isDebug=n.isDebug,this._loadingFrameUrl=this._assetsUrl+"/html/paypal-landing-frame"+m(this._isDebug)+".html",f.create({name:"braintreepaypallanding",dispatchFrameUrl:this._assetsUrl+"/html/dispatch-frame"+m(this._isDebug)+".html",openFrameUrl:this._loadingFrameUrl},(function(e){this._frameService=e,clearTimeout(r),t.resolve()}).bind(this)),t},g.prototype.createPayment=function(e){return e&&_.FLOW_ENDPOINTS.hasOwnProperty(e.flow)?(i.sendEvent(this._clientPromise,"paypal-checkout.createPayment"),this._createPaymentResource(e).then((function(t){return"checkout"===e.flow?t.paymentResource.redirectUrl.match(/EC-\w+/)[0]:t.agreementSetup.tokenId}))):s.reject(new d(p.PAYPAL_FLOW_OPTION_REQUIRED))},g.prototype._createPaymentResource=function(e,t){var n=this,r="paypal_hermes/"+_.FLOW_ENDPOINTS[e.flow];return t=t||{},!0===e.offerCredit&&i.sendEvent(this._clientPromise,"paypal-checkout.credit.offered"),this._clientPromise.then((function(i){return i.request({endpoint:r,method:"post",data:n._formatPaymentResourceData(e,t)})})).catch((function(e){return s.reject(n._setupError?n._setupError:422===(e.details&&e.details.httpStatus)?new d({type:p.PAYPAL_INVALID_PAYMENT_OPTION.type,code:p.PAYPAL_INVALID_PAYMENT_OPTION.code,message:p.PAYPAL_INVALID_PAYMENT_OPTION.message,details:{originalError:e}}):u(e,{type:p.PAYPAL_FLOW_FAILED.type,code:p.PAYPAL_FLOW_FAILED.code,message:p.PAYPAL_FLOW_FAILED.message}))}))},g.prototype.startVaultInitiatedCheckout=function(e){var t,n=this;return this._vaultInitiatedCheckoutInProgress?(i.sendEvent(this._clientPromise,"paypal-checkout.startVaultInitiatedCheckout.error.already-in-progress"),s.reject(new d(p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_IN_PROGRESS))):(y.forEach((function(n){e.hasOwnProperty(n)||(t=n)})),t?s.reject(new d({type:p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED.type,code:p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_PARAM_REQUIRED.code,message:"Required param "+t+" is missing."})):(this._vaultInitiatedCheckoutInProgress=!0,this._addModalBackdrop(e),e=r({},e,{flow:"checkout"}),i.sendEvent(this._clientPromise,"paypal-checkout.startVaultInitiatedCheckout.started"),this._waitForVaultInitiatedCheckoutDependencies().then((function(){var t=new c,i=n._createPaymentResource(e,{returnUrl:n._constructVaultCheckutUrl("redirect-frame"),cancelUrl:n._constructVaultCheckutUrl("cancel-frame")}).then((function(e){return n._frameService.redirect(e.paymentResource.redirectUrl),t}));return n._frameService.open({},n._createFrameServiceCallback(t)),i})).catch((function(e){return n._vaultInitiatedCheckoutInProgress=!1,n._removeModalBackdrop(),"FRAME_SERVICE_FRAME_CLOSED"===e.code?(i.sendEvent(n._clientPromise,"paypal-checkout.startVaultInitiatedCheckout.canceled.by-customer"),s.reject(new d(p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_CANCELED))):(n._frameService&&n._frameService.close(),e.code&&e.code.indexOf("FRAME_SERVICE_FRAME_OPEN_FAILED")>-1?(i.sendEvent(n._clientPromise,"paypal-checkout.startVaultInitiatedCheckout.failed.popup-not-opened"),s.reject(new d({code:p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED.code,type:p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED.type,message:p.PAYPAL_START_VAULT_INITIATED_CHECKOUT_POPUP_OPEN_FAILED.message,details:{originalError:e}}))):s.reject(e))})).then((function(e){return n._frameService.close(),n._vaultInitiatedCheckoutInProgress=!1,n._removeModalBackdrop(),i.sendEvent(n._clientPromise,"paypal-checkout.startVaultInitiatedCheckout.succeeded"),s.resolve(e)}))))},g.prototype._addModalBackdrop=function(e){e.optOutOfModalBackdrop||(this._modalBackdrop||(this._modalBackdrop=document.createElement("div"),this._modalBackdrop.setAttribute("data-braintree-paypal-vault-initiated-checkout-modal",!0),this._modalBackdrop.style.position="fixed",this._modalBackdrop.style.top=0,this._modalBackdrop.style.bottom=0,this._modalBackdrop.style.left=0,this._modalBackdrop.style.right=0,this._modalBackdrop.style.zIndex=9999,this._modalBackdrop.style.background="black",this._modalBackdrop.style.opacity="0.7",this._modalBackdrop.addEventListener("click",(function(){this.focusVaultInitiatedCheckoutWindow()}).bind(this))),document.body.appendChild(this._modalBackdrop))},g.prototype._removeModalBackdrop=function(){this._modalBackdrop&&this._modalBackdrop.parentNode&&this._modalBackdrop.parentNode.removeChild(this._modalBackdrop)},g.prototype.closeVaultInitiatedCheckoutWindow=function(){return this._vaultInitiatedCheckoutInProgress&&i.sendEvent(this._clientPromise,"paypal-checkout.startVaultInitiatedCheckout.canceled.by-merchant"),this._waitForVaultInitiatedCheckoutDependencies().then((function(){this._frameService.close()}).bind(this))},g.prototype.focusVaultInitiatedCheckoutWindow=function(){return this._waitForVaultInitiatedCheckoutDependencies().then((function(){this._frameService.focus()}).bind(this))},g.prototype._createFrameServiceCallback=function(e){var t=this;return function(n,i){n?e.reject(n):i&&(t._frameService.redirect(t._loadingFrameUrl),t.tokenizePayment({paymentToken:i.token,payerID:i.PayerID,paymentID:i.paymentId}).then((function(t){e.resolve(t)})).catch((function(t){e.reject(t)})))}},g.prototype._waitForVaultInitiatedCheckoutDependencies=function(){var e=this;return this._clientPromise.then((function(){return e._frameServicePromise}))},g.prototype._constructVaultCheckutUrl=function(e){var t=this._frameService._serviceId;return this._assetsUrl+"/html/"+e+m(this._isDebug)+".html?channel="+t},g.prototype.tokenizePayment=function(e){var t,n=this,r=!0,o={flow:e.billingToken?"vault":"checkout",intent:e.intent},a={ecToken:e.paymentToken,billingToken:e.billingToken,payerId:e.payerID,paymentId:e.paymentID,shippingOptionsId:e.shippingOptionsId};return e.hasOwnProperty("vault")&&(r=e.vault),o.vault=r,i.sendEvent(this._clientPromise,"paypal-checkout.tokenization.started"),this._clientPromise.then((function(e){return e.request({endpoint:"payment_methods/paypal_accounts",method:"post",data:n._formatTokenizeData(o,a)})})).then((function(e){return t=n._formatTokenizePayload(e),i.sendEvent(n._clientPromise,"paypal-checkout.tokenization.success"),t.creditFinancingOffered&&i.sendEvent(n._clientPromise,"paypal-checkout.credit.accepted"),t})).catch((function(e){return n._setupError?s.reject(n._setupError):(i.sendEvent(n._clientPromise,"paypal-checkout.tokenization.failed"),s.reject(u(e,{type:p.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.type,code:p.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.code,message:p.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.message})))}))},g.prototype.getClientId=function(){return this._clientPromise.then((function(e){return e.getConfiguration().gatewayConfiguration.paypal.clientId}))},g.prototype._formatPaymentResourceData=function(e,t){var n,i=e.intent,r={returnUrl:t.returnUrl||"https://www.paypal.com/checkoutnow/error",cancelUrl:t.cancelUrl||"https://www.paypal.com/checkoutnow/error",offerPaypalCredit:!0===e.offerCredit,merchantAccountId:this._merchantAccountId,experienceProfile:{brandName:e.displayName||this._configuration.gatewayConfiguration.paypal.displayName,localeCode:e.locale,noShipping:(!e.enableShippingAddress).toString(),addressOverride:!1===e.shippingAddressEditable,landingPageType:e.landingPageType},shippingOptions:e.shippingOptions};if("checkout"===e.flow)for(n in r.amount=e.amount,r.currencyIsoCode=e.currency,i&&("capture"===i&&(i="sale"),r.intent=i),e.hasOwnProperty("lineItems")&&(r.lineItems=e.lineItems),e.hasOwnProperty("vaultInitiatedCheckoutPaymentMethodToken")&&(r.vaultInitiatedCheckoutPaymentMethodToken=e.vaultInitiatedCheckoutPaymentMethodToken),e.hasOwnProperty("shippingOptions")&&(r.shippingOptions=e.shippingOptions),e.shippingAddressOverride)e.shippingAddressOverride.hasOwnProperty(n)&&(r[n]=e.shippingAddressOverride[n]);else r.shippingAddress=e.shippingAddressOverride,e.billingAgreementDescription&&(r.description=e.billingAgreementDescription);return r},g.prototype._formatTokenizeData=function(e,t){var n=this._configuration,i=n.gatewayConfiguration,r={paypalAccount:{correlationId:t.billingToken||t.ecToken,options:{validate:"vault"===e.flow&&!("TOKENIZATION_KEY"===n.authorizationType)&&e.vault}}};return t.billingToken?r.paypalAccount.billingAgreementToken=t.billingToken:(r.paypalAccount.paymentToken=t.paymentId,r.paypalAccount.payerId=t.payerId,r.paypalAccount.unilateral=i.paypal.unvettedMerchant,e.intent&&(r.paypalAccount.intent=e.intent)),this._merchantAccountId&&(r.merchantAccountId=this._merchantAccountId),r},g.prototype._formatTokenizePayload=function(e){var t,n={};return e.paypalAccounts&&(n=e.paypalAccounts[0]),t={nonce:n.nonce,details:{},type:n.type},n.details&&n.details.payerInfo&&(t.details=n.details.payerInfo),n.details&&n.details.creditFinancingOffered&&(t.creditFinancingOffered=n.details.creditFinancingOffered),n.details&&n.details.shippingOptionId&&(t.shippingOptionId=n.details.shippingOptionId),n.details&&n.details.cobrandedCardLabel&&(t.cobrandedCardLabel=n.details.cobrandedCardLabel),t},g.prototype.teardown=function(){return E(this,h(g.prototype)),s.resolve()},t.exports=l.wrapPrototype(g)},{"../lib/analytics":93,"../lib/assign":95,"../lib/braintree-error":98,"../lib/constants":103,"../lib/convert-methods-to-error":104,"../lib/convert-to-braintree-error":105,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/frame-service/external":115,"../lib/methods":130,"../lib/promise":132,"../lib/use-min":134,"../paypal/shared/constants":155,"./errors":150,"@braintree/extended-promise":22,"@braintree/wrap-promise":30}],153:[function(e,t,n){(function(n){"use strict";var i=e("../../lib/frame-service/external"),r=e("../../lib/braintree-error"),o=e("../../lib/convert-to-braintree-error"),a=e("../../lib/use-min"),s=e("../../lib/once"),c=e("../shared/constants"),l=e("../../lib/constants").INTEGRATION_TIMEOUT_MS,d=e("../../lib/analytics"),u=e("../../lib/methods"),p=e("../../lib/deferred"),_=e("../shared/errors"),f=e("../../lib/convert-methods-to-error"),h=e("../../lib/querystring"),m=e("../../lib/promise"),E=e("@braintree/wrap-promise");function b(e){this._client=e.client,this._assetsUrl=e.client.getConfiguration().gatewayConfiguration.paypal.assetsUrl+"/web/3.60.0",this._isDebug=e.client.getConfiguration().isDebug,this._loadingFrameUrl=this._assetsUrl+"/html/paypal-landing-frame"+a(this._isDebug)+".html",this._authorizationInProgress=!1}b.prototype._initialize=function(){var e=this,t=this._client,n=setTimeout((function(){d.sendEvent(t,"paypal.load.timed-out")}),l);return new m((function(r){i.create({name:c.LANDING_FRAME_NAME,dispatchFrameUrl:e._assetsUrl+"/html/dispatch-frame"+a(e._isDebug)+".html",openFrameUrl:e._loadingFrameUrl},(function(i){e._frameService=i,clearTimeout(n),d.sendEvent(t,"paypal.load.succeeded"),r(e)}))}))},b.prototype.tokenize=function(e,t){var i,o,a=this,l=this._client;return t&&(t=s(p(t))),e&&c.FLOW_ENDPOINTS.hasOwnProperty(e.flow)?(i=new m((function(t,i){a._authorizationInProgress?(d.sendEvent(l,"paypal.tokenization.error.already-opened"),i(new r(_.PAYPAL_TOKENIZATION_REQUEST_ACTIVE))):(a._authorizationInProgress=!0,n.popupBridge||d.sendEvent(l,"paypal.tokenization.opened"),!0===e.offerCredit&&d.sendEvent(l,"paypal.credit.offered"),a._navigateFrameToAuth(e).catch(i),a._frameService.open({},a._createFrameServiceCallback(e,t,i)))})),t?(i.then((function(e){t(null,e)})).catch(t),this._frameService.createHandler({beforeClose:function(){d.sendEvent(l,"paypal.tokenization.closed.by-merchant")}})):i):(o=new r(_.PAYPAL_FLOW_OPTION_REQUIRED),t?(t(o),this._frameService.createNoopHandler()):m.reject(o))},b.prototype._createFrameServiceCallback=function(e,t,i){var o=this,a=this._client;return n.popupBridge?function(n,s){var c=s&&s.path&&"/cancel"===s.path.substring(0,7);o._authorizationInProgress=!1,n||c?(d.sendEvent(a,"paypal.tokenization.closed-popupbridge.by-user"),i(new r(_.PAYPAL_POPUP_CLOSED))):s&&o._tokenizePayPal(e,s.queryItems).then(t).catch(i)}:function(n,s){o._authorizationInProgress=!1,n?"FRAME_SERVICE_FRAME_CLOSED"===n.code?(d.sendEvent(a,"paypal.tokenization.closed.by-user"),i(new r(_.PAYPAL_POPUP_CLOSED))):n.code&&n.code.indexOf("FRAME_SERVICE_FRAME_OPEN_FAILED")>-1&&i(new r({code:_.PAYPAL_POPUP_OPEN_FAILED.code,type:_.PAYPAL_POPUP_OPEN_FAILED.type,message:_.PAYPAL_POPUP_OPEN_FAILED.message,details:{originalError:n}})):s&&o._tokenizePayPal(e,s).then(t).catch(i)}},b.prototype._tokenizePayPal=function(e,t){var i=this,r=this._client;return n.popupBridge||this._frameService.redirect(this._loadingFrameUrl),r.request({endpoint:"payment_methods/paypal_accounts",method:"post",data:this._formatTokenizeData(e,t)}).then((function(e){var t=i._formatTokenizePayload(e);return d.sendEvent(r,n.popupBridge?"paypal.tokenization.success-popupbridge":"paypal.tokenization.success"),t.creditFinancingOffered&&d.sendEvent(r,"paypal.credit.accepted"),i._frameService.close(),t})).catch((function(e){return d.sendEvent(r,n.popupBridge?"paypal.tokenization.failed-popupbridge":"paypal.tokenization.failed"),i._frameService.close(),m.reject(o(e,{type:_.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.type,code:_.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.code,message:_.PAYPAL_ACCOUNT_TOKENIZATION_FAILED.message}))}))},b.prototype._formatTokenizePayload=function(e){var t,n={};return e.paypalAccounts&&(n=e.paypalAccounts[0]),t={nonce:n.nonce,details:{},type:n.type},n.details&&n.details.payerInfo&&(t.details=n.details.payerInfo),n.details&&n.details.creditFinancingOffered&&(t.creditFinancingOffered=n.details.creditFinancingOffered),t},b.prototype._formatTokenizeData=function(e,t){var n=this._client.getConfiguration(),i=n.gatewayConfiguration,r={paypalAccount:{correlationId:t.ba_token||t.token,options:{validate:"vault"===e.flow&&!("TOKENIZATION_KEY"===n.authorizationType)}}};return t.ba_token?r.paypalAccount.billingAgreementToken=t.ba_token:(r.paypalAccount.paymentToken=t.paymentId,r.paypalAccount.payerId=t.PayerID,r.paypalAccount.unilateral=i.paypal.unvettedMerchant,e.hasOwnProperty("intent")&&(r.paypalAccount.intent=e.intent)),r},b.prototype._navigateFrameToAuth=function(e){var t=this,i=this._client;return i.request({endpoint:"paypal_hermes/"+c.FLOW_ENDPOINTS[e.flow],method:"post",data:this._formatPaymentResourceData(e)}).then((function(r){var o;o="checkout"===e.flow?r.paymentResource.redirectUrl:r.agreementSetup.approvalUrl,"commit"===e.useraction&&(o=h.queryify(o,{useraction:"commit"})),n.popupBridge&&d.sendEvent(i,"paypal.tokenization.opened-popupbridge"),t._frameService.redirect(o)})).catch((function(e){var n=e.details&&e.details.httpStatus;return t._frameService.close(),t._authorizationInProgress=!1,m.reject(422===n?new r({type:_.PAYPAL_INVALID_PAYMENT_OPTION.type,code:_.PAYPAL_INVALID_PAYMENT_OPTION.code,message:_.PAYPAL_INVALID_PAYMENT_OPTION.message,details:{originalError:e}}):o(e,{type:_.PAYPAL_FLOW_FAILED.type,code:_.PAYPAL_FLOW_FAILED.code,message:_.PAYPAL_FLOW_FAILED.message}))}))},b.prototype._formatPaymentResourceData=function(e){var t,i=this._client.getConfiguration().gatewayConfiguration,r=this._frameService._serviceId,o={returnUrl:i.paypal.assetsUrl+"/web/3.60.0/html/redirect-frame"+a(this._isDebug)+".html?channel="+r,cancelUrl:i.paypal.assetsUrl+"/web/3.60.0/html/cancel-frame"+a(this._isDebug)+".html?channel="+r,offerPaypalCredit:!0===e.offerCredit,experienceProfile:{brandName:e.displayName||i.paypal.displayName,localeCode:e.locale,noShipping:(!e.enableShippingAddress).toString(),addressOverride:!1===e.shippingAddressEditable,landingPageType:e.landingPageType}};if(n.popupBridge&&"function"==typeof n.popupBridge.getReturnUrlPrefix&&(o.returnUrl=n.popupBridge.getReturnUrlPrefix()+"return",o.cancelUrl=n.popupBridge.getReturnUrlPrefix()+"cancel"),"checkout"===e.flow)for(t in o.amount=e.amount,o.currencyIsoCode=e.currency,e.hasOwnProperty("intent")&&(o.intent=e.intent),e.shippingAddressOverride)e.shippingAddressOverride.hasOwnProperty(t)&&(o[t]=e.shippingAddressOverride[t]);else o.shippingAddress=e.shippingAddressOverride,e.billingAgreementDescription&&(o.description=e.billingAgreementDescription);return o},b.prototype.closeWindow=function(){this._authorizationInProgress&&d.sendEvent(this._client,"paypal.tokenize.closed.by-merchant"),this._frameService.close()},b.prototype.focusWindow=function(){this._frameService.focus()},b.prototype.teardown=E((function(){return this._frameService.teardown(),f(this,u(b.prototype)),d.sendEvent(this._client,"paypal.teardown-completed"),m.resolve()})),t.exports=b}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../lib/analytics":93,"../../lib/braintree-error":98,"../../lib/constants":103,"../../lib/convert-methods-to-error":104,"../../lib/convert-to-braintree-error":105,"../../lib/deferred":109,"../../lib/frame-service/external":115,"../../lib/methods":130,"../../lib/once":131,"../../lib/promise":132,"../../lib/querystring":133,"../../lib/use-min":134,"../shared/constants":155,"../shared/errors":156,"@braintree/wrap-promise":30}],154:[function(e,t,n){"use strict";var i=e("../lib/analytics"),r=e("../lib/basic-component-verification"),o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("../lib/braintree-error"),c=e("./shared/errors"),l=e("./external/paypal"),d=e("@braintree/wrap-promise"),u=e("../lib/promise");t.exports={create:d((function(e){return r.verify({name:"PayPal",client:e.client,authorization:e.authorization}).then((function(){return o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:"PayPal"})})).then((function(t){var n=t.getConfiguration();return e.client=t,!0!==n.gatewayConfiguration.paypalEnabled?u.reject(new s(c.PAYPAL_NOT_ENABLED)):(i.sendEvent(e.client,"paypal.initialized"),new l(e)._initialize())}))})),isSupported:function(){return!0},VERSION:"3.60.0"}},{"../lib/analytics":93,"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./external/paypal":153,"./shared/errors":156,"@braintree/wrap-promise":30}],155:[function(e,t,n){"use strict";t.exports={LANDING_FRAME_NAME:"braintreepaypallanding",FLOW_ENDPOINTS:{checkout:"create_payment_resource",vault:"setup_billing_agreement"}}},{}],156:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={PAYPAL_NOT_ENABLED:{type:i.types.MERCHANT,code:"PAYPAL_NOT_ENABLED",message:"PayPal is not enabled for this merchant."},PAYPAL_TOKENIZATION_REQUEST_ACTIVE:{type:i.types.MERCHANT,code:"PAYPAL_TOKENIZATION_REQUEST_ACTIVE",message:"Another tokenization request is active."},PAYPAL_ACCOUNT_TOKENIZATION_FAILED:{type:i.types.NETWORK,code:"PAYPAL_ACCOUNT_TOKENIZATION_FAILED",message:"Could not tokenize user's PayPal account."},PAYPAL_FLOW_FAILED:{type:i.types.NETWORK,code:"PAYPAL_FLOW_FAILED",message:"Could not initialize PayPal flow."},PAYPAL_FLOW_OPTION_REQUIRED:{type:i.types.MERCHANT,code:"PAYPAL_FLOW_OPTION_REQUIRED",message:"PayPal flow property is invalid or missing."},PAYPAL_POPUP_OPEN_FAILED:{type:i.types.MERCHANT,code:"PAYPAL_POPUP_OPEN_FAILED",message:"PayPal popup failed to open, make sure to tokenize in response to a user action."},PAYPAL_POPUP_CLOSED:{type:i.types.CUSTOMER,code:"PAYPAL_POPUP_CLOSED",message:"Customer closed PayPal popup before authorizing."},PAYPAL_INVALID_PAYMENT_OPTION:{type:i.types.MERCHANT,code:"PAYPAL_INVALID_PAYMENT_OPTION",message:"PayPal payment options are invalid."}}},{"../../lib/braintree-error":98}],157:[function(e,t,n){"use strict";var i=e("@braintree/wrap-promise"),r=e("../lib/basic-component-verification"),o=e("./preferred-payment-methods");t.exports={create:i((function(e){return r.verify({name:"PreferredPaymentMethods",client:e.client,authorization:e.authorization}).then((function(){return(new o).initialize(e)}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"./preferred-payment-methods":158,"@braintree/wrap-promise":30}],158:[function(e,t,n){"use strict";var i=e("@braintree/wrap-promise"),r=e("../lib/analytics"),o=e("../lib/create-assets-url"),a=e("../lib/create-deferred-client"),s=e("../lib/promise");function c(){}c.prototype.initialize=function(e){var t=this;return this._clientPromise=a.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:o.create(e.authorization),name:"PreferredPaymentMethods"}).catch((function(e){return t._setupError=e,s.reject(e)})),r.sendEvent(this._clientPromise,"preferred-payment-methods.initialized"),s.resolve(this)},c.prototype.fetchPreferredPaymentMethods=function(){var e,t=this;return this._clientPromise.then((function(t){return(e=t).request({api:"graphQLApi",data:{query:"query ClientConfiguration { clientConfiguration { paypal { paymentMethodAvailableOnDevice } } }"}})})).then((function(t){var n=t.data.clientConfiguration.paypal.paymentMethodAvailableOnDevice;return r.sendEvent(e,"preferred-payment-methods.paypal.api-detected."+n),{paypalPreferred:n}})).catch((function(){return t._setupError?s.reject(t._setupError):(r.sendEvent(e,"preferred-payment-methods.api-error"),{paypalPreferred:!1})}))},t.exports=i.wrapPrototype(c)},{"../lib/analytics":93,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"@braintree/wrap-promise":30}],159:[function(e,t,n){(function(n){"use strict";var i=e("../../../lib/assign").assign,r=e("../../../lib/analytics"),o=e("../../../lib/braintree-error"),a=e("../../../lib/promise"),s=e("@braintree/extended-promise"),c=e("@braintree/event-emitter"),l=e("../../shared/errors"),d=e("@braintree/iframer"),u=e("../../../lib/bus"),p=e("../../shared/constants"),_=e("../../../lib/vendor/uuid"),f=e("../../shared/events"),h=e("../../../lib/use-min");function m(e){c.call(this),this._client=e.client,this._createPromise=e.createPromise,this._createOptions=e,this._client?(this._isDebug=this._client.getConfiguration().isDebug,this._assetsUrl=this._client.getConfiguration().gatewayConfiguration.assetsUrl):(this._isDebug=Boolean(e.isDebug),this._assetsUrl=e.assetsUrl),this._assetsUrl=this._assetsUrl+"/web/3.60.0"}c.createChild(m),m.prototype._waitForClient=function(){return this._client?a.resolve():this._createPromise.then((function(e){this._client=e}).bind(this))},m.prototype.setUpEventListeners=function(){throw new o(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype.verifyCard=function(e,t){var n,i,o=this;return(i=this._checkForVerifyCardError(e,t=t||{}))?a.reject(i):(this._verifyCardInProgress=!0,n=this._formatVerifyCardOptions(e),this._formatLookupData(n).then((function(e){return r.sendEvent(o._createPromise,"three-d-secure.verification-flow.started"),o._performLookup(n.nonce,e)})).then((function(e){return r.sendEvent(o._createPromise,"three-d-secure.verification-flow.3ds-version."+e.lookup.threeDSecureVersion),o._onLookupComplete(e,n)})).then((function(e){return o.initializeChallengeWithLookupResponse(e,n)})).then((function(e){return o._resetVerificationState(),r.sendEvent(o._createPromise,"three-d-secure.verification-flow.completed"),e})).catch((function(e){return o._resetVerificationState(),r.sendEvent(o._createPromise,"three-d-secure.verification-flow.failed"),a.reject(e)})))},m.prototype._checkForFrameworkSpecificVerifyCardErrors=function(){throw new o(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype._presentChallenge=function(){throw new o(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype.prepareLookup=function(){throw new o(l.THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED)},m.prototype._resetVerificationState=function(){this._verifyCardInProgress=!1,this._verifyCardPromisePlus=null},m.prototype._performLookup=function(e,t){var n=this,i="payment_methods/"+e+"/three_d_secure/lookup";return this._waitForClient().then((function(){return n._client.request({endpoint:i,method:"post",data:t}).catch((function(e){var t,i=e&&e.details&&e.details.httpStatus,s="three-d-secure.verification-flow.lookup-failed";return 404===i?(t=l.THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR,s+=".404"):422===i?(t=l.THREEDS_LOOKUP_VALIDATION_ERROR,s+=".422"):t=l.THREEDS_LOOKUP_ERROR,r.sendEvent(n._createPromise,s),a.reject(new o({type:t.type,code:t.code,message:t.message,details:{originalError:e}}))}))}))},m.prototype._checkForVerifyCardError=function(e,t){var n;return!0===this._verifyCardInProgress?new o(l.THREEDS_AUTHENTICATION_IN_PROGRESS):(e.nonce?e.amount||(n="an amount"):n="a nonce",n||(n=this._checkForFrameworkSpecificVerifyCardErrors(e,t)),n?new o({type:l.THREEDS_MISSING_VERIFY_CARD_OPTION.type,code:l.THREEDS_MISSING_VERIFY_CARD_OPTION.code,message:"verifyCard options must include "+n+"."}):null)},m.prototype.initializeChallengeWithLookupResponse=function(e,t){var n=this;return t=t||{},this._lookupPaymentMethod=e.paymentMethod,n._verifyCardPromisePlus=n._verifyCardPromisePlus||new s,n._handleLookupResponse(e,t),n._verifyCardPromisePlus.then((function(e){return r.sendEvent(n._createPromise,"three-d-secure.verification-flow.liability-shifted."+String(e.liabilityShifted)),r.sendEvent(n._createPromise,"three-d-secure.verification-flow.liability-shift-possible."+String(e.liabilityShiftPossible)),e}))},m.prototype._handleLookupResponse=function(e,t){var n,i=Boolean(e.lookup&&e.lookup.acsUrl);r.sendEvent(this._createPromise,"three-d-secure.verification-flow.challenge-presented."+String(i)),i?this._presentChallenge(e,t):((n=this._formatAuthResponse(e.paymentMethod,e.threeDSecureInfo)).verificationDetails=e.threeDSecureInfo,this._verifyCardPromisePlus.resolve(n))},m.prototype._onLookupComplete=function(e){return this._lookupPaymentMethod=e.paymentMethod,this._verifyCardPromisePlus=new s,a.resolve(e)},m.prototype._formatAuthResponse=function(e,t){return{nonce:e.nonce,binData:e.binData,details:e.details,description:e.description&&e.description.replace(/\+/g," "),liabilityShifted:t&&t.liabilityShifted,liabilityShiftPossible:t&&t.liabilityShiftPossible,threeDSecureInfo:e.threeDSecureInfo}},m.prototype._formatVerifyCardOptions=function(e){return i({},e)},m.prototype._formatLookupData=function(e){return a.resolve({amount:e.amount})},m.prototype._handleV1AuthResponse=function(e){var t=JSON.parse(e.auth_response);t.success?this._verifyCardPromisePlus.resolve(this._formatAuthResponse(t.paymentMethod,t.threeDSecureInfo)):t.threeDSecureInfo&&t.threeDSecureInfo.liabilityShiftPossible?this._verifyCardPromisePlus.resolve(this._formatAuthResponse(this._lookupPaymentMethod,t.threeDSecureInfo)):this._verifyCardPromisePlus.reject(new o({type:o.types.UNKNOWN,code:"UNKNOWN_AUTH_RESPONSE",message:t.error.message}))},m.prototype.cancelVerifyCard=function(){var e,t;return this._verifyCardInProgress=!1,this._lookupPaymentMethod?(e=i({},this._lookupPaymentMethod,{liabilityShiftPossible:(t=this._lookupPaymentMethod.threeDSecureInfo)&&t.liabilityShiftPossible,liabilityShifted:t&&t.liabilityShifted,verificationDetails:t&&t.verificationDetails}),a.resolve(e)):a.reject(new o(l.THREEDS_NO_VERIFICATION_PAYLOAD))},m.prototype._setupV1Bus=function(e){var t=n.location.href.split("#")[0],i=e.lookupResponse,r=new u({channel:_(),merchantUrl:n.location.href}),o=this._assetsUrl+"/html/three-d-secure-authentication-complete-frame.html?channel="+encodeURIComponent(r.channel)+"&";return r.on(u.events.CONFIGURATION_REQUEST,(function(e){e({acsUrl:i.acsUrl,pareq:i.pareq,termUrl:i.termUrl+"&three_d_secure_version=3.60.0&authentication_complete_base_url="+encodeURIComponent(o),md:i.md,parentUrl:t})})),r.on(f.AUTHENTICATION_COMPLETE,e.handleAuthResponse),r},m.prototype._setupV1Iframe=function(e){var t=this._assetsUrl+"/html/three-d-secure-bank-frame"+h(this._isDebug)+".html?showLoader="+e.showLoader;return d({src:t,height:400,width:400,name:p.LANDING_FRAME_NAME+"_"+this._v1Bus.channel,title:"3D Secure Authorization Frame"})},m.prototype._setupV1Elements=function(e){this._v1Bus=this._setupV1Bus(e),this._v1Iframe=this._setupV1Iframe(e)},m.prototype._teardownV1Elements=function(){this._v1Bus&&(this._v1Bus.teardown(),this._v1Bus=null),this._v1Iframe&&this._v1Iframe.parentNode&&(this._v1Iframe.parentNode.removeChild(this._v1Iframe),this._v1Iframe=null),this._onV1Keyup&&(document.removeEventListener("keyup",this._onV1Keyup),this._onV1Keyup=null)},m.prototype.teardown=function(){return r.sendEvent(this._createPromise,"three-d-secure.teardown-completed"),this._teardownV1Elements(),a.resolve()},t.exports=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../lib/analytics":93,"../../../lib/assign":95,"../../../lib/braintree-error":98,"../../../lib/bus":101,"../../../lib/promise":132,"../../../lib/use-min":134,"../../../lib/vendor/uuid":136,"../../shared/constants":168,"../../shared/errors":169,"../../shared/events":170,"@braintree/event-emitter":21,"@braintree/extended-promise":22,"@braintree/iframer":23}],160:[function(e,t,n){"use strict";var i=e("./songbird");function r(e){i.call(this,e)}(r.prototype=Object.create(i.prototype,{constructor:i}))._createV1IframeModalElement=function(e){var t=document.createElement("div");return t.innerHTML='<div class="modal fade in" tabindex="-1" role="dialog" aria-labelledby="CCAFrameModal-label" aria-hidden="true" style="display: block;"><div class="modal-dialog" style="width:440px;z-index:999999;"><div class="modal-content"><div class="modal-body" data-braintree-v1-fallback-iframe-container><button type="button" data-braintree-v1-fallback-close-button class="close" data-dismiss="modal" aria-hidden="true">\xd7</button></div></div></div><div data-braintree-v1-fallback-backdrop style="position: fixed;cursor: pointer;z-index: 999998;top: 0;left: 0;width: 100%;height: 100%;"></div></div>',t.querySelector("[data-braintree-v1-fallback-iframe-container]").appendChild(e),t},r.prototype._createCardinalConfigurationOptions=function(e){var t=i.prototype._createCardinalConfigurationOptions.call(this,e);return t.payment.framework="bootstrap3",t},t.exports=r},{"./songbird":165}],161:[function(e,t,n){"use strict";var i=e("./songbird");function r(e){i.call(this,e)}(r.prototype=Object.create(i.prototype,{constructor:i}))._createV1IframeModalElement=function(e){var t=document.createElement("div"),n=Boolean(this._createOptions&&this._createOptions.cardinalSDKConfig&&this._createOptions.cardinalSDKConfig.payment&&this._createOptions.cardinalSDKConfig.payment.displayExitButton);return t.innerHTML='<div style="position: fixed;z-index: 999999;top: 50%;left: 50%;padding: 24px 20px;transform: translate(-50%,-50%);border-radius: 2px;background: #fff;max-width: 100%;overflow: auto;"><div><button data-braintree-v1-fallback-close-button style="font-family: Helvetica,Arial,sans-serif;font-size: 25px;line-height: 12px;position: absolute;top: 2px;right: 0px;cursor: pointer;color: #999;border: 0;outline: none;background: none;" onMouseOver="this.style.color=\'#000\'" onMouseOut="this.style.color=\'#999\'">\xd7</button></div><div data-braintree-v1-fallback-iframe-container style="height: 400px;"></div></div><div data-braintree-v1-fallback-backdrop style="position: fixed;z-index: 999998;cursor: pointer;top: 0;left: 0;width: 100%;height: 100%;transition: opacity 1ms ease;background: rgba(0,0,0,.6);"></div>',n||(t.querySelector("[data-braintree-v1-fallback-close-button]").style.display="none"),t.querySelector("[data-braintree-v1-fallback-iframe-container]").appendChild(e),t},t.exports=r},{"./songbird":165}],162:[function(e,t,n){"use strict";var i=e("./legacy"),r=e("./cardinal-modal"),o=e("./bootstrap3-modal"),a=e("./inline-iframe");t.exports={legacy:i,"cardinal-modal":r,"bootstrap3-modal":o,"inline-iframe":a}},{"./bootstrap3-modal":160,"./cardinal-modal":161,"./inline-iframe":163,"./legacy":164}],163:[function(e,t,n){"use strict";var i=e("./songbird"),r=e("../../../lib/braintree-error"),o=e("../../shared/errors"),a=e("../../../lib/enumerate");function s(e){i.call(this,e)}s.prototype=Object.create(i.prototype,{constructor:i}),s.events=a(["AUTHENTICATION_IFRAME_AVAILABLE"],"inline-iframe-framework:"),s.prototype.setUpEventListeners=function(e){i.prototype.setUpEventListeners.call(this,e),this.on(s.events.AUTHENTICATION_IFRAME_AVAILABLE,(function(t,n){e("authentication-iframe-available",t,n)}))},s.prototype._createCardinalConfigurationOptions=function(e){var t=i.prototype._createCardinalConfigurationOptions.call(this,e);return t.payment.framework="inline",t},s.prototype._addV1IframeToPage=function(){this._emit(s.events.AUTHENTICATION_IFRAME_AVAILABLE,{element:this._v1Modal},(function(){}))},s.prototype._setupFrameworkSpecificListeners=function(){this.setCardinalListener("ui.inline.setup",this._onInlineSetup.bind(this))},s.prototype._onInlineSetup=function(e,t,n,i){var a,c;e&&t?("CCA"!==t.paymentType||"suppress"!==t.data.mode&&"static"!==t.data.mode)&&(c=!0):c=!0,c?i(new r(o.THREEDS_INLINE_IFRAME_DETAILS_INCORRECT)):((a=document.createElement("div")).innerHTML=e,"suppress"===t.data.mode?(a.style.display="none",document.body.appendChild(a),n()):"static"===t.data.mode&&this._emit(s.events.AUTHENTICATION_IFRAME_AVAILABLE,{element:a},(function(){n()})))},t.exports=s},{"../../../lib/braintree-error":98,"../../../lib/enumerate":111,"../../shared/errors":169,"./songbird":165}],164:[function(e,t,n){"use strict";var i=e("./base"),r=e("../../../lib/deferred");function o(e){i.call(this,e)}(o.prototype=Object.create(i.prototype,{constructor:o})).setUpEventListeners=function(){},o.prototype.transformV1CustomerBillingAddress=function(e){return e.billingAddress.line1=e.billingAddress.streetAddress,e.billingAddress.line2=e.billingAddress.extendedAddress,e.billingAddress.city=e.billingAddress.locality,e.billingAddress.state=e.billingAddress.region,e.billingAddress.countryCode=e.billingAddress.countryCodeAlpha2,delete e.billingAddress.streetAddress,delete e.billingAddress.extendedAddress,delete e.billingAddress.locality,delete e.billingAddress.region,delete e.billingAddress.countryCodeAlpha2,e},o.prototype._createIframe=function(e){var t=this;return this._setupV1Elements({lookupResponse:e.lookupResponse,showLoader:e.showLoader,handleAuthResponse:function(n){t._handleAuthResponse(n,e)}}),this._v1Iframe},o.prototype._handleAuthResponse=function(e,t){this._v1Bus.teardown(),t.removeFrame(),r((function(){this._handleV1AuthResponse(e)}).bind(this))()},o.prototype._checkForFrameworkSpecificVerifyCardErrors=function(e){var t;return"function"!=typeof e.addFrame?t="an addFrame function":"function"!=typeof e.removeFrame&&(t="a removeFrame function"),t},o.prototype._formatVerifyCardOptions=function(e){var t=i.prototype._formatVerifyCardOptions.call(this,e);return t.addFrame=r(e.addFrame),t.removeFrame=r(e.removeFrame),t.showLoader=!1!==e.showLoader,t},o.prototype._formatLookupData=function(e){var t=this;return i.prototype._formatLookupData.call(this,e).then((function(n){return e.customer&&e.customer.billingAddress&&(n.customer=t.transformV1CustomerBillingAddress(e.customer)),n}))},o.prototype._presentChallenge=function(e,t){t.addFrame(null,this._createIframe({showLoader:t.showLoader,lookupResponse:e.lookup,removeFrame:t.removeFrame}))},t.exports=o},{"../../../lib/deferred":109,"./base":159}],165:[function(e,t,n){(function(n){"use strict";var i=e("./base"),r=e("../../../lib/assign").assign,o=e("../../../lib/deferred"),a=e("../../../lib/braintree-error"),s=e("../../../lib/convert-to-braintree-error"),c=e("../../../lib/analytics"),l=e("../../../lib/assets"),d=e("../../shared/errors"),u=e("../../../lib/enumerate"),p=e("../../shared/constants"),_=e("../../../lib/promise"),f=e("@braintree/extended-promise"),h=e("../../../lib/constants").INTEGRATION_TIMEOUT_MS,m=e("../../../lib/constants").PLATFORM;function E(e){i.call(this,e),this._useV1Fallback=!1,this._clientMetadata={requestedThreeDSecureVersion:"2",sdkVersion:m+"/3.60.0"},this._getDfReferenceIdPromisePlus=new f,this.setupSongbird(e),this._cardinalEvents=[]}function b(e,t,n){t[n+"Line1"]=e.streetAddress,t[n+"Line2"]=e.extendedAddress,t[n+"Line3"]=e.line3,t[n+"City"]=e.locality,t[n+"State"]=e.region,t[n+"PostalCode"]=e.postalCode,t[n+"CountryCode"]=e.countryCodeAlpha2}E.prototype=Object.create(i.prototype,{constructor:E}),E.events=u(["ON_LOOKUP_COMPLETE"],"songbird-framework:"),E.prototype.setUpEventListeners=function(e){this.on(E.events.ON_LOOKUP_COMPLETE,(function(t,n){e("lookup-complete",t,n)}))},E.prototype.prepareLookup=function(e){var t=r({},e),n=this;return this.getDfReferenceId().then((function(e){t.dfReferenceId=e})).then((function(){return n._triggerCardinalBinProcess(e.bin)})).catch((function(){})).then((function(){return n._waitForClient()})).then((function(){return t.clientMetadata=n._clientMetadata,t.authorizationFingerprint=n._client.getConfiguration().authorizationFingerprint,t.braintreeLibraryVersion="braintree/web/3.60.0",t}))},E.prototype.initializeChallengeWithLookupResponse=function(e,t){return this.setupSongbird().then((function(){return i.prototype.initializeChallengeWithLookupResponse.call(this,e,t)}).bind(this))},E.prototype._initiateV1Fallback=function(e){this._useV1Fallback=!0,c.sendEvent(this._createPromise,"three-d-secure.v1-fallback."+e),this._songbirdPromise.resolve()},E.prototype._triggerCardinalBinProcess=function(e){var t=this,i=Date.now();return e?n.Cardinal.trigger("bin.process",e).then((function(e){t._clientMetadata.issuerDeviceDataCollectionTimeElapsed=Date.now()-i,t._clientMetadata.issuerDeviceDataCollectionResult=e&&e.Status})):_.resolve()},E.prototype.transformBillingAddress=function(e,t){return t&&(b(t,e,"billing"),e.billingPhoneNumber=t.phoneNumber,e.billingGivenName=t.givenName,e.billingSurname=t.surname),e},E.prototype.transformShippingAddress=function(e){var t=e.shippingAddress;return t&&(b(t,e,"shipping"),delete e.shippingAddress),e},E.prototype._createV1IframeModalElement=function(e){var t=document.createElement("div");return t.innerHTML='<div data-braintree-v1-fallback-iframe-container="true" style="height: 400px;"></div>',t.querySelector('[data-braintree-v1-fallback-iframe-container="true"]').appendChild(e),t},E.prototype._createV1IframeModal=function(e){var t=this._createV1IframeModalElement(e),n=t.querySelector("[data-braintree-v1-fallback-close-button]"),i=t.querySelector("[data-braintree-v1-fallback-backdrop]"),r=this;function o(){t.parentNode.removeChild(t),r.cancelVerifyCard(d.THREEDS_CARDINAL_SDK_CANCELED),document.removeEventListener("keyup",r._onV1Keyup),r._onV1Keyup=null}return this._onV1Keyup=function(e){"Escape"===e.key&&t.parentNode&&o()},n&&n.addEventListener("click",o),i&&i.addEventListener("click",o),document.addEventListener("keyup",this._onV1Keyup),t},E.prototype._addV1IframeToPage=function(){document.body.appendChild(this._v1Modal)},E.prototype._handleAuthResponseFromV1Fallback=function(e){this._teardownV1Elements(),this._v1Modal.parentNode.removeChild(this._v1Modal),this._handleV1AuthResponse(e)},E.prototype._presentChallengeWithV1Fallback=function(e){var t=this;this._setupV1Elements({lookupResponse:e,showLoader:!0,handleAuthResponse:function(e){t._handleAuthResponseFromV1Fallback(e)}}),this._v1Modal=this._createV1IframeModal(this._v1Iframe),this._addV1IframeToPage()},E.prototype.setupSongbird=function(e){var t=this,i=Date.now();return this._songbirdPromise||(e=e||{},this._songbirdPromise=new f,this._v2SetupFailureReason="reason-unknown",t._loadCardinalScript(e).then((function(){return n.Cardinal?t._configureCardinalSdk({setupOptions:e,setupStartTime:i}):(t._v2SetupFailureReason="cardinal-global-unavailable",_.reject(new a(d.THREEDS_CARDINAL_SDK_SETUP_FAILED)))})).catch((function(e){var i=s(e,{type:d.THREEDS_CARDINAL_SDK_SETUP_FAILED.type,code:d.THREEDS_CARDINAL_SDK_SETUP_FAILED.code,message:d.THREEDS_CARDINAL_SDK_SETUP_FAILED.message});t._getDfReferenceIdPromisePlus.reject(i),n.clearTimeout(t._songbirdSetupTimeoutReference),c.sendEvent(t._client,"three-d-secure.cardinal-sdk.init.setup-failed"),t._initiateV1Fallback("cardinal-sdk-setup-failed."+t._v2SetupFailureReason)}))),this._songbirdPromise},E.prototype._configureCardinalSdk=function(e){var t=this;return this._waitForClient().then((function(){var i=t._client.getConfiguration().gatewayConfiguration.threeDSecure.cardinalAuthenticationJWT,r=e.setupStartTime,o=t._createCardinalConfigurationOptions(e.setupOptions);t.setCardinalListener("payments.setupComplete",t._createPaymentsSetupCompleteCallback()),t._setupFrameworkSpecificListeners(),n.Cardinal.configure(o),n.Cardinal.setup("init",{jwt:i}),t._clientMetadata.cardinalDeviceDataCollectionTimeElapsed=Date.now()-r,t.setCardinalListener("payments.validated",t._createPaymentsValidatedCallback())})).catch((function(e){return t._v2SetupFailureReason="cardinal-configuration-threw-error",_.reject(e)}))},E.prototype.setCardinalListener=function(e,t){this._cardinalEvents.push(e),n.Cardinal.on(e,t)},E.prototype._setupFrameworkSpecificListeners=function(){},E.prototype._createCardinalConfigurationOptions=function(e){var t=e.cardinalSDKConfig||{},n=t.payment||{};return!t.logging&&e.loggingEnabled&&(t.logging={level:"verbose"}),t.payment={},n.hasOwnProperty("displayLoading")&&(t.payment.displayLoading=n.displayLoading),n.hasOwnProperty("displayExitButton")&&(t.payment.displayExitButton=n.displayExitButton),t},E.prototype._loadCardinalScript=function(e){var t=this,i=p.CARDINAL_SCRIPT_SOURCE.sandbox;return this._waitForClient().then((function(){var r="production"===t._client.getConfiguration().gatewayConfiguration.environment;return t._songbirdSetupTimeoutReference=n.setTimeout((function(){c.sendEvent(t._client,"three-d-secure.cardinal-sdk.init.setup-timeout"),t._initiateV1Fallback("cardinal-sdk-setup-timeout")}),e.timeout||h),r&&(i=p.CARDINAL_SCRIPT_SOURCE.production),l.loadScript({src:i})})).catch((function(e){return t._v2SetupFailureReason="songbird-js-failed-to-load",_.reject(s(e,d.THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED))}))},E.prototype._createPaymentsSetupCompleteCallback=function(){var e=this;return function(t){e._getDfReferenceIdPromisePlus.resolve(t.sessionId),n.clearTimeout(e._songbirdSetupTimeoutReference),c.sendEvent(e._createPromise,"three-d-secure.cardinal-sdk.init.setup-completed"),e._songbirdPromise.resolve()}},E.prototype.getDfReferenceId=function(){return this._getDfReferenceIdPromisePlus},E.prototype._performJWTValidation=function(e){var t=this._lookupPaymentMethod.nonce,n="payment_methods/"+t+"/three_d_secure/authenticate_from_jwt",i=this;return c.sendEvent(i._createPromise,"three-d-secure.verification-flow.upgrade-payment-method.started"),this._waitForClient().then((function(){return i._client.request({method:"post",endpoint:n,data:{jwt:e,paymentMethodNonce:t}})})).then((function(e){var t=i._formatAuthResponse(e.paymentMethod||i._lookupPaymentMethod,e.threeDSecureInfo);return c.sendEvent(i._client,"three-d-secure.verification-flow.upgrade-payment-method.succeeded"),_.resolve(t)})).catch((function(e){var t=new a({type:d.THREEDS_JWT_AUTHENTICATION_FAILED.type,code:d.THREEDS_JWT_AUTHENTICATION_FAILED.code,message:d.THREEDS_JWT_AUTHENTICATION_FAILED.message,details:{originalError:e}});return c.sendEvent(i._client,"three-d-secure.verification-flow.upgrade-payment-method.errored"),_.reject(t)}))},E.prototype._createPaymentsValidatedCallback=function(){var e=this;return function(t,n){var i;if(c.sendEvent(e._createPromise,"three-d-secure.verification-flow.cardinal-sdk.action-code."+t.ActionCode.toLowerCase()),e._verifyCardPromisePlus)switch(t.ActionCode){case"SUCCESS":case"NOACTION":case"FAILURE":e._performJWTValidation(n).then((function(t){e._verifyCardPromisePlus.resolve(t)})).catch((function(t){e._verifyCardPromisePlus.reject(t)}));break;case"ERROR":switch(c.sendEvent(e._createPromise,"three-d-secure.verification-flow.cardinal-sdk-error."+t.ErrorNumber),t.ErrorNumber){case 10001:case 10002:i=new a(d.THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT);break;case 10003:case 10007:case 10009:i=new a(d.THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT);break;case 10005:case 10006:i=new a(d.THREEDS_CARDINAL_SDK_BAD_CONFIG);break;case 10008:case 10010:i=new a(d.THREEDS_CARDINAL_SDK_BAD_JWT);break;case 10011:c.sendEvent(e._createPromise,"three-d-secure.verification-flow.canceled"),i=new a(d.THREEDS_CARDINAL_SDK_CANCELED);break;default:i=new a(d.THREEDS_CARDINAL_SDK_ERROR)}i.details={originalError:{code:t.ErrorNumber,description:t.ErrorDescription}},e._verifyCardPromisePlus.reject(i)}else e._initiateV1Fallback("cardinal-sdk-setup-error.number-"+t.ErrorNumber)}},E.prototype._checkForVerifyCardError=function(e,t){return i.prototype._checkForVerifyCardError.call(this,e,t)},E.prototype._checkForFrameworkSpecificVerifyCardErrors=function(e,t){var n;return"function"==typeof e.onLookupComplete||t.ignoreOnLookupCompleteRequirement||(n="an onLookupComplete function"),n},E.prototype._formatVerifyCardOptions=function(e){var t=i.prototype._formatVerifyCardOptions.call(this,e),n=t.additionalInformation||{};return n=this.transformBillingAddress(n,e.billingAddress),n=this.transformShippingAddress(n),e.onLookupComplete&&(t.onLookupComplete=o(e.onLookupComplete)),e.email&&(n.email=e.email),e.mobilePhoneNumber&&(n.mobilePhoneNumber=e.mobilePhoneNumber),t.additionalInformation=n,t},E.prototype._onLookupComplete=function(e,t){var n=this;return i.prototype._onLookupComplete.call(this,e).then((function(e){return new _((function(i,r){function o(){i(e)}e.requiresUserAuthentication=Boolean(e.lookup&&e.lookup.acsUrl),n._verifyCardPromisePlus.catch(r),t.onLookupComplete?t.onLookupComplete(e,o):n._emit(E.events.ON_LOOKUP_COMPLETE,e,o)}))}))},E.prototype._presentChallenge=function(e){this._useV1Fallback?this._presentChallengeWithV1Fallback(e.lookup):n.Cardinal.continue("cca",{AcsUrl:e.lookup.acsUrl,Payload:e.lookup.pareq},{OrderDetails:{TransactionId:e.lookup.transactionId}})},E.prototype._formatLookupData=function(e){var t=this;return i.prototype._formatLookupData.call(this,e).then((function(n){return n.additionalInfo=e.additionalInformation,e.challengeRequested&&(n.challengeRequested=e.challengeRequested),e.exemptionRequested&&(n.exemptionRequested=e.exemptionRequested),e.bin&&(n.bin=e.bin),t.prepareLookup(n)}))},E.prototype.cancelVerifyCard=function(e){var t=this;return i.prototype.cancelVerifyCard.call(this).then((function(n){return t._verifyCardPromisePlus&&(e=e||new a(d.THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT),t._verifyCardPromisePlus.reject(e)),n}))},E.prototype.teardown=function(){return n.Cardinal&&this._cardinalEvents.forEach((function(e){n.Cardinal.off(e)})),i.prototype.teardown.call(this)},t.exports=E}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../lib/analytics":93,"../../../lib/assets":94,"../../../lib/assign":95,"../../../lib/braintree-error":98,"../../../lib/constants":103,"../../../lib/convert-to-braintree-error":105,"../../../lib/deferred":109,"../../../lib/enumerate":111,"../../../lib/promise":132,"../../shared/constants":168,"../../shared/errors":169,"./base":159,"@braintree/extended-promise":22}],166:[function(e,t,n){"use strict";var i=e("@braintree/wrap-promise"),r=e("../../lib/methods"),o=e("../../lib/convert-methods-to-error"),a=e("@braintree/event-emitter"),s=e("./frameworks");function c(e){var t=this,n=s[e.framework];a.call(this),this._framework=new n(e),this._framework.setUpEventListeners((function(){t._emit.apply(t,arguments)}))}a.createChild(c),c.prototype.verifyCard=function(e){var t;return this.hasListener("lookup-complete")&&(t={ignoreOnLookupCompleteRequirement:!0}),this._framework.verifyCard(e,t)},c.prototype.initializeChallengeWithLookupResponse=function(e){return"string"==typeof e&&(e=JSON.parse(e)),this._framework.initializeChallengeWithLookupResponse(e)},c.prototype.prepareLookup=function(e){return this._framework.prepareLookup(e).then((function(e){return JSON.stringify(e)}))},c.prototype.cancelVerifyCard=function(){return this._framework.cancelVerifyCard()},c.prototype.teardown=function(){var e=r(c.prototype).concat(r(a.prototype));return o(this,e),this._framework.teardown()},t.exports=i.wrapPrototype(c)},{"../../lib/convert-methods-to-error":104,"../../lib/methods":130,"./frameworks":162,"@braintree/event-emitter":21,"@braintree/wrap-promise":30}],167:[function(e,t,n){"use strict";var i=e("./external/three-d-secure"),r=e("../lib/is-https").isHTTPS,o=e("../lib/basic-component-verification"),a=e("../lib/create-deferred-client"),s=e("../lib/create-assets-url"),c=e("../lib/braintree-error"),l=e("../lib/analytics"),d=e("./shared/errors"),u=e("../lib/promise"),p=e("@braintree/wrap-promise");t.exports={create:p((function(e){return o.verify({name:"3D Secure",client:e.client,authorization:e.authorization}).then((function(){var t=s.create(e.authorization),n=function(e){var t=String(e.version||"");if(!t||"1"===t)return"legacy";switch(t){case"2":case"2-cardinal-modal":return"cardinal-modal";case"2-bootstrap3-modal":return"bootstrap3-modal";case"2-inline-iframe":return"inline-iframe";default:throw new c({code:d.THREEDS_UNRECOGNIZED_VERSION.code,type:d.THREEDS_UNRECOGNIZED_VERSION.type,message:"Version `"+e.version+"` is not a recognized version. You may need to update the version of your Braintree SDK to support this version."})}}(e),o=a.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:t,name:"3D Secure"}).then((function(t){var i,o=t.getConfiguration(),a=o.gatewayConfiguration;return e.client=t,a.threeDSecureEnabled||(i=d.THREEDS_NOT_ENABLED),"TOKENIZATION_KEY"===o.authorizationType&&(i=d.THREEDS_CAN_NOT_USE_TOKENIZATION_KEY),"production"===a.environment&&!r()&&(i=d.THREEDS_HTTPS_REQUIRED),"legacy"===n||a.threeDSecure&&a.threeDSecure.cardinalAuthenticationJWT||(l.sendEvent(e.client,"three-d-secure.initialization.failed.missing-cardinalAuthenticationJWT"),i=d.THREEDS_NOT_ENABLED_FOR_V2),i?u.reject(new c(i)):(l.sendEvent(e.client,"three-d-secure.initialized"),t)})),p=new i({client:e.client,assetsUrl:t,createPromise:o,loggingEnabled:e.loggingEnabled,cardinalSDKConfig:e.cardinalSDKConfig,framework:n});return e.client?o.then((function(){return p})):p}))})),VERSION:"3.60.0"}},{"../lib/analytics":93,"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/is-https":127,"../lib/promise":132,"./external/three-d-secure":166,"./shared/errors":169,"@braintree/wrap-promise":30}],168:[function(e,t,n){"use strict";t.exports={LANDING_FRAME_NAME:"braintreethreedsecurelanding",CARDINAL_SCRIPT_SOURCE:{production:"https://songbird.cardinalcommerce.com/edge/v1/songbird.js",sandbox:"https://songbirdstag.cardinalcommerce.com/edge/v1/songbird.js"}}},{}],169:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={THREEDS_NOT_ENABLED:{type:i.types.MERCHANT,code:"THREEDS_NOT_ENABLED",message:"3D Secure is not enabled for this merchant."},THREEDS_CAN_NOT_USE_TOKENIZATION_KEY:{type:i.types.MERCHANT,code:"THREEDS_CAN_NOT_USE_TOKENIZATION_KEY",message:"3D Secure can not use a tokenization key for authorization."},THREEDS_HTTPS_REQUIRED:{type:i.types.MERCHANT,code:"THREEDS_HTTPS_REQUIRED",message:"3D Secure requires HTTPS."},THREEDS_NOT_ENABLED_FOR_V2:{type:i.types.MERCHANT,code:"THREEDS_NOT_ENABLED_FOR_V2",message:"3D Secure version 2 is not enabled for this merchant. Contact Braintree Support for assistance at https://help.braintreepayments.com/"},THREEDS_UNRECOGNIZED_VERSION:{type:i.types.MERCHANT,code:"THREEDS_UNRECOGNIZED_VERSION"},THREEDS_CARDINAL_SDK_SETUP_FAILED:{type:i.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_SETUP_FAILED",message:"Something went wrong setting up Cardinal's Songbird.js library."},THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED:{type:i.types.NETWORK,code:"THREEDS_CARDINAL_SDK_SCRIPT_LOAD_FAILED",message:"Cardinal's Songbird.js library could not be loaded."},THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT:{type:i.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_SETUP_TIMEDOUT",message:"Cardinal's Songbird.js took too long to setup."},THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT:{type:i.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_RESPONSE_TIMEDOUT",message:"Cardinal's API took too long to respond."},THREEDS_CARDINAL_SDK_BAD_CONFIG:{type:i.types.MERCHANT,code:"THREEDS_CARDINAL_SDK_BAD_CONFIG",message:"JWT or other required field missing. Please check your setup configuration."},THREEDS_CARDINAL_SDK_BAD_JWT:{type:i.types.MERCHANT,code:"THREEDS_CARDINAL_SDK_BAD_JWT",message:"Cardinal JWT missing or malformed. Please check your setup configuration."},THREEDS_CARDINAL_SDK_ERROR:{type:i.types.UNKNOWN,code:"THREEDS_CARDINAL_SDK_ERROR",message:"A general error has occurred with Cardinal. See description for more information."},THREEDS_CARDINAL_SDK_CANCELED:{type:i.types.CUSTOMER,code:"THREEDS_CARDINAL_SDK_CANCELED",message:"Canceled by user."},THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT:{type:i.types.MERCHANT,code:"THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT",message:"3D Secure verfication canceled by merchant."},THREEDS_AUTHENTICATION_IN_PROGRESS:{type:i.types.MERCHANT,code:"THREEDS_AUTHENTICATION_IN_PROGRESS",message:"Cannot call verifyCard while existing authentication is in progress."},THREEDS_MISSING_VERIFY_CARD_OPTION:{type:i.types.MERCHANT,code:"THREEDS_MISSING_VERIFY_CARD_OPTION"},THREEDS_JWT_AUTHENTICATION_FAILED:{type:i.types.UNKNOWN,code:"THREEDS_JWT_AUTHENTICATION_FAILED",message:"Something went wrong authenticating the JWT from Cardinal"},THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR:{type:i.types.MERCHANT,code:"THREEDS_LOOKUP_TOKENIZED_CARD_NOT_FOUND_ERROR",message:"Either the payment method nonce passed to `verifyCard` does not exist, or it was already consumed"},THREEDS_LOOKUP_VALIDATION_ERROR:{type:i.types.CUSTOMER,code:"THREEDS_LOOKUP_VALIDATION_ERROR",message:"The data passed in `verifyCard` did not pass validation checks. See details for more info"},THREEDS_LOOKUP_ERROR:{type:i.types.UNKNOWN,code:"THREEDS_LOOKUP_ERROR",message:"Something went wrong during the 3D Secure lookup"},THREEDS_INLINE_IFRAME_DETAILS_INCORRECT:{type:i.types.UNKNOWN,code:"THREEDS_INLINE_IFRAME_DETAILS_INCORRECT",message:"Something went wrong when attempting to add the authentication iframe to the page."},THREEDS_NO_VERIFICATION_PAYLOAD:{type:i.types.MERCHANT,code:"THREEDS_NO_VERIFICATION_PAYLOAD",message:"No verification payload available."},THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN:{type:i.types.INTERNAL,code:"THREEDS_TERM_URL_REQUIRES_BRAINTREE_DOMAIN",message:"Term Url must be on a Braintree domain."},THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED:{type:i.types.INTERNAL,code:"THREEDS_FRAMEWORK_METHOD_NOT_IMPLEMENTED",message:"Method not implemented for this framework."}}},{"../../lib/braintree-error":98}],170:[function(e,t,n){"use strict";var i=e("../../lib/enumerate");t.exports=i(["AUTHENTICATION_COMPLETE"],"threedsecure:")},{"../../lib/enumerate":111}],171:[function(e,t,n){"use strict";var i=e("./shared/unionpay"),r=e("../lib/basic-component-verification"),o=e("../lib/braintree-error"),a=e("../lib/create-deferred-client"),s=e("../lib/create-assets-url"),c=e("../lib/analytics"),l=e("./shared/errors"),d=e("../lib/promise"),u=e("@braintree/wrap-promise");t.exports={create:u((function(e){return r.verify({name:"UnionPay",client:e.client,authorization:e.authorization}).then((function(){return a.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:s.create(e.authorization),name:"UnionPay"})})).then((function(t){var n=t.getConfiguration();return e.client=t,n.gatewayConfiguration.unionPay&&!0===n.gatewayConfiguration.unionPay.enabled?(c.sendEvent(e.client,"unionpay.initialized"),new i(e)):d.reject(new o(l.UNIONPAY_NOT_ENABLED))}))})),VERSION:"3.60.0"}},{"../lib/analytics":93,"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./shared/errors":173,"./shared/unionpay":174,"@braintree/wrap-promise":30}],172:[function(e,t,n){"use strict";var i=e("../../lib/enumerate");t.exports={events:i(["HOSTED_FIELDS_FETCH_CAPABILITIES","HOSTED_FIELDS_ENROLL","HOSTED_FIELDS_TOKENIZE"],"union-pay:"),HOSTED_FIELDS_FRAME_NAME:"braintreeunionpayhostedfields"}},{"../../lib/enumerate":111}],173:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={UNIONPAY_NOT_ENABLED:{type:i.types.MERCHANT,code:"UNIONPAY_NOT_ENABLED",message:"UnionPay is not enabled for this merchant."},UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID:{type:i.types.MERCHANT,code:"UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID",message:"Found an invalid Hosted Fields instance. Please use a valid Hosted Fields instance."},UNIONPAY_HOSTED_FIELDS_INSTANCE_REQUIRED:{type:i.types.MERCHANT,code:"UNIONPAY_HOSTED_FIELDS_INSTANCE_REQUIRED",message:"Could not find the Hosted Fields instance."},UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED:{type:i.types.MERCHANT,code:"UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED",message:"A card or a Hosted Fields instance is required. Please supply a card or a Hosted Fields instance."},UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES:{type:i.types.MERCHANT,code:"UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES",message:"Please supply either a card or a Hosted Fields instance, not both."},UNIONPAY_EXPIRATION_DATE_INCOMPLETE:{type:i.types.MERCHANT,code:"UNIONPAY_EXPIRATION_DATE_INCOMPLETE",message:"You must supply expiration month and year or neither."},UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID:{type:i.types.CUSTOMER,code:"UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID",message:"Enrollment failed due to user input error."},UNIONPAY_ENROLLMENT_NETWORK_ERROR:{type:i.types.NETWORK,code:"UNIONPAY_ENROLLMENT_NETWORK_ERROR",message:"Could not enroll UnionPay card."},UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR:{type:i.types.NETWORK,code:"UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR",message:"Could not fetch card capabilities."},UNIONPAY_TOKENIZATION_NETWORK_ERROR:{type:i.types.NETWORK,code:"UNIONPAY_TOKENIZATION_NETWORK_ERROR",message:"A tokenization network error occurred."},UNIONPAY_MISSING_MOBILE_PHONE_DATA:{type:i.types.MERCHANT,code:"UNIONPAY_MISSING_MOBILE_PHONE_DATA",message:"A `mobile` with `countryCode` and `number` is required."},UNIONPAY_FAILED_TOKENIZATION:{type:i.types.CUSTOMER,code:"UNIONPAY_FAILED_TOKENIZATION",message:"The supplied card data failed tokenization."}}},{"../../lib/braintree-error":98}],174:[function(e,t,n){"use strict";var i=e("../../lib/analytics"),r=e("../../lib/braintree-error"),o=e("../../lib/bus"),a=e("./constants"),s=e("../../lib/use-min"),c=e("../../lib/convert-methods-to-error"),l=e("./errors"),d=a.events,u=e("@braintree/iframer"),p=e("../../lib/methods"),_=e("../../lib/vendor/uuid"),f=e("../../lib/promise"),h=e("@braintree/wrap-promise");function m(e){this._options=e}m.prototype.fetchCapabilities=function(e){var t=this,n=this._options.client,o=e.card?e.card.number:null,a=e.hostedFields;return o&&a?f.reject(new r(l.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):o?n.request({method:"get",endpoint:"payment_methods/credit_cards/capabilities",data:{_meta:{source:"unionpay"},creditCard:{number:o}}}).then((function(e){return i.sendEvent(n,"unionpay.capabilities-received"),e})).catch((function(e){var t=e.details&&e.details.httpStatus;return i.sendEvent(n,"unionpay.capabilities-failed"),f.reject(403===t?e:new r({type:l.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.type,code:l.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.code,message:l.UNIONPAY_FETCH_CAPABILITIES_NETWORK_ERROR.message,details:{originalError:e}}))})):a?a._bus?t._initializeHostedFields().then((function(){return new f((function(e,n){t._bus.emit(d.HOSTED_FIELDS_FETCH_CAPABILITIES,{hostedFields:a},(function(t){t.err?n(new r(t.err)):e(t.payload)}))}))})):f.reject(new r(l.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID)):f.reject(new r(l.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},m.prototype.enroll=function(e){var t,n=this,o=this._options.client,a=e.card,s=e.mobile,c=e.hostedFields;if(!s)return f.reject(new r(l.UNIONPAY_MISSING_MOBILE_PHONE_DATA));if(c)return c._bus?a?f.reject(new r(l.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):new f((function(e,t){n._initializeHostedFields().then((function(){n._bus.emit(d.HOSTED_FIELDS_ENROLL,{hostedFields:c,mobile:s},(function(n){n.err?t(new r(n.err)):e(n.payload)}))}))})):f.reject(new r(l.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID));if(a&&a.number){if(t={_meta:{source:"unionpay"},unionPayEnrollment:{number:a.number,mobileCountryCode:s.countryCode,mobileNumber:s.number}},a.expirationDate)t.unionPayEnrollment.expirationDate=a.expirationDate;else if(a.expirationMonth||a.expirationYear){if(!a.expirationMonth||!a.expirationYear)return f.reject(new r(l.UNIONPAY_EXPIRATION_DATE_INCOMPLETE));t.unionPayEnrollment.expirationYear=a.expirationYear,t.unionPayEnrollment.expirationMonth=a.expirationMonth}return o.request({method:"post",endpoint:"union_pay_enrollments",data:t}).then((function(e){return i.sendEvent(o,"unionpay.enrollment-succeeded"),{enrollmentId:e.unionPayEnrollmentId,smsCodeRequired:e.smsCodeRequired}})).catch((function(e){var t,n=e.details&&e.details.httpStatus;return 403===n?t=e:n<500?(t=new r(l.UNIONPAY_ENROLLMENT_CUSTOMER_INPUT_INVALID)).details={originalError:e}:(t=new r(l.UNIONPAY_ENROLLMENT_NETWORK_ERROR)).details={originalError:e},i.sendEvent(o,"unionpay.enrollment-failed"),f.reject(t)}))}return f.reject(new r(l.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},m.prototype.tokenize=function(e){var t,n=this,o=this._options.client,a=e.card,s=e.hostedFields;return a&&s?f.reject(new r(l.UNIONPAY_CARD_AND_HOSTED_FIELDS_INSTANCES)):a?(t={_meta:{source:"unionpay"},creditCard:{number:e.card.number,options:{unionPayEnrollment:{id:e.enrollmentId}}}},e.smsCode&&(t.creditCard.options.unionPayEnrollment.smsCode=e.smsCode),a.expirationDate?t.creditCard.expirationDate=a.expirationDate:a.expirationMonth&&a.expirationYear&&(t.creditCard.expirationYear=a.expirationYear,t.creditCard.expirationMonth=a.expirationMonth),e.card.cvv&&(t.creditCard.cvv=e.card.cvv),o.request({method:"post",endpoint:"payment_methods/credit_cards",data:t}).then((function(e){var t=e.creditCards[0];return delete t.consumed,delete t.threeDSecureInfo,i.sendEvent(o,"unionpay.nonce-received"),t})).catch((function(e){var t,n=e.details&&e.details.httpStatus;return i.sendEvent(o,"unionpay.nonce-failed"),403===n?t=e:n<500?(t=new r(l.UNIONPAY_FAILED_TOKENIZATION)).details={originalError:e}:(t=new r(l.UNIONPAY_TOKENIZATION_NETWORK_ERROR)).details={originalError:e},f.reject(t)}))):s?s._bus?new f((function(t,i){n._initializeHostedFields().then((function(){n._bus.emit(d.HOSTED_FIELDS_TOKENIZE,e,(function(e){e.err?i(new r(e.err)):t(e.payload)}))}))})):f.reject(new r(l.UNIONPAY_HOSTED_FIELDS_INSTANCE_INVALID)):f.reject(new r(l.UNIONPAY_CARD_OR_HOSTED_FIELDS_INSTANCE_REQUIRED))},m.prototype.teardown=function(){return this._bus&&(this._hostedFieldsFrame.parentNode.removeChild(this._hostedFieldsFrame),this._bus.teardown()),c(this,p(m.prototype)),f.resolve()},m.prototype._initializeHostedFields=function(){var e,t,n=_(),i=this;return this._hostedFieldsInitializePromise||(this._hostedFieldsInitializePromise=new f((function(r){e=i._options.client.getConfiguration().gatewayConfiguration.assetsUrl,t=i._options.client.getConfiguration().isDebug,i._bus=new o({channel:n,merchantUrl:location.href}),i._hostedFieldsFrame=u({name:a.HOSTED_FIELDS_FRAME_NAME+"_"+n,src:e+"/web/3.60.0/html/unionpay-hosted-fields-frame"+s(t)+".html",height:0,width:0}),i._bus.on(o.events.CONFIGURATION_REQUEST,(function(e){e(i._options.client),r()})),document.body.appendChild(i._hostedFieldsFrame)}))),this._hostedFieldsInitializePromise},t.exports=h.wrapPrototype(m)},{"../../lib/analytics":93,"../../lib/braintree-error":98,"../../lib/bus":101,"../../lib/convert-methods-to-error":104,"../../lib/methods":130,"../../lib/promise":132,"../../lib/use-min":134,"../../lib/vendor/uuid":136,"./constants":172,"./errors":173,"@braintree/iframer":23,"@braintree/wrap-promise":30}],175:[function(e,t,n){"use strict";t.exports={PLAID_LINK_JS:"https://cdn.plaid.com/link/v2/stable/link-initialize.js"}},{}],176:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={US_BANK_ACCOUNT_OPTION_REQUIRED:{type:i.types.MERCHANT,code:"US_BANK_ACCOUNT_OPTION_REQUIRED"},US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS:{type:i.types.MERCHANT,code:"US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS"},US_BANK_ACCOUNT_LOGIN_LOAD_FAILED:{type:i.types.NETWORK,code:"US_BANK_ACCOUNT_LOGIN_LOAD_FAILED",message:"Bank login flow failed to load."},US_BANK_ACCOUNT_LOGIN_CLOSED:{type:i.types.CUSTOMER,code:"US_BANK_ACCOUNT_LOGIN_CLOSED",message:"Customer closed bank login flow before authorizing."},US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE:{type:i.types.MERCHANT,code:"US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE",message:"Another bank login tokenization request is active."},US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR:{type:i.types.NETWORK,code:"US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR",message:"A tokenization network error occurred."},US_BANK_ACCOUNT_FAILED_TOKENIZATION:{type:i.types.CUSTOMER,code:"US_BANK_ACCOUNT_FAILED_TOKENIZATION",message:"The supplied data failed tokenization."},US_BANK_ACCOUNT_NOT_ENABLED:{type:i.types.MERCHANT,code:"US_BANK_ACCOUNT_NOT_ENABLED",message:"US bank account is not enabled."},US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED:{type:i.types.MERCHANT,code:"US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED",message:"Bank login is not enabled."}}},{"../lib/braintree-error":98}],177:[function(e,t,n){"use strict";var i=e("../lib/basic-component-verification"),r=e("../lib/braintree-error"),o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("./errors"),c=e("./us-bank-account"),l=e("../lib/promise"),d=e("@braintree/wrap-promise");t.exports={create:d((function(e){var t="US Bank Account";return i.verify({name:t,client:e.client,authorization:e.authorization}).then((function(){return o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:t})})).then((function(t){return e.client=t,e.client.getConfiguration().gatewayConfiguration.usBankAccount?new c(e):l.reject(new r(s.US_BANK_ACCOUNT_NOT_ENABLED))}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./errors":176,"./us-bank-account":178,"@braintree/wrap-promise":30}],178:[function(e,t,n){(function(n){"use strict";var i=e("../lib/braintree-error"),r=e("./constants"),o=e("./errors"),a=e("../lib/errors"),s=e("../lib/analytics"),c=e("../lib/once"),l=e("../lib/convert-methods-to-error"),d=e("../lib/methods"),u=e("../lib/promise"),p=e("@braintree/wrap-promise"),_=v("UsBankAccount"),f=v("UsBankLogin");function h(e){this._client=e.client,this._isTokenizingBankLogin=!1,s.sendEvent(this._client,"usbankaccount.initialized")}function m(e){var t,n=e.details&&e.details.httpStatus;return(t=new i(401===n?a.BRAINTREE_API_ACCESS_RESTRICTED:n<500?o.US_BANK_ACCOUNT_FAILED_TOKENIZATION:o.US_BANK_ACCOUNT_TOKENIZATION_NETWORK_ERROR)).details={originalError:e},t}function E(e,t){var n=e.data[t].paymentMethod;return{nonce:n.id,details:{},description:"US bank account ending in - "+n.details.last4,type:"us_bank_account"}}function b(e,t){function r(){var i=this.readyState;i&&"loaded"!==i&&"complete"!==i||(e.removeEventListener("error",a),e.removeEventListener("load",r),e.removeEventListener("readystatechange",r),t(null,n.Plaid))}function a(){e.parentNode.removeChild(e),t(new i(o.US_BANK_ACCOUNT_LOGIN_LOAD_FAILED))}e.addEventListener("error",a),e.addEventListener("load",r),e.addEventListener("readystatechange",r)}function y(e){return{streetAddress:e.streetAddress,extendedAddress:e.extendedAddress,city:e.locality,state:e.region,zipCode:e.postalCode}}function g(e,t){"personal"===t.ownershipType?e.individualOwner={firstName:t.firstName,lastName:t.lastName}:"business"===t.ownershipType&&(e.businessOwner={businessName:t.businessName})}function v(e){return"mutation Tokenize"+e+"($input: Tokenize"+e+"Input!) {  tokenize"+e+"(input: $input) {    paymentMethod {      id      details {        ... on UsBankAccountDetails {          last4        }      }    }  }}"}h.prototype.tokenize=function(e){return(e=e||{}).mandateText?e.bankDetails&&e.bankLogin?u.reject(new i({type:o.US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS.type,code:o.US_BANK_ACCOUNT_MUTUALLY_EXCLUSIVE_OPTIONS.code,message:"tokenize must be called with bankDetails or bankLogin, not both."})):e.bankDetails?this._tokenizeBankDetails(e):e.bankLogin?this._tokenizeBankLogin(e):u.reject(new i({type:o.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:o.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:"tokenize must be called with bankDetails or bankLogin."})):u.reject(new i({type:o.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:o.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:"mandateText property is required."}))},h.prototype._tokenizeBankDetails=function(e){var t=this._client,n=e.bankDetails,i={achMandate:e.mandateText,routingNumber:n.routingNumber,accountNumber:n.accountNumber,accountType:n.accountType.toUpperCase(),billingAddress:y(n.billingAddress||{})};return g(i,n),t.request({api:"graphQLApi",data:{query:_,variables:{input:{usBankAccount:i}}}}).then((function(e){return s.sendEvent(t,"usbankaccount.bankdetails.tokenization.succeeded"),u.resolve(E(e,"tokenizeUsBankAccount"))})).catch((function(e){var n=m(e);return s.sendEvent(t,"usbankaccount.bankdetails.tokenization.failed"),u.reject(n)}))},h.prototype._tokenizeBankLogin=function(e){var t=this,n=this._client,r=n.getConfiguration().gatewayConfiguration,a="production"===r.environment,c=r.usBankAccount.plaid;return e.bankLogin.displayName?c?this._isTokenizingBankLogin?u.reject(new i(o.US_BANK_ACCOUNT_LOGIN_REQUEST_ACTIVE)):(this._isTokenizingBankLogin=!0,new u((function(r,l){t._loadPlaid((function(d,u){d?l(d):(u.create({clientName:e.bankLogin.displayName,apiVersion:"v2",env:a?"production":"sandbox",key:c.publicKey,product:"auth",selectAccount:!0,onExit:function(){t._isTokenizingBankLogin=!1,s.sendEvent(n,"usbankaccount.banklogin.tokenization.closed.by-user"),l(new i(o.US_BANK_ACCOUNT_LOGIN_CLOSED))},onSuccess:function(i,o){var c=e.bankLogin,d={publicToken:i,accountId:a?o.account_id:"plaid_account_id",accountType:o.account.subtype.toUpperCase(),achMandate:e.mandateText,billingAddress:y(c.billingAddress||{})};g(d,c),n.request({api:"graphQLApi",data:{query:f,variables:{input:{usBankLogin:d}}}}).then((function(e){t._isTokenizingBankLogin=!1,s.sendEvent(n,"usbankaccount.banklogin.tokenization.succeeded"),r(E(e,"tokenizeUsBankLogin"))})).catch((function(e){var i;t._isTokenizingBankLogin=!1,i=m(e),s.sendEvent(n,"usbankaccount.banklogin.tokenization.failed"),l(i)}))}}).open(),s.sendEvent(n,"usbankaccount.banklogin.tokenization.started"))}))}))):u.reject(new i(o.US_BANK_ACCOUNT_BANK_LOGIN_NOT_ENABLED)):u.reject(new i({type:o.US_BANK_ACCOUNT_OPTION_REQUIRED.type,code:o.US_BANK_ACCOUNT_OPTION_REQUIRED.code,message:"displayName property is required when using bankLogin."}))},h.prototype._loadPlaid=function(e){var t,i;e=c(e),n.Plaid?e(null,n.Plaid):(t=document.querySelector('script[src="'+r.PLAID_LINK_JS+'"]'))?b(t,e):((i=document.createElement("script")).src=r.PLAID_LINK_JS,i.async=!0,b(i,e),document.body.appendChild(i),this._plaidScript=i)},h.prototype.teardown=function(){return this._plaidScript&&document.body.removeChild(this._plaidScript),l(this,d(h.prototype)),u.resolve()},t.exports=p.wrapPrototype(h)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/analytics":93,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/errors":112,"../lib/methods":130,"../lib/once":131,"../lib/promise":132,"./constants":175,"./errors":176,"@braintree/wrap-promise":30}],179:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={VAULT_MANAGER_DELETE_PAYMENT_METHOD_NONCE_REQUIRES_CLIENT_TOKEN:{type:i.types.MERCHANT,code:"VAULT_MANAGER_DELETE_PAYMENT_METHOD_NONCE_REQUIRES_CLIENT_TOKEN",message:"A client token with a customer id must be used to delete a payment method nonce."},VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND:{type:i.types.MERCHANT,code:"VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND"},VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR:{type:i.types.UNKNOWN,code:"VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR"}}},{"../lib/braintree-error":98}],180:[function(e,t,n){"use strict";var i=e("../lib/basic-component-verification"),r=e("../lib/create-deferred-client"),o=e("../lib/create-assets-url"),a=e("./vault-manager"),s=e("@braintree/wrap-promise");t.exports={create:s((function(e){var t="Vault Manager";return i.verify({name:t,client:e.client,authorization:e.authorization}).then((function(){return new a({createPromise:r.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:o.create(e.authorization),name:t})})}))})),VERSION:"3.60.0"}},{"../lib/basic-component-verification":96,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"./vault-manager":181,"@braintree/wrap-promise":30}],181:[function(e,t,n){"use strict";var i=e("../lib/analytics"),r=e("../lib/braintree-error"),o=e("./errors"),a=e("../lib/convert-methods-to-error"),s=e("../lib/methods"),c=e("../lib/promise"),l=e("@braintree/wrap-promise");function d(e){this._createPromise=e.createPromise}function u(e){var t={nonce:e.nonce,default:e.default,details:e.details,hasSubscription:e.hasSubscription,type:e.type};return e.description&&(t.description=e.description),e.binData&&(t.binData=e.binData),t}d.prototype.fetchPaymentMethods=function(e){var t;return t=!0===(e=e||{}).defaultFirst?1:0,this._createPromise.then((function(e){return e.request({endpoint:"payment_methods",method:"get",data:{defaultFirst:t}})})).then((function(e){return i.sendEvent(this._createPromise,"vault-manager.fetch-payment-methods.succeeded"),e.paymentMethods.map(u)}).bind(this))},d.prototype.deletePaymentMethod=function(e){return this._createPromise.then((function(t){return"CLIENT_TOKEN"===t.getConfiguration().authorizationType?t.request({api:"graphQLApi",data:{query:"mutation DeletePaymentMethodFromSingleUseToken($input: DeletePaymentMethodFromSingleUseTokenInput!) {  deletePaymentMethodFromSingleUseToken(input: $input) {    clientMutationId  }}",variables:{input:{singleUseTokenId:e}},operationName:"DeletePaymentMethodFromSingleUseToken"}}).then((function(){i.sendEvent(t,"vault-manager.delete-payment-method.succeeded")})).catch((function(n){var a,s=n.details.originalError;return i.sendEvent(t,"vault-manager.delete-payment-method.failed"),s[0]&&"NOT_FOUND"===s[0].extensions.errorClass&&(a=new r({type:o.VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND.type,code:o.VAULT_MANAGER_PAYMENT_METHOD_NONCE_NOT_FOUND.code,message:"A payment method for payment method nonce `"+e+"` could not be found.",details:{originalError:s}})),a||(a=new r({type:o.VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR.type,code:o.VAULT_MANAGER_DELETE_PAYMENT_METHOD_UNKNOWN_ERROR.code,message:"An unknown error occured when attempting to delete the payment method assocaited with the payment method nonce `"+e+"`.",details:{originalError:s}})),c.reject(a)})):c.reject(new r(o.VAULT_MANAGER_DELETE_PAYMENT_METHOD_NONCE_REQUIRES_CLIENT_TOKEN))}))},d.prototype.teardown=function(){return a(this,s(d.prototype)),c.resolve()},t.exports=l.wrapPrototype(d)},{"../lib/analytics":93,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/methods":130,"../lib/promise":132,"./errors":179,"@braintree/wrap-promise":30}],182:[function(e,t,n){"use strict";var i=e("../lib/analytics"),r=e("../lib/basic-component-verification"),o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("./shared/errors"),c=e("@braintree/wrap-promise"),l=e("../lib/braintree-error"),d=e("./venmo"),u=e("../lib/promise"),p=e("./shared/supports-venmo");t.exports={create:c((function(e){return r.verify({name:"Venmo",client:e.client,authorization:e.authorization}).then((function(){var t,n;return e.profileId&&"string"!=typeof e.profileId?u.reject(new l(s.VENMO_INVALID_PROFILE_ID)):e.deepLinkReturnUrl&&"string"!=typeof e.deepLinkReturnUrl?u.reject(new l(s.VENMO_INVALID_DEEP_LINK_RETURN_URL)):(t=o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:"Venmo"}).then((function(t){var n=t.getConfiguration();return e.client=t,n.gatewayConfiguration.payWithVenmo?t:u.reject(new l(s.VENMO_NOT_ENABLED))})),e.createPromise=t,n=new d(e),i.sendEvent(t,"venmo.initialized"),e.client?t.then((function(){return n})):n)}))})),isBrowserSupported:function(e){return p.isBrowserSupported(e)},VERSION:"3.60.0"}},{"../lib/analytics":93,"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./shared/errors":185,"./shared/supports-venmo":186,"./venmo":187,"@braintree/wrap-promise":30}],183:[function(e,t,n){"use strict";var i=e("@braintree/browser-detection/is-android"),r=e("@braintree/browser-detection/is-chrome"),o=e("@braintree/browser-detection/is-ios"),a=e("@braintree/browser-detection/is-ios-safari"),s=e("@braintree/browser-detection/is-samsung"),c=e("@braintree/browser-detection/is-mobile-firefox");t.exports={isAndroid:i,isChrome:r,isIos:o,isIosSafari:a,isSamsungBrowser:s,isMobileFirefox:c}},{"@braintree/browser-detection/is-android":3,"@braintree/browser-detection/is-chrome":5,"@braintree/browser-detection/is-ios":16,"@braintree/browser-detection/is-ios-safari":13,"@braintree/browser-detection/is-mobile-firefox":17,"@braintree/browser-detection/is-samsung":18}],184:[function(e,t,n){"use strict";t.exports={DOCUMENT_VISIBILITY_CHANGE_EVENT_DELAY:500,DEFAULT_PROCESS_RESULTS_DELAY:1e3,VENMO_OPEN_URL:"https://venmo.com/braintree/checkout"}},{}],185:[function(e,t,n){"use strict";var i=e("../../lib/braintree-error");t.exports={VENMO_NOT_ENABLED:{type:i.types.MERCHANT,code:"VENMO_NOT_ENABLED",message:"Venmo is not enabled for this merchant."},VENMO_TOKENIZATION_REQUEST_ACTIVE:{type:i.types.MERCHANT,code:"VENMO_TOKENIZATION_REQUEST_ACTIVE",message:"Another tokenization request is active."},VENMO_APP_FAILED:{type:i.types.UNKNOWN,code:"VENMO_APP_FAILED",message:"Venmo app encountered a problem."},VENMO_APP_CANCELED:{type:i.types.CUSTOMER,code:"VENMO_APP_CANCELED",message:"Venmo app authorization was canceled."},VENMO_CANCELED:{type:i.types.CUSTOMER,code:"VENMO_CANCELED",message:"User canceled Venmo authorization, or Venmo app is not available."},VENMO_INVALID_PROFILE_ID:{type:i.types.MERCHANT,code:"VENMO_INVALID_PROFILE_ID",message:"Venmo profile ID is invalid."},VENMO_INVALID_DEEP_LINK_RETURN_URL:{type:i.types.MERCHANT,code:"VENMO_INVALID_DEEP_LINK_RETURN_URL",message:"Venmo deep link return URL is invalid."}}},{"../../lib/braintree-error":98}],186:[function(e,t,n){"use strict";var i=e("./browser-detection");t.exports={isBrowserSupported:function(e){var t=i.isAndroid()&&i.isChrome(),n=i.isIos()&&i.isChrome(),r=i.isIosSafari()||t,o=n||i.isSamsungBrowser()||i.isMobileFirefox();return e=e||{allowNewBrowserTab:!0},r||e.allowNewBrowserTab&&o}}},{"./browser-detection":183}],187:[function(e,t,n){(function(n){"use strict";var i=e("../lib/analytics"),r=e("./shared/supports-venmo"),o=e("./shared/constants"),a=e("./shared/errors"),s=e("../lib/querystring"),c=e("../lib/methods"),l=e("../lib/convert-methods-to-error"),d=e("@braintree/wrap-promise"),u=e("../lib/braintree-error"),p=e("../lib/promise"),_=e("@braintree/extended-promise");function f(e){this._createPromise=e.createPromise,this._allowNewBrowserTab=!1!==e.allowNewBrowserTab,this._profileId=e.profileId,this._deepLinkReturnUrl=e.deepLinkReturnUrl}function h(){return n.location.hash.substring(1).split("&").reduce((function(e,t){var n=t.split("="),i=decodeURIComponent(n[0]).replace(/\W/g,""),r=decodeURIComponent(n[1]);return e[i]=r,e}),{})}function m(){var e;return void 0!==n.document.hidden?e="visibilitychange":void 0!==n.document.msHidden?e="msvisibilitychange":void 0!==n.document.webkitHidden&&(e="webkitvisibilitychange"),e}f.prototype.getUrl=function(){return this._url?p.resolve(this._url):this._createPromise.then((function(e){var t=e.getConfiguration(),i={},r=this._deepLinkReturnUrl||n.location.href.replace(n.location.hash,""),a=t.gatewayConfiguration.payWithVenmo,c=t.analyticsMetadata,l={_meta:{version:c.sdkVersion,integration:c.integration,platform:c.platform,sessionId:c.sessionId}};return i["x-success"]=r+"#venmoSuccess=1",i["x-cancel"]=r+"#venmoCancel=1",i["x-error"]=r+"#venmoError=1",i.ua=n.navigator.userAgent,i.braintree_merchant_id=this._profileId||a.merchantId,i.braintree_access_token=a.accessToken,i.braintree_environment=a.environment,i.braintree_sdk_data=btoa(JSON.stringify(l)),this._url=o.VENMO_OPEN_URL+"?"+s.stringify(i),this._url}).bind(this))},f.prototype.isBrowserSupported=function(){return r.isBrowserSupported({allowNewBrowserTab:this._allowNewBrowserTab})},f.prototype.hasTokenizationResult=function(){var e=h();return void 0!==(e.venmoSuccess||e.venmoError||e.venmoCancel)},f.prototype.tokenize=function(e){var t=this;return e=e||{},!0===this._tokenizationInProgress?p.reject(new u(a.VENMO_TOKENIZATION_REQUEST_ACTIVE)):this.hasTokenizationResult()?this._processResults():(this._tokenizationInProgress=!0,this._tokenizePromise=new _,this._previousHash=n.location.hash,this._visibilityChangeListener=function(){var i;n.document.hidden||(t._tokenizationInProgress=!1,setTimeout((function(){t._processResults().catch((function(e){i=e})).then((function(e){n.location.hash=t._previousHash,t._removeVisibilityEventListener(),delete t._visibilityChangeListener,i?t._tokenizePromise.reject(i):t._tokenizePromise.resolve(e),delete t._tokenizePromise}))}),e.processResultsDelay||o.DEFAULT_PROCESS_RESULTS_DELAY))},this.getUrl().then((function(e){return t._deepLinkReturnUrl?n.location=e:n.open(e),setTimeout((function(){n.document.addEventListener(m(),t._visibilityChangeListener)}),o.DOCUMENT_VISIBILITY_CHANGE_EVENT_DELAY),t._tokenizePromise})))},f.prototype.teardown=function(){return this._removeVisibilityEventListener(),l(this,c(f.prototype)),p.resolve()},f.prototype._removeVisibilityEventListener=function(){n.document.removeEventListener(m(),this._visibilityChangeListener)},f.prototype._processResults=function(){var e=this,t=h();return new p((function(r,o){var s;t.venmoSuccess?(i.sendEvent(e._createPromise,"venmo.appswitch.handle.success"),r({nonce:(s=t).paymentMethodNonce,type:"VenmoAccount",details:{username:s.username}})):t.venmoError?(i.sendEvent(e._createPromise,"venmo.appswitch.handle.error"),o(new u({type:a.VENMO_APP_FAILED.type,code:a.VENMO_APP_FAILED.code,message:a.VENMO_APP_FAILED.message,details:{originalError:{message:decodeURIComponent(t.errorMessage),code:t.errorCode}}}))):t.venmoCancel?(i.sendEvent(e._createPromise,"venmo.appswitch.handle.cancel"),o(new u(a.VENMO_APP_CANCELED))):(i.sendEvent(e._createPromise,"venmo.appswitch.cancel-or-unavailable"),o(new u(a.VENMO_CANCELED))),"function"==typeof n.history.replaceState&&n.location.hash&&history.pushState({},"",n.location.href.slice(0,n.location.href.indexOf("#")))}))},t.exports=d.wrapPrototype(f)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lib/analytics":93,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/methods":130,"../lib/promise":132,"../lib/querystring":133,"./shared/constants":184,"./shared/errors":185,"./shared/supports-venmo":186,"@braintree/extended-promise":22,"@braintree/wrap-promise":30}],188:[function(e,t,n){"use strict";var i=e("../lib/braintree-error");t.exports={VISA_CHECKOUT_NOT_ENABLED:{type:i.types.MERCHANT,code:"VISA_CHECKOUT_NOT_ENABLED",message:"Visa Checkout is not enabled for this merchant."},VISA_CHECKOUT_INIT_OPTIONS_REQUIRED:{type:i.types.MERCHANT,code:"VISA_CHECKOUT_INIT_OPTIONS_REQUIRED",message:"initOptions requires an object."},VISA_CHECKOUT_PAYMENT_REQUIRED:{type:i.types.MERCHANT,code:"VISA_CHECKOUT_PAYMENT_REQUIRED",message:"tokenize requires callid, encKey, and encPaymentData."},VISA_CHECKOUT_TOKENIZATION:{type:i.types.NETWORK,code:"VISA_CHECKOUT_TOKENIZATION",message:"A network error occurred when processing the Visa Checkout payment."}}},{"../lib/braintree-error":98}],189:[function(e,t,n){"use strict";var i=e("../lib/basic-component-verification"),r=e("../lib/braintree-error"),o=e("../lib/create-deferred-client"),a=e("../lib/create-assets-url"),s=e("./visa-checkout"),c=e("../lib/analytics"),l=e("./errors"),d=e("../lib/promise"),u=e("@braintree/wrap-promise");t.exports={create:u((function(e){var t="Visa Checkout";return i.verify({name:t,client:e.client,authorization:e.authorization}).then((function(){return o.create({authorization:e.authorization,client:e.client,debug:e.debug,assetsUrl:a.create(e.authorization),name:t})})).then((function(t){return e.client=t,e.client.getConfiguration().gatewayConfiguration.visaCheckout?(c.sendEvent(e.client,"visacheckout.initialized"),new s(e)):d.reject(new r(l.VISA_CHECKOUT_NOT_ENABLED))}))})),VERSION:"3.60.0"}},{"../lib/analytics":93,"../lib/basic-component-verification":96,"../lib/braintree-error":98,"../lib/create-assets-url":106,"../lib/create-deferred-client":108,"../lib/promise":132,"./errors":188,"./visa-checkout":190,"@braintree/wrap-promise":30}],190:[function(e,t,n){"use strict";var i=e("../lib/braintree-error"),r=e("../lib/analytics"),o=e("./errors"),a=e("../lib/json-clone"),s=e("../lib/methods"),c=e("../lib/convert-methods-to-error"),l=e("../lib/promise"),d=e("@braintree/wrap-promise"),u={Visa:"VISA",MasterCard:"MASTERCARD",Discover:"DISCOVER","American Express":"AMEX"};function p(e){this._client=e.client}p.prototype.createInitOptions=function(e){var t,n=this._client.getConfiguration().gatewayConfiguration,r=n.visaCheckout;if(!e)throw new i(o.VISA_CHECKOUT_INIT_OPTIONS_REQUIRED);return(t=a(e)).apikey=t.apikey||r.apikey,t.externalClientId=t.externalClientId||r.externalClientId,t.settings=t.settings||{},t.settings.dataLevel="FULL",t.settings.payment=t.settings.payment||{},t.settings.payment.cardBrands||(t.settings.payment.cardBrands=n.visaCheckout.supportedCardTypes.reduce((function(e,t){return u.hasOwnProperty(t)?e.concat(u[t]):e}),[])),t},p.prototype.tokenize=function(e){var t=this;return e.callid&&e.encKey&&e.encPaymentData?this._client.request({method:"post",endpoint:"payment_methods/visa_checkout_cards",data:{_meta:{source:"visa-checkout"},visaCheckoutCard:{callId:e.callid,encryptedPaymentData:e.encPaymentData,encryptedKey:e.encKey}}}).then((function(e){return r.sendEvent(t._client,"visacheckout.tokenize.succeeded"),e.visaCheckoutCards[0]})).catch((function(e){return r.sendEvent(t._client,"visacheckout.tokenize.failed"),l.reject(new i({type:o.VISA_CHECKOUT_TOKENIZATION.type,code:o.VISA_CHECKOUT_TOKENIZATION.code,message:o.VISA_CHECKOUT_TOKENIZATION.message,details:{originalError:e}}))})):l.reject(new i(o.VISA_CHECKOUT_PAYMENT_REQUIRED))},p.prototype.teardown=function(){return c(this,s(p.prototype)),l.resolve()},t.exports=d.wrapPrototype(p)},{"../lib/analytics":93,"../lib/braintree-error":98,"../lib/convert-methods-to-error":104,"../lib/json-clone":129,"../lib/methods":130,"../lib/promise":132,"./errors":188,"@braintree/wrap-promise":30}]},{},[91])(91)}}]);