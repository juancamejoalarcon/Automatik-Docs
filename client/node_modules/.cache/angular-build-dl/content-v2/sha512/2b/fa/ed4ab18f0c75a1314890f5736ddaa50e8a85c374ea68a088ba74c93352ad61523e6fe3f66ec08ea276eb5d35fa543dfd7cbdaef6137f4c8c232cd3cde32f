function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],o=!0,n=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);o=!0);}catch(c){n=!0,i=c}finally{try{o||null==a.return||a.return()}finally{if(n)throw i}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{pU93:function(e,t,r){"use strict";r.r(t),r.d(t,"SettingsModule",(function(){return Q}));var o=r("ofXK"),n=r("M0ag"),i=r("tyNb"),s=r("ey9i"),a=r("fXoL"),c=r("3Pt+"),u=r("5eHb"),l=r("p8ln"),b=["modal"],d=["imageSrc"];function g(e,t){if(1&e){var r=a.Rb();a.Qb(0,"input",42),a.Zb("ngModelChange",(function(e){return a.rc(r),a.dc().oldPass=e})),a.Pb()}if(2&e){var o=a.dc();a.ic("ngModel",o.oldPass)}}function m(e,t){if(1&e){var r=a.Rb();a.Qb(0,"input",43),a.Zb("ngModelChange",(function(e){return a.rc(r),a.dc().newPass=e})),a.Pb()}if(2&e){var o=a.dc();a.ic("ngModel",o.newPass)}}function p(e,t){if(1&e){var r=a.Rb();a.Qb(0,"input",44),a.Zb("ngModelChange",(function(e){return a.rc(r),a.dc().removeAccountPass=e})),a.Pb()}if(2&e){var o=a.dc();a.ic("ngModel",o.removeAccountPass)}}function f(e,t){if(1&e){var r=a.Rb();a.Qb(0,"button",41),a.Zb("click",(function(){a.rc(r);var e=a.dc();return e.changePassword(e.oldPass.value,e.newPass.value)})),a.zc(1,"Guardar"),a.Pb()}}function h(e,t){if(1&e){var r=a.Rb();a.Qb(0,"button",41),a.Zb("click",(function(){a.rc(r);var e=a.dc();return e.removeAccount(e.removeAccountPass)})),a.zc(1,"Eliminar"),a.Pb()}}var v,_,y,C,P=((v=function(){function e(t,r,o,n,i,a){_classCallCheck(this,e),this.router=t,this.route=r,this.userService=o,this.fb=n,this.toastr=i,this.commonsService=a,this.user=new s.q,this.errors={},this.isSubmitting=!1,this.settingsForm=this.fb.group({image:"",username:"",email:"",description:"",nameAndSurname:"",contactInformation:"",dateOfBirth:"",companyName:""})}return _createClass(e,[{key:"ngOnInit",value:function(){console.log(this.route.snapshot.data),this.commonsService.isBrowser()&&(console.log("User auth in component: "+this.userService.isAuth),Object.assign(this.user,this.userService.getCurrentUser()),this.settingsForm.patchValue(this.user))}},{key:"onFileChange",value:function(e){var t=this,r=new FileReader;if(e.target.files&&e.target.files.length){var o=_slicedToArray(e.target.files,1)[0],n=o.size/1024/1024;this.hasExtension(e.target.value,[".jpg",".gif",".png"])?n>1?(e.target.value="",this.toastr.error("File is bigger than 1 MB","Error",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"})):(r.readAsDataURL(o),r.onload=function(o){var n=new Image;n.src=o.target.result,n.onload=function(){n.height===n.width?(t.settingsForm.patchValue({image:r.result}),t.imageSrc.nativeElement.src=r.result):(e.target.value="",t.toastr.error("Size error width and height must be equal","Error",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}))}}):(e.target.value="",this.toastr.error("File must be of type jpg gif or png","Error",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}))}}},{key:"hasExtension",value:function(e,t){return new RegExp("("+t.join("|").replace(/\./g,"\\.")+")$").test(e)}},{key:"submitForm",value:function(){var e=this;this.isSubmitting=!0;var t=this.validation(this.settingsForm.value);console.log(t),this.userService.update(t).subscribe((function(t){e.toastr.success("User updated","",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"})}),(function(t){e.errors=t,e.isSubmitting=!1}))}},{key:"validation",value:function(e){for(var t={},r=0,o=Object.entries(e);r<o.length;r++){var n=_slicedToArray(o[r],2),i=n[0],s=n[1];e[i]!==this.user[i]&&(t[i]=s,this.user[i]=s)}return t}},{key:"toggleModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.modalStatus=e,this.modal.nativeElement.classList.toggle("show-modal")}},{key:"changePassword",value:function(e,t){var r=this;e===t?this.toastr.error("Old and new password are the same","",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}):""===e||""===t?this.toastr.error("Fields cannot be empty","",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}):this.userService.changePassword({oldPassword:e,newPassword:t}).subscribe((function(e){e.invalidPassword?r.toastr.error("Current password is wrong","",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}):(r.toggleModal(),r.toastr.success("User updated","",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}))}),(function(e){r.errors=e,r.isSubmitting=!1}))}},{key:"removeAccount",value:function(e){var t=this;confirm("\xbfSeguro que deseas eliminar tu usuario? Una vez eliminado no habr\xe1 posibilidad de recuperarlo, as\xed como tampoco podr\xe1s recuperar ninguno de los documentos creados con este usuario")&&this.userService.removeAccount(e).subscribe((function(e){e.invalidPassword?t.toastr.error("Contrase\xf1a incorrecta","",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}):e.userRemoved&&(t.toastr.success("Usuario eliminado","",{positionClass:"toast-bottom-right",progressBar:!0,progressAnimation:"decreasing"}),t.logout())}),(function(e){t.errors=e,t.isSubmitting=!1}))}},{key:"logout",value:function(){this.userService.purgeAuth(),this.router.navigateByUrl("/")}}]),e}()).\u0275fac=function(e){return new(e||v)(a.Lb(i.d),a.Lb(i.a),a.Lb(s.r),a.Lb(c.f),a.Lb(u.b),a.Lb(s.d))},v.\u0275cmp=a.Fb({type:v,selectors:[["app-settings"]],viewQuery:function(e,t){var r;1&e&&(a.Dc(b,!0),a.Dc(d,!0)),2&e&&(a.oc(r=a.ac())&&(t.modal=r.first),a.oc(r=a.ac())&&(t.imageSrc=r.first))},decls:52,vars:9,consts:[[1,"sub-menu"],[1,"sub-menu__container"],[1,"sub-menu__nav","sub-menu__nav--my-forms",2,"justify-content","center"],[1,"sub-menu__nav__button","sub-menu__nav__button--without-hover"],[1,"settings"],[3,"errors"],[1,"settings__container",3,"formGroup","ngSubmit"],[1,"settings__profile-image"],[1,"settings__profile-image__container"],[1,"settings__profile__image__img"],["alt","profile image",3,"src"],["imageSrc",""],[1,"settings__profile__image__input"],[1,"input-file"],["type","file","name","profile-image",3,"change"],[1,"settings__form"],[1,"settings__form__container"],[1,"settings__form__group"],["type","text","placeholder","Nombre de usuario","formControlName","username"],["type","text","placeholder","Nombre y apellidos","formControlName","nameAndSurname"],["type","text","placeholder","Corren electr\xf3nico","formControlName","email"],["name","description","cols","30","rows","10","placeholder","Description","formControlName","description"],["type","date","placeholder","Fecha de nacimiento","formControlName","dateOfBirth"],["type","text","placeholder","Empresa","formControlName","companyName"],["type","text","placeholder","Contacto","formControlName","contactInformation"],[1,"settings__form__button-container"],["type","submit",1,"button-filled","icon","icon-save-solid"],[1,"settings__buttons"],[1,"settings__buttons__container"],["type","button",1,"button-filled","trigger",3,"click"],["type","button",1,"button-filled",3,"click"],[1,"modal"],["modal",""],[1,"modal__content",2,"padding","2rem"],[1,"modal__content__modal-middle","modal__content__modal-middle--change-password"],[1,"modal__content__modal-middle__container"],["type","password","placeholder","Contrase\xf1a actual",3,"ngModel","ngModelChange",4,"ngIf"],["type","password","placeholder","Contrase\xf1a nueva",3,"ngModel","ngModelChange",4,"ngIf"],["type","password","placeholder","Contrase\xf1a",3,"ngModel","ngModelChange",4,"ngIf"],[1,"modal__content__modal-bottom"],["class","button-filled","id","modal-button",3,"click",4,"ngIf"],["id","modal-button",1,"button-filled",3,"click"],["type","password","placeholder","Contrase\xf1a actual",3,"ngModel","ngModelChange"],["type","password","placeholder","Contrase\xf1a nueva",3,"ngModel","ngModelChange"],["type","password","placeholder","Contrase\xf1a",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(a.Qb(0,"div",0),a.Qb(1,"div",1),a.Qb(2,"ul",2),a.Qb(3,"li",3),a.zc(4),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(5,"div",4),a.Mb(6,"app-list-errors",5),a.Qb(7,"form",6),a.Zb("ngSubmit",(function(){return t.submitForm()})),a.Qb(8,"div",7),a.Qb(9,"div",8),a.Qb(10,"div",9),a.Mb(11,"img",10,11),a.Pb(),a.Qb(13,"fieldset",12),a.Qb(14,"label",13),a.zc(15," Cambiar imagen de perfil "),a.Qb(16,"input",14),a.Zb("change",(function(e){return t.onFileChange(e)})),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(17,"div",15),a.Qb(18,"div",16),a.Qb(19,"fieldset",17),a.Mb(20,"input",18),a.Mb(21,"input",19),a.Mb(22,"input",20),a.Pb(),a.Qb(23,"fieldset",17),a.Mb(24,"textarea",21),a.Mb(25,"input",22),a.Mb(26,"input",23),a.Mb(27,"input",24),a.Pb(),a.Qb(28,"div",25),a.Mb(29,"button",26),a.Pb(),a.Pb(),a.Pb(),a.Mb(30,"hr"),a.Qb(31,"div",27),a.Qb(32,"div",28),a.Qb(33,"button",29),a.Zb("click",(function(){return t.toggleModal("changePass")})),a.zc(34," Cambiar contrase\xf1a "),a.Pb(),a.Qb(35,"button",30),a.Zb("click",(function(){return t.logout()})),a.zc(36," Cerrar sesi\xf3n "),a.Pb(),a.Qb(37,"button",30),a.Zb("click",(function(){return t.toggleModal("remove")})),a.zc(38," Eliminar cuenta "),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Pb(),a.Qb(39,"div",31,32),a.Qb(41,"div",33),a.Qb(42,"div",34),a.Qb(43,"div",35),a.yc(44,g,1,1,"input",36),a.yc(45,m,1,1,"input",37),a.yc(46,p,1,1,"input",38),a.Pb(),a.Pb(),a.Qb(47,"div",39),a.yc(48,f,2,0,"button",40),a.yc(49,h,2,0,"button",40),a.Qb(50,"button",41),a.Zb("click",(function(){return t.toggleModal()})),a.zc(51,"Cancelar"),a.Pb(),a.Pb(),a.Pb(),a.Pb()),2&e&&(a.zb(4),a.Bc(" ",t.user.username," "),a.zb(2),a.ic("errors",t.errors),a.zb(1),a.ic("formGroup",t.settingsForm),a.zb(4),a.jc("src",t.user.image,a.tc),a.zb(33),a.ic("ngIf","changePass"===t.modalStatus),a.zb(1),a.ic("ngIf","changePass"===t.modalStatus),a.zb(1),a.ic("ngIf","remove"===t.modalStatus),a.zb(2),a.ic("ngIf","changePass"===t.modalStatus),a.zb(1),a.ic("ngIf","remove"===t.modalStatus))},directives:[l.a,c.G,c.r,c.j,c.c,c.q,c.i,o.t,c.t],encapsulation:2}),v),w=r("LRne"),S=((_=function(){function e(t,r,o){_classCallCheck(this,e),this.userService=t,this.router=r,this.commonsService=o}return _createClass(e,[{key:"resolve",value:function(){var e=this;if(this.commonsService.isBrowser()){if(this.userService.appInited)return this.userService.isAuth||this.router.navigateByUrl("/auth/login"),Object(w.a)("User auth resolver: "+this.userService.isAuth);this.userService.populate(),this.userService.isAuthenticated.subscribe((function(t){return t||e.router.navigateByUrl("/auth/login"),Object(w.a)("User auth resolver: "+e.userService.isAuth)}))}return Object(w.a)("User auth resolver: "+this.userService.isAuth)}}]),e}()).\u0275fac=function(e){return new(e||_)(a.Vb(s.r),a.Vb(i.d),a.Vb(s.d))},_.\u0275prov=a.Hb({token:_,factory:_.\u0275fac}),_),A=[{path:"",component:P,resolve:{message:S}}],M=((C=function e(){_classCallCheck(this,e)}).\u0275mod=a.Jb({type:C}),C.\u0275inj=a.Ib({factory:function(e){return new(e||C)},imports:[[i.h.forChild(A)],i.h]}),C),Q=((y=function e(){_classCallCheck(this,e)}).\u0275mod=a.Jb({type:y}),y.\u0275inj=a.Ib({factory:function(e){return new(e||y)},providers:[S],imports:[[o.c,n.a,M]]}),y)}}]);