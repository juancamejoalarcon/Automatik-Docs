(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"305l":function(e,t,i){"use strict";i.r(t),i.d(t,"AuthModule",(function(){return ee}));var n=i("IzEk"),o=i("lJxs"),s=i("fXoL"),r=i("tyNb"),a=i("ey9i");let c=(()=>{class e{constructor(e,t){this.router=e,this.userService=t}canActivate(e,t){return this.userService.isAuthenticated.pipe(Object(n.a)(1),Object(o.a)(e=>!e))}}return e.\u0275fac=function(t){return new(t||e)(s.Vb(r.d),s.Vb(a.v))},e.\u0275prov=s.Hb({token:e,factory:e.\u0275fac}),e})();var l=i("M0ag"),d=i("3Pt+"),u=i("ofXK"),m=i("p8ln"),b=i("sqhz");const p=["modal"],h=["modalMiddle"],f=["closeModalButton"],g=["privacyCheckbox"],v=function(){return["/search"]};function _(e,t){1&e&&(s.Qb(0,"a",31),s.Mb(1,"span",32),s.Pb()),2&e&&s.ic("routerLink",s.kc(1,v))}const y=function(e){return[e]};function P(e,t){if(1&e&&(s.Qb(0,"a",33),s.Mb(1,"span",34),s.Qb(2,"span"),s.zc(3,"Return to form"),s.Pb(),s.Pb()),2&e){const e=s.dc();s.ic("routerLink",s.lc(1,y,"/certified-forms/"+e.queryParams.formPath))}}const w=function(){return["../login"]};function k(e,t){1&e&&(s.Qb(0,"a",20),s.zc(1,"Ya tengo una cuenta"),s.Pb()),2&e&&s.ic("routerLink",s.kc(1,w))}const M=function(){return["../signup"]};function I(e,t){1&e&&(s.Qb(0,"a",20),s.zc(1,"\xbfNecesita una cuenta?"),s.Pb()),2&e&&s.ic("routerLink",s.kc(1,M))}function E(e,t){1&e&&(s.Qb(0,"div",35),s.Mb(1,"label",36),s.Mb(2,"input",37),s.Pb())}function C(e,t){1&e&&(s.Qb(0,"div",38),s.Mb(1,"label",36),s.Mb(2,"input",39),s.Pb())}function Q(e,t){1&e&&(s.Qb(0,"div",38),s.Mb(1,"label",40),s.Mb(2,"input",41),s.Pb())}function z(e,t){1&e&&(s.Qb(0,"div",38),s.Mb(1,"label",42),s.Mb(2,"input",43),s.Pb())}function S(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",44),s.Qb(1,"label",45),s.Zb("click",(function(t){return s.rc(e),s.dc().remindUserToReadPrivacyPolicy(t)})),s.Mb(2,"input",46,47),s.Qb(4,"span",48),s.zc(5,"He le\xeddo y acepto el aviso legal y la "),s.Qb(6,"a",49),s.Zb("click",(function(){s.rc(e);const t=s.dc(),i=s.pc(31);return t.toogleModal(i)})),s.zc(7,"pol\xedtica de privacidad"),s.Pb(),s.Pb(),s.Pb(),s.Pb()}}function L(e,t){1&e&&(s.Qb(0,"div",44),s.Qb(1,"label",50),s.Mb(2,"input",51),s.Qb(3,"span"),s.zc(4,"Desea que le enviemos notificaciones a su correo"),s.Pb(),s.Pb(),s.Pb())}const R=function(e,t){return{"sign-in__container__form__form-group":e,"sign-in__container__form__form-group--signup":t}},x=function(e,t){return{"sign-in__container__form__checkbox":e,"sign-in__container__form__checkbox--signup":t}},T=function(){return["../recover-password"]};let D=(()=>{class e{constructor(e,t,i,n,o){this.route=e,this.router=t,this.userService=i,this.commonsService=n,this.fb=o,this.authType="",this.title="",this.errors={errors:{}},this.isSubmitting=!1,this.queryParams={},this.form=this.fb.group({email:["",d.E.required],password:["",d.E.required],rememberme:[!0,d.E.required]})}ngOnInit(){this.route.url.subscribe(e=>{this.authType=e[e.length-1].path,this.title="login"===this.authType?"Iniciar sesi\xf3n":"Registrarse","signup"===this.authType&&(this.form.addControl("username",new d.g),this.form.addControl("repeatPassword",new d.g),this.form.addControl("notifications",new d.g))}),this.route.queryParams.subscribe(e=>{this.commonsService.isObjectEmpty(e)||(this.queryParams=e)})}ngAfterViewInit(){this.checkIfUserHasScrolledToBottom()}toogleModal(e){this.commonsService.toggleModal(e,!0)}checkIfUserHasScrolledToBottom(){this.modalMiddle.nativeElement.addEventListener("scroll",e=>{e.srcElement.scrollHeight-e.srcElement.scrollTop<=e.srcElement.clientHeight+200&&(this.enablePrivacyButton(),this.privacyCheckbox.nativeElement.disabled=!1)})}enablePrivacyButton(){this.closeModalButton.nativeElement.classList.remove("button-filled__disabled")}checkIfPrivacyChecked(e){"signup"===this.authType&&(e.preventDefault(),this.privacyCheckbox.nativeElement.checked?this.submitForm():this.commonsService.toastMessage("error","Debes leer todas las condiciones de privacidad","Condiciones"))}closeModalAndEnableCheckbox(){this.closeModalButton.nativeElement.classList.contains("button-filled__disabled")?this.commonsService.toastMessage("error","Debes leer todas las condiciones de privacidad","Condiciones"):this.toogleModal(this.modal.nativeElement)}remindUserToReadPrivacyPolicy(e){e.preventDefault(),"A"!==e.target.nodeName&&(!0===this.privacyCheckbox.nativeElement.disabled?this.commonsService.toastMessage("error","Debes leer todas las condiciones de privacidad","Condiciones"):this.privacyCheckbox.nativeElement.checked=!this.privacyCheckbox.nativeElement.checked),this.modalMiddle.nativeElement.scrollHeight===this.modalMiddle.nativeElement.clientHeight&&(this.enablePrivacyButton(),this.privacyCheckbox.nativeElement.disabled=!1)}submitForm(){this.isSubmitting=!0,this.errors={errors:{}},this.userService.attemptAuth(this.authType,this.form.value,this.form.value.rememberme).subscribe(e=>{this.router.navigateByUrl(this.queryParams.formPath?`/certified-forms/${this.queryParams.formPath}`:"/")},e=>{this.errors=e,this.isSubmitting=!1})}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(r.a),s.Lb(r.d),s.Lb(a.v),s.Lb(a.e),s.Lb(d.f))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-auth-page"]],viewQuery:function(e,t){var i;1&e&&(s.Dc(p,!0),s.Dc(h,!0),s.Dc(f,!0),s.Dc(g,!0)),2&e&&(s.oc(i=s.ac())&&(t.modal=i.first),s.oc(i=s.ac())&&(t.modalMiddle=i.first),s.oc(i=s.ac())&&(t.closeModalButton=i.first),s.oc(i=s.ac())&&(t.privacyCheckbox=i.first))},decls:44,vars:25,consts:[[1,"sign-in-search-button","sign-in-search-button--return"],[3,"routerLink",4,"ngIf"],["class","sign-in-search-button__return-to-form",3,"routerLink",4,"ngIf"],[1,"sign-in"],[1,"sign-in__container"],["src","/assets/images/logo.png","alt","login image",1,"sign-in__container__top-image"],[1,"sign-in__container__title"],["class","sign-in__container__need-account",3,"routerLink",4,"ngIf"],[3,"errors"],[1,"sign-in__container__form",3,"formGroup","ngSubmit"],[3,"disabled"],["class","sign-in__container__form__form-group",4,"ngIf"],["class","sign-in__container__form__form-group--signup",4,"ngIf"],[3,"ngClass"],["for","password"],["type","password","name","password","id","password","formControlName","password","placeholder","Contrase\xf1a"],["class","sign-in__container__form__checkbox--signup",4,"ngIf"],["for","rememberme"],["type","checkbox","name","rememberme","id","rememberme","formControlName","rememberme","value","Remember me","checked","",1,"filled-in"],["type","submit",3,"value","click"],[1,"sign-in__container__need-account",3,"routerLink"],[1,"modal"],["modal",""],[1,"modal__content","modal__content--privacy"],[1,"modal__content__top","modal__content__top--privacy"],[1,"modal__content__modal-middle","modal__content__modal-middle--privacy"],["modalMiddle",""],[1,"modal__content__modal-middle__container"],[1,"modal__content__modal-bottom","modal__content__modal-bottom--privacy"],["id","modal-button",1,"button-filled","button-filled__disabled",3,"click"],["closeModalButton",""],[3,"routerLink"],[1,"icon","icon-search"],[1,"sign-in-search-button__return-to-form",3,"routerLink"],[1,"icon","icon-arrow-left-solid"],[1,"sign-in__container__form__form-group"],["for","name"],["type","text","name","name","id","name","formControlName","email","placeholder","Nombre de usuario o email"],[1,"sign-in__container__form__form-group--signup"],["type","text","name","name","id","name","formControlName","username","placeholder","Nombre de usuario"],["for","email"],["type","email","name","email","id","email","formControlName","email","placeholder","Email"],["for","repeat-password"],["type","password","name","repeat-password","id","repeat-password","formControlName","repeatPassword","placeholder","Repetir Contrase\xf1a"],[1,"sign-in__container__form__checkbox--signup"],["for","privacy-checkbox","id","privacy-label",3,"click"],["type","checkbox","name","privacy","id","privacy-checkbox","value","privacy","disabled","",1,"filled-in"],["privacyCheckbox",""],["id","privacy-span"],[1,"trigger",3,"click"],["for","notifications"],["type","checkbox","name","notifications","id","notifications","formControlName","notifications","value","Notifications","checked","",1,"filled-in"]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.yc(1,_,2,2,"a",1),s.yc(2,P,4,3,"a",2),s.Pb(),s.Qb(3,"div",3),s.Qb(4,"div",4),s.Mb(5,"img",5),s.Qb(6,"h1",6),s.zc(7),s.Pb(),s.yc(8,k,2,2,"a",7),s.yc(9,I,2,2,"a",7),s.Mb(10,"app-list-errors",8),s.Qb(11,"form",9),s.Zb("ngSubmit",(function(){return t.submitForm()})),s.Qb(12,"fieldset",10),s.yc(13,E,3,0,"div",11),s.yc(14,C,3,0,"div",12),s.yc(15,Q,3,0,"div",12),s.Qb(16,"div",13),s.Mb(17,"label",14),s.Mb(18,"input",15),s.Pb(),s.yc(19,z,3,0,"div",12),s.yc(20,S,8,0,"div",16),s.yc(21,L,5,0,"div",16),s.Qb(22,"div",13),s.Qb(23,"label",17),s.Mb(24,"input",18),s.Qb(25,"span"),s.zc(26,"Recu\xe9rdame"),s.Pb(),s.Pb(),s.Pb(),s.Qb(27,"input",19),s.Zb("click",(function(e){return t.checkIfPrivacyChecked(e)})),s.Pb(),s.Pb(),s.Qb(28,"a",20),s.zc(29,"He olvidado mi contrase\xf1a"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(30,"div",21,22),s.Qb(32,"div",23),s.Qb(33,"div",24),s.Qb(34,"h2"),s.zc(35,"Pol\xedticas de privacidad"),s.Pb(),s.Pb(),s.Qb(36,"div",25,26),s.Qb(38,"div",27),s.Mb(39,"app-privacy-policy"),s.Pb(),s.Pb(),s.Qb(40,"div",28),s.Qb(41,"button",29,30),s.Zb("click",(function(){return t.closeModalAndEnableCheckbox()})),s.zc(43,"Entendido"),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e&&(s.zb(1),s.ic("ngIf",!t.queryParams.formPath),s.zb(1),s.ic("ngIf",t.queryParams.formPath),s.zb(5),s.Ac(t.title),s.zb(1),s.ic("ngIf","signup"==t.authType),s.zb(1),s.ic("ngIf","login"==t.authType),s.zb(1),s.ic("errors",t.errors),s.zb(1),s.ic("formGroup",t.form),s.zb(1),s.ic("disabled",t.isSubmitting),s.zb(1),s.ic("ngIf","login"==t.authType),s.zb(1),s.ic("ngIf","signup"==t.authType),s.zb(1),s.ic("ngIf","signup"==t.authType),s.zb(1),s.ic("ngClass",s.mc(18,R,"login"===t.authType,"signup"===t.authType)),s.zb(3),s.ic("ngIf","signup"==t.authType),s.zb(1),s.ic("ngIf","signup"==t.authType),s.zb(1),s.ic("ngIf","signup"==t.authType),s.zb(1),s.ic("ngClass",s.mc(21,x,"login"===t.authType,"signup"===t.authType)),s.zb(5),s.jc("value",t.title),s.zb(1),s.ic("routerLink",s.kc(24,T)))},directives:[u.t,m.a,d.G,d.r,d.j,u.q,d.c,d.q,d.i,d.a,r.g,b.a],encapsulation:2}),e})();const B=["emailInput"],A=["invalidError"],q=["passwordInput"],N=["repeatPasswordInput"],H=["confirmationMessage"],Z=["title"],O=["sendLinkButton"];function j(e,t){1&e&&(s.Qb(0,"h1",13,14),s.zc(2,"Escriba su e-mail"),s.Pb())}function F(e,t){1&e&&(s.Qb(0,"h1",13),s.zc(1,"Escriba su nueva constrase\xf1a"),s.Pb())}function J(e,t){if(1&e){const e=s.Rb();s.Qb(0,"input",15,16),s.Zb("ngModelChange",(function(t){return s.rc(e),s.dc().email=t})),s.Pb()}if(2&e){const e=s.dc();s.ic("ngModel",e.email)}}function U(e,t){if(1&e){const e=s.Rb();s.Qb(0,"input",17,18),s.Zb("ngModelChange",(function(t){return s.rc(e),s.dc().password=t})),s.Pb()}if(2&e){const e=s.dc();s.ic("ngModel",e.password)}}function V(e,t){1&e&&s.Mb(0,"br")}function W(e,t){if(1&e){const e=s.Rb();s.Qb(0,"input",19,20),s.Zb("ngModelChange",(function(t){return s.rc(e),s.dc().repeatPassword=t})),s.Pb()}if(2&e){const e=s.dc();s.ic("ngModel",e.repeatPassword)}}function G(e,t){if(1&e){const e=s.Rb();s.Qb(0,"input",21,22),s.Zb("click",(function(){return s.rc(e),s.dc().sendEmail()})),s.Pb()}}function X(e,t){if(1&e){const e=s.Rb();s.Qb(0,"input",23),s.Zb("click",(function(){return s.rc(e),s.dc().resetPassword()})),s.Pb()}}function K(e,t){1&e&&(s.Qb(0,"label",24,25),s.zc(2,"Visita tu email. Recibir\xe1s un correo con instrucciones para resetar tu contrase\xf1a."),s.Pb())}const Y=[{path:"login",component:D,canActivate:[c]},{path:"signup",component:D,canActivate:[c]},{path:"recover-password",component:(()=>{class e{constructor(e,t,i,n){this.commonsService=e,this.userService=t,this.route=i,this.router=n,this.isResetPassword=!1}ngOnInit(){this.route.queryParams.subscribe(e=>{e.token?(this.token=e.token,this.isResetPassword=!0):this.isResetPassword=!1})}sendEmail(){this.commonsService.validateEmail(this.email)?this.userService.forgotPassword(this.email).subscribe(e=>{e.emailSent?(this.commonsService.toastMessage("success","Check your email for further instructions","Email sent"),this.emailInput.nativeElement.style.borderBottom="3px solid #556270",this.invalidError.nativeElement.classList.add("d-none"),this.confirmationMessage.nativeElement.classList.remove("d-none"),this.title.nativeElement.classList.add("d-none"),this.emailInput.nativeElement.classList.add("d-none"),this.sendLinkButton.nativeElement.classList.add("d-none")):e.emailNotFound&&(this.commonsService.toastMessage("error","Account with this email could not be found","Email not found"),this.emailInput.nativeElement.style.borderBottom="3px solid #C44D58",this.invalidError.nativeElement.classList.remove("d-none"))}):(this.emailInput.nativeElement.style.borderBottom="3px solid #C44D58",this.invalidError.nativeElement.classList.remove("d-none"),this.commonsService.toastMessage("error","Validation error","Invalid email"))}resetPassword(){this.validatePassword()&&this.userService.resetPassword(this.token,this.password,this.repeatPassword).subscribe(e=>{console.log(e),e.passwordRestored?(this.commonsService.toastMessage("success","Try to log in","Contrase\xf1a restaurada"),this.router.navigate(["/auth/login"])):e.noToken?(this.router.navigate(["/auth/recover-password"]),this.commonsService.toastMessage("error","El token expir\xf3 o no existe","Token error")):this.commonsService.toastMessage("error","Error","Ha ocurrido un error")})}validatePassword(){return this.password&&""!==this.password?this.repeatPassword&&""!==this.repeatPassword?this.password!==this.repeatPassword?(this.passwordInput.nativeElement.style.borderBottom="3px solid #C44D58",this.repeatPasswordInput.nativeElement.style.borderBottom="3px solid #C44D58",this.commonsService.toastMessage("error","","Fields do not match"),!1):(this.passwordInput.nativeElement.style.borderBottom="3px solid #556270",this.repeatPasswordInput.nativeElement.style.borderBottom="3px solid #556270",!0):(this.commonsService.toastMessage("error","Repeat password is empty","Empty field"),this.repeatPasswordInput.nativeElement.style.borderBottom="3px solid #C44D58",!1):(this.commonsService.toastMessage("error","Password is empty","Empty field"),this.passwordInput.nativeElement.style.borderBottom="3px solid #C44D58",!1)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(a.e),s.Lb(a.v),s.Lb(r.a),s.Lb(r.d))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-recover-password"]],viewQuery:function(e,t){var i;1&e&&(s.Dc(B,!0),s.Dc(A,!0),s.Dc(q,!0),s.Dc(N,!0),s.Dc(H,!0),s.Dc(Z,!0),s.Dc(O,!0)),2&e&&(s.oc(i=s.ac())&&(t.emailInput=i.first),s.oc(i=s.ac())&&(t.invalidError=i.first),s.oc(i=s.ac())&&(t.passwordInput=i.first),s.oc(i=s.ac())&&(t.repeatPasswordInput=i.first),s.oc(i=s.ac())&&(t.confirmationMessage=i.first),s.oc(i=s.ac())&&(t.title=i.first),s.oc(i=s.ac())&&(t.sendLinkButton=i.first))},decls:15,vars:9,consts:[[1,"recover"],[1,"recover__container"],["class","recover__container__title",4,"ngIf"],["for","email"],["type","email","name","email","id","name","placeholder","E-MAIL",3,"ngModel","ngModelChange",4,"ngIf"],["type","password","name","password","id","password","placeholder","PASSWORD",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["type","password","name","repeatPassword","id","repeatPassword","placeholder","REPEAT PASSWORD",3,"ngModel","ngModelChange",4,"ngIf"],[1,"secondary-color","d-none"],["invalidError",""],["type","submit","value","Send link",3,"click",4,"ngIf"],["type","submit","value","Reset",3,"click",4,"ngIf"],["class","recover__container__message d-none",4,"ngIf"],[1,"recover__container__title"],["title",""],["type","email","name","email","id","name","placeholder","E-MAIL",3,"ngModel","ngModelChange"],["emailInput",""],["type","password","name","password","id","password","placeholder","PASSWORD",3,"ngModel","ngModelChange"],["passwordInput",""],["type","password","name","repeatPassword","id","repeatPassword","placeholder","REPEAT PASSWORD",3,"ngModel","ngModelChange"],["repeatPasswordInput",""],["type","submit","value","Send link",3,"click"],["sendLinkButton",""],["type","submit","value","Reset",3,"click"],[1,"recover__container__message","d-none"],["confirmationMessage",""]],template:function(e,t){1&e&&(s.Qb(0,"div",0),s.Qb(1,"div",1),s.yc(2,j,3,0,"h1",2),s.yc(3,F,2,0,"h1",2),s.Mb(4,"label",3),s.yc(5,J,2,1,"input",4),s.yc(6,U,2,1,"input",5),s.yc(7,V,1,0,"br",6),s.yc(8,W,2,1,"input",7),s.Qb(9,"span",8,9),s.zc(11,"Invalid email"),s.Pb(),s.yc(12,G,2,0,"input",10),s.yc(13,X,1,0,"input",11),s.yc(14,K,3,0,"label",12),s.Pb(),s.Pb()),2&e&&(s.zb(2),s.ic("ngIf",!t.isResetPassword),s.zb(1),s.ic("ngIf",t.isResetPassword),s.zb(2),s.ic("ngIf",!t.isResetPassword),s.zb(1),s.ic("ngIf",t.isResetPassword),s.zb(1),s.ic("ngIf",t.isResetPassword),s.zb(1),s.ic("ngIf",t.isResetPassword),s.zb(4),s.ic("ngIf",!t.isResetPassword),s.zb(1),s.ic("ngIf",t.isResetPassword),s.zb(1),s.ic("ngIf",!t.isResetPassword))},directives:[u.t,d.c,d.q,d.t],encapsulation:2}),e})(),canActivate:[c]}];let $=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(t){return new(t||e)},imports:[[r.h.forChild(Y)],r.h]}),e})(),ee=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(t){return new(t||e)},providers:[c],imports:[[l.a,$]]}),e})()}}]);