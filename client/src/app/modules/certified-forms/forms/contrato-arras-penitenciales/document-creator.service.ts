import { Injectable } from '@angular/core';
import { CommonsService } from '../../../../core';
import * as FormBasedDocsApi from '../../../../../assets/js/wodotexteditor/localfileeditor.js';
@Injectable()
export class DocumentCreatorService {

  public defaultUri = 'data:application/vnd.oasis.opendocument.text;base64,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';

  public originalDocumentBodyClone: any;
  public currentDocumentBodyClone: any;

  constructor(
    private commonsService: CommonsService,
  ) { }

  init() {
    this.commonsService.toggleSpinner();
    this.createEditorFromURI('fillForm', 'editorContainer', this.defaultUri);
      setTimeout(() => {
        this.resizeDocumentContainer();
        window.addEventListener('resize', this.resizeDocumentContainer);
        this.originalDocumentBodyClone = document.getElementsByTagName('office:text')[0].cloneNode(true);
        this.commonsService.toggleSpinner();
      }, 5000);
  }

  createEditorFromURI(formType: string, idOfContainer: string = 'editorContainer', dataURI: string) {
    const byteString = atob(dataURI.split(',')[1]);
    const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
    const ab = new ArrayBuffer(byteString.length);
    const ia = new Uint8Array(ab);
    for (let i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }
    const blob = new Blob([ab], {type: mimeString});
    const url = URL.createObjectURL(blob);
    window['DOCUMENTOURL'] = url;
    FormBasedDocsApi.createEditor(formType, idOfContainer);
  }

  getEditorSession() {
    return FormBasedDocsApi.getEditorSession();
  }

  resizeDocumentContainer() {
    FormBasedDocsApi.documentToFitScreen();
  }

  buildDocument(steps: any) {
    this.currentDocumentBodyClone = this.originalDocumentBodyClone.cloneNode(true);
    // 1.- Change doc structure
    this.structuralChanges(steps);
    // 2.- Change values
    // this.replacements(steps);
  }
  /************************/
  /* CHANGE DOC STRUCTURE */
  /************************/
  structuralChanges(steps: any) {
    steps.forEach((step: any) => {
      if (step.type === 'iRadioC') {
        this.buildForRadioC(step);
      } else if (step.type === 'iCheckbox') {
        this.buildForCheckbox(step);
      }
    });
    document.getElementsByTagName('office:text')[0].parentElement.replaceChild(
      this.currentDocumentBodyClone.cloneNode(true), document.getElementsByTagName('office:text')[0]
    );
  }

  buildForRadioC(step:any) {
    const elementContainingWord = this.findword(step.wordToReplace);
    let replacement: string;
    step.radios.forEach((radio) =>{
      if (radio.checked) {
        replacement = radio.replacement;
      }
    });
    // Case where we have just one paragraph with the wordToReplace
    if (elementContainingWord.children.length === 1) {
      elementContainingWord.firstChild.innerHTML = replacement;
      // console.dir(elementContainingWord);
    }
  }

  buildForCheckbox(step: any) {
    console.log(step);
  }
  /*****************************/
  /*END OF CHANGE DOC STRUCTURE*/
  /*****************************/
  

  replacements(steps: any) {
    steps.forEach((step: any) => {
      if (step.type === 'iText') {
        const elementContainingWord = this.findword(step.wordToReplace);
        const regexp = new RegExp(step.wordToReplace, 'g');
        elementContainingWord.innerHTML =
          elementContainingWord.innerHTML
          .replace(
          regexp,
          `<span class="highlight ${step.isFocused ? 'focused' : ''}" data-identifier="${step.wordToReplace}">${step.replacement}</span>`);
      }
    });
    document.getElementsByTagName('office:text')[0].parentElement.replaceChild(
      this.currentDocumentBodyClone.cloneNode(true), document.getElementsByTagName('office:text')[0]
    );
  }

  findword(wordToReplace: string) {
    // USE ARRAY FOR ALL VALUES
    const children = this.currentDocumentBodyClone.childNodes;
    for (let i = 0; i < children.length; i++) {
      if (!this.elementIsExcluded(children[i])) {
        if (children[i].innerHTML.includes(wordToReplace)) {
          return children[i];
        }
      }
    }
  }

  elementIsExcluded(element: any) {
    const excludedElements = [
        'office:text',
        'text:sequence-decls',
        'text:sequence-decl',
        'draw:frame',
        'draw:image',
        'office:annotation',
        'office:annotation-end',
        'dc:creator',
        'dc:date'
    ];
    return excludedElements.includes(element.nodeName);
  }
}
