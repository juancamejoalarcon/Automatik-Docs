import { Injectable } from '@angular/core';
import { CommonsService } from '../../../../core';
import * as FormBasedDocsApi from '../../../../../assets/js/wodotexteditor/localfileeditor.js';
@Injectable()
export class DocumentCreatorService {

  public defaultUri = 'data:application/vnd.oasis.opendocument.text;base64,UEsDBAoAAAAAAGOjJU9exjIMJwAAACcAAAAIAAAAbWltZXR5cGVhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LnRleHRQSwMECgAAAAAAY6MlTz5S3f/bAgAA2wIAABgAAABUaHVtYm5haWxzL3RodW1ibmFpbC5wbmeJUE5HDQoaCgAAAA1JSERSAAAAtQAAAQAIAwAAAML9x+kAAAEIUExURXV8iHt8g36Bgn6JlXmKnIR3cIV8fI6CcpaFdYSAgoKIjY6JhoWNmYmQjIyRmJCHiJWJhZGLj52QhZeXmpmVlJubm5ugpKOfnaOfpq2knKqon6Wko6Wmqaulo6mppamqqqCnsKWrtqutsq6xs7Kvp7Kyrrm1r7K1urW5vbu1s7i1ubu4tbu6vr2+wb/Exb3DysG+u8C/wsvFv9HGusTDw8fGyMfLy8jFxM7JxcvKy8rN0s3S083Q2NHNx9PQzdjTytPT0tHY3NrW097Z09nZ2sjU4tbc4t/g3OHc1+Lh4eDj6eTp7ezn4err7e3u8O7x9PDt5vTx7fjy6fDy8/L1+P7+/gAAAP///1WRQz0AAAGOSURBVHja7dS5TgIBFIZR3HA3Kg5oZmTcEMExoiHqYIKIuBAjSHTe/1WsaWwshOT83ded5t5cNo3LUVNTU1NTU1NTU1NTU1NTU1NPr3o0GMuvsfr4pf5VvVwtd1qNKGun6W2ncXzVHDYH3X7/ptdr999W7gZ3rV47bT2lzXgYpJ9pcvs9CerTXLyXP4hG0WapuJ6Pt3ai2efrtWBvLiwMg+3DxcOZsLC1u7pUmM/C4k5pYeNxEtS1i+ty0DrPSnEvKIeVSrI/c/kZP5zVonpWCyudoBpUq/WTODl6byRJJQleX+7TybvGUWPY/fZDqKmpqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqampqan/vB9KFAIzFAHSlgAAAABJRU5ErkJgglBLAwQKAAAACAA6aEdP7DtlMwYDAADdEQAACwAAAGNvbnRlbnQueG1s7VhLbtswEL2KoD3N2IGLWLCdTVGgQAIUaAp0S0uUzJYSWZKKrF1P04P1JB1Sn1BxFKhNjKKFN0o082becH4UvL4+5Dy4p0ozUWzC+ewiDGgRi4QV2Sb8dPcOXYXX27VIUxbTKBFxmdPCoFgUBv4GAVgXOoLXlAG+VEUkiGY6KkhOdWTiSEhadGaRj44cVyNJdlNtE2LIjmg6sI434d4YGWEsS8VnQmU4iTHl1BpqPJ/NcY9Vl8lkLsAOeBSpptuSClLom8d7oszkHFmwb52KqaYHzVEqoES5JIbtOB26UflURxbr2+bE7PtMV1U1qy5druer1RW+BaV73N70eGrIVC6L9bmKMt9R9TtdoU09PGrTs1NdtB3u2UtFNeghh3YypnnxbXxfLripTo5Oou8nzxZARyoPczM9BAceWNPD5N61WN/2YBtJP9U5i4uLBW7UPZiz4utIl62w0/bQnD8F/Hx707Ski1GSmIZBW11vzy3CfqulsMxQCjiU0Jjr7RqPKVo5KY2AYWAxcqUCRVMy9wya/y35JvwwvwxbQUpyxutNKIkimSJy3ylAYFeqe0GN2UdDioSopIPk0N1UIUmyI0TH3btFUkFNlGFUB6lwxUCEswxO/aXUhqV157V9RRoWFVBXQsFqTAnX9CE0S9iOoj010OFxvi4Wx+mF4U+YEKIvmu2dRtp1w6pNfVcxQHtMUDyIEHpmuYyv3jzE8oivl7vnc8VZvqg4p0n9/5Thu/nicYatp/A0x/jD4PHoVLeKnUjq/sU68zYHbK7A3ZMP1ilsQ90PUqOUktewRDT0AspFQr1i+662a7c7Nf1WwkdYv3aOhYETJUxLTmokSgN7kSJO7ymsRFi8Tt3U4D3n0GzKXUmW79jZCwnu7F1xGs9Nr7y+47fN19lJfL9jWalG8/GEsCuwbLz4q8ZeH104khTHADtgW1hIygSxolDjIgtqUaqgu5KDPVX05/cfHTF46YKQz/Euw1eGMRtfKf8K9xl2hp1hZ9g/DMODzw88+DLBI7/ObH8BUEsDBAoAAAAAAGOjJU8AAAAAAAAAAAAAAAAcAAAAQ29uZmlndXJhdGlvbnMyL2FjY2VsZXJhdG9yL1BLAwQKAAAAAABjoyVPAAAAAAAAAAAAAAAAGgAAAENvbmZpZ3VyYXRpb25zMi9zdGF0dXNiYXIvUEsDBAoAAAAAAGOjJU8AAAAAAAAAAAAAAAAaAAAAQ29uZmlndXJhdGlvbnMyL3BvcHVwbWVudS9QSwMECgAAAAAAY6MlTwAAAAAAAAAAAAAAAB8AAABDb25maWd1cmF0aW9uczIvaW1hZ2VzL0JpdG1hcHMvUEsDBAoAAAAAAGOjJU8AAAAAAAAAAAAAAAAYAAAAQ29uZmlndXJhdGlvbnMyL21lbnViYXIvUEsDBAoAAAAAAGOjJU8AAAAAAAAAAAAAAAAYAAAAQ29uZmlndXJhdGlvbnMyL2Zsb2F0ZXIvUEsDBAoAAAAAAGOjJU8AAAAAAAAAAAAAAAAYAAAAQ29uZmlndXJhdGlvbnMyL3Rvb2xiYXIvUEsDBAoAAAAAAGOjJU8AAAAAAAAAAAAAAAAcAAAAQ29uZmlndXJhdGlvbnMyL3Byb2dyZXNzYmFyL1BLAwQKAAAAAABjoyVPAAAAAAAAAAAAAAAAGgAAAENvbmZpZ3VyYXRpb25zMi90b29scGFuZWwvUEsDBAoAAAAAAGOjJU+092jSgwMAAIMDAAAMAAAAbWFuaWZlc3QucmRmPD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0ic3R5bGVzLnhtbCI+CiAgICA8cmRmOnR5cGUgcmRmOnJlc291cmNlPSJodHRwOi8vZG9jcy5vYXNpcy1vcGVuLm9yZy9ucy9vZmZpY2UvMS4yL21ldGEvb2RmI1N0eWxlc0ZpbGUiLz4KICA8L3JkZjpEZXNjcmlwdGlvbj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIj4KICAgIDxuczA6aGFzUGFydCB4bWxuczpuczA9Imh0dHA6Ly9kb2NzLm9hc2lzLW9wZW4ub3JnL25zL29mZmljZS8xLjIvbWV0YS9wa2cjIiByZGY6cmVzb3VyY2U9InN0eWxlcy54bWwiLz4KICA8L3JkZjpEZXNjcmlwdGlvbj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iY29udGVudC54bWwiPgogICAgPHJk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';
  constructor(
    private commonsService: CommonsService,
  ) { }

  init() {
    this.commonsService.toggleSpinner();
    this.createEditorFromURI('fillForm', 'editorContainer', this.defaultUri);
      setTimeout(() => {
        this.resizeDocumentContainer();
        window.addEventListener('resize', this.resizeDocumentContainer);
        this.commonsService.toggleSpinner();
      }, 4000);
  }

  createEditorFromURI(formType: string, idOfContainer: string = 'editorContainer', dataURI: string) {
    // convert base64 to raw binary data held in a string
    // doesn't handle URLEncoded DataURIs - see SO answer #6850276 for code that does this
    const byteString = atob(dataURI.split(',')[1]);
    // separate out the mime component
    const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
    // write the bytes of the string to an ArrayBuffer
    const ab = new ArrayBuffer(byteString.length);
    // create a view into the buffer
    const ia = new Uint8Array(ab);
    // set the bytes of the buffer to the correct values
    for (let i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }
    // write the ArrayBuffer to a blob, and you're done
    const blob = new Blob([ab], {type: mimeString});
    // return URL
    const url = URL.createObjectURL(blob);
    window['DOCUMENTOURL'] = url;
    FormBasedDocsApi.createEditor(formType, idOfContainer);
  }

  getEditorSession() {
    return FormBasedDocsApi.getEditorSession();
  }

  resizeDocumentContainer() {
    FormBasedDocsApi.documentToFitScreen();
}

}
